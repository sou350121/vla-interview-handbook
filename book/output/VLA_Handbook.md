---
title: "VLA Handbookï¼šä»ç†è®ºåˆ°å®è·µ"
subtitle: "Vision-Language-Action å®Œå…¨æŒ‡å—"
author: "VLA Handbook Contributors"
date: "2025å¹´12æœˆ18æ—¥"
documentclass: report
geometry: margin=2.5cm
fontsize: 11pt
toc: true
toc-depth: 3
numbersections: true
colorlinks: true
linkcolor: blue
urlcolor: blue
header-includes:
  - \usepackage{ctex}
  - \usepackage{fancyhdr}
  - \pagestyle{fancy}
  - \fancyhead[L]{VLA Handbook}
  - \fancyhead[R]{\thepage}
  - \fancyfoot[C]{}
---

\newpage

# å‰è¨€

æœ¬ä¹¦æ˜¯ **VLA Handbook** é¡¹ç›®çš„å®Œæ•´ç†è®ºéƒ¨åˆ†ï¼Œç³»ç»Ÿæ€§åœ°ä»‹ç»äº†è§†è§‰-è¯­è¨€-åŠ¨ä½œ (Vision-Language-Action) æ¨¡å‹çš„æ ¸å¿ƒæ¦‚å¿µã€å…³é”®æŠ€æœ¯ä¸å·¥ç¨‹å®è·µã€‚

**é€‚ç”¨è¯»è€…**ï¼š
- å‡†å¤‡æœºå™¨äºº/å…·èº«æ™ºèƒ½æ–¹å‘é¢è¯•çš„å·¥ç¨‹å¸ˆ
- å¸Œæœ›ç³»ç»Ÿå­¦ä¹  VLA æŠ€æœ¯æ ˆçš„ç ”ç©¶è€…
- å¯¹å¤šæ¨¡æ€æœºå™¨äººæ„Ÿå…´è¶£çš„å­¦ç”Ÿ

**å¦‚ä½•ä½¿ç”¨æœ¬ä¹¦**ï¼š
1. **ç³»ç»Ÿå­¦ä¹ **ï¼šæŒ‰ç« èŠ‚é¡ºåºé˜…è¯»ï¼Œå»ºç«‹å®Œæ•´çŸ¥è¯†ä½“ç³»
2. **é¢è¯•å‡†å¤‡**ï¼šé‡ç‚¹å…³æ³¨æ¯ç« æœ«å°¾çš„ Q&A éƒ¨åˆ†
3. **æŸ¥é˜…å‚è€ƒ**ï¼šä½¿ç”¨ç›®å½•å¿«é€Ÿå®šä½ç‰¹å®šä¸»é¢˜

**åœ¨çº¿ç‰ˆæœ¬**ï¼šhttps://github.com/sou350121/VLA-Handbook

\newpage

# ç¬¬ä¸€éƒ¨åˆ†ï¼šåŸºç¡€æ¶æ„


\newpage

# ç¬¬1ç«  Transformer vs CNN


## ä¸»è¦æ•°å­¦æ€æƒ³ (Main Mathematical Idea)

> **"Global Attention vs. Local Connectivity (å½’çº³åç½®çš„æƒè¡¡)"**

Transformer å’Œ CNN çš„æ ¸å¿ƒå¯¹ç«‹åœ¨äºå¦‚ä½•å¤„ç†ä¿¡æ¯ï¼š
1.  **CNN (å·ç§¯)**: å‡è®¾ "ç›¸é‚»çš„åƒç´ æ˜¯ç›¸å…³çš„" (**Local Connectivity**) å’Œ "ç‰¹å¾åœ¨å“ªé‡Œå¹¶ä¸é‡è¦" (**Translation Invariance**)ã€‚è¿™æ˜¯ä¸€ç§å¼ºçƒˆçš„**å½’çº³åç½® (Inductive Bias)**ã€‚
2.  **Transformer (æ³¨æ„åŠ›)**: å‡è®¾ "ä»»ä½•ä¸¤ä¸ªåƒç´ ä¹‹é—´éƒ½å¯èƒ½ç›¸å…³" (**Global Attention**)ã€‚å®ƒæ²¡æœ‰é¢„è®¾çš„åç½®ï¼Œå®Œå…¨ä¾èµ–æ•°æ®é©±åŠ¨çš„å…³ç³»å‘ç° (**Content-based Interactions**)ã€‚

ä»æ•°å­¦ä¸Šè®²ï¼ŒCNN çš„å·ç§¯æ ¸æ˜¯ä¸€ä¸ª**å›ºå®š**çš„å±€éƒ¨ç®—å­ $y_i = \sum_j w_{i-j} x_j$ï¼Œè€Œ Transformer çš„æ³¨æ„åŠ›æ˜¯ä¸€ä¸ª**åŠ¨æ€**çš„å…¨å±€ç®—å­ $y_i = \sum_j \text{softmax}(q_i^T k_j) v_j$ï¼Œå…¶ä¸­æƒé‡å–å†³äºè¾“å…¥æœ¬èº«ã€‚

---

åœ¨ VLA (Vision-Language-Action) é¢è¯•ä¸­ï¼Œç†è§£ Backbone (éª¨å¹²ç½‘ç»œ) çš„å·®å¼‚è‡³å…³é‡è¦ã€‚è™½ç„¶ç°åœ¨çš„è¶‹åŠ¿æ˜¯ Transformer (ViT) ä¸€ç»Ÿå¤©ä¸‹ï¼Œä½† CNN (ResNet, EfficientNet) ä¾ç„¶åœ¨ RT-1 ç­‰ç»å…¸æ¨¡å‹ä¸­æ‰®æ¼”é‡è¦è§’è‰²ã€‚

## 1. æ ¸å¿ƒå·®å¼‚ä¸€è§ˆè¡¨

| ç‰¹æ€§ | CNN (å·ç§¯ç¥ç»ç½‘ç»œ) | Transformer (è‡ªæ³¨æ„åŠ›æœºåˆ¶) |
| :--- | :--- | :--- |
| **æ ¸å¿ƒæ“ä½œ** | Convolution (å·ç§¯) | Self-Attention (è‡ªæ³¨æ„åŠ›) |
| **æ„Ÿå—é‡ (Receptive Field)** | å±€éƒ¨ (Local) -> é€æ¸æ‰©å¤§ | å…¨å±€ (Global) |
| **å½’çº³åç½® (Inductive Bias)** | å¼º (å¹³ç§»ä¸å˜æ€§, å±€éƒ¨æ€§) | å¼± (éœ€æµ·é‡æ•°æ®å­¦ä¹ ) |
| **è®¡ç®—å¤æ‚åº¦** | $O(N)$ (çº¿æ€§) | $O(N^2)$ (å¹³æ–¹çº§) |
| **å¹¶è¡Œæ€§** | é«˜ | æé«˜ |
| **æ“…é•¿é¢†åŸŸ** | å›¾åƒçº¹ç†, è¾¹ç¼˜æ£€æµ‹ | è¯­ä¹‰ç†è§£, é•¿è·ç¦»ä¾èµ– |
| **ä»£è¡¨æ¨¡å‹** | ResNet, EfficientNet | ViT, BERT, GPT |

## 2. CNN (Convolutional Neural Networks)

### åŸç†
CNN æ¨¡ä»¿ç”Ÿç‰©è§†è§‰çš®å±‚ï¼Œé€šè¿‡**æ»‘åŠ¨çª—å£ (Sliding Window)** æå–ç‰¹å¾ã€‚
- **å±€éƒ¨æ€§ (Locality)**: æ¯æ¬¡åªçœ‹ä¸€å°å—åŒºåŸŸ (e.g., 3x3 åƒç´ )ã€‚
- **å¹³ç§»ä¸å˜æ€§ (Translation Invariance)**: çŒ«åœ¨å›¾ç‰‡å·¦ä¸Šè§’è¿˜æ˜¯å³ä¸‹è§’ï¼Œè¯†åˆ«å‡ºçš„ç‰¹å¾æ˜¯ä¸€æ ·çš„ã€‚
- **å±‚çº§ç»“æ„**: æµ…å±‚å­¦è¾¹ç¼˜/çº¹ç†ï¼Œæ·±å±‚å­¦å½¢çŠ¶/ç‰©ä½“ã€‚

### åœ¨ VLA ä¸­çš„åº”ç”¨
- **RT-1**: ä½¿ç”¨ **EfficientNet-B3** ä½œä¸ºè§†è§‰ç¼–ç å™¨ã€‚
- **ä¼˜åŠ¿**: è®­ç»ƒæ”¶æ•›å¿«ï¼Œå¯¹å°æ•°æ®é›†å‹å¥½ (å› ä¸ºæœ‰å¾ˆå¼ºçš„å½’çº³åç½®)ã€‚
- **åŠ£åŠ¿**: éš¾ä»¥æ•æ‰é•¿è·ç¦»å…³ç³» (æ¯”å¦‚ï¼šæ¡Œå­å·¦è¾¹çš„æ¯å­å’Œæ¡Œå­å³è¾¹çš„å£¶ä¹‹é—´çš„å…³ç³»ï¼ŒCNN éœ€è¦å †å å¾ˆå¤šå±‚æ‰èƒ½"çœ‹"åˆ°ä¸¤è€…)ã€‚

## 3. Transformer (Attention Is All You Need)

### åŸç†
Transformer æŠ›å¼ƒäº†å·ç§¯ï¼Œå®Œå…¨ä¾èµ– **Self-Attention (è‡ªæ³¨æ„åŠ›æœºåˆ¶)**ã€‚
- **å…¨å±€æ„Ÿå—é‡**: æ¯ä¸€ä¸ª Token (åƒç´ å—) éƒ½èƒ½ç›´æ¥"å…³æ³¨"åˆ°å›¾åƒä¸­çš„å…¶ä»–æ‰€æœ‰ Tokenã€‚
- **åŠ¨æ€æƒé‡**: å·ç§¯æ ¸çš„æƒé‡æ˜¯å›ºå®šçš„ (è®­ç»ƒå¥½å)ï¼Œè€Œ Attention Map æ˜¯æ ¹æ®è¾“å…¥åŠ¨æ€ç”Ÿæˆçš„ã€‚

### åœ¨ VLA ä¸­çš„åº”ç”¨
- **RT-2 / OpenVLA / Pi0**: ä½¿ç”¨ **ViT (Vision Transformer)** æˆ– **SigLIP**ã€‚
- **ä¼˜åŠ¿**:
    - **å¤šæ¨¡æ€ç»Ÿä¸€**: å›¾åƒ Patch å’Œæ–‡æœ¬ Token å¯ä»¥è¢«åŒç­‰å¯¹å¾…ï¼Œç›´æ¥æ‹¼æ¥è¾“å…¥ Transformerã€‚
    - **Scaling Law**: æ•°æ®è¶Šå¤šï¼Œæ¨¡å‹è¶Šå¤§ï¼Œæ•ˆæœè¶Šå¥½ (ç”±å¼±å½’çº³åç½®å†³å®š)ã€‚
- **åŠ£åŠ¿**: è®­ç»ƒæå…¶æ˜‚è´µï¼Œéœ€è¦æµ·é‡æ•°æ® (JFT-300M, LAION-5B) æ‰èƒ½è¶…è¶Š CNNã€‚

## 4. ä¸ºä»€ä¹ˆ VLA è½¬å‘ Transformer?

1.  **å¤šæ¨¡æ€èåˆ**: æœºå™¨äººéœ€è¦åŒæ—¶å¤„ç†è§†è§‰ (Vision) å’Œè¯­è¨€ (Language)ã€‚Transformer æ˜¯ç›®å‰å”¯ä¸€èƒ½å®Œç¾ç»Ÿä¸€è¿™ä¸¤ç§æ¨¡æ€çš„æ¶æ„ (Early Fusion)ã€‚
2.  **è¯­ä¹‰ç†è§£**: æœºå™¨äººä¸å†åªæ˜¯"æ‰§è¡ŒåŠ¨ä½œ"ï¼Œè€Œæ˜¯éœ€è¦"ç†è§£ç¯å¢ƒ"ã€‚Transformer åœ¨è¯­ä¹‰æå–ä¸Šè¿œå¼ºäº CNNã€‚
3.  **æ—¶åºå»ºæ¨¡**: åŠ¨ä½œåºåˆ— (Action Sequence) æœ¬è´¨ä¸Šæ˜¯æ—¶é—´åºåˆ—ã€‚Transformer (GPT é£æ ¼) å¤©ç”Ÿé€‚åˆå¤„ç†åºåˆ—é¢„æµ‹é—®é¢˜ã€‚

## 5. æ·±åº¦è§£æ: ViT & SigLIP æŠ€æœ¯ç»†èŠ‚
åœ¨ OpenVLA å’Œ Pi0 ç­‰ç°ä»£æ¨¡å‹ä¸­ï¼ŒViT (Vision Transformer) é€šå¸¸æ­é… **SigLIP** é¢„è®­ç»ƒç›®æ ‡ä½¿ç”¨ã€‚

### 5.1 Vision Transformer (ViT) æ ¸å¿ƒç»„ä»¶
ViT å°†å›¾åƒè§†ä¸ºä¸€ç³»åˆ— Patch çš„åºåˆ—ï¼Œå®Œå…¨æ‘’å¼ƒäº†å·ç§¯ã€‚

1.  **Patchify & Linear Projection (åˆ‡ç‰‡ä¸çº¿æ€§æ˜ å°„)**:
    - è¾“å…¥å›¾åƒ $x \in \mathbb{R}^{H \times W \times C}$ è¢«åˆ‡åˆ†ä¸º $N$ ä¸ª $P \times P$ çš„ Patch $x_p \in \mathbb{R}^{N \times (P^2 \cdot C)}$ã€‚
    - **å…¬å¼**:
      $$
      z_0 = [x_p^1 E; x_p^2 E; \cdots; x_p^N E] + E_{pos}
      $$
      å…¶ä¸­ $E \in \mathbb{R}^{(P^2 \cdot C) \times D}$ æ˜¯å¯å­¦ä¹ çš„çº¿æ€§æŠ•å½±çŸ©é˜µï¼Œ$E_{pos} \in \mathbb{R}^{(N+1) \times D}$ æ˜¯ä½ç½®ç¼–ç ã€‚
    - **å…³é”®ç»†èŠ‚**: è¿™ä¸€æ­¥ç­‰ä»·äºä¸€ä¸ª `Conv2d(in_channels=3, out_channels=D, kernel_size=P, stride=P)` æ“ä½œã€‚

2.  **Positional Embedding Interpolation (ä½ç½®ç¼–ç æ’å€¼)**:
    - **é—®é¢˜**: VLA ä»»åŠ¡ä¸­ï¼Œè¾“å…¥å›¾åƒåˆ†è¾¨ç‡å¯èƒ½å˜åŒ– (e.g., 224x224 -> 384x384)ï¼Œå¯¼è‡´ Patch æ•°é‡ $N$ å˜åŒ–ã€‚
    - **è§£å†³æ–¹æ¡ˆ**: é¢„è®­ç»ƒçš„ 1D ä½ç½®ç¼–ç ä¸èƒ½ç›´æ¥ç”¨ã€‚éœ€è¦å°†å…¶ reshape æˆ 2D ç½‘æ ¼ï¼Œè¿›è¡Œ **åŒçº¿æ€§æ’å€¼ (Bicubic/Bilinear Interpolation)** åˆ°æ–°çš„å°ºå¯¸ï¼Œå†å±•å¹³å› 1Dã€‚è¿™æ˜¯ ViT èƒ½å¤„ç†ä¸åŒåˆ†è¾¨ç‡çš„å…³é”®ã€‚

3.  **CLS Token vs Average Pooling**:
    - **CLS Token**: åŸå§‹ ViT åœ¨åºåˆ—å¼€å¤´åŠ ä¸€ä¸ªç‰¹æ®Šçš„ `[CLS]` Tokenï¼Œå…¶è¾“å‡ºä½œä¸ºæ•´å¼ å›¾çš„ç‰¹å¾ (BERT é£æ ¼)ã€‚
    - **Average Pooling (GAP)**: ç°ä»£ ViT (å¦‚ SigLIP) å¾€å¾€å»æ‰ CLS Tokenï¼Œç›´æ¥å¯¹æ‰€æœ‰ Patch çš„è¾“å‡ºå–å¹³å‡ (Global Average Pooling)ã€‚
      - **ä¼˜åŠ¿**: èƒ½å¤Ÿåˆ©ç”¨å…¨å›¾ä¿¡æ¯ï¼Œä¸”å¯¹ Learning Rate æ›´é²æ£’ (MAP è®ºæ–‡æŒ‡å‡º GAP ä¼˜äº CLS)ã€‚

### 5.2 SigLIP (Sigmoid Loss for Language Image Pre-training)
OpenVLA çš„è§†è§‰ç¼–ç å™¨ä½¿ç”¨çš„æ˜¯ **SigLIP** (æ¥è‡ª Google DeepMind)ï¼Œè€Œéä¼ ç»Ÿçš„ CLIPã€‚

#### 1. ä¸ºä»€ä¹ˆä¸ç”¨ CLIP (Softmax Loss)?
ä¼ ç»Ÿçš„ CLIP ä½¿ç”¨ **InfoNCE Loss** (åŸºäº Softmax)ï¼Œéœ€è¦ç»´æŠ¤å·¨å¤§çš„è´Ÿæ ·æœ¬å¯¹ (Negative Pairs)ã€‚
$$
L_{CLIP} = -\frac{1}{N} \sum_{i=1}^N \log \frac{e^{x_i \cdot y_i / \tau}}{\sum_{j=1}^N e^{x_i \cdot y_j / \tau}}
$$
- **é€šä¿¡ç“¶é¢ˆ**: åˆ†æ¯ $\sum e^{...}$ éœ€è¦èšåˆæ‰€æœ‰ GPU ä¸Šçš„æ‰€æœ‰æ ·æœ¬ (Global Reduction)ã€‚åœ¨åˆ†å¸ƒå¼è®­ç»ƒä¸­ï¼Œè¿™ä¼šå¯¼è‡´å·¨å¤§çš„é€šä¿¡å¼€é”€ã€‚

#### 2. SigLIP çš„åˆ›æ–° (Sigmoid Loss)
SigLIP å°† $N \times N$ çš„åŒ¹é…é—®é¢˜è½¬åŒ–ä¸º **$N^2$ ä¸ªç‹¬ç«‹çš„äºŒåˆ†ç±»é—®é¢˜**ã€‚
$$
L_{SigLIP} = - \frac{1}{N} \sum_{i=1}^N \sum_{j=1}^N \left[ \mathbb{I}_{i=j} \log \sigma(x_i \cdot y_j / \tau + b) + \mathbb{I}_{i \neq j} \log (1 - \sigma(x_i \cdot y_j / \tau + b)) \right]
$$
- **$\mathbb{I}_{i=j}$**: æ­£æ ·æœ¬å¯¹ (å¯¹è§’çº¿)ï¼Œæ ‡ç­¾ä¸º 1ã€‚
- **$\mathbb{I}_{i \neq j}$**: è´Ÿæ ·æœ¬å¯¹ (éå¯¹è§’çº¿)ï¼Œæ ‡ç­¾ä¸º 0ã€‚
- **ä¼˜åŠ¿**:
    1.  **æ— éœ€å…¨å±€åŒæ­¥**: æ¯ä¸ª GPU åªéœ€å¤„ç†è‡ªå·±æ‰‹å¤´çš„è´Ÿæ ·æœ¬ï¼Œæ¢¯åº¦è®¡ç®—æ˜¯å±€éƒ¨çš„ã€‚
    2.  **Batch Size ç‹¬ç«‹**: æ€§èƒ½ä¸å†å¼ºä¾èµ–äºè¶…å¤§ Batch Size (CLIP éœ€è¦å¤§ Batch æä¾›è¶³å¤Ÿè´Ÿæ ·æœ¬ï¼ŒSigLIP å¯¹ Batch å¤§å°ä¸æ•æ„Ÿ)ã€‚

#### 3. å…³é”®å®ç°ç»†èŠ‚: Bias Initialization
SigLIP å¼•å…¥äº†ä¸€ä¸ªå¯å­¦ä¹ çš„ Bias $b$ (é€šå¸¸åˆå§‹åŒ–ä¸º $- \log N$)ã€‚
- **åŸå› **: åœ¨è®­ç»ƒåˆæœŸï¼Œæ­£æ ·æœ¬æå°‘ (1ä¸ª)ï¼Œè´Ÿæ ·æœ¬æå¤š ($N-1$ä¸ª)ã€‚å¦‚æœ Bias ä¸º 0ï¼ŒSigmoid è¾“å‡º 0.5ï¼Œä¼šå¯¼è‡´å·¨å¤§çš„åˆå§‹ Loss (å› ä¸ºå¤§éƒ¨åˆ†åº”è¯¥æ˜¯ 0)ã€‚
- **Trick**: åˆå§‹åŒ– $b = -10$ æˆ– $- \log N$ï¼Œå¼ºåˆ¶åˆå§‹æ¦‚ç‡æ¥è¿‘ 0ï¼ŒåŒ¹é…è´Ÿæ ·æœ¬å ä¸»å¯¼çš„å…ˆéªŒåˆ†å¸ƒï¼Œæå¤§åœ°ç¨³å®šäº†è®­ç»ƒã€‚

## 6. è‡ªæ³¨æ„åŠ›æœºåˆ¶è¯¦è§£ (Self-Attention Deep Dive)

### 6.1 è®¡ç®—å…¬å¼

è‡ªæ³¨æ„åŠ›æœºåˆ¶çš„æ ¸å¿ƒå…¬å¼ï¼š

$$
\text{Attention}(Q, K, V) = \text{softmax}\left(\frac{QK^T}{\sqrt{d_k}}\right) V
$$

å…¶ä¸­ï¼š
- $Q = XW_Q$, $K = XW_K$, $V = XW_V$ (çº¿æ€§æŠ•å½±)
- $d_k$: Key çš„ç»´åº¦ (ç”¨äºç¼©æ”¾ï¼Œé˜²æ­¢ç‚¹ç§¯è¿‡å¤§å¯¼è‡´ softmax é¥±å’Œ)
- $X \in \mathbb{R}^{N \times d}$: è¾“å…¥åºåˆ— (N ä¸ª Tokenï¼Œæ¯ä¸ª d ç»´)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Self-Attention è®¡ç®—æµç¨‹                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   è¾“å…¥ X [N, d]                                                 â”‚
â”‚       â”‚                                                         â”‚
â”‚       â”œâ”€â”€â–¶ W_Q â”€â”€â–¶ Q [N, d_k]                                   â”‚
â”‚       â”œâ”€â”€â–¶ W_K â”€â”€â–¶ K [N, d_k]                                   â”‚
â”‚       â””â”€â”€â–¶ W_V â”€â”€â–¶ V [N, d_v]                                   â”‚
â”‚                                                                 â”‚
â”‚   Step 1: QK^T / âˆšd_k  â”€â”€â–¶  Attention Scores [N, N]             â”‚
â”‚   Step 2: softmax(...)  â”€â”€â–¶  Attention Weights [N, N]           â”‚
â”‚   Step 3: Weights Ã— V   â”€â”€â–¶  Output [N, d_v]                    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 è®¡ç®—å¤æ‚åº¦åˆ†æ

| æ­¥éª¤ | æ“ä½œ | æ—¶é—´å¤æ‚åº¦ | ç©ºé—´å¤æ‚åº¦ |
| :--- | :--- | :--- | :--- |
| çº¿æ€§æŠ•å½± | $XW_Q, XW_K, XW_V$ | $O(Nd^2)$ | $O(Nd)$ |
| $QK^T$ | çŸ©é˜µä¹˜æ³• | $O(N^2 d)$ | $O(N^2)$ âš ï¸ |
| Softmax | æŒ‰è¡Œå½’ä¸€åŒ– | $O(N^2)$ | $O(N^2)$ |
| $\text{Attn} \times V$ | çŸ©é˜µä¹˜æ³• | $O(N^2 d)$ | $O(Nd)$ |
| **æ€»è®¡** | | **$O(N^2 d)$** | **$O(N^2)$** |

**å…³é”®æ´å¯Ÿ**:
- **æ—¶é—´å¤æ‚åº¦**: $O(N^2 d)$ï¼Œå¯¹åºåˆ—é•¿åº¦ $N$ æ˜¯å¹³æ–¹çº§
- **ç©ºé—´å¤æ‚åº¦**: $O(N^2)$ï¼Œéœ€è¦å­˜å‚¨å®Œæ•´çš„ $N \times N$ æ³¨æ„åŠ›çŸ©é˜µ
- **ç“¶é¢ˆ**: å½“ $N$ å¾ˆå¤§æ—¶ (å¦‚ VLA ä¸­å¤šå¸§å›¾åƒ + è¯­è¨€ Token)ï¼Œæ˜¾å­˜æˆä¸ºä¸»è¦ç“¶é¢ˆ
- **è§£å†³æ–¹æ¡ˆ**: Flash Attention (å‚è§ [flash_attention.md](./flash_attention.md))

### 6.3 Multi-Head Attention

å°†æ³¨æ„åŠ›åˆ†æˆå¤šä¸ª"å¤´"ï¼Œæ¯ä¸ªå¤´å…³æ³¨ä¸åŒçš„ç‰¹å¾å­ç©ºé—´ï¼š

$$
\text{MultiHead}(Q, K, V) = \text{Concat}(\text{head}_1, ..., \text{head}_h) W^O
$$

$$
\text{head}_i = \text{Attention}(QW_i^Q, KW_i^K, VW_i^V)
$$

**ä¼˜åŠ¿**:
- ä¸åŒå¤´å¯ä»¥å…³æ³¨ä¸åŒç±»å‹çš„å…³ç³» (ä½ç½®ã€è¯­ä¹‰ã€çº¹ç†ç­‰)
- å‚æ•°é‡ä¸å˜ ($d_k = d / h$)ï¼Œä½†è¡¨è¾¾èƒ½åŠ›æ›´å¼º

---

## 7. é¢è¯•å¸¸è§é—®é¢˜

**Q: è‡ªæ³¨æ„åŠ›æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿè®¡ç®—å¤æ‚åº¦æ€ä¹ˆç®—ï¼Ÿ**
A: è‡ªæ³¨æ„åŠ›è®©åºåˆ—ä¸­æ¯ä¸ªä½ç½®éƒ½èƒ½ç›´æ¥å…³æ³¨å…¶ä»–æ‰€æœ‰ä½ç½®ã€‚è®¡ç®— $QK^T$ éœ€è¦ $O(N^2 d)$ æ—¶é—´å’Œ $O(N^2)$ ç©ºé—´ï¼Œå…¶ä¸­ $N$ æ˜¯åºåˆ—é•¿åº¦ï¼Œ$d$ æ˜¯ç‰¹å¾ç»´åº¦ã€‚è¿™æ˜¯ Transformer å¤„ç†é•¿åºåˆ—æ—¶çš„ä¸»è¦ç“¶é¢ˆã€‚

**Q: ä¸ºä»€ä¹ˆè¦é™¤ä»¥ $\sqrt{d_k}$ï¼Ÿ**
A: å½“ $d_k$ è¾ƒå¤§æ—¶ï¼Œ$QK^T$ çš„ç‚¹ç§¯å€¼ä¼šå¾ˆå¤§ï¼Œå¯¼è‡´ softmax è¾“å‡ºæ¥è¿‘ one-hot (æ¢¯åº¦æ¶ˆå¤±)ã€‚é™¤ä»¥ $\sqrt{d_k}$ å¯ä»¥ç¨³å®šæ¢¯åº¦ã€‚

**Q: ä¸ºä»€ä¹ˆ ViT éœ€è¦æ¯” ResNet æ›´å¤šçš„æ•°æ®?**
A: å› ä¸º ViT ç¼ºä¹ **å½’çº³åç½® (Inductive Bias)**ã€‚CNN å¤©ç”ŸçŸ¥é“"ç›¸é‚»åƒç´ ç›¸å…³"å’Œ"å¹³ç§»ä¸å˜"ï¼Œè€Œ ViT å¿…é¡»ä»æ•°æ®ä¸­è‡ªå·±å­¦ä¹ è¿™äº›è§„å¾‹ã€‚

**Q: ä»€ä¹ˆæ˜¯ Patchify?**
A: å°†ä¸€å¼ å›¾ç‰‡åˆ‡æˆä¸€ä¸ªä¸ªå°æ–¹å— (e.g., 16x16 åƒç´ )ï¼Œæ‹‰å¹³æˆå‘é‡ï¼Œä½œä¸º Transformer çš„è¾“å…¥ Tokenã€‚è¿™ç›¸å½“äº NLP ä¸­çš„åˆ†è¯ (Tokenization)ã€‚


---

\newpage

# ç¬¬2ç«  Flash Attention ä¸æ¨ç†ä¼˜åŒ–


Flash Attention æ˜¯ Transformer æ¨¡å‹ï¼ˆåŒ…æ‹¬ VLAï¼‰åœ¨éƒ¨ç½²æ—¶çš„æ ¸å¿ƒä¼˜åŒ–æŠ€æœ¯ï¼Œè§£å†³äº†æ ‡å‡† Attention çš„å†…å­˜ç“¶é¢ˆé—®é¢˜ã€‚

## 0. ä¸»è¦æ•¸å­¸æ€æƒ³ (Main Mathematical Idea)

> **ç¬¬ä¸€æ€§åŸç†**: **Locality of Reference (å¼•ç”¨çš„å±€éƒ¨æ€§ / Tiling)**

åœ¨ç°ä»£è®¡ç®—ç¡¬ä»¶ï¼ˆGPUï¼‰ä¸­ï¼Œ**æ¬è¿æ•°æ®**æ¯”**è®¡ç®—æ•°æ®**è¦æ…¢å¾—å¤šä¸”æ˜‚è´µå¾—å¤šã€‚æ•°å­¦å…¬å¼ç­‰ä»·å¹¶ä¸ä»£è¡¨è®¡ç®—æ•ˆç‡ç­‰ä»·ã€‚

- **æ ¸å¿ƒæ•°å­¦å·¥å…·**: **Block Matrix Multiplication (åˆ†å—çŸ©é˜µä¹˜æ³•)** ä¸ **Online Statistics (åœ¨çº¿ç»Ÿè®¡é‡)**ã€‚
- **è§£é¢˜é€»è¾‘**:
    1.  **åˆ†å— (Tiling)**: å°†å·¨å¤§çš„çŸ©é˜µ $N \times N$ åˆ‡åˆ†æˆå°å—ï¼Œä½¿å¾—æ¯ä¸ªå°å—å¯ä»¥å®Œå…¨å¡è¿› GPU æå¿«çš„ç‰‡ä¸Šç¼“å­˜ (SRAM)ã€‚
    2.  **åœ¨çº¿ Softmax**: æ ‡å‡† Softmax éœ€è¦éå†å…¨è¡Œæ‰èƒ½è®¡ç®—å½’ä¸€åŒ–å› å­ã€‚Flash Attention åˆ©ç”¨æ•°å­¦æŠ€å·§ ($e^{x-m}$)ï¼Œä½¿å¾— Softmax å¯ä»¥åˆ†å—å¢é‡è®¡ç®—ï¼Œæ— éœ€ç­‰å¾…å…¨è¡Œç»“æœã€‚
    3.  **é‡è®¡ç®—**: æœ‰æ—¶ä¸ºäº†çœå»æ˜‚è´µçš„æ˜¾å­˜è¯»å†™ (HBM I/O)ï¼Œå®æ„¿åœ¨ SRAM ä¸­é‡æ–°ç®—ä¸€éï¼ˆRecomputationï¼‰ã€‚è¿™æ˜¯å…¸å‹çš„"æ—¶é—´æ¢ç©ºé—´ï¼Œç©ºé—´æ¢å¸¦å®½"ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Flash Attention vs æ ‡å‡† Attention                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   æ ‡å‡† Attention (å†…å­˜ç“¶é¢ˆ)           Flash Attention (åˆ†å—)    â”‚
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚      Q Â· K^T      â”‚               â”‚   Qâ‚Â·Kâ‚  Qâ‚Â·Kâ‚‚   â”‚     â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚               â”‚  â”Œâ”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”  â”‚     â”‚
â”‚   â”‚   â”‚             â”‚ â”‚   â”€â”€â”€â”€â–¶       â”‚  â”‚ å—1 â”‚â”‚ å—2 â”‚  â”‚     â”‚
â”‚   â”‚   â”‚   N Ã— N     â”‚ â”‚   åˆ†å—        â”‚  â””â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”˜  â”‚     â”‚
â”‚   â”‚   â”‚  (å·¨å¤§!)    â”‚ â”‚               â”‚  â”Œâ”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”  â”‚     â”‚
â”‚   â”‚   â”‚             â”‚ â”‚               â”‚  â”‚ å—3 â”‚â”‚ å—4 â”‚  â”‚     â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚               â”‚  â””â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”˜  â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚   å†…å­˜: O(NÂ²) âŒ                       å†…å­˜: O(N) âœ…             â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        å†…å­˜å±‚çº§ä¼˜åŒ–                              â”‚
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚   â”‚      HBM       â”‚     â”‚     SRAM       â”‚                     â”‚
â”‚   â”‚   (æ˜¾å­˜)       â”‚     â”‚   (L2 Cache)   â”‚                     â”‚
â”‚   â”‚   24GB+        â”‚ â—€â”€â–¶ â”‚    ~20MB       â”‚                     â”‚
â”‚   â”‚   æ…¢ 1TB/s     â”‚     â”‚   å¿« 19TB/s    â”‚                     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚          â”‚                      â”‚                               â”‚
â”‚          â”‚   æ ‡å‡†: å¤šæ¬¡è¯»å†™      â”‚   Flash: ä¸€æ¬¡åŠ è½½             â”‚
â”‚          â”‚   Q,K â”€â”€â–¶ S â”€â”€â–¶ P    â”‚   å…¨éƒ¨åœ¨ SRAM è®¡ç®—            â”‚
â”‚          â”‚   æ¯æ­¥å†™å› HBM       â”‚   åªå†™æœ€ç»ˆç»“æœ                 â”‚
â”‚          â”‚                      â”‚                               â”‚
â”‚   ç»“æœ: 2-4x åŠ é€Ÿ, æ˜¾å­˜ O(NÂ²) â†’ O(N)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 1. ä¸ºä»€ä¹ˆéœ€è¦ Flash Attention?

### æ ‡å‡† Attention çš„é—®é¢˜
æ ‡å‡†çš„ Scaled Dot-Productæ ‡å‡† Attention è®¡ç®—å…¬å¼ï¼š

```
Attention(Q, K, V) = softmax(QÂ·K^T / âˆšd_k) Â· V
```

- **å†…å­˜ç“¶é¢ˆ**: è®¡ç®— $QK^T$ éœ€è¦å­˜å‚¨ $N \times N$ çš„æ³¨æ„åŠ›çŸ©é˜µï¼Œå…¶ä¸­ $N$ æ˜¯åºåˆ—é•¿åº¦ã€‚
- **å®ä¾‹**: å¯¹äº ViT (åºåˆ—é•¿åº¦ 196), $196 \times 196 = 38,416$ ä¸ªæµ®ç‚¹æ•°ã€‚VLA ä¸­è‹¥åŒ…å«å¤šå¸§å›¾åƒï¼Œ$N$ å¯èƒ½è¾¾åˆ°æ•°åƒã€‚
- **æ˜¾å­˜å ç”¨**: $O(N^2)$ çš„å†…å­˜å ç”¨ä½¿å¾—é•¿åºåˆ—æ¨ç†å‡ ä¹ä¸å¯è¡Œã€‚

## 2. Flash Attention çš„æ ¸å¿ƒæ€æƒ³

### Tiling (åˆ†å—è®¡ç®—)
Flash Attention é€šè¿‡ **åˆ†å— (Tiling)** é¿å…å®é™…å­˜å‚¨å®Œæ•´çš„ $QK^T$ çŸ©é˜µã€‚

**ç®—æ³•æµç¨‹**:
1. å°† $Q, K, V$ åˆ†å‰²æˆå°å— (Tiles)ã€‚
2. é€å—è®¡ç®— Attentionï¼Œåœ¨ SRAM (L2 Cache) ä¸­å®Œæˆã€‚
3. ä½¿ç”¨ **åœ¨çº¿ Softmax (Online Softmax)** æŠ€æœ¯å¢é‡æ›´æ–°å½’ä¸€åŒ–ã€‚
4. æœ€ç»ˆåˆå¹¶ç»“æœï¼Œé¿å…å°†ä¸­é—´ç»“æœå†™å› HBM (High Bandwidth Memory)ã€‚

### 2.1 Kernel Fusion (ç®—å­èåˆ): IO-Aware Computing
Flash Attention çš„æ ¸å¿ƒæ´å¯Ÿæ˜¯ï¼š**Transformer çš„ç“¶é¢ˆä¸åœ¨è®¡ç®— (FLOPs)ï¼Œè€Œåœ¨æ˜¾å­˜è¯»å†™ (HBM IO)**ã€‚

-   **HBM vs SRAM**:
    -   **HBM (High Bandwidth Memory)**: æ˜¾å­˜ï¼Œå®¹é‡å¤§ (24GB+)ï¼Œä½†é€Ÿåº¦æ…¢ (1-2 TB/s)ã€‚
    -   **SRAM (L2 Cache)**: ç‰‡ä¸Šç¼“å­˜ï¼Œå®¹é‡å° (å‡ å MB)ï¼Œä½†é€Ÿåº¦æå¿« (19 TB/s+)ã€‚
-   **æ ‡å‡† Attention**: éœ€è¦å¤šæ¬¡è¯»å†™ HBMã€‚
    1.  è¯» $Q, K$ -> ç®— $S = QK^T$ -> å†™å› HBM ($N^2$)ã€‚
    2.  è¯» $S$ -> ç®— $P = \text{softmax}(S)$ -> å†™å› HBM ($N^2$)ã€‚
    3.  è¯» $P, V$ -> ç®— $O = PV$ -> å†™å› HBMã€‚
-   **Flash Attention Fusion**:
    -   å°†ä¸Šè¿°æ‰€æœ‰æ­¥éª¤èåˆè¿›**åŒä¸€ä¸ª CUDA Kernel**ã€‚
    -   æ•°æ®ä¸€æ—¦ä» HBM åŠ è½½åˆ° SRAMï¼Œå°±åœ¨ SRAM ä¸­å®Œæˆ $QK^T$, Softmax, $PV$ çš„æ‰€æœ‰è®¡ç®—ï¼ŒåªæŠŠæœ€ç»ˆç»“æœ $O$ å†™å› HBMã€‚
    -   **ç»“æœ**: HBM è¯»å†™é‡ä» $O(N^2)$ é™ä½åˆ° $O(N)$ï¼Œå°½ç®¡ FLOPs æ²¡å˜ï¼Œä½†ç«¯åˆ°ç«¯é€Ÿåº¦æå‡äº† 2-4 å€ã€‚

### 2.2 Recomputation (é‡è®¡ç®—): æ¢å–æ˜¾å­˜çš„è‰ºæœ¯
åœ¨è®­ç»ƒæ—¶çš„åå‘ä¼ æ’­ (Backward Pass) ä¸­ï¼Œé€šå¸¸éœ€è¦ä¿å­˜å‰å‘ä¼ æ’­çš„ä¸­é—´æ¿€æ´»å€¼ (Activations) æ¥è®¡ç®—æ¢¯åº¦ã€‚

-   **æ ‡å‡†åšæ³•**: ä¿å­˜å·¨å¤§çš„ $N \times N$ æ³¨æ„åŠ›çŸ©é˜µ $P$ã€‚è¿™ç›´æ¥å¯¼è‡´äº† OOM (Out of Memory)ã€‚
-   **Flash Attention åšæ³•**:
    -   **ä¸ä¿å­˜** $P$ çŸ©é˜µã€‚
    -   åœ¨åå‘ä¼ æ’­æ—¶ï¼Œåˆ©ç”¨ä¿å­˜åœ¨ SRAM ä¸­çš„ $Q, K, V$ å—ï¼Œ**é‡æ–°è®¡ç®—**ä¸€é Attentionã€‚
-   **ä¸ºä»€ä¹ˆæ›´å¿«?**
    -   ç›´è§‰ä¸Šï¼Œé‡è®¡ç®—ä¼šå¢åŠ  FLOPsï¼Œåº”è¯¥å˜æ…¢ã€‚
    -   ä½†ç”±äº Attention æ˜¯ **IO-Bound** (å—é™äºå¸¦å®½) çš„ï¼Œé‡è®¡ç®—å¸¦æ¥çš„é¢å¤– FLOPs å¼€é”€ï¼Œè¿œå°äºä» HBM è¯»å–å·¨å¤§çŸ©é˜µ $P$ çš„æ—¶é—´å¼€é”€ã€‚
    -   **ç»“è®º**: Recomputation ä¸ä»…çœäº†æ˜¾å­˜ï¼Œåè€Œå› ä¸ºå‡å°‘äº† IO è€Œå˜å¿«äº†ã€‚

### æ•°å­¦æ¨å¯¼ï¼šåœ¨çº¿ Softmax

æ ‡å‡† Softmax éœ€è¦ä¸¤æ¬¡æ‰«æåºåˆ—ï¼ˆä¸€æ¬¡æ±‚å’Œï¼Œä¸€æ¬¡å½’ä¸€åŒ–ï¼‰ã€‚Flash Attention ä½¿ç”¨å¢é‡æ›´æ–°ï¼š

```
softmax(x)_i = exp(x_i) / Î£ exp(x_j)  (j=1 åˆ° N)
```

é€šè¿‡ç»´æŠ¤è¿è¡Œä¸­çš„ **æœ€å¤§å€¼ m** å’Œ **ç´¯ç§¯å’Œ l**ï¼Œå¯ä»¥é€å—æ›´æ–°ï¼š

```
m_new = max(m_old, m_block)

l_new = exp(m_old - m_new) * l_old + exp(m_block - m_new) * l_block
```

## 3. åœ¨ VLA ä¸­çš„åº”ç”¨

### Wall-X / OpenVLA
- **Wall-X**: requirements.txt ä¸­æ˜ç¡®ä¾èµ– `flash-attn==2.7.4`ã€‚
- **OpenVLA**: æ”¯æŒ Flash Attention 2 åŠ é€Ÿæ¨ç†ï¼Œå°¤å…¶åœ¨å¤„ç†é•¿å†å²åºåˆ—æ—¶ã€‚

### Pi0
- Pi0 ä½¿ç”¨ Flow Matchingï¼Œæ¨ç†æ—¶éœ€è¦å¤šæ­¥ ODE Solverã€‚Flash Attention åœ¨æ¯ä¸€æ­¥éƒ½èƒ½æ˜¾è‘—å‡å°‘æ˜¾å­˜å ç”¨ã€‚

### æ€§èƒ½æå‡
- **é€Ÿåº¦**: 2-4x åŠ é€Ÿï¼ˆç›¸æ¯”æ ‡å‡† Attentionï¼‰ã€‚
- **æ˜¾å­˜**: å†…å­˜å ç”¨ä» $O(N^2)$ é™è‡³ $O(N)$ã€‚
- **éƒ¨ç½²**: ä½¿å¾—åœ¨æ¶ˆè´¹çº§ GPU (e.g., RTX 4090) ä¸Šéƒ¨ç½² 7B VLA æˆä¸ºå¯èƒ½ã€‚

## 4. Flash Attention vs å…¶ä»–ä¼˜åŒ–

| æŠ€æœ¯ | å†…å­˜å¤æ‚åº¦ | ç²¾åº¦ | é€‚ç”¨åœºæ™¯ |
| :--- | :--- | :--- | :--- |
| **Standard Attention** | $O(N^2)$ | ç²¾ç¡® | çŸ­åºåˆ— |
| **Flash Attention** | $O(N)$ | ç²¾ç¡® | é•¿åºåˆ—ï¼ŒçœŸæœºæ¨ç† |
| **Sparse Attention** | $O(N \log N)$ | è¿‘ä¼¼ | è¶…é•¿æ–‡æœ¬ (ä¸é€‚åˆ VLA) |
| **Linear Attention** | $O(N)$ | è¿‘ä¼¼ | ç ”ç©¶é˜¶æ®µ |

## 5. KV-Cache æ¨ç†åŠ é€Ÿ (KV-Cache for Inference)

### 5.1 é—®é¢˜èƒŒæ™¯

åœ¨è‡ªå›å½’ç”Ÿæˆ (Autoregressive Generation) æ—¶ï¼Œæ¯ç”Ÿæˆä¸€ä¸ªæ–° Token éƒ½éœ€è¦è®¡ç®— Attentionï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æ—  KV-Cache çš„æ¨ç†                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   ç”Ÿæˆ Token 1:  è®¡ç®— Kâ‚, Vâ‚                                    â”‚
â”‚   ç”Ÿæˆ Token 2:  é‡æ–°è®¡ç®— Kâ‚, Kâ‚‚, Vâ‚, Vâ‚‚  â† é‡å¤è®¡ç®—!            â”‚
â”‚   ç”Ÿæˆ Token 3:  é‡æ–°è®¡ç®— Kâ‚, Kâ‚‚, Kâ‚ƒ, Vâ‚, Vâ‚‚, Vâ‚ƒ  â† æ›´å¤šé‡å¤!   â”‚
â”‚   ...                                                           â”‚
â”‚   ç”Ÿæˆ Token N:  é‡æ–°è®¡ç®— Kâ‚...K_N, Vâ‚...V_N  â† O(NÂ²) æ€»è®¡ç®—é‡   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 KV-Cache åŸç†

**æ ¸å¿ƒæ€æƒ³**: ç¼“å­˜å·²è®¡ç®—çš„ Key å’Œ Valueï¼Œæ–° Token åªéœ€è®¡ç®—å¢é‡ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æœ‰ KV-Cache çš„æ¨ç†                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   ç”Ÿæˆ Token 1:  è®¡ç®— Kâ‚, Vâ‚ â†’ å­˜å…¥ Cache                        â”‚
â”‚   ç”Ÿæˆ Token 2:  åªè®¡ç®— Kâ‚‚, Vâ‚‚ â†’ è¿½åŠ åˆ° Cache                    â”‚
â”‚   ç”Ÿæˆ Token 3:  åªè®¡ç®— Kâ‚ƒ, Vâ‚ƒ â†’ è¿½åŠ åˆ° Cache                    â”‚
â”‚   ...                                                           â”‚
â”‚   ç”Ÿæˆ Token N:  åªè®¡ç®— K_N, V_N â†’ O(N) æ€»è®¡ç®—é‡                 â”‚
â”‚                                                                 â”‚
â”‚   Attention è®¡ç®—:                                               â”‚
â”‚   Q_new (1, d) Ã— K_cache^T (N, d) â†’ Scores (1, N)               â”‚
â”‚   Scores Ã— V_cache (N, d) â†’ Output (1, d)                       â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 åŠ é€Ÿæ•ˆæœ

| æŒ‡æ ‡ | æ—  KV-Cache | æœ‰ KV-Cache |
| :--- | :--- | :--- |
| æ¯ Token è®¡ç®—é‡ | $O(N^2 d)$ | $O(Nd)$ |
| ç”Ÿæˆ N ä¸ª Token | $O(N^3 d)$ | $O(N^2 d)$ |
| N=1000 æ—¶åŠ é€Ÿæ¯” | 1x | **~1000x** |

### 5.4 æ˜¾å­˜ä»£ä»·

KV-Cache éœ€è¦é¢å¤–æ˜¾å­˜å­˜å‚¨å†å² K å’Œ Vï¼š


$$
\text{KV-Cache æ˜¾å­˜} = 2 \times L \times N \times d \times \text{batch\_size} \times \text{bytes}
$$


- $L$: Transformer å±‚æ•°
- $N$: åºåˆ—é•¿åº¦
- $d$: éšè—ç»´åº¦
- Factor 2: K å’Œ V å„ä¸€ä»½

**ç¤ºä¾‹ (Llama-7B, FP16)**:
- $L=32, d=4096, N=2048, \text{batch}=1$
- KV-Cache = $2 \times 32 \times 2048 \times 4096 \times 2 \text{ bytes} \approx 1 \text{ GB}$

### 5.5 KV-Cache ä¼˜åŒ–æŠ€æœ¯

| æŠ€æœ¯ | åŸç† | èŠ‚çœæ¯”ä¾‹ |
| :--- | :--- | :--- |
| **GQA (Grouped Query Attention)** | å¤šä¸ª Q å¤´å…±äº« K/V å¤´ | 4-8x |
| **MQA (Multi-Query Attention)** | æ‰€æœ‰ Q å¤´å…±äº«ä¸€ç»„ K/V | æ›´æ¿€è¿› |
| **Paged Attention (vLLM)** | ç±»ä¼¼è™šæ‹Ÿå†…å­˜ï¼ŒæŒ‰éœ€åˆ†é… | åŠ¨æ€ä¼˜åŒ– |
| **KV-Cache é‡åŒ–** | INT8/INT4 å­˜å‚¨ | 2-4x |

---

## 6. é¢è¯•å¸¸è§é—®é¢˜

**Q: Flash Attention çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ**
A: ä¸‰ä¸ªå…³é”®æŠ€æœ¯ï¼š
1. **Tiling (åˆ†å—)**: å°† $QK^T$ åˆ†æˆå°å—è®¡ç®—ï¼Œé¿å…å­˜å‚¨å®Œæ•´ $N \times N$ çŸ©é˜µ
2. **Kernel Fusion**: å°† $QK^T \to \text{softmax} \to \times V$ èåˆè¿›å•ä¸ª CUDA Kernelï¼Œå‡å°‘ HBM è¯»å†™
3. **Online Softmax**: å¢é‡æ›´æ–°å½’ä¸€åŒ–å¸¸æ•°ï¼Œæ”¯æŒåˆ†å—è®¡ç®—
ç»“æœ: å†…å­˜ $O(N^2) \to O(N)$ï¼Œé€Ÿåº¦ 2-4x åŠ é€Ÿã€‚

**Q: KV-Cache å¦‚ä½•åŠ é€Ÿæ¨ç†ï¼Ÿ**
A: åœ¨è‡ªå›å½’ç”Ÿæˆæ—¶ï¼Œç¼“å­˜å·²è®¡ç®—çš„ K å’Œ Vï¼Œæ–° Token åªéœ€è®¡ç®—å¢é‡ $K_{new}, V_{new}$ã€‚å°†æ¯ Token è®¡ç®—é‡ä» $O(N^2 d)$ é™åˆ° $O(Nd)$ï¼ŒN=1000 æ—¶çº¦ 1000 å€åŠ é€Ÿã€‚ä»£ä»·æ˜¯é¢å¤–æ˜¾å­˜ $O(LNd)$ã€‚

**Q: Flash Attention æ˜¯å¦‚ä½•åšåˆ°ç²¾ç¡®è®¡ç®—çš„ï¼Ÿ**
A: é€šè¿‡åœ¨çº¿ Softmax å’Œåˆ†å—è®¡ç®—ï¼ŒFlash Attention åœ¨æ•°å­¦ä¸Šç­‰ä»·äºæ ‡å‡† Attentionï¼Œåªæ˜¯æ”¹å˜äº†è®¡ç®—é¡ºåºå’Œå†…å­˜è®¿é—®æ¨¡å¼ï¼Œæ²¡æœ‰å¼•å…¥ä»»ä½•è¿‘ä¼¼ã€‚

**Q: ä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥ç”¨ Sparse Attention?**
A: VLA çš„æ³¨æ„åŠ›æ¨¡å¼é€šå¸¸æ˜¯å¯†é›†çš„ï¼ˆè§†è§‰ Patch ä¹‹é—´å…³ç³»ç´§å¯†ï¼‰ï¼Œç¨€ç–å‡è®¾ä¸æˆç«‹ã€‚Flash Attention ä¿æŒäº†å¯†é›†è®¡ç®—ï¼Œåªæ˜¯ä¼˜åŒ–äº†å†…å­˜ã€‚

**Q: Flash Attention å¯¹è®­ç»ƒå’Œæ¨ç†éƒ½æœ‰æ•ˆå—ï¼Ÿ**
A: æ˜¯çš„ã€‚è®­ç»ƒæ—¶é€šè¿‡ Recomputation èŠ‚çœæ˜¾å­˜ï¼Œæ¨ç†æ—¶é€šè¿‡ Kernel Fusion åŠ é€Ÿã€‚Wall-X ç­‰æ¨¡å‹åœ¨ä¸¤è€…éƒ½ä½¿ç”¨ã€‚


---

\newpage

# ç¬¬3ç«  å¤šæ¨¡æ€æ¨¡å‹åŸºç¡€


> **æ ¸å¿ƒæ¦‚å¿µ**: å¤šæ¨¡æ€æ¨¡å‹ (Multimodal Models) æ˜¯æŒ‡èƒ½å¤ŸåŒæ—¶å¤„ç†å¤šç§æ•°æ®æ¨¡æ€ï¼ˆå¦‚è§†è§‰ã€è¯­è¨€ã€éŸ³é¢‘ã€è§¦è§‰ç­‰ï¼‰çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ã€‚åœ¨ VLA é¢†åŸŸï¼Œå¤šæ¨¡æ€èƒ½åŠ›æ˜¯è¿æ¥"çœ‹"ã€"è¯´"ã€"åš"çš„å…³é”®ã€‚

## 1. ä¸ºä»€ä¹ˆéœ€è¦å¤šæ¨¡æ€? (Why Multimodal?)

### 1.1 æœºå™¨äººçš„æ„ŸçŸ¥éœ€æ±‚

æœºå™¨äººåœ¨çœŸå®ä¸–ç•Œä¸­éœ€è¦åŒæ—¶å¤„ç†å¤šç§ä¿¡æ¯ï¼š

| æ¨¡æ€ | æ¥æº | ä½œç”¨ |
| :--- | :--- | :--- |
| **è§†è§‰ (Vision)** | RGB ç›¸æœºã€æ·±åº¦ç›¸æœº | ç†è§£åœºæ™¯ã€è¯†åˆ«ç‰©ä½“ |
| **è¯­è¨€ (Language)** | è¯­éŸ³æŒ‡ä»¤ã€æ–‡æœ¬ | ç†è§£ä»»åŠ¡æ„å›¾ |
| **æœ¬ä½“æ„ŸçŸ¥ (Proprioception)** | å…³èŠ‚ç¼–ç å™¨ã€IMU | æ„ŸçŸ¥è‡ªèº«çŠ¶æ€ |
| **è§¦è§‰ (Tactile)** | è§¦è§‰ä¼ æ„Ÿå™¨ | æ„ŸçŸ¥æ¥è§¦åŠ›ã€çº¹ç† |
| **éŸ³é¢‘ (Audio)** | éº¦å…‹é£ | ç¯å¢ƒå£°éŸ³ã€è¯­éŸ³äº¤äº’ |

### 1.2 å•æ¨¡æ€çš„å±€é™æ€§

- **ä»…è§†è§‰**: æ— æ³•ç†è§£æŠ½è±¡æŒ‡ä»¤ï¼ˆ"æŠŠé‚£ä¸ªå±é™©çš„ä¸œè¥¿æ‹¿èµ°"ï¼‰
- **ä»…è¯­è¨€**: æ— æ³•å®šä½å…·ä½“ç‰©ä½“ï¼ˆ"æ¡Œä¸Šçš„çº¢è‰²æ¯å­"åœ¨å“ªï¼Ÿï¼‰
- **ç¼ºä¹æœ¬ä½“æ„ŸçŸ¥**: ä¸çŸ¥é“æœºæ¢°è‡‚å½“å‰å§¿æ€ï¼Œæ— æ³•é—­ç¯æ§åˆ¶

### 1.3 å¤šæ¨¡æ€çš„ä¼˜åŠ¿


$$
\text{å¤šæ¨¡æ€ç†è§£} > \sum \text{å•æ¨¡æ€ç†è§£}
$$


- **è¯­ä¹‰æ¥åœ° (Grounding)**: å°†è¯­è¨€æ¦‚å¿µä¸è§†è§‰å®ä½“ç»‘å®š
- **è·¨æ¨¡æ€æ¨ç†**: "çº¢è‰²çš„ä¸œè¥¿"ï¼ˆè¯­è¨€ï¼‰â†’ é”å®šçº¢è‰²ç‰©ä½“ï¼ˆè§†è§‰ï¼‰â†’ æŠ“å–åŠ¨ä½œ
- **é²æ£’æ€§**: ä¸€ä¸ªæ¨¡æ€å¤±æ•ˆæ—¶ï¼Œå…¶ä»–æ¨¡æ€å¯ä»¥è¡¥å¿

## 2. å¤šæ¨¡æ€æ¶æ„æ¼”è¿› (Architecture Evolution)

### 2.1 æ—©æœŸï¼šåŒå¡”æ¨¡å‹ (Dual-Encoder)

```
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
å›¾åƒ â”€â”€â”€â”€â–¶â”‚  Image      â”‚      â”‚   Text      â”‚â—€â”€â”€â”€â”€ æ–‡æœ¬
          â”‚  Encoder    â”‚      â”‚   Encoder   â”‚
          â”‚  (ResNet)   â”‚      â”‚   (BERT)    â”‚
          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                    â”‚
                 â–¼                    â–¼
              img_emb              text_emb
                 â”‚                    â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                    Cosine Similarity
```

**ä»£è¡¨**: CLIP, ALIGN
**ç‰¹ç‚¹**: å›¾åƒå’Œæ–‡æœ¬ç‹¬ç«‹ç¼–ç ï¼Œé€šè¿‡å¯¹æ¯”å­¦ä¹ å¯¹é½åˆ°åŒä¸€ç©ºé—´
**å±€é™**: æ— æ³•è¿›è¡Œæ·±åº¦çš„è·¨æ¨¡æ€äº¤äº’

### 2.2 ä¸­æœŸï¼šèåˆç¼–ç å™¨ (Fusion Encoder)

```
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
å›¾åƒ â”€â”€â”€â”€â–¶â”‚  Image      â”‚      â”‚   Text      â”‚â—€â”€â”€â”€â”€ æ–‡æœ¬
          â”‚  Encoder    â”‚      â”‚   Encoder   â”‚
          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                    â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  Fusion Module  â”‚
                 â”‚  (Cross-Attn)   â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â–¼
                   Fused Features
```

**ä»£è¡¨**: ViLBERT, LXMERT, UNITER
**ç‰¹ç‚¹**: é€šè¿‡ Cross-Attention å®ç°æ·±åº¦äº¤äº’
**æ”¹è¿›**: æ”¯æŒæ›´å¤æ‚çš„å¤šæ¨¡æ€æ¨ç†

### 2.3 ç°ä»£ï¼šç»Ÿä¸€è§£ç å™¨ (Unified Decoder)

```
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
å›¾åƒ â”€â”€â”€â”€â–¶â”‚  Vision     â”‚â”€â”€â”
          â”‚  Encoder    â”‚  â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                           â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”œâ”€â”€â–¶â”‚     LLM Decoder     â”‚â”€â”€â–¶ è¾“å‡º
                           â”‚   â”‚  (Unified Token)    â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
æ–‡æœ¬ â”€â”€â”€â”€â–¶â”‚  Tokenizer  â”‚â”€â”€â”˜
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä»£è¡¨**: Flamingo, LLaVA, GPT-4V, Gemini
**ç‰¹ç‚¹**: å°†è§†è§‰ç‰¹å¾ä½œä¸º"è™šæ‹Ÿ Token"è¾“å…¥åˆ° LLM
**ä¼˜åŠ¿**: åˆ©ç”¨ LLM çš„å¼ºå¤§æ¨ç†èƒ½åŠ›ï¼Œæ”¯æŒä»»æ„è¾“å…¥è¾“å‡ºç»„åˆ

## 3. VLA ä¸­çš„å¤šæ¨¡æ€èåˆç­–ç•¥ (Fusion Strategies in VLA)

### 3.1 æ—©æœŸèåˆ (Early Fusion)

åœ¨ç‰¹å¾æå–é˜¶æ®µå°±è¿›è¡Œèåˆã€‚

```python
class EarlyFusion(nn.Module):
    def __init__(self):
        self.vision_proj = nn.Linear(vision_dim, hidden_dim)
        self.language_proj = nn.Linear(language_dim, hidden_dim)
        self.proprio_proj = nn.Linear(proprio_dim, hidden_dim)
        
    def forward(self, image_feat, text_feat, proprio):
        # ç›´æ¥æ‹¼æ¥
        fused = torch.cat([
            self.vision_proj(image_feat),
            self.language_proj(text_feat),
            self.proprio_proj(proprio)
        ], dim=1)  # [B, L_v + L_t + 1, D]
        return fused
```

**ä¼˜ç‚¹**: ç®€å•é«˜æ•ˆ
**ç¼ºç‚¹**: ä¸åŒæ¨¡æ€çš„ç‰¹å¾å°ºåº¦å¯èƒ½ä¸åŒ¹é…

### 3.2 ä¸­æœŸèåˆ (Mid Fusion / Cross-Attention)

é€šè¿‡æ³¨æ„åŠ›æœºåˆ¶åŠ¨æ€èåˆã€‚

```python
class CrossModalAttention(nn.Module):
    def __init__(self, hidden_dim, num_heads=8):
        self.cross_attn = nn.MultiheadAttention(hidden_dim, num_heads)
        
    def forward(self, query_feat, context_feat):
        """
        query_feat: éœ€è¦è¢«å¢å¼ºçš„ç‰¹å¾ (e.g., åŠ¨ä½œ query)
        context_feat: æä¾›ä¸Šä¸‹æ–‡çš„ç‰¹å¾ (e.g., å›¾åƒ + è¯­è¨€)
        """
        # Query attends to Context
        attended, attn_weights = self.cross_attn(
            query=query_feat,
            key=context_feat,
            value=context_feat
        )
        return attended, attn_weights
```

**ä»£è¡¨**: RT-1 (TokenLearner)ï¼ŒOcto
**ä¼˜ç‚¹**: åŠ¨æ€å­¦ä¹ æ¨¡æ€é—´å…³ç³»
**ç¼ºç‚¹**: è®¡ç®—å¼€é”€å¤§

### 3.3 æ™šæœŸèåˆ (Late Fusion)

å„æ¨¡æ€ç‹¬ç«‹å¤„ç†åå†åˆå¹¶å†³ç­–ã€‚

```python
class LateFusion(nn.Module):
    def __init__(self):
        self.vision_policy = VisionPolicy()
        self.language_policy = LanguagePolicy()
        self.fusion_head = nn.Linear(hidden_dim * 2, action_dim)
        
    def forward(self, image, text):
        vision_out = self.vision_policy(image)
        language_out = self.language_policy(text)
        
        # å†³ç­–å±‚èåˆ
        fused = torch.cat([vision_out, language_out], dim=-1)
        action = self.fusion_head(fused)
        return action
```

**ä¼˜ç‚¹**: å„æ¨¡æ€å¯ä»¥ç‹¬ç«‹ä¼˜åŒ–
**ç¼ºç‚¹**: æ— æ³•å­¦ä¹ å¤æ‚çš„è·¨æ¨¡æ€äº¤äº’

### 3.4 VLA ä¸­çš„ä¸»æµæ–¹æ¡ˆï¼šFiLM è°ƒåˆ¶

**FiLM (Feature-wise Linear Modulation)** æ˜¯ VLA ä¸­æœ€å¸¸ç”¨çš„æ¡ä»¶æ³¨å…¥æ–¹å¼ã€‚

```python
class FiLM(nn.Module):
    """Feature-wise Linear Modulation"""
    def __init__(self, cond_dim, feature_dim):
        self.gamma = nn.Linear(cond_dim, feature_dim)  # Scale
        self.beta = nn.Linear(cond_dim, feature_dim)   # Shift
        
    def forward(self, feature, condition):
        """
        feature: è¦è°ƒåˆ¶çš„ç‰¹å¾ [B, L, D]
        condition: æ¡ä»¶ä¿¡æ¯ [B, C]
        """
        gamma = self.gamma(condition).unsqueeze(1)  # [B, 1, D]
        beta = self.beta(condition).unsqueeze(1)
        
        # è°ƒåˆ¶: Î³ * feature + Î²
        return gamma * feature + beta
```

**åº”ç”¨åœºæ™¯**:
- **RT-1**: è¯­è¨€ç‰¹å¾é€šè¿‡ FiLM è°ƒåˆ¶è§†è§‰ç‰¹å¾
- **Diffusion Policy**: æ—¶é—´æ­¥ $t$ é€šè¿‡ FiLM æ³¨å…¥åˆ° U-Net

## 4. æ ¸å¿ƒè§†è§‰ç¼–ç å™¨ (Vision Encoders)

### 4.1 ViT (Vision Transformer)

```
å›¾åƒ [H, W, 3] 
    â”‚
    â–¼ Patch Embedding (16x16)
[N_patches, D] where N = (H/16) * (W/16)
    â”‚
    â–¼ + Position Embedding
    â”‚
    â–¼ Transformer Encoder (L layers)
    â”‚
    â–¼
[CLS] token æˆ– å…¨å±€å¹³å‡æ± åŒ–
```

**ç‰¹ç‚¹**:
- å°†å›¾åƒåˆ‡åˆ†ä¸º Patch (å¦‚ 16x16)
- æ¯ä¸ª Patch ä½œä¸ºä¸€ä¸ª Token
- é€šè¿‡ Self-Attention å»ºæ¨¡å…¨å±€å…³ç³»

### 4.2 SigLIP (Sigmoid Loss for Language-Image Pre-training)

**æ”¹è¿› CLIP**:
- ä½¿ç”¨ Sigmoid æ›¿ä»£ Softmax (æ›´å¥½çš„æ‰¹é‡å¯¹æ¯”å­¦ä¹ )
- æ”¯æŒæ›´å¤§çš„ batch size
- VLA é¦–é€‰çš„è§†è§‰ç¼–ç å™¨ (OpenVLA, RDT)

### 4.3 DINOv2 (Self-supervised Vision Transformer)

**ç‰¹ç‚¹**:
- è‡ªç›‘ç£é¢„è®­ç»ƒï¼Œæ— éœ€æ ‡ç­¾
- å¼ºå¤§çš„ä½å±‚è§†è§‰ç‰¹å¾ (è¾¹ç¼˜ã€çº¹ç†)
- é€‚åˆéœ€è¦ç²¾ç¡®ç©ºé—´ä¿¡æ¯çš„ä»»åŠ¡

### 4.4 å¯¹æ¯”ä¸é€‰æ‹©

| ç¼–ç å™¨ | é¢„è®­ç»ƒæ–¹å¼ | ç‰¹ç‚¹ | VLA åº”ç”¨ |
| :--- | :--- | :--- | :--- |
| **ResNet** | ç›‘ç£å­¦ä¹  | é«˜æ•ˆï¼Œé€‚åˆ CNN ç­–ç•¥ | RT-1, Diffusion Policy |
| **ViT** | ç›‘ç£/è‡ªç›‘ç£ | å…¨å±€å»ºæ¨¡å¼º | é€šç”¨ |
| **CLIP/SigLIP** | å¯¹æ¯”å­¦ä¹  | è¯­ä¹‰å¯¹é½å¥½ | OpenVLA, RDT |
| **DINOv2** | è‡ªç›‘ç£ | ç©ºé—´ç‰¹å¾å¼º | ç²¾ç»†æ“ä½œ |

## 5. è¯­è¨€ç¼–ç å™¨ (Language Encoders)

### 5.1 BERT-style (Encoder-only)

```python
from transformers import BertModel

text = "pick up the red cup"
inputs = tokenizer(text, return_tensors="pt")
outputs = bert_model(**inputs)

## ä½¿ç”¨ [CLS] token æˆ–å¹³å‡æ± åŒ–
text_embedding = outputs.last_hidden_state[:, 0, :]  # [B, D]
```

**é€‚ç”¨**: ç†è§£å‹ä»»åŠ¡ï¼ŒæŒ‡ä»¤åµŒå…¥

### 5.2 T5-style (Encoder-Decoder)

**é€‚ç”¨**: éœ€è¦ç”Ÿæˆæ–‡æœ¬çš„ä»»åŠ¡ (å¦‚ CoT æ¨ç†)

### 5.3 LLM-style (Decoder-only)

**ä»£è¡¨**: Llama, Gemma, Qwen
**é€‚ç”¨**: ç°ä»£ VLA çš„æ ‡å‡†é€‰æ‹©ï¼Œåˆ©ç”¨å¼ºå¤§çš„ In-context Learning

---

## 5.5 PaliGemma è¯¦è§£ (VLA å¸¸ç”¨ Backbone)

> **è®ºæ–‡**: [PaliGemma: A versatile 3B VLM for transfer](https://arxiv.org/abs/2407.07726) (Google, 2024)
> **å®˜æ–¹**: [HuggingFace](https://huggingface.co/google/paligemma-3b-pt-224)

PaliGemma æ˜¯ Google æ¨å‡ºçš„è½»é‡çº§ VLMï¼Œå·²æˆä¸º **Ï€0ã€OpenVLA** ç­‰ VLA çš„é¦–é€‰ backboneã€‚

### ä¸ºä»€ä¹ˆ VLA å¸¸ç”¨ PaliGemma?

| ä¼˜åŠ¿ | è¯´æ˜ |
| :--- | :--- |
| **è½»é‡é«˜æ•ˆ** | 3B å‚æ•°ï¼Œå¯åœ¨å•å¡ (24GB) å¾®è°ƒ |
| **é¢„è®­ç»ƒå……åˆ†** | åœ¨å¤§é‡å›¾æ–‡æ•°æ®ä¸Šè®­ç»ƒï¼Œè§†è§‰ç†è§£å¼º |
| **å¼€æºå‹å¥½** | Apache 2.0 è®¸å¯ï¼Œå¯å•†ç”¨ |
| **æ¨¡å—åŒ–è®¾è®¡** | Vision Encoder å’Œ LLM è§£è€¦ï¼Œæ˜“äºé€‚é… |
| **å¤šåˆ†è¾¨ç‡** | æ”¯æŒ 224/448/896 è¾“å…¥å°ºå¯¸ |

### PaliGemma æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PaliGemma 3B                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚   Image Input                    Text Input                  â”‚
â”‚   [224Ã—224Ã—3]                    "Pick up the cup"           â”‚
â”‚        â”‚                              â”‚                      â”‚
â”‚        â–¼                              â–¼                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚   SigLIP     â”‚              â”‚   Gemma      â”‚            â”‚
â”‚   â”‚  ViT-So400m  â”‚              â”‚  Tokenizer   â”‚            â”‚
â”‚   â”‚  (400M)      â”‚              â”‚              â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚          â”‚                             â”‚                     â”‚
â”‚   [256 patches]                  [L tokens]                  â”‚
â”‚   [256, 1152]                    [L, 2048]                   â”‚
â”‚          â”‚                             â”‚                     â”‚
â”‚          â–¼                             â”‚                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚                     â”‚
â”‚   â”‚  Linear Proj â”‚ (1152 â†’ 2048)       â”‚                     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚                     â”‚
â”‚          â”‚                             â”‚                     â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                     â–¼                                        â”‚
â”‚            [Vision] + [Text Tokens]                          â”‚
â”‚                     â”‚                                        â”‚
â”‚                     â–¼                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚   â”‚                 Gemma 2B LLM                            â”‚â”‚
â”‚   â”‚          (18 Transformer Layers)                        â”‚â”‚
â”‚   â”‚                                                         â”‚â”‚
â”‚   â”‚    Self-Attention (Vision + Text ä¸€èµ·å¤„ç†)               â”‚â”‚
â”‚   â”‚                     â†“                                   â”‚â”‚
â”‚   â”‚              Hidden States                              â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                     â”‚                                        â”‚
â”‚                     â–¼                                        â”‚
â”‚              [B, L, 2048]                                    â”‚
â”‚           (é€ç»™ Action Head)                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

#### 1. SigLIP Vision Encoder

```python
## SigLIP vs CLIP
## SigLIP ä½¿ç”¨ Sigmoid Loss è€Œé Softmaxï¼Œæ›´é€‚åˆç»†ç²’åº¦ç†è§£

## é…ç½®
vision_config = {
    "model": "ViT-So400m",      # 400M å‚æ•°
    "image_size": 224,          # æˆ– 448, 896
    "patch_size": 14,           # 16Ã—16 patches
    "hidden_size": 1152,
    "num_layers": 27,
    "num_heads": 16
}

## è¾“å‡º: [B, 256, 1152] (256 = (224/14)Â² patches)
```

#### 2. Gemma 2B LLM

```python
## Gemma æ˜¯ Google çš„è½»é‡çº§ LLM
llm_config = {
    "hidden_size": 2048,
    "num_layers": 18,
    "num_heads": 8,
    "vocab_size": 256000,
    "max_position": 8192,
    "intermediate_size": 16384  # FFN
}
```

#### 3. æŠ•å½±å±‚ (Linear Projection)

```python
## å°† SigLIP ç‰¹å¾æŠ•å°„åˆ° Gemma ç©ºé—´
self.vision_proj = nn.Linear(1152, 2048)

## æŠ•å°„åï¼Œè§†è§‰ Token å’Œæ–‡æœ¬ Token åœ¨åŒä¸€ç©ºé—´
vision_tokens = self.vision_proj(siglip_output)  # [B, 256, 2048]
```

### VLA ä¸­çš„ä½¿ç”¨æ–¹å¼

```python
from transformers import AutoProcessor, PaliGemmaForConditionalGeneration

## åŠ è½½æ¨¡å‹
model = PaliGemmaForConditionalGeneration.from_pretrained(
    "google/paligemma-3b-pt-224",
    torch_dtype=torch.bfloat16
)
processor = AutoProcessor.from_pretrained("google/paligemma-3b-pt-224")

## æ–¹å¼ 1: è·å– Hidden States (ç”¨äº Action Head)
def get_vlm_features(images, text):
    inputs = processor(images=images, text=text, return_tensors="pt")
    outputs = model(
        **inputs,
        output_hidden_states=True
    )
    # æœ€åä¸€å±‚ hidden states
    hidden = outputs.hidden_states[-1]  # [B, L, 2048]
    return hidden

## æ–¹å¼ 2: ç›´æ¥ç”Ÿæˆæ–‡æœ¬ (ç”¨äº CoT)
def generate_text(images, text):
    inputs = processor(images=images, text=text, return_tensors="pt")
    outputs = model.generate(**inputs, max_new_tokens=100)
    return processor.decode(outputs[0])
```

### PaliGemma ç‰ˆæœ¬å¯¹æ¯”

| ç‰ˆæœ¬ | å‚æ•°é‡ | è¾“å…¥åˆ†è¾¨ç‡ | é€‚ç”¨åœºæ™¯ |
| :--- | :--- | :--- | :--- |
| **paligemma-3b-pt-224** | 3B | 224Ã—224 | VLA é¦–é€‰ï¼Œå¹³è¡¡æ•ˆç‡ |
| paligemma-3b-pt-448 | 3B | 448Ã—448 | éœ€è¦æ›´å¤šç»†èŠ‚ |
| paligemma-3b-pt-896 | 3B | 896Ã—896 | é«˜åˆ†è¾¨ç‡ä»»åŠ¡ |
| paligemma-3b-mix-224 | 3B | 224Ã—224 | æ··åˆä»»åŠ¡å¾®è°ƒç‰ˆ |

### PaliGemma vs å…¶ä»– VLM

| æ¨¡å‹ | å‚æ•°é‡ | å¼€æº | VLA é€‚ç”¨æ€§ |
| :--- | :--- | :--- | :--- |
| **PaliGemma** | **3B** | âœ… Apache 2.0 | â­â­â­â­â­ æœ€å¸¸ç”¨ |
| LLaVA 1.5 | 7B/13B | âœ… | â­â­â­â­ è¾ƒå¤§ä½†æˆç†Ÿ |
| Qwen-VL | 7B | âœ… | â­â­â­â­ ä¸­æ–‡æ”¯æŒå¥½ |
| GPT-4V | ~1T | âŒ | â­â­ API å»¶è¿Ÿé«˜ |
| PaLI-X | 55B | âŒ | â­ å¤ªå¤§æ— æ³•éƒ¨ç½² |

### é¢è¯•å¸¸è§é—®é¢˜

**Q: ä¸ºä»€ä¹ˆ Ï€0 é€‰æ‹© PaliGemma è€Œä¸æ˜¯æ›´å¤§çš„ LLaVA?**

A: ä¸‰ä¸ªåŸå› :
1. **æ•ˆç‡**: 3B å‚æ•°å¯åœ¨å•å¡è®­ç»ƒ/æ¨ç†ï¼Œæ»¡è¶³æœºå™¨äººå®æ—¶æ€§è¦æ±‚
2. **SigLIP**: æ¯” CLIP æ›´å¥½çš„ç»†ç²’åº¦è§†è§‰ç†è§£
3. **æ¨¡å—åŒ–**: Vision/Language è§£è€¦ï¼Œæ–¹ä¾¿æ¥ Action Head

---

**Q: PaliGemma çš„ 256 ä¸ª vision tokens å¤Ÿç”¨å—?**

A: å¯¹äºå¤§å¤šæ•°æœºå™¨äººä»»åŠ¡è¶³å¤Ÿ:
- æ¡Œé¢æ“ä½œ: 224Ã—224 åˆ†è¾¨ç‡ + 256 tokens èƒ½è¦†ç›–å…³é”®ç‰©ä½“
- éœ€è¦ç²¾ç»†æ“ä½œæ—¶: å¯ç”¨ 448/896 ç‰ˆæœ¬ (1024/4096 tokens)
- Trade-off: æ›´å¤š tokens = æ›´æ…¢æ¨ç†

---

## 5.6 ä¸»æµ VLM å¯¹æ¯”è¡¨ï¼ˆVLA è®­ç»ƒå‚è€ƒï¼‰

> **ç›®æ ‡**: ä¸º VLA å¼€å‘è€…æä¾›å½“å‰å¸‚åœºä¸Šä¸»æµ Vision Language Model çš„å¯¹æ¯”ï¼Œé‡ç‚¹å…³æ³¨**å·²åœ¨ VLA é¡¹ç›®ä¸­å®é™…ä½¿ç”¨**çš„æ¨¡å‹ã€‚
> 
> **æœ€åæ›´æ–°**: 2025å¹´12æœˆ5æ—¥

---

### 5.6.1 âœ… å·²åœ¨ VLA ä¸­å®é™…ä½¿ç”¨ï¼ˆä¼˜å…ˆæ¨èï¼‰

| æ¨¡å‹ | æœºæ„ | å‘å¸ƒæ—¶é—´ | Vision Encoder | LLM Backbone | å‚æ•°é‡ | è¾“å…¥åˆ†è¾¨ç‡ | å¼€æº | è®¸å¯è¯ | VLA åº”ç”¨æ¡ˆä¾‹ | HuggingFace |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **PaliGemma 3B** | Google | 2024.07 | SigLIP ViT-So400m | Gemma 2B | 3B | 224/448/896 | âœ… | Apache 2.0 | **Ï€0 (Pi-Zero)**, OpenVLA å˜ä½“ | [google/paligemma-3b-pt-224](https://huggingface.co/google/paligemma-3b-pt-224) |
| **SigLIP** | Google | 2023.09 | ViT (Sigmoid Loss) | - | 400M-2.6B | 224-384 | âœ… | Apache 2.0 | **OpenVLA**, **RDT** (Vision Encoder) | [google/siglip-*](https://huggingface.co/models?search=siglip) |
| **LLaVA 1.5/1.6** | - | 2023.10/2024.01 | CLIP/ViT | Llama 2/Vicuna | 7B/13B | 336/672 | âœ… | Apache 2.0 | **OpenVLA** (Llama 2 + SigLIP ç»„åˆ) | [llava-hf/llava-1.5-*](https://huggingface.co/models?search=llava) |
| **LLaVA-NeXT** | - | 2024.12 | CLIP/ViT | Llama 3/Vicuna | 7B/13B/34B | 672/1344 | âœ… | Apache 2.0 | æœ€æ–°ç‰ˆæœ¬ï¼Œæ€§èƒ½æå‡ | [llava-hf/llava-next-*](https://huggingface.co/models?search=llava-next) |
| **PaLI-X** | Google | 2023.12 | ViT-22B | PaLM-E | 55B | 224-1024 | âŒ | - | **RT-2** | - |

**é€‰æ‹©å»ºè®®**:
- **PaliGemma 3B**: VLA è®­ç»ƒé¦–é€‰ï¼Œè½»é‡é«˜æ•ˆï¼ˆå•å¡ 24GB å¯è®­ç»ƒï¼‰ï¼Œé¢„è®­ç»ƒå……åˆ†ï¼Œæ¨¡å—åŒ–è®¾è®¡
- **SigLIP**: VLA é¦–é€‰è§†è§‰ç¼–ç å™¨ï¼Œæ¯” CLIP æ›´å¼ºçš„ç»†ç²’åº¦ç†è§£ï¼Œæ”¯æŒå¤§ batch è®­ç»ƒ
- **LLaVA**: æˆç†Ÿç¨³å®šï¼Œç¤¾åŒºæ”¯æŒå¥½ï¼Œé€‚åˆéœ€è¦æ›´å¤§æ¨¡å‹çš„åœºæ™¯

### 5.6.2 ğŸ”„ é€‚åˆ VLA è®­ç»ƒçš„å¼€æº VLMï¼ˆæ¨èå°è¯•ï¼‰

#### ğŸ†• 2025å¹´æœ€æ–°å‘å¸ƒ

| æ¨¡å‹ | æœºæ„ | å‘å¸ƒæ—¶é—´ | Vision Encoder | LLM Backbone | å‚æ•°é‡ | è¾“å…¥åˆ†è¾¨ç‡ | å¼€æº | è®¸å¯è¯ | ä¼˜åŠ¿ | HuggingFace |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **Qwen2.5-VL** | é˜¿é‡Œå·´å·´ | 2025.03 | Window Attn ViT + MRoPE | Qwen2.5 LLM | 3B/7B/32B/72B | ä»»æ„åˆ†è¾¨ç‡ | âœ… | Apache 2.0 | **2025 SOTA**ï¼Œæ•°å­¦æ¨ç†å¼ºï¼Œé•¿è§†é¢‘æ”¯æŒ | [Qwen/Qwen2.5-VL-*](https://huggingface.co/models?search=Qwen2.5-VL) |
| **Eagle 2.5** | NVIDIA | 2025.04 | é•¿ä¸Šä¸‹æ–‡ ViT | - | 8B | é•¿è§†é¢‘ | âœ… | Apache 2.0 | é•¿ä¸Šä¸‹æ–‡å¤šæ¨¡æ€ï¼ŒVideo-MME 72.4% | [nvidia/Eagle-*](https://huggingface.co/models?search=Eagle) |
| **Seed 1.5-VL** | å­—èŠ‚è·³åŠ¨ | 2025.05 | - | - | 20B (æ¿€æ´») | - | âœ… | - | åª²ç¾ Gemini 2.5 Proï¼ŒGUI äº¤äº’å¼º | [ByteDance/Seed-*](https://huggingface.co/models?search=Seed) |
| **PLM** | Meta | 2025.05 | - | - | - | - | âœ… | MIT | å¼€æºè§†è§‰è¯­è¨€æ¨¡å‹ï¼Œå¤æ‚è§†è§‰ä»»åŠ¡ | [meta-llama/PLM](https://github.com/facebookresearch/PLM) |
| **GLM-4.5V** | æ™ºè°±AI | 2025 | 3D-RoPE ViT | GLM-4.5-Air | 106B (12B æ¿€æ´») | - | âœ… | Apache 2.0 | MoE æ¶æ„ï¼Œ3D ç©ºé—´æ¨ç† | [THUDM/GLM-4.5V](https://huggingface.co/models?search=GLM-4) |
| **Llama 4 Scout/Maverick** | Meta | 2025.04 | ViT Patch | MoE Transformer | 16-128 ä¸“å®¶ | - | âœ… | Meta Llama | 10M token ä¸Šä¸‹æ–‡ï¼Œå¤šæ¨¡æ€ | [meta-llama/Llama-4](https://huggingface.co/models?search=llama-4) |

#### 2024å¹´å‘å¸ƒï¼ˆä»æ¨èï¼‰

| æ¨¡å‹ | æœºæ„ | å‘å¸ƒæ—¶é—´ | Vision Encoder | LLM Backbone | å‚æ•°é‡ | è¾“å…¥åˆ†è¾¨ç‡ | å¼€æº | è®¸å¯è¯ | ä¼˜åŠ¿ | HuggingFace |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **Qwen2-VL** | é˜¿é‡Œå·´å·´ | 2024.08 | InternViT | Qwen2 LLM | 2B/7B/72B | 448-1344 | âœ… | Apache 2.0 | æ€§èƒ½å¤§å¹…æå‡ | [Qwen/Qwen2-VL-*](https://huggingface.co/models?search=Qwen2-VL) |
| **InternVL2** | å•†æ±¤ | 2024.07 | InternViT-6B | InternLM2 | 2B/4B/8B/26B | 448-1344 | âœ… | Apache 2.0 | å¤šæ¨¡æ€èƒ½åŠ›å¢å¼º | [OpenGVLab/InternVL2-*](https://huggingface.co/models?search=InternVL2) |
| **MiniCPM-V 2.6** | é¢å£æ™ºèƒ½ | 2024.08 | ViT | MiniCPM | 8B | 336-1344 | âœ… | Apache 2.0 | è¶…è½»é‡çº§ï¼Œè¾¹ç¼˜éƒ¨ç½² | [openbmb/MiniCPM-V-*](https://huggingface.co/models?search=MiniCPM-V) |
| **LLaVA-NeXT** | - | 2024.06 | CLIP/ViT | Llama 3/Vicuna | 7B/13B/34B | 672/1344 | âœ… | Apache 2.0 | æœ€æ–° LLaVA ç‰ˆæœ¬ | [llava-hf/llava-next-*](https://huggingface.co/models?search=llava-next) |
| **SmolVLA** | Hugging Face | 2024.12 | ViT-Small | TinyLlama | 450M | 224 | âœ… | Apache 2.0 | è¶…è½»é‡çº§ï¼ŒVLA ç ”ç©¶å…¥é—¨ | [huggingface/smolvla](https://huggingface.co/models?search=smolvla) |

#### ç»å…¸æ¨¡å‹ï¼ˆä»å¯ç”¨ï¼‰

| æ¨¡å‹ | æœºæ„ | å‘å¸ƒæ—¶é—´ | Vision Encoder | LLM Backbone | å‚æ•°é‡ | è¾“å…¥åˆ†è¾¨ç‡ | å¼€æº | è®¸å¯è¯ | ä¼˜åŠ¿ | HuggingFace |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **Qwen-VL** | é˜¿é‡Œå·´å·´ | 2023.11 | CLIP-ViT | Qwen LLM | 7B/72B | 448-1024 | âœ… | Apache 2.0 | ä¸­æ–‡æ”¯æŒå¥½ | [Qwen/Qwen-VL](https://huggingface.co/Qwen/Qwen-VL) |
| **CogVLM** | æ™ºè°±AI | 2023.10 | EVA2-ViT | GLM | 17B | 490 | âœ… | Apache 2.0 | è§†è§‰ç†è§£å¼ºï¼Œä¸­æ–‡æ”¯æŒ | [THUDM/cogvlm-*](https://huggingface.co/models?search=cogvlm) |
| **InternVL** | å•†æ±¤ | 2024.01 | InternViT | InternLM | 2B-26B | 448-1024 | âœ… | Apache 2.0 | å¤šåˆ†è¾¨ç‡æ”¯æŒ | [OpenGVLab/InternVL-*](https://huggingface.co/models?search=InternVL) |

**é€‚ç”¨åœºæ™¯**:
- **Qwen2.5-VL** (ğŸ†• 2025): ä¸­æ–‡æŒ‡ä»¤ VLA é¦–é€‰ï¼Œæ•°å­¦æ¨ç†å¼ºï¼Œæ”¯æŒä»»æ„åˆ†è¾¨ç‡å’Œé•¿è§†é¢‘
- **Eagle 2.5** (ğŸ†• 2025): é•¿ä¸Šä¸‹æ–‡å¤šæ¨¡æ€ä»»åŠ¡ï¼Œè§†é¢‘ç†è§£
- **Seed 1.5-VL** (ğŸ†• 2025): GUI äº¤äº’ã€å¤æ‚è§†è§‰æ¨ç†
- **GLM-4.5V** (ğŸ†• 2025): 3D ç©ºé—´æ¨ç†ä»»åŠ¡
- **Llama 4** (ğŸ†• 2025): è¶…é•¿ä¸Šä¸‹æ–‡ï¼ˆ10M tokenï¼‰ï¼Œæ–‡æ¡£åˆ†æ
- **Qwen2-VL**: ä¸­æ–‡æ”¯æŒå¥½ï¼ˆ2024 ç‰ˆæœ¬ï¼‰
- **MiniCPM-V**: è¾¹ç¼˜è®¾å¤‡éƒ¨ç½²ï¼Œèµ„æºå—é™åœºæ™¯
- **SmolVLA**: è¶…è½»é‡çº§ç ”ç©¶ï¼Œå¿«é€ŸåŸå‹éªŒè¯

### 5.6.3 âŒ é—­æº APIï¼ˆå‚è€ƒï¼Œä¸é€‚åˆç›´æ¥è®­ç»ƒï¼‰

| æ¨¡å‹ | æœºæ„ | å‘å¸ƒæ—¶é—´ | å‚æ•°é‡ | ç‰¹ç‚¹ | VLA é€‚ç”¨æ€§ |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **Gemini 2.5 Pro** ğŸ†• | Google | 2025.03 | æœªå…¬å¼€ | **2025 SOTA**ï¼Œ1M token ä¸Šä¸‹æ–‡ï¼Œå†…ç½®æ€è€ƒåŠŸèƒ½ | â­â­ API è°ƒç”¨ï¼Œæˆæœ¬é«˜ |
| **Claude 3.7 Vision** ğŸ†• | Anthropic | 2025.02 | æœªå…¬å¼€ | é«˜ç²¾åº¦ OCRï¼Œå›¾è¡¨è§£æ | â­â­ API è°ƒç”¨ï¼Œå»¶è¿Ÿé—®é¢˜ |
| **GPT-4o** | OpenAI | 2024.05 | ~1T | å¤šæ¨¡æ€ç†è§£å¼ºï¼Œç»Ÿä¸€ Transformer æ¶æ„ | â­â­ API å»¶è¿Ÿé«˜ï¼Œä¸é€‚åˆå®æ—¶æ§åˆ¶ |
| **GPT-4o-mini** | OpenAI | 2024.07 | æœªå…¬å¼€ | è½»é‡ç‰ˆ GPT-4oï¼Œæˆæœ¬æ›´ä½ | â­â­ API è°ƒç”¨ï¼Œå»¶è¿Ÿä»è¾ƒé«˜ |
| **Gemini 1.5 Pro** | Google | 2024.02 | æœªå…¬å¼€ | 1M token ä¸Šä¸‹æ–‡ | â­â­ API è°ƒç”¨ï¼Œæˆæœ¬é«˜ |
| **Claude 3.5 Sonnet** | Anthropic | 2024.06 | æœªå…¬å¼€ | è§†è§‰ç†è§£å¼ºï¼Œæ€§èƒ½æå‡ | â­â­ API è°ƒç”¨ï¼Œå»¶è¿Ÿé—®é¢˜ |

**è¯´æ˜**: é—­æº API æ¨¡å‹è™½ç„¶èƒ½åŠ›å¼ºï¼Œä½†å­˜åœ¨å»¶è¿Ÿé«˜ã€æˆæœ¬é«˜ã€æ— æ³•æœ¬åœ°éƒ¨ç½²ç­‰é—®é¢˜ï¼Œä¸é€‚åˆç›´æ¥ç”¨äº VLA è®­ç»ƒã€‚å¯ä½œä¸ºå‚è€ƒæˆ–ç”¨äºæ•°æ®æ ‡æ³¨ã€CoT æ¨ç†ç­‰è¾…åŠ©ä»»åŠ¡ã€‚

**2025 å¹´é—­æºæ¨¡å‹è¶‹åŠ¿**:
- **Gemini 2.5 Pro**: ç›®å‰æ’è¡Œæ¦œç¬¬ä¸€ï¼Œå†…ç½®æ¨ç†æ€è€ƒåŠŸèƒ½
- **Claude 3.7**: OCR å’Œå›¾è¡¨è§£æèƒ½åŠ›å¤§å¹…æå‡

### 5.6.4 ç»å…¸æ¨¡å‹ï¼ˆå†å²å‚è€ƒï¼‰

| æ¨¡å‹ | æœºæ„ | å‘å¸ƒæ—¶é—´ | ç‰¹ç‚¹ | VLA å½±å“ |
| :--- | :--- | :--- | :--- | :--- |
| **BLIP-2** | Salesforce | 2023.01 | Q-Former æ¶æ„åˆ›æ–° | â­ æ—©æœŸ VLMï¼Œè¾ƒå°‘ç›´æ¥ç”¨äº VLA |
| **Flamingo** | DeepMind | 2022.04 | Perceiver Resampler, Gated Cross-Attention | â­â­ æ¶æ„åˆ›æ–°å½±å“æ·±è¿œï¼Œä½†æœªç›´æ¥ç”¨äº VLA |

### 5.6.5 VLA è®­ç»ƒé€‰æ‹©æŒ‡å—

#### å¿«é€Ÿé€‰æ‹©

```
éœ€è¦è½»é‡çº§ã€å•å¡è®­ç»ƒï¼Ÿ
  â”œâ”€ æ˜¯ â†’ PaliGemma 3B (é¦–é€‰)
  â””â”€ å¦ â†’ LLaVA 7B/13B

åªéœ€è¦ Vision Encoderï¼Ÿ
  â””â”€ SigLIP (VLA é¦–é€‰)

éœ€è¦ä¸­æ–‡æ”¯æŒï¼Ÿ
  â””â”€ Qwen-VL 7B

éœ€è¦è¾¹ç¼˜éƒ¨ç½²ï¼Ÿ
  â””â”€ MiniCPM-V 2.4B

éœ€è¦é«˜åˆ†è¾¨ç‡è¾“å…¥ï¼Ÿ
  â””â”€ InternVL æˆ– PaliGemma 896px ç‰ˆæœ¬
```

#### æŠ€æœ¯å¯¹æ¯”

| ç‰¹æ€§ | PaliGemma 3B | LLaVA 7B | Qwen-VL 7B | SigLIP (Vision) |
| :--- | :--- | :--- | :--- | :--- |
| **è®­ç»ƒæ•ˆç‡** | â­â­â­â­â­ å•å¡å¯è®­ç»ƒ | â­â­â­ éœ€è¦å¤šå¡ | â­â­â­ éœ€è¦å¤šå¡ | â­â­â­â­â­ ä»… Vision |
| **æ¨ç†é€Ÿåº¦** | â­â­â­â­ å¿« | â­â­â­ ä¸­ç­‰ | â­â­â­ ä¸­ç­‰ | â­â­â­â­â­ æå¿« |
| **è§†è§‰ç†è§£** | â­â­â­â­ å¼º | â­â­â­â­ å¼º | â­â­â­â­ å¼º | â­â­â­â­â­ æœ€å¼º |
| **ä¸­æ–‡æ”¯æŒ** | â­â­ ä¸€èˆ¬ | â­â­ ä¸€èˆ¬ | â­â­â­â­â­ ä¼˜ç§€ | - |
| **VLA ç”Ÿæ€** | â­â­â­â­â­ æœ€å¸¸ç”¨ | â­â­â­â­ æˆç†Ÿ | â­â­â­ è¾ƒå°‘ | â­â­â­â­â­ æœ€å¸¸ç”¨ |

#### å®é™…åº”ç”¨æ¡ˆä¾‹

1. **Ï€0 (Pi-Zero)**: ä½¿ç”¨ PaliGemma 3B ä½œä¸º VLM backboneï¼Œç»“åˆ Flow Matching å®ç°é«˜é¢‘æ§åˆ¶
2. **OpenVLA**: ä½¿ç”¨ Llama 2 7B + SigLIP ç»„åˆï¼Œé€šè¿‡ LoRA é«˜æ•ˆå¾®è°ƒ
3. **RT-2**: ä½¿ç”¨ PaLI-X 55Bï¼ˆé—­æºï¼‰ï¼Œè¯æ˜äº† VLM è¯­ä¹‰èƒ½åŠ›å¯è¿ç§»åˆ°æœºå™¨äººæ§åˆ¶
4. **RDT**: ä½¿ç”¨ SigLIP ä½œä¸º Vision Encoderï¼Œä¸“æ³¨äºè§†è§‰ç‰¹å¾æå–

### 5.6.6 é›†æˆå»ºè®®

#### ä½¿ç”¨ PaliGemma 3B è®­ç»ƒ VLA

```python
from transformers import AutoProcessor, PaliGemmaForConditionalGeneration
import torch

## 1. åŠ è½½é¢„è®­ç»ƒæ¨¡å‹
model = PaliGemmaForConditionalGeneration.from_pretrained(
    "google/paligemma-3b-pt-224",
    torch_dtype=torch.bfloat16
)
processor = AutoProcessor.from_pretrained("google/paligemma-3b-pt-224")

## 2. è·å–å¤šæ¨¡æ€ç‰¹å¾ï¼ˆç”¨äº Action Headï¼‰
def get_vlm_features(images, text_instructions):
    inputs = processor(images=images, text=text_instructions, return_tensors="pt")
    outputs = model(**inputs, output_hidden_states=True)
    hidden = outputs.hidden_states[-1]  # [B, L, 2048]
    return hidden

## 3. æ¥ Action Head
action_head = nn.Linear(2048, action_dim * chunk_size)
actions = action_head(hidden[:, -1, :])  # ä½¿ç”¨æœ€åä¸€ä¸ª token
```

#### ä½¿ç”¨ SigLIP ä½œä¸º Vision Encoder

```python
from transformers import AutoProcessor, AutoModel
import torch

## åŠ è½½ SigLIP Vision Encoder
vision_encoder = AutoModel.from_pretrained("google/siglip-base-patch16-224")
processor = AutoProcessor.from_pretrained("google/siglip-base-patch16-224")

## æå–è§†è§‰ç‰¹å¾
def extract_vision_features(images):
    inputs = processor(images=images, return_tensors="pt")
    outputs = vision_encoder(**inputs)
    return outputs.last_hidden_state  # [B, N_patches, D]
```

### 5.6.7 Pre-training vs Fine-tuning vs Post-training

> **é‡è¦æ¦‚å¿µ**: åœ¨ VLA è®­ç»ƒä¸­ï¼Œè¿™ä¸‰ä¸ªæœ¯è¯­æœ‰æ˜ç¡®çš„åŒºåˆ«å’Œé¡ºåºã€‚

#### è®­ç»ƒé˜¶æ®µå¯¹æ¯”

| é˜¶æ®µ | è‹±æ–‡ | ä¸­æ–‡ | æ•°æ®æ¥æº | è®­ç»ƒç›®æ ‡ | å…¸å‹æ–¹æ³• | VLA åº”ç”¨ |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **Pre-training** | Pre-training | é¢„è®­ç»ƒ | å¤§è§„æ¨¡é€šç”¨æ•°æ® (ImageNet, CLIP, äº’è”ç½‘å›¾æ–‡) | å­¦ä¹ é€šç”¨è§†è§‰/è¯­è¨€ç‰¹å¾ | è‡ªç›‘ç£å­¦ä¹ ã€å¯¹æ¯”å­¦ä¹  | VLM backbone (PaliGemma, SigLIP) |
| **Fine-tuning** | Fine-tuning | å¾®è°ƒ | ç›®æ ‡ä»»åŠ¡æ•°æ® (æœºå™¨äººç¤ºæ•™æ•°æ®) | é€‚é…ç‰¹å®šä»»åŠ¡ | ç›‘ç£å­¦ä¹  (BC), LoRA | OpenVLA, Ï€0 åœ¨æœºå™¨äººæ•°æ®ä¸Šå¾®è°ƒ |
| **Post-training** | Post-training | åè®­ç»ƒ | äº¤äº’æ”¶é›†çš„æ•°æ® (æˆåŠŸ+å¤±è´¥è½¨è¿¹) | è‡ªæˆ‘æ”¹è¿›ï¼Œè¶…è¶Šç¤ºæ•™ | Offline RL (Recap) | Ï€*0.6 çš„ Recap ç®—æ³• |

#### è¯¦ç»†è¯´æ˜

**1. Pre-training (é¢„è®­ç»ƒ)**

```
å¤§è§„æ¨¡æ•°æ® (ImageNet/CLIP/äº’è”ç½‘å›¾æ–‡)
        â”‚
        â–¼
  å­¦ä¹ é€šç”¨ç‰¹å¾
        â”‚
        â–¼
  é¢„è®­ç»ƒæ¨¡å‹ (å¦‚ PaliGemma 3B)
```

- **ç›®æ ‡**: åœ¨å¤§è§„æ¨¡æ•°æ®ä¸Šå­¦ä¹ é€šç”¨çš„è§†è§‰å’Œè¯­è¨€ç†è§£èƒ½åŠ›
- **æ•°æ®**: é€šå¸¸ä¸éœ€è¦æ ‡æ³¨ï¼Œä½¿ç”¨è‡ªç›‘ç£æˆ–å¯¹æ¯”å­¦ä¹ 
- **ç»“æœ**: å¾—åˆ°ä¸€ä¸ªå…·å¤‡åŸºç¡€èƒ½åŠ›çš„æ¨¡å‹
- **VLA åº”ç”¨**: 
  - PaliGemma 3B åœ¨äº’è”ç½‘å›¾æ–‡æ•°æ®ä¸Šé¢„è®­ç»ƒ
  - SigLIP åœ¨å›¾åƒ-æ–‡æœ¬å¯¹ä¸Šè¿›è¡Œå¯¹æ¯”å­¦ä¹ é¢„è®­ç»ƒ

**2. Fine-tuning (å¾®è°ƒ)**

```
é¢„è®­ç»ƒæ¨¡å‹ (PaliGemma 3B)
        â”‚
        â–¼
  ç›®æ ‡ä»»åŠ¡æ•°æ® (æœºå™¨äººç¤ºæ•™)
        â”‚
        â–¼
  å¾®è°ƒåæ¨¡å‹ (é€‚é…æœºå™¨äººæ§åˆ¶)
```

- **ç›®æ ‡**: åœ¨é¢„è®­ç»ƒæ¨¡å‹åŸºç¡€ä¸Šï¼Œç”¨ç›®æ ‡ä»»åŠ¡æ•°æ®å¾®è°ƒï¼Œä½¿å…¶é€‚é…ç‰¹å®šä»»åŠ¡
- **æ•°æ®**: éœ€è¦æ ‡æ³¨çš„ç¤ºæ•™æ•°æ® (observation-action pairs)
- **æ–¹æ³•**: 
  - **Full Fine-tuning**: æ›´æ–°æ‰€æœ‰å‚æ•°ï¼ˆæ˜¾å­˜éœ€æ±‚å¤§ï¼‰
  - **LoRA/QLoRA**: åªè®­ç»ƒå°‘é‡å‚æ•°ï¼ˆæ¨èï¼‰
- **VLA åº”ç”¨**:
  - OpenVLA: åœ¨æœºå™¨äººæ•°æ®ä¸Š LoRA å¾®è°ƒ
  - Ï€0: åœ¨æœºå™¨äººæ•°æ®ä¸Šå¾®è°ƒ PaliGemma

**3. Post-training (åè®­ç»ƒ)**

```
å¾®è°ƒåæ¨¡å‹ (Ï€0.6)
        â”‚
        â–¼
  æœºå™¨äººäº¤äº’æ”¶é›†æ•°æ® (æˆåŠŸ+å¤±è´¥)
        â”‚
        â–¼
  Offline RL (Recap ç®—æ³•)
        â”‚
        â–¼
  æ”¹è¿›åæ¨¡å‹ (Ï€*0.6, è¶…è¶Šç¤ºæ•™)
```

- **ç›®æ ‡**: é€šè¿‡åˆ†ææˆåŠŸå’Œå¤±è´¥è½¨è¿¹ï¼Œè‡ªæˆ‘æ”¹è¿›ï¼Œè¶…è¶Šäººç±»ç¤ºæ•™æ°´å¹³
- **æ•°æ®**: æœºå™¨äººå®é™…è¿è¡Œæ”¶é›†çš„æ•°æ®ï¼ˆåŒ…å«æˆåŠŸå’Œå¤±è´¥æ¡ˆä¾‹ï¼‰
- **æ–¹æ³•**: Offline RL (å¦‚ Recap ç®—æ³•)
- **ç‰¹ç‚¹**: 
  - ä¸ä»…å­¦ä¹ "æ€ä¹ˆåš"ï¼Œè¿˜å­¦ä¹ "æ€ä¹ˆåšå¾—æ›´å¥½"
  - å¯ä»¥è¶…è¶Šäººç±»ç¤ºæ•™è€…çš„æ°´å¹³
- **VLA åº”ç”¨**: Ï€*0.6 çš„ Recap ç®—æ³•

#### å®Œæ•´è®­ç»ƒæµç¨‹ç¤ºä¾‹ (Ï€0.6 â†’ Ï€*0.6)

```python
## Phase 1: Pre-training (é€šå¸¸ç”±æ¨¡å‹æä¾›æ–¹å®Œæˆ)
## ä½¿ç”¨å¤§è§„æ¨¡æ•°æ®è®­ç»ƒ PaliGemma 3B
pretrained_vlm = load_pretrained("google/paligemma-3b-pt-224")

## Phase 2: Fine-tuning (åœ¨æœºå™¨äººæ•°æ®ä¸Šå¾®è°ƒ)
## ä½¿ç”¨ç¤ºæ•™æ•°æ®å¾®è°ƒ
robot_demos = load_robot_demonstrations()  # äººç±»ç¤ºæ•™æ•°æ®
finetuned_model = fine_tune(pretrained_vlm, robot_demos, method="LoRA")
## å¾—åˆ° Ï€0.6

## Phase 3: Post-training (Recap, è‡ªæˆ‘æ”¹è¿›)
## æœºå™¨äººäº¤äº’æ”¶é›†æ•°æ®
interaction_data = robot.collect_data()  # åŒ…å«æˆåŠŸå’Œå¤±è´¥è½¨è¿¹

## ä½¿ç”¨ Offline RL æ”¹è¿›
improved_model = recap_algorithm(finetuned_model, interaction_data)
## å¾—åˆ° Ï€*0.6
```

#### å…³é”®åŒºåˆ«æ€»ç»“

| ç‰¹æ€§ | Pre-training | Fine-tuning | Post-training |
| :--- | :--- | :--- | :--- |
| **æ•°æ®æ¥æº** | é€šç”¨å¤§è§„æ¨¡æ•°æ® | ç›®æ ‡ä»»åŠ¡ç¤ºæ•™æ•°æ® | äº¤äº’æ”¶é›†çš„æˆåŠŸ+å¤±è´¥æ•°æ® |
| **è®­ç»ƒç›®æ ‡** | å­¦ä¹ é€šç”¨ç‰¹å¾ | é€‚é…ç‰¹å®šä»»åŠ¡ | è‡ªæˆ‘æ”¹è¿›ï¼Œè¶…è¶Šç¤ºæ•™ |
| **å­¦ä¹ æ–¹å¼** | è‡ªç›‘ç£/å¯¹æ¯”å­¦ä¹  | ç›‘ç£å­¦ä¹  (BC) | Offline RL |
| **æ˜¯å¦å¿…éœ€** | âœ… æ˜¯ (æ¨¡å‹åŸºç¡€) | âœ… æ˜¯ (ä»»åŠ¡é€‚é…) | âš ï¸ å¯é€‰ (æ€§èƒ½æå‡) |
| **å…¸å‹æ—¶é—´** | æ•°å‘¨/æœˆ (å¤§è§„æ¨¡) | æ•°å°æ—¶/å¤© | æ•°å¤©/å‘¨ (æŒç»­æ”¹è¿›) |

#### é¢è¯•å¸¸è§é—®é¢˜

**Q: Pre-training å’Œ Fine-tuning çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ**

A:
- **Pre-training**: åœ¨å¤§è§„æ¨¡é€šç”¨æ•°æ®ä¸Šå­¦ä¹ åŸºç¡€èƒ½åŠ›ï¼ˆå¦‚è§†è§‰ç†è§£ã€è¯­è¨€ç†è§£ï¼‰
- **Fine-tuning**: åœ¨é¢„è®­ç»ƒæ¨¡å‹åŸºç¡€ä¸Šï¼Œç”¨ç›®æ ‡ä»»åŠ¡æ•°æ®å¾®è°ƒï¼Œä½¿å…¶é€‚é…ç‰¹å®šä»»åŠ¡ï¼ˆå¦‚æœºå™¨äººæ§åˆ¶ï¼‰

**Q: Post-training å’Œ Fine-tuning çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ**

A:
- **Fine-tuning**: ä½¿ç”¨äººç±»ç¤ºæ•™æ•°æ®ï¼Œå­¦ä¹ "æ€ä¹ˆåš"ï¼ˆæ¨¡ä»¿å­¦ä¹ ï¼‰
- **Post-training**: ä½¿ç”¨äº¤äº’æ”¶é›†çš„æˆåŠŸ+å¤±è´¥æ•°æ®ï¼Œå­¦ä¹ "æ€ä¹ˆåšå¾—æ›´å¥½"ï¼ˆå¼ºåŒ–å­¦ä¹ ï¼‰ï¼Œå¯ä»¥è¶…è¶Šäººç±»ç¤ºæ•™æ°´å¹³

**Q: ä¸ºä»€ä¹ˆéœ€è¦ Pre-trainingï¼Ÿ**

A: 
- æœºå™¨äººæ•°æ®ç¨€ç¼ºä¸”æ˜‚è´µï¼Œä»å¤´è®­ç»ƒéœ€è¦å¤§é‡æ•°æ®
- Pre-training è®©æ¨¡å‹å…·å¤‡é€šç”¨èƒ½åŠ›ï¼Œåªéœ€å°‘é‡æœºå™¨äººæ•°æ®å³å¯é€‚é…
- ç±»ä¼¼äººç±»å…ˆå­¦åŸºç¡€çŸ¥è¯†ï¼Œå†å­¦ä¸“ä¸šæŠ€èƒ½

### 5.6.8 å¸¸è§é—®é¢˜

**Q: ä¸ºä»€ä¹ˆ VLA é¦–é€‰ PaliGemma 3B è€Œä¸æ˜¯æ›´å¤§çš„ LLaVA?**

A: ä¸‰ä¸ªåŸå› :
1. **æ•ˆç‡**: 3B å‚æ•°å¯åœ¨å•å¡ (24GB) è®­ç»ƒ/æ¨ç†ï¼Œæ»¡è¶³æœºå™¨äººå®æ—¶æ€§è¦æ±‚
2. **SigLIP**: æ¯” CLIP æ›´å¥½çš„ç»†ç²’åº¦è§†è§‰ç†è§£
3. **æ¨¡å—åŒ–**: Vision/Language è§£è€¦ï¼Œæ–¹ä¾¿æ¥ Action Head

**Q: SigLIP å’Œ CLIP çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ**

A: 
- **æŸå¤±å‡½æ•°**: CLIP ä½¿ç”¨ Softmax + Cross-Entropy (InfoNCE)ï¼ŒSigLIP ä½¿ç”¨ Sigmoid + Binary CE
- **Batch ä¾èµ–**: CLIP çš„ Softmax éœ€è¦å¯¹æ¯” batch å†…æ‰€æœ‰æ ·æœ¬ï¼ŒSigLIP çš„ Sigmoid æ¯å¯¹ç‹¬ç«‹è®¡ç®—
- **æ‰©å±•æ€§**: SigLIP æ›´é€‚åˆå¤§ batch è®­ç»ƒï¼Œè´Ÿæ ·æœ¬åˆ©ç”¨æ›´é«˜æ•ˆ

**Q: å¦‚ä½•é€‰æ‹© Vision Encoder å’Œ LLM çš„ç»„åˆï¼Ÿ**

A:
- **è½»é‡çº§**: PaliGemma 3B (SigLIP + Gemma 2B)
- **å¹³è¡¡**: LLaVA (CLIP/ViT + Llama 2 7B)
- **è‡ªå®šä¹‰**: SigLIP (Vision) + ä»»æ„ LLM (Language)

**Q: ä¸­æ–‡ VLA ä»»åŠ¡åº”è¯¥é€‰æ‹©å“ªä¸ª VLMï¼Ÿ**

A: æ¨è **Qwen2.5-VL 7B**ï¼ˆğŸ†• 2025.03ï¼‰ï¼Œä¸­æ–‡æ”¯æŒæœ€å¥½ï¼Œæ•°å­¦æ¨ç†èƒ½åŠ›å¼ºï¼Œæ”¯æŒä»»æ„åˆ†è¾¨ç‡å’Œé•¿è§†é¢‘ã€‚å¦‚æœèµ„æºå—é™ï¼Œå¯é€‰æ‹© **Qwen2.5-VL 3B** ç‰ˆæœ¬ã€‚

**Q: æœ‰å“ªäº› 2025 å¹´æœ€æ–°çš„ VLM æ›´æ–°å€¼å¾—å…³æ³¨ï¼Ÿ**

A: 
- **Qwen2.5-VL** (2025.03): é˜¿é‡Œå·´å·´æœ€æ–°ç‰ˆæœ¬ï¼Œ**2025 SOTA**ï¼Œæ•°å­¦æ¨ç†å¼ºï¼Œæ”¯æŒä»»æ„åˆ†è¾¨ç‡
- **Eagle 2.5** (2025.04): NVIDIA å‘å¸ƒï¼Œé•¿ä¸Šä¸‹æ–‡å¤šæ¨¡æ€ï¼ŒVideo-MME 72.4%
- **Seed 1.5-VL** (2025.05): å­—èŠ‚è·³åŠ¨å‘å¸ƒï¼Œåª²ç¾ Gemini 2.5 Proï¼ŒGUI äº¤äº’å¼º
- **GLM-4.5V** (2025): æ™ºè°±AIï¼ŒMoE æ¶æ„ï¼Œ3D ç©ºé—´æ¨ç†
- **Llama 4** (2025.04): Meta å‘å¸ƒï¼Œ10M token ä¸Šä¸‹æ–‡ï¼Œå¤šæ¨¡æ€ MoE æ¶æ„
- **PLM** (2025.05): Meta å¼€æºè§†è§‰è¯­è¨€æ¨¡å‹

**Q: 2025å¹´é—­æº API æ¨¡å‹æœ‰å“ªäº›æ›´æ–°ï¼Ÿ**

A:
- **Gemini 2.5 Pro** (2025.03): Google å‘å¸ƒï¼Œæ’è¡Œæ¦œç¬¬ä¸€ï¼Œå†…ç½®æ€è€ƒåŠŸèƒ½
- **Claude 3.7 Vision** (2025.02): Anthropic å‘å¸ƒï¼Œé«˜ç²¾åº¦ OCR å’Œå›¾è¡¨è§£æ

---

## 6. æŠ•å½±å±‚è®¾è®¡ (Projector Design)

å°†è§†è§‰ç‰¹å¾æ˜ å°„åˆ°è¯­è¨€ç©ºé—´æ˜¯ VLA çš„å…³é”®ã€‚

### 6.1 ç®€å• MLP

```python
class MLPProjector(nn.Module):
    def __init__(self, vision_dim, language_dim):
        self.proj = nn.Sequential(
            nn.Linear(vision_dim, language_dim),
            nn.GELU(),
            nn.Linear(language_dim, language_dim)
        )
    
    def forward(self, vision_feat):
        return self.proj(vision_feat)
```

### 6.2 Perceiver Resampler (Flamingo)

```python
class PerceiverResampler(nn.Module):
    """å°†å¯å˜æ•°é‡çš„è§†è§‰ Token å‹ç¼©ä¸ºå›ºå®šæ•°é‡"""
    def __init__(self, num_latents=64):
        self.latents = nn.Parameter(torch.randn(num_latents, hidden_dim))
        self.cross_attn = nn.MultiheadAttention(hidden_dim, num_heads)
        
    def forward(self, vision_tokens):
        # vision_tokens: [B, N_patches, D] (N_patches å¯å˜)
        # è¾“å‡º: [B, num_latents, D] (å›ºå®š)
        
        latents = self.latents.unsqueeze(0).expand(B, -1, -1)
        output, _ = self.cross_attn(
            query=latents,
            key=vision_tokens,
            value=vision_tokens
        )
        return output  # [B, 64, D]
```

**ä¼˜åŠ¿**: æ§åˆ¶è§†è§‰ Token æ•°é‡ï¼Œå‡å°‘ LLM çš„è®¡ç®—è´Ÿæ‹…

### 6.3 Q-Former (BLIP-2)

ä½¿ç”¨å¯å­¦ä¹ çš„ Query ä»è§†è§‰ç¼–ç å™¨ä¸­æå–ä¸ä»»åŠ¡ç›¸å…³çš„ç‰¹å¾ã€‚

## 7. å®æˆ˜ï¼šæ„å»ºç®€å•çš„å¤šæ¨¡æ€ VLA

```python
import torch
import torch.nn as nn
from transformers import AutoModel, AutoTokenizer

class SimpleMultimodalVLA(nn.Module):
    def __init__(
        self,
        vision_encoder_name="google/siglip-base-patch16-224",
        language_model_name="meta-llama/Llama-2-7b-hf",
        action_dim=7,
        chunk_size=16
    ):
        super().__init__()
        
        # è§†è§‰ç¼–ç å™¨ (å†»ç»“)
        self.vision_encoder = AutoModel.from_pretrained(vision_encoder_name)
        for param in self.vision_encoder.parameters():
            param.requires_grad = False
        
        # æŠ•å½±å±‚ (å¯è®­ç»ƒ)
        vision_dim = self.vision_encoder.config.hidden_size
        language_dim = 4096  # Llama 2 hidden dim
        self.vision_projector = nn.Sequential(
            nn.Linear(vision_dim, language_dim),
            nn.GELU(),
            nn.Linear(language_dim, language_dim)
        )
        
        # è¯­è¨€æ¨¡å‹ (LoRA å¾®è°ƒ)
        self.language_model = AutoModel.from_pretrained(
            language_model_name,
            load_in_4bit=True  # QLoRA
        )
        
        # åŠ¨ä½œå¤´ (å¯è®­ç»ƒ)
        self.action_head = nn.Sequential(
            nn.Linear(language_dim, language_dim // 2),
            nn.ReLU(),
            nn.Linear(language_dim // 2, action_dim * chunk_size)
        )
        
        self.chunk_size = chunk_size
        self.action_dim = action_dim
    
    def forward(self, images, input_ids, attention_mask):
        """
        images: [B, C, H, W]
        input_ids: [B, L]
        attention_mask: [B, L]
        """
        batch_size = images.shape[0]
        
        # 1. è§†è§‰ç¼–ç 
        with torch.no_grad():
            vision_outputs = self.vision_encoder(images)
            vision_features = vision_outputs.last_hidden_state  # [B, N_patches, D_v]
        
        # 2. æŠ•å½±åˆ°è¯­è¨€ç©ºé—´
        vision_tokens = self.vision_projector(vision_features)  # [B, N_patches, D_l]
        
        # 3. è·å–è¯­è¨€åµŒå…¥
        text_embeds = self.language_model.get_input_embeddings()(input_ids)
        
        # 4. æ‹¼æ¥ [Vision Tokens | Text Tokens]
        inputs_embeds = torch.cat([vision_tokens, text_embeds], dim=1)
        
        # 5. é€šè¿‡è¯­è¨€æ¨¡å‹
        outputs = self.language_model(
            inputs_embeds=inputs_embeds,
            output_hidden_states=True
        )
        
        # 6. å–æœ€åä¸€ä¸ª hidden state ä½œä¸ºåŠ¨ä½œæ¡ä»¶
        last_hidden = outputs.hidden_states[-1][:, -1, :]  # [B, D_l]
        
        # 7. é¢„æµ‹åŠ¨ä½œ
        actions = self.action_head(last_hidden)  # [B, action_dim * chunk_size]
        actions = actions.view(batch_size, self.chunk_size, self.action_dim)
        
        return actions
```

## 8. é¢è¯•é«˜é¢‘é—®é¢˜ (Q&A)

**Q1: CLIP å’Œ SigLIP çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ**

A:
- **æŸå¤±å‡½æ•°**: CLIP ä½¿ç”¨ Softmax + Cross-Entropy (InfoNCE)ï¼ŒSigLIP ä½¿ç”¨ Sigmoid + Binary CE
- **batch ä¾èµ–**: CLIP çš„ Softmax éœ€è¦å¯¹æ¯” batch å†…æ‰€æœ‰æ ·æœ¬ï¼ŒSigLIP çš„ Sigmoid æ¯å¯¹ç‹¬ç«‹è®¡ç®—
- **æ‰©å±•æ€§**: SigLIP æ›´é€‚åˆå¤§ batch è®­ç»ƒï¼Œè´Ÿæ ·æœ¬åˆ©ç”¨æ›´é«˜æ•ˆ

**Q2: ä¸ºä»€ä¹ˆ VLA æ™®éé€‰æ‹© Decoder-only LLM è€Œä¸æ˜¯ BERTï¼Ÿ**

A:
- **ç”Ÿæˆèƒ½åŠ›**: Decoder-only å¤©ç„¶æ”¯æŒè‡ªå›å½’ç”Ÿæˆï¼ˆåŒ…æ‹¬åŠ¨ä½œ Tokenï¼‰
- **In-context Learning**: å¯ä»¥é€šè¿‡ Prompt å¼•å¯¼æ¨¡å‹ç†è§£æ–°ä»»åŠ¡
- **è§„æ¨¡æ•ˆåº”**: å¤§è§„æ¨¡ LLM (7B+) ä¸»è¦æ˜¯ Decoder-only æ¶æ„ï¼Œå¯ä»¥ç›´æ¥å¤ç”¨

**Q3: å¤šæ¨¡æ€èåˆä¸­ Early / Mid / Late Fusion å¦‚ä½•é€‰æ‹©ï¼Ÿ**

A:
- **Early Fusion**: æ•°æ®æ¨¡æ€ç›¸ä¼¼åº¦é«˜ï¼ˆå¦‚å¤šç›¸æœºå›¾åƒï¼‰
- **Mid Fusion (Cross-Attention)**: éœ€è¦åŠ¨æ€å»ºæ¨¡æ¨¡æ€é—´å…³ç³»ï¼ˆVLA é¦–é€‰ï¼‰
- **Late Fusion**: å„æ¨¡æ€ä»»åŠ¡ç‹¬ç«‹æ€§å¼ºï¼Œæˆ–éœ€è¦æ¨¡å—åŒ–è§£é‡Šæ€§

**Q4: è§†è§‰ Token æ•°é‡å¦‚ä½•é€‰æ‹©ï¼Ÿ**

A:
- **å¤šäº†**: LLM è®¡ç®—å¼€é”€å¤§ï¼Œé•¿åºåˆ— Attention å˜æ…¢
- **å°‘äº†**: ä¸¢å¤±ç©ºé—´ç»†èŠ‚ï¼Œå½±å“ç²¾ç»†æ“ä½œ
- **å¸¸è§é€‰æ‹©**: 256 tokens (16x16 patches @ 224px)ï¼Œæˆ–ä½¿ç”¨ Perceiver Resampler å‹ç¼©åˆ° 64

**Q5: ä¸ºä»€ä¹ˆè¦å†»ç»“è§†è§‰ç¼–ç å™¨ï¼Ÿ**

A:
- **é˜²æ­¢ç¾éš¾æ€§é—å¿˜**: è§†è§‰ç¼–ç å™¨çš„é¢„è®­ç»ƒç‰¹å¾å¾ˆé‡è¦
- **è®¡ç®—æ•ˆç‡**: å‡å°‘å¯è®­ç»ƒå‚æ•°
- **æ•°æ®æ•ˆç‡**: æœºå™¨äººæ•°æ®å°‘ï¼Œå…¨é‡è®­ç»ƒå®¹æ˜“è¿‡æ‹Ÿåˆ
- **ä¾‹å¤–**: å¦‚æœè§†è§‰ä»»åŠ¡å·®å¼‚å¤§ï¼ˆå¦‚ä» ImageNet è¿ç§»åˆ°å†…çª¥é•œï¼‰ï¼Œå¯èƒ½éœ€è¦å¾®è°ƒ

**Q6: å¦‚æœè§†è§‰æ¨¡å—è¯¯åˆ¤ï¼Œå¦‚ä½•é€šè¿‡è¯­è¨€çº é”™ï¼Ÿ**

A: è¿™æ˜¯å¤šæ¨¡æ€ VLA çš„æ ¸å¿ƒä¼˜åŠ¿ä¹‹ä¸€ï¼Œæœ‰ä»¥ä¸‹å‡ ç§æœºåˆ¶ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   è§†è§‰è¯¯åˆ¤ â†’ è¯­è¨€çº é”™æœºåˆ¶                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   åœºæ™¯: è§†è§‰æ¨¡å—è¯¯åˆ¤ "çº¢è‰²æ¯å­" ä¸º "æ©™è‰²æ¯å­"                    â”‚
â”‚                                                                 â”‚
â”‚   æ–¹æ¡ˆ 1: é—­ç¯è¯­è¨€åé¦ˆ (Human-in-the-Loop)                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  ç”¨æˆ·: "ä¸å¯¹ï¼Œæ˜¯çº¢è‰²çš„é‚£ä¸ª"                               â”‚   â”‚
â”‚   â”‚  VLA: é‡æ–°å®šä½ â†’ ä¿®æ­£ç›®æ ‡                                â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚   æ–¹æ¡ˆ 2: Chain-of-Thought è‡ªæ£€                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  VLA è¾“å‡º: "æˆ‘çœ‹åˆ°ä¸€ä¸ªæ©™è‰²ç‰©ä½“..."                        â”‚   â”‚
â”‚   â”‚  ç”¨æˆ·æŒ‡ä»¤: "æŠ“çº¢è‰²æ¯å­"                                   â”‚   â”‚
â”‚   â”‚  CoT æ¨ç†: "æŒ‡ä»¤è¯´çº¢è‰²ï¼Œä½†æˆ‘è¯†åˆ«ä¸ºæ©™è‰²ï¼Œå¯èƒ½æœ‰è¯¯"          â”‚   â”‚
â”‚   â”‚  åŠ¨ä½œ: è¯·æ±‚ç¡®è®¤ æˆ– é‡æ–°æ„ŸçŸ¥                              â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚   æ–¹æ¡ˆ 3: å¤šæ¨¡æ€ä¸€è‡´æ€§æ£€æŸ¥                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  è®¡ç®—: sim(è¯­è¨€æè¿° Embedding, è§†è§‰ç‰¹å¾ Embedding)        â”‚   â”‚
â”‚   â”‚  å¦‚æœ sim < threshold: è§¦å‘é‡æ–°æ„ŸçŸ¥/è¯¢é—®                  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚   æ–¹æ¡ˆ 4: ä¸»åŠ¨è¯¢é—® (Uncertainty-aware)                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  VLA: "ä½ æ˜¯æŒ‡è¿™ä¸ªå—ï¼Ÿ" (æ˜¾ç¤ºå€™é€‰ç‰©ä½“)                     â”‚   â”‚
â”‚   â”‚  ç”¨æˆ·: "æ˜¯çš„" / "ä¸æ˜¯ï¼Œæ˜¯å·¦è¾¹é‚£ä¸ª"                        â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®ç°è¦ç‚¹**:
1. **è¯­ä¹‰æ¥åœ° (Grounding)**: è¯­è¨€æŒ‡ä»¤å¿…é¡»ä¸è§†è§‰æ£€æµ‹ç»“æœç»‘å®šï¼Œè€Œéç‹¬ç«‹å¤„ç†
2. **ç½®ä¿¡åº¦è¾“å‡º**: è§†è§‰æ¨¡å—è¾“å‡ºæ£€æµ‹ç½®ä¿¡åº¦ï¼Œä½ç½®ä¿¡åº¦æ—¶è§¦å‘çº é”™æœºåˆ¶
3. **å¤šè½®å¯¹è¯**: VLA éœ€è¦æ”¯æŒå¤šè½®äº¤äº’ï¼Œè€Œéå•æ¬¡æŒ‡ä»¤æ‰§è¡Œ
4. **CoT æ¨ç†**: æ˜¾å¼è¾“å‡ºæ¨ç†è¿‡ç¨‹ï¼Œä¾¿äºå‘ç°çŸ›ç›¾ (å‚è§ [chain_of_thought.md](./chain_of_thought.md))

## 9. å‚è€ƒèµ„æº (References)

- **CLIP**: [Learning Transferable Visual Models From Natural Language Supervision](https://arxiv.org/abs/2103.00020)
- **LLaVA**: [Visual Instruction Tuning](https://arxiv.org/abs/2304.08485)
- **Flamingo**: [A Visual Language Model for Few-Shot Learning](https://arxiv.org/abs/2204.14198)
- **SigLIP**: [Sigmoid Loss for Language Image Pre-Training](https://arxiv.org/abs/2303.15343)

---


\newpage

# ç¬¬4ç«  VLA æ¶æ„æ€»è§ˆ


æœ¬ç« èŠ‚æ·±å…¥è§£æ Vision-Language-Action (VLA) æ¨¡å‹çš„æ ¸å¿ƒæ¶æ„æ¼”è¿›ï¼Œä» Google çš„ RT ç³»åˆ—åˆ°å¼€æºçš„ OpenVLAï¼Œå†åˆ°æœ€æ–°çš„ Physical Intelligence (Pi) æ¨¡å‹ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    VLA æ¶æ„æ¼”è¿›è·¯çº¿å›¾                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   RT-1 (2022)              RT-2 (2023)              Ï€0 (2024)   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚EffNet   â”‚              â”‚ PaLI-X  â”‚              â”‚ Gemma   â”‚ â”‚
â”‚   â”‚   +     â”‚   â”€â”€â”€â”€â–¶      â”‚  55B    â”‚   â”€â”€â”€â”€â–¶      â”‚  +Flow  â”‚ â”‚
â”‚   â”‚Tokenize â”‚              â”‚ VLM+Act â”‚              â”‚ Matchingâ”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚     å°æ¨¡å‹                   å¤§VLM                    é«˜æ•ˆæ¨ç†   â”‚
â”‚     æœºå™¨äººæ•°æ®               +äº’è”ç½‘æ•°æ®               +ç²¾ç»†æ§åˆ¶  â”‚
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                    é€šç”¨ VLA æ¶æ„æ¨¡æ¿                     â”‚   â”‚
â”‚   â”‚                                                         â”‚   â”‚
â”‚   â”‚    ğŸ“· Image          ğŸ“ Language                        â”‚   â”‚
â”‚   â”‚       â”‚                  â”‚                              â”‚   â”‚
â”‚   â”‚       â–¼                  â–¼                              â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚   â”‚
â”‚   â”‚  â”‚ Vision  â”‚       â”‚ Language  â”‚                        â”‚   â”‚
â”‚   â”‚  â”‚ Encoder â”‚       â”‚ Encoder   â”‚                        â”‚   â”‚
â”‚   â”‚  â”‚(ViT/CNN)â”‚       â”‚(LLM/BERT) â”‚                        â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                        â”‚   â”‚
â”‚   â”‚       â”‚                  â”‚                              â”‚   â”‚
â”‚   â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚   â”‚
â”‚   â”‚                â”‚ Fusion                                 â”‚   â”‚
â”‚   â”‚                â–¼                                        â”‚   â”‚
â”‚   â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚   â”‚
â”‚   â”‚       â”‚  Transformer    â”‚                               â”‚   â”‚
â”‚   â”‚       â”‚    Backbone     â”‚                               â”‚   â”‚
â”‚   â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚   â”‚
â”‚   â”‚                â”‚                                        â”‚   â”‚
â”‚   â”‚                â–¼                                        â”‚   â”‚
â”‚   â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚   â”‚
â”‚   â”‚       â”‚   Action Head   â”‚                               â”‚   â”‚
â”‚   â”‚       â”‚ Token/Diff/Flow â”‚                               â”‚   â”‚
â”‚   â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚   â”‚
â”‚   â”‚                â”‚                                        â”‚   â”‚
â”‚   â”‚                â–¼                                        â”‚   â”‚
â”‚   â”‚          ğŸ¦¾ Robot Action                                â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 1. RT-1 (Robotics Transformer 1)
> **æ ¸å¿ƒæ€æƒ³**: å°†æœºå™¨äººæ§åˆ¶å»ºæ¨¡ä¸º Token ç”Ÿæˆé—®é¢˜ï¼Œä½¿ç”¨ Transformer å¤„ç†å¤šæ¨¡æ€è¾“å…¥ã€‚

- **æ¶æ„**: EfficientNet (Vision) + FiLM (Language conditioning) + TokenLearner + Transformer.
- **Action Tokenization**:
    - å°†è¿ç»­çš„åŠ¨ä½œç©ºé—´ (x, y, z, roll, pitch, yaw, gripper) ç¦»æ•£åŒ–ä¸º 256 ä¸ª binsã€‚
    - è¾“å‡ºæ˜¯ä¸€ä¸ªç¦»æ•£çš„ Token åºåˆ—ï¼Œä»£è¡¨åŠ¨ä½œç»´åº¦ã€‚
- **å…³é”®ç‚¹**:
    - **TokenLearner**: æ˜¾è‘—å‡å°‘äº†è§†è§‰ Token çš„æ•°é‡ (e.g., 81 -> 8)ï¼Œæé«˜äº†æ¨ç†é€Ÿåº¦ã€‚
    - **æ•°æ®è§„æ¨¡**: 130k episodes (17 months of data).
    - **å±€é™æ€§**: æ³›åŒ–èƒ½åŠ›æœ‰é™ï¼Œä¸»è¦ä¾èµ–äºå¤§è§„æ¨¡æ”¶é›†çš„æœºå™¨äººæ•°æ®ï¼Œç¼ºä¹äº’è”ç½‘çŸ¥è¯†çš„è¿ç§»ã€‚

## 2. RT-2 (Robotics Transformer 2)
> **æ ¸å¿ƒæ€æƒ³**: VLA = VLM + Action Tokens. ç›´æ¥å¾®è°ƒé¢„è®­ç»ƒçš„ VLM (å¦‚ PaLI-X, PaLM-E) ç”¨äºæœºå™¨äººæ§åˆ¶ã€‚

- **æ¶æ„**: åŸºäºå¤§è§„æ¨¡ VLM (Vision-Language Model) å¾®è°ƒã€‚
- **Co-fine-tuning**:
    - æ··åˆè®­ç»ƒï¼šäº’è”ç½‘ VQA æ•°æ® + æœºå™¨äººæ“ä½œæ•°æ®ã€‚
    - æœºå™¨äººåŠ¨ä½œè¢«è¡¨ç¤ºä¸ºç‰¹æ®Šçš„æ–‡æœ¬ Token (e.g., "1 128 90 ...")ï¼Œä¸è‡ªç„¶è¯­è¨€ Token å…±äº«è¯è¡¨ã€‚
- **å…³é”®ç‚¹**:
    - **æ¶Œç°èƒ½åŠ› (Emergent Capabilities)**: èƒ½å¤Ÿç†è§£æœªè§è¿‡çš„æŒ‡ä»¤ (e.g., "pick up the extinct animal" -> æŠ“æé¾™ç©å…·)ï¼Œå¾—ç›Šäº VLM çš„è¯­ä¹‰ç†è§£èƒ½åŠ›ã€‚
    - **Chain-of-Thought**: æ”¯æŒç®€å•çš„æ¨ç†æ­¥éª¤ã€‚
    - **å±€é™æ€§**: æ¨ç†é€Ÿåº¦æ…¢ (å¤§æ¨¡å‹)ï¼Œéš¾ä»¥åœ¨è¾¹ç¼˜ç«¯å®æ—¶è¿è¡Œã€‚

## 3. OpenVLA / Octo
> **æ ¸å¿ƒæ€æƒ³**: å¼€æºã€é«˜æ•ˆã€åŸºäº Diffusion æˆ– Llama çš„ VLA ç­–ç•¥ã€‚

### Octo
- **æ¶æ„**: åŸºäº Diffusion Policy çš„ Transformer æ¶æ„ã€‚
- **ç‰¹ç‚¹**: æ”¯æŒå¤šç§è§‚å¯Ÿç©ºé—´ (Proprioception, Images) å’ŒåŠ¨ä½œç©ºé—´ã€‚
- **è®­ç»ƒ**: åœ¨ Open X-Embodiment (OXE) æ•°æ®é›†ä¸Šè®­ç»ƒã€‚

### OpenVLA
- **æ¶æ„**: åŸºäº Llama 2 (7B) + DINOv2 / SigLIP (Vision Encoder)ã€‚
- **Action Head**:
    - å¹¶æ²¡æœ‰ç›´æ¥è¾“å‡ºæ–‡æœ¬ Tokenï¼Œè€Œæ˜¯ä½¿ç”¨ä¸“é—¨çš„ Action Head (Linear Layer) é¢„æµ‹å»ç¦»æ•£åŒ–çš„åŠ¨ä½œ Tokenã€‚
    - ä½¿ç”¨ **Action Detokenization** è¿˜åŸä¸ºè¿ç»­åŠ¨ä½œã€‚
- **ä¼˜åŒ–**: æ”¯æŒ 4-bit é‡åŒ– (QLoRA) è®­ç»ƒå’Œæ¨ç†ï¼Œé€‚åˆæ¶ˆè´¹çº§æ˜¾å¡ã€‚

## 4. Physical Intelligence (Pi) Models
> **æ ¸å¿ƒæ€æƒ³**: é€šç”¨æœºå™¨äººåŸºç¡€æ¨¡å‹ (Generalist Robot Foundation Models)ï¼Œå¼ºè°ƒè·¨å½¢æ€ (Cross-Embodiment) å’Œç‰©ç†ä¸–ç•Œçš„ç†è§£ã€‚

### Ï€0 (Pi-Zero)
- **å®šä½**: åŸºç¡€ VLA æ¨¡å‹ï¼Œæ—¨åœ¨è§£å†³é€šç”¨çš„ç‰©ç†æ“ä½œé—®é¢˜ã€‚**å·²å¼€æº (Open Weights)**ã€‚
- **æ¶æ„ç‰¹ç‚¹**:
    - ç±»ä¼¼äº RT ç³»åˆ—ï¼Œä½†æ›´å¼ºè°ƒå¯¹ç‰©ç†åŠ¨åŠ›å­¦çš„ç†è§£ã€‚
    - å¯èƒ½é‡‡ç”¨äº†æ›´é«˜æ•ˆçš„ Action Tokenizerï¼Œä»¥é€‚åº”é«˜é¢‘æ§åˆ¶éœ€æ±‚ã€‚
- **æ•°æ®**: æ··åˆäº†å¤šç§æœºå™¨äººçš„æ•°æ® (Arms, Quadrupeds, Humanoids)ã€‚

### Ï€0.5 (Pi-Zero-Point-Five) - April 2025
> **[Deep Dive: Pi0.5 æ¨¡å‹è§£å‰–](./pi0_5_dissection.md)**

- **æ ¸å¿ƒå‡çº§**: **Open-world Generalization** (å¼€æ”¾ä¸–ç•Œæ³›åŒ–) ä¸ **Hierarchical Inference** (åˆ†å±‚æ¨ç†)ã€‚
- **æ¶æ„ç‰¹ç‚¹**:
    - **ç»Ÿä¸€æ¨¡å‹ (Unified Model)**: åŒæ—¶è´Ÿè´£é«˜å±‚è¯­ä¹‰è§„åˆ’ (Subtask Prediction) å’Œåº•å±‚ç”µæœºæ§åˆ¶ (Motor Control)ã€‚æ¨¡å‹"è‡ªè¨€è‡ªè¯­"ä¸‹ä¸€æ­¥è¦åšä»€ä¹ˆï¼Œç„¶åæ‰§è¡Œã€‚
    - **å¼‚æ„æ•°æ®è®­ç»ƒ**: å¼•å…¥äº†å¤§é‡çš„äº’è”ç½‘è§†é¢‘æ•°æ® (YouTube) å’Œæ¨¡æ‹Ÿæ•°æ®ï¼Œé€šè¿‡ Co-training å®ç°å¯¹æ–°ç¯å¢ƒ (å¦‚ä»æœªè§è¿‡çš„å¨æˆ¿) çš„é€‚åº”ã€‚
    - **æ··åˆæ¶æ„**: é¢„è®­ç»ƒé˜¶æ®µå¯èƒ½ä½¿ç”¨ç¦»æ•£ Token (FAST tokenizer) ä»¥æé«˜æ•ˆç‡ï¼Œæ¨ç†é˜¶æ®µä½¿ç”¨ Flow Matching ç”Ÿæˆè¿ç»­åŠ¨ä½œã€‚

### Ï€0.6 & Ï€*0.6 (Pi-Star) - November 2025
> **[Deep Dive: Pi0.6 æ¨¡å‹è§£å‰–](./pi0_6_dissection.md)**

- **æ ¸å¿ƒå‡çº§**: **RL (Reinforcement Learning) å¼ºåŒ–** ä¸ **Recap ç®—æ³•**ã€‚
- **Backbone**: å‡çº§ä¸º **5B Parameter VLM**ï¼Œå¢å¼ºäº†å¯¹å¤æ‚æŒ‡ä»¤å’Œç¯å¢ƒçš„ç†è§£ã€‚
- **Ï€*0.6 (Pi-Star)**:
    - **Recap ç®—æ³•**: ä¸€ç§ Offline RL æ–¹æ³•ã€‚æ¨¡å‹é€šè¿‡"å¤ç›˜" (Recap) è¿‡å»çš„æˆåŠŸä¸å¤±è´¥ç»éªŒè¿›è¡Œè‡ªæˆ‘æå‡ï¼Œè€Œä¸ä»…ä»…æ˜¯æ¨¡ä»¿ (BC)ã€‚
    - **æ€§èƒ½é£è·ƒ**: åœ¨é•¿åºåˆ—ä»»åŠ¡ (å¦‚æŠ˜å è¡£ç‰©ã€ç»„è£…çº¸ç®±) ä¸Šï¼Œååé‡ç¿»å€ï¼Œå¤±è´¥ç‡é™ä½ 2xã€‚
    - **Self-Improvement**: å…·å¤‡åœ¨çœŸæœºè¿è¡Œä¸­æŒç»­å­¦ä¹ çš„èƒ½åŠ›ã€‚
- **Action Expert**: å¼•å…¥äº†ä¸“é—¨çš„åŠ¨ä½œä¸“å®¶æ¨¡å—ï¼Œä¸“é—¨å¤„ç†ç²¾ç»†æ“ä½œï¼Œè§£å†³äº†å¤§è¯­è¨€æ¨¡å‹åœ¨ç²¾ç»†è¿åŠ¨æ§åˆ¶ä¸Šçš„"æ‰‹ç¬¨"é—®é¢˜ã€‚

## 5. æ¨¡å‹å¯¹æ¯”æ€»ç»“ (Model Comparison)

| æ¨¡å‹ | åŸºç¡€æ¶æ„ | Action è¾“å‡º | è®­ç»ƒæ•°æ® | ä¼˜åŠ¿ | åŠ£åŠ¿ |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **RT-1** | EfficientNet + Transformer | Discrete Tokens | Robot Data Only | æ¨ç†å¿«ï¼Œç¨³å®šæ€§é«˜ | æ³›åŒ–å·®ï¼Œæ— è¯­ä¹‰æ¨ç† |
| **RT-2** | PaLI-X / PaLM-E | Text Tokens | Web + Robot Data | è¯­ä¹‰ç†è§£å¼ºï¼ŒZero-shot | æ¨ç†æ…¢ï¼Œé—­æº |
| **OpenVLA** | Llama 2 + SigLIP | Action Head | OXE Dataset | å¼€æºï¼Œæ”¯æŒé‡åŒ–ï¼Œæ˜“éƒ¨ç½² | æ€§èƒ½ç•¥é€Šäºé—­æº SOTA |
| **WALL-OSS** | Qwen2.5 VLMoE | **Dual Branches** (Flow + FAST) | Cross-Embodiment | **COT æ¨ç†**ï¼ŒåŒåˆ†æ”¯ï¼Œ**å·²å¼€æº** | è®­ç»ƒèµ„æºéœ€æ±‚é«˜ |
| **Ï€0.6** | Gemma 3 + Action Expert | Specialized | Cross-Embodiment + RL | æ³›åŒ–å¼ºï¼Œç²¾ç»†æ“ä½œå¥½ï¼Œ**å·²å¼€æº** | è®­ç»ƒæå…¶æ˜‚è´µ |

## é¢è¯•é«˜é¢‘è€ƒç‚¹
1. **Action Tokenization**: ä¸ºä»€ä¹ˆè¦ç¦»æ•£åŒ–ï¼Ÿè¿ç»­å›å½’ (Regression) æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ(ç­”: å¤šæ¨¡æ€åˆ†å¸ƒå¤„ç†èƒ½åŠ›)
2. **Co-fine-tuning**: ä¸ºä»€ä¹ˆè¦æ··åˆäº’è”ç½‘æ•°æ®ï¼Ÿ(ç­”: ä¿æŒ VLM çš„è¯­ä¹‰èƒ½åŠ›ï¼Œé˜²æ­¢ç¾éš¾æ€§é—å¿˜)
3. **Sim-to-Real**: OpenVLA å¦‚ä½•åœ¨çœŸæœºä¸Šéƒ¨ç½²ï¼Ÿ(ç­”: é‡åŒ–ï¼ŒVLM è’¸é¦)


---

\newpage

# ç¬¬äºŒéƒ¨åˆ†ï¼šç­–ç•¥ç”Ÿæˆä¸åŠ¨ä½œè¡¨ç¤º


\newpage

# ç¬¬5ç«  åŠ¨ä½œè¡¨ç¤ºæ–¹æ³•


åœ¨ VLA æ¨¡å‹ä¸­ï¼Œ"å¦‚ä½•è¾“å‡ºåŠ¨ä½œ" æ˜¯ä¸€ä¸ªæ ¸å¿ƒè®¾è®¡é€‰æ‹©ã€‚æœ¬ç« è¯¦ç»†å¯¹æ¯”ä¸‰ç§ä¸»æµçš„åŠ¨ä½œç”ŸæˆèŒƒå¼ï¼š**ç¦»æ•£åŒ– (Discrete Tokenization)**ã€**æ‰©æ•£ç­–ç•¥ (Diffusion Policy)** å’Œ **æµåŒ¹é… (Flow Matching)**ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ä¸‰ç§åŠ¨ä½œç”ŸæˆèŒƒå¼å¯¹æ¯” (Action Generation)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. ç¦»æ•£åŒ– Tokenization (RT-1, RT-2)                            â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚     â”‚ è¿ç»­åŠ¨ä½œ â”€â”€â–¶ ç¦»æ•£ Bins â”€â”€â–¶ Token é¢„æµ‹   â”‚                 â”‚
â”‚     â”‚  0.234   â”€â”€â–¶  [0-255]  â”€â”€â–¶   Token 60   â”‚                 â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚     âš¡ å¿«é€Ÿ (1æ­¥)  |  ğŸ“‰ ç²¾åº¦æŸå¤±  |  âœ… å¤šæ¨¡æ€                  â”‚
â”‚                                                                 â”‚
â”‚  2. æ‰©æ•£ç­–ç•¥ Diffusion (Octo)                                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚     â”‚ å™ªå£° â•â•â•â•â–¶ å»å™ª â•â•â•â•â–¶ å»å™ª â•â•â•â•â–¶ åŠ¨ä½œ   â”‚                 â”‚
â”‚     â”‚  x_T  â”€â”€â–¶  x_{T-1} â”€â”€â–¶ ... â”€â”€â–¶  x_0    â”‚                 â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚     ğŸ¢ æ…¢ (50-100æ­¥)  |  ğŸ¯ é«˜ç²¾åº¦  |  âœ… å¤šæ¨¡æ€                 â”‚
â”‚                                                                 â”‚
â”‚  3. æµåŒ¹é… Flow Matching (Ï€0)                                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚     â”‚ å™ªå£° â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–¶ åŠ¨ä½œ â”‚                 â”‚
â”‚     â”‚  x_T  â”€â”€â”€â”€â”€â”€ ç›´çº¿ ODE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  x_0  â”‚                 â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚     âš¡ æå¿« (1-10æ­¥)  |  ğŸ¯ é«˜ç²¾åº¦  |  âœ… å¤šæ¨¡æ€                 â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 1. ç¦»æ•£åŒ– (Discrete Tokenization)
> **ä»£è¡¨æ¨¡å‹**: **RT-1**, **RT-2**, **Gato**

### æ ¸å¿ƒæ€æƒ³
å°†è¿ç»­çš„ç‰©ç†åŠ¨ä½œ (å¦‚å…³èŠ‚è§’åº¦ã€æœ«ç«¯åæ ‡) ç¦»æ•£åŒ–ä¸ºæ•´æ•° Tokenï¼Œä»è€Œå¯ä»¥ä½¿ç”¨æ ‡å‡†çš„ Transformer (åˆ†ç±»ä»»åŠ¡) è¿›è¡Œé¢„æµ‹ã€‚

### æ•°å­¦å…¬å¼
å‡è®¾åŠ¨ä½œ $a \in [min, max]$ï¼Œæˆ‘ä»¬å°†å…¶åˆ’åˆ†ä¸º $N$ ä¸ªåŒºé—´ (Bins)ã€‚

$$
Token = \text{round}\left( \frac{a - min}{max - min} \times (N - 1) \right)
$$

- **RT-1**: ä½¿ç”¨ $N=256$ã€‚
- **é¢„æµ‹**: æ¨¡å‹è¾“å‡ºä¸€ä¸ª Logits å‘é‡ $z \in \mathbb{R}^N$ï¼Œé€šè¿‡ Softmax å¾—åˆ°æ¦‚ç‡åˆ†å¸ƒï¼š

$$
P(Token = i) = \frac{e^{z_i}}{\sum_{j=0}^{N-1} e^{z_j}}
$$


### ä¼˜ç¼ºç‚¹
- **ä¼˜ç‚¹**:
    - **å¤šæ¨¡æ€åˆ†å¸ƒ (Multimodal)**: å¯ä»¥å¾ˆå¥½åœ°å»ºæ¨¡"å‘å·¦èµ°æˆ–å‘å³èµ°" (åŒå³°åˆ†å¸ƒ)ï¼Œè€Œä¸ä¼šè¾“å‡ºä¸­é—´çš„å¹³å‡å€¼ (æ’å¢™)ã€‚
    - **æ¶æ„ç»Ÿä¸€**: å¯ä»¥ç›´æ¥å¤ç”¨ LLM çš„ Cross-Entropy Lossã€‚
- **ç¼ºç‚¹**:
    - **ç²¾åº¦æŸå¤±**: ä¸¢å¤±äº† Bin å†…éƒ¨çš„ç²¾åº¦ã€‚å¯¹äºé«˜ç²¾åº¦è£…é…ä»»åŠ¡ï¼Œ256 ä¸ª Bin å¯èƒ½ä¸å¤Ÿã€‚
    - **é«˜é¢‘æŠ–åŠ¨**: é¢„æµ‹ç»“æœåœ¨ç›¸é‚» Bin ä¹‹é—´è·³å˜ä¼šå¯¼è‡´åŠ¨ä½œä¸å¹³æ»‘ã€‚

---

## 2. æ‰©æ•£ç­–ç•¥ (Diffusion Policy)
> **å‰ç½®é˜…è¯»**: [ä¼ ç»ŸåŠ¨ä½œç”Ÿæˆæ–¹æ³• (MSE/GMM)](./traditional_action_generation.md) - äº†è§£ä¸ºä»€ä¹ˆ MSE ä¼šå¯¼è‡´"æ’å¢™"ï¼Œä»¥åŠ GMM çš„å±€é™æ€§ã€‚

> **ä»£è¡¨æ¨¡å‹**: **Octo**, **MimicGen**, **Toyota HPT**

### æ ¸å¿ƒæ€æƒ³
å°†åŠ¨ä½œç”Ÿæˆå»ºæ¨¡ä¸ºä»é«˜æ–¯å™ªå£°ä¸­ **å»å™ª (Denoising)** çš„è¿‡ç¨‹ã€‚

### æ•°å­¦å…¬å¼
- **å‰å‘è¿‡ç¨‹ (åŠ å™ª)**:

$$
q(x_t | x_0) = \mathcal{N}(x_t; \sqrt{\bar{\alpha}_t} x_0, (1 - \bar{\alpha}_t) I)
$$

- **é€†å‘è¿‡ç¨‹ (å»å™ª)**:
æ¨¡å‹ $\epsilon_\theta(x_t, t, \text{cond})$ é¢„æµ‹å™ªå£°ï¼Œä»è€Œé€æ­¥è¿˜åŸåŠ¨ä½œï¼š

$$
x_{t-1} = \frac{1}{\sqrt{\alpha_t}} \left( x_t - \frac{1 - \alpha_t}{\sqrt{1 - \bar{\alpha}_t}} \epsilon_\theta(x_t, t, \text{cond}) \right) + \sigma_t z
$$


### ä¼˜ç¼ºç‚¹
- **ä¼˜ç‚¹**:
    - **é«˜ç²¾åº¦**: è¾“å‡ºæ˜¯è¿ç»­å€¼ï¼Œæ²¡æœ‰ç¦»æ•£åŒ–è¯¯å·®ã€‚
    - **å¤šæ¨¡æ€**: å¤©ç„¶æ”¯æŒå¤šè§£åˆ†å¸ƒ (Multimodal Distribution)ã€‚
    - **ç¨³å®šæ€§**: ç›¸æ¯” GANï¼Œè®­ç»ƒæ›´ç¨³å®šã€‚
- **ç¼ºç‚¹**:
    - **æ¨ç†æ…¢**: éœ€è¦è¿­ä»£å»å™ª (é€šå¸¸ 50-100 æ­¥)ï¼Œå¯¼è‡´æ¨ç†å»¶è¿Ÿé«˜ (Latency)ï¼Œéš¾ä»¥ç”¨äºé«˜é¢‘æ§åˆ¶ (å¦‚ >50Hz)ã€‚

---

## 3. æµåŒ¹é… (Flow Matching)
> **ä»£è¡¨æ¨¡å‹**: **Pi0 (Physical Intelligence)**

### æ ¸å¿ƒæ€æƒ³
å­¦ä¹ ä¸€ä¸ª **ç¡®å®šæ€§çš„å‘é‡åœº (Vector Field)**ï¼Œå°†å™ªå£°åˆ†å¸ƒå¹³æ»‘åœ°å˜æ¢ä¸ºæ•°æ®åˆ†å¸ƒã€‚

### ä¸ Diffusion çš„å¯¹æ¯”
- **Diffusion**: èµ°çš„æ˜¯éšæœºæ¸¸èµ° (Stochastic) çš„å»å™ªè·¯å¾„ã€‚
- **Flow Matching**: èµ°çš„æ˜¯ **ç›´çº¿ (Straight)** è·¯å¾„ (Optimal Transport)ã€‚

### ä¼˜ç¼ºç‚¹
- **ä¼˜ç‚¹**:
    - **æé€Ÿæ¨ç†**: ç”±äºè½¨è¿¹æ˜¯ç›´çš„ï¼ŒODE æ±‚è§£å™¨åªéœ€è¦å¾ˆå°‘çš„æ­¥æ•° (e.g., 1-10 æ­¥) å°±èƒ½å¾—åˆ°é«˜è´¨é‡ç»“æœã€‚
    - **é«˜é¢‘æ§åˆ¶**: ä½¿å¾—å¤§æ¨¡å‹ä¹Ÿèƒ½è·‘åœ¨ 50Hz+ çš„æ§åˆ¶é¢‘ç‡ä¸Šã€‚
- **ç¼ºç‚¹**:
    - **è®­ç»ƒå¤æ‚**: æ•°å­¦ç†è®ºç›¸å¯¹è¾ƒæ–°ï¼Œè®­ç»ƒç¨³å®šæ€§éœ€è¦æŠ€å·§ã€‚

---

## æ€»ç»“å¯¹æ¯” (Comparison)

| èŒƒå¼ | ä»£è¡¨æ¨¡å‹ | è¾“å‡ºç±»å‹ | æ¨ç†é€Ÿåº¦ | ç²¾åº¦ | å¤šæ¨¡æ€æ”¯æŒ |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **Discrete Tokenization** | RT-1, RT-2 | æ•´æ•° Token | å¿« (1æ­¥) | ä½ (å—é™äº Bin) | æ”¯æŒ |
| **Diffusion Policy** | Octo | è¿ç»­æµ®ç‚¹æ•° | æ…¢ (50+æ­¥) | é«˜ | æ”¯æŒ |
| **Flow Matching** | Pi0 | è¿ç»­æµ®ç‚¹æ•° | æå¿« (1-10æ­¥) | é«˜ | æ”¯æŒ |

> **é¢è¯• Tip**: å¦‚æœé¢è¯•å®˜é—® "ä¸ºä»€ä¹ˆç°åœ¨çš„ VLA æ¨¡å‹å¼€å§‹ä» Tokenization è½¬å‘ Diffusion/Flow?"
> **ç­”**: ä¸ºäº†è¿½æ±‚**é«˜ç²¾åº¦æ“ä½œ** (å¦‚ç©¿é’ˆã€è£…é…)ã€‚Tokenization åœ¨å¤„ç†è¿™ç§ä»»åŠ¡æ—¶ï¼Œé‡åŒ–è¯¯å·®æ˜¯è‡´å‘½çš„ï¼Œè€Œ Diffusion/Flow æä¾›äº†è¿ç»­ç©ºé—´çš„ç²¾ç»†æ§åˆ¶èƒ½åŠ›ã€‚


---

\newpage

# ç¬¬6ç«  Diffusion Policy


> **æ ¸å¿ƒè®ºæ–‡**: [Diffusion Policy: Visuomotor Policy Learning via Action Diffusion](https://arxiv.org/abs/2303.04137) (Cheng Chi et al., RSS 2023)
> **ä»£è¡¨æ¨¡å‹**: **Octo**, **MimicGen**, **Toyota HPT**

## 0. ä¸»è¦æ•¸å­¸æ€æƒ³ (Main Mathematical Idea)

> **ç¬¬ä¸€æ€§åŸç†**: **Constructing Structure from Chaos (ä»æ··æ²Œä¸­æ„å»ºç§©åº)**

ç‰©ç†ä¸–ç•Œä¸­ï¼Œç†µå¢ï¼ˆæœ‰åºå˜æ— åºï¼‰æ˜¯è‡ªç„¶è¶‹åŠ¿ï¼Œå¦‚å¢¨æ°´åœ¨æ°´ä¸­æ‰©æ•£ã€‚Diffusion Model è¯•å›¾åœ¨æ•°å­¦ä¸Š**é€†è½¬**è¿™ä¸€æ—¶é—´è¿‡ç¨‹ã€‚

- **æ ¸å¿ƒæ•°å­¦å·¥å…·**: **Langevin Dynamics (æœ—ä¹‹ä¸‡åŠ¨åŠ›å­¦)** ä¸ **Score Matching**ã€‚
- **è§£é¢˜é€»è¾‘**:
    1.  **é€†å‘æ€ç»´**: å¦‚æœæˆ‘ä»¬çŸ¥é“æ•°æ®æ˜¯å¦‚ä½•ä¸€æ­¥æ­¥å˜æˆå™ªå£°çš„ï¼ˆå‰å‘è¿‡ç¨‹ï¼‰ï¼Œé‚£ä¹ˆåªè¦å­¦ä¼šæ¯ä¸€æ­¥çš„"é€†æ“ä½œ"ï¼ˆå»å™ªï¼‰ï¼Œå°±èƒ½ä»çº¯å™ªå£°ä¸­æ¢å¤å‡ºæ•°æ®ã€‚
    2.  **æ¢¯åº¦æŒ‡å¼•**: å­¦ä¹ æ•°æ®åˆ†å¸ƒçš„æ¢¯åº¦åœºï¼ˆScore Functionï¼Œ$\nabla_x \log p(x)$ï¼‰ã€‚è¿™å°±åƒåœ¨è¿·é›¾ï¼ˆå™ªå£°ï¼‰ä¸­ï¼Œæ¯ä¸€æ­¥éƒ½æ²¿ç€"æ•°æ®å¯†åº¦æ›´é«˜"çš„æ–¹å‘èµ°ä¸€å°æ­¥ï¼Œæœ€ç»ˆå¿…ç„¶ä¼šèµ°åˆ°æ•°æ®æµå½¢ä¸Šï¼ˆç”Ÿæˆåˆç†çš„åŠ¨ä½œï¼‰ã€‚
    3.  **å¤šæ¨¡æ€**: ä¸åƒå›å½’æ¨¡å‹å¯»æ‰¾"å¹³å‡å€¼"ï¼Œæ‰©æ•£æ¨¡å‹å­¦ä¹ çš„æ˜¯æ•´ä¸ªåœ°å½¢ï¼ˆLandscapeï¼‰ï¼Œå› æ­¤å¯ä»¥ä»åŒä¸€ä¸ªå™ªå£°èµ·ç‚¹èµ°åˆ°ä¸åŒçš„ç»ˆç‚¹ï¼ˆè§£å†³å¤šè§£é—®é¢˜ï¼‰ã€‚

## 1. ä¸ºä»€ä¹ˆéœ€è¦ Diffusion Policy? (Why?)

åœ¨ VLA å‡ºç°ä¹‹å‰ï¼Œä¸»æµçš„åŠ¨ä½œç”Ÿæˆæ–¹å¼æ˜¯ **MSE Regression** (å‡æ–¹è¯¯å·®å›å½’) æˆ– **GMM** (é«˜æ–¯æ··åˆæ¨¡å‹)ã€‚

### 1.1 å¤šæ¨¡æ€åˆ†å¸ƒé—®é¢˜ (The Multimodality Problem)
æœºå™¨äººç»å¸¸é¢ä¸´"å¤šè§£"æƒ…å†µã€‚ä¾‹å¦‚ï¼Œç»•è¿‡éšœç¢ç‰©å¯ä»¥**ä»å·¦ç»•**ä¹Ÿå¯ä»¥**ä»å³ç»•**ã€‚
- **MSE (å‡å€¼å›å½’)**: ä¼šé¢„æµ‹å‡ºå·¦å’Œå³çš„å¹³å‡å€¼ -> **ç›´ç›´æ’å‘éšœç¢ç‰©**ã€‚
- **Diffusion**: å¯ä»¥å®Œç¾æ‹ŸåˆåŒå³°åˆ†å¸ƒï¼Œéšæœºé‡‡æ ·å‡º"å·¦"æˆ–"å³"çš„ä¸€æ¡å®Œæ•´è½¨è¿¹ï¼Œè€Œä¸ä¼šå–å¹³å‡ã€‚
    - **Energy-Based Model (EBM) è§†è§’**: æˆ‘ä»¬å¯ä»¥æŠŠ Diffusion çœ‹ä½œæ˜¯åœ¨å­¦ä¹ ä¸€ä¸ªèƒ½é‡å‡½æ•° $E(x)$ã€‚çœŸå®æ•°æ®çš„èƒ½é‡ä½ï¼Œå™ªå£°çš„èƒ½é‡é«˜ã€‚
    - MSE è¯•å›¾æœ€å°åŒ–å•ä¸€æ¨¡æ€çš„è¯¯å·®ï¼Œç›¸å½“äºåœ¨ä¸¤ä¸ªä½è°·ä¹‹é—´å¼ºè¡Œæ‰¾ä¸€ä¸ª"å¹³å‡ä½è°·" (å¾€å¾€æ˜¯èƒ½é‡å¾ˆé«˜çš„é«˜åœ°)ã€‚
    - Diffusion åˆ™æ˜¯å­¦ä¹ æ•´ä¸ªåœ°è²Œ (Landscape)ï¼Œå…è®¸å­˜åœ¨å¤šä¸ªåˆ†ç¦»çš„ä½è°· (Modes)ã€‚

### 1.2 è¿ç»­ç©ºé—´çš„é«˜ç²¾åº¦ (High Precision)
ç›¸æ¯”äº Tokenization (RT-1) å°†åŠ¨ä½œç¦»æ•£åŒ–ä¸º 256 ä¸ªæ¡¶ï¼ŒDiffusion ç›´æ¥åœ¨è¿ç»­ç©ºé—´ç”Ÿæˆæµ®ç‚¹æ•°ï¼Œç²¾åº¦ç†è®ºä¸Šæ— é™ï¼Œéå¸¸é€‚åˆ**ç©¿é’ˆå¼•çº¿ã€ç²¾å¯†è£…é…**ç­‰ä»»åŠ¡ã€‚

## 2. æ•°å­¦åŸç† (Mathematical Formulation)

Diffusion Policy å°†åŠ¨ä½œç”Ÿæˆå»ºæ¨¡ä¸ºä¸€ä¸ª **æ¡ä»¶å»å™ªè¿‡ç¨‹ (Conditional Denoising Process)**ã€‚

### 2.1 å‰å‘è¿‡ç¨‹ (Forward Process / Diffusion)
å°†çœŸå®çš„åŠ¨ä½œè½¨è¿¹ $x_0$ é€æ­¥åŠ å™ªï¼Œå˜æˆçº¯é«˜æ–¯å™ªå£° $x_T$ã€‚

$$
q(x_t | x_{t-1}) = \mathcal{N}(x_t; \sqrt{1 - \beta_t} x_{t-1}, \beta_t I)
$$

ç»è¿‡ $t$ æ­¥åï¼Œå¯ä»¥ç›´æ¥å†™å‡º $x_t$ ä¸ $x_0$ çš„å…³ç³»ï¼š
$$
q(x_t | x_0) = \mathcal{N}(x_t; \sqrt{\bar{\alpha}_t} x_0, (1 - \bar{\alpha}_t) I)
$$

å…¶ä¸­ $\alpha_t = 1 - \beta_t$, $\bar{\alpha}_t = \prod_{i=1}^t \alpha_i$ã€‚

### 2.2 å™ªå£°è°ƒåº¦å™¨ (Noise Scheduler)
$\beta_t$ çš„é€‰æ‹©è‡³å…³é‡è¦ï¼Œé€šå¸¸æœ‰ä¸¤ç§ç­–ç•¥ï¼š
- **Linear Schedule**: $\beta_t$ ä» $\beta_{min}=10^{-4}$ çº¿æ€§å¢åŠ åˆ° $\beta_{max}=0.02$ã€‚
    - $\beta_t = \beta_{min} + \frac{t}{T}(\beta_{max} - \beta_{min})$
- **Cosine Schedule**: $\beta_t$ éšä½™å¼¦å‡½æ•°å˜åŒ–ï¼Œèƒ½æ›´å¥½åœ°ä¿ç•™ä¸­é—´æ—¶åˆ»çš„ä¿¡æ¯ï¼Œé˜²æ­¢å™ªå£°è¿‡æ—©"æ·¹æ²¡"ä¿¡å·ã€‚
    - $\bar{\alpha}_t = \frac{f(t)}{f(0)}, \quad f(t) = \cos^2 \left( \frac{t/T + s}{1+s} \cdot \frac{\pi}{2} \right)$
    - è¿™ç§è°ƒåº¦åœ¨ $t$ è¾ƒå°æ—¶å™ªå£°å¢åŠ å¾—å¾ˆæ…¢ï¼Œä¿ç•™äº†æ›´å¤šåŸå§‹ä¿¡å·ï¼Œå¯¹å¾®å°åŠ¨ä½œçš„ç”Ÿæˆæ›´æœ‰åˆ©ã€‚

### 2.3 é€†å‘è¿‡ç¨‹ (Reverse Process / Denoising)
è®­ç»ƒä¸€ä¸ªç¥ç»ç½‘ç»œ $\epsilon_\theta(x_t, t, \text{Obs})$ æ¥é¢„æµ‹å™ªå£°ã€‚
- **è¾“å…¥**: å½“å‰å¸¦å™ªåŠ¨ä½œ $x_t$ï¼Œæ—¶é—´æ­¥ $t$ï¼Œè§‚æµ‹æ¡ä»¶ $\text{Obs}$ (å›¾åƒ/è¯­è¨€)ã€‚
- **è¾“å‡º**: é¢„æµ‹çš„å™ªå£° $\hat{\epsilon}$ã€‚

å»å™ªå…¬å¼ (DDPM):

$$
x_{t-1} = \frac{1}{\sqrt{\alpha_t}} \left( x_t - \frac{1 - \alpha_t}{\sqrt{1 - \bar{\alpha}_t}} \epsilon_\theta(x_t, t, \text{Obs}) \right) + \sigma_t z
$$

å…¶ä¸­ $z \sim \mathcal{N}(0, I)$ æ˜¯éšæœºå™ªå£° (ä½†åœ¨æœ€åä¸€æ­¥ $t=0$ æ—¶è®¾ä¸º 0)ã€‚$\sigma_t$ æ˜¯æ–¹å·®é¡¹ï¼Œé€šå¸¸å– $\sqrt{\beta_t}$ æˆ– $\tilde{\beta}_t$ã€‚

### 2.4 æŸå¤±å‡½æ•° (Loss Function)
éå¸¸ç®€å•ï¼Œå°±æ˜¯é¢„æµ‹å™ªå£°ä¸çœŸå®å™ªå£°çš„ MSEï¼š

$$
\mathcal{L} = \mathbb{E}_{t, x_0, \epsilon} \left[ \| \epsilon - \epsilon_\theta(\sqrt{\bar{\alpha}_t} x_0 + \sqrt{1 - \bar{\alpha}_t} \epsilon, t, \text{Obs}) \|^2 \right]
$$


## 3. ç½‘ç»œæ¶æ„ (Network Architecture)

Diffusion Policy çš„æ ¸å¿ƒæ˜¯é‚£ä¸ªé¢„æµ‹å™ªå£°çš„ç½‘ç»œ $\epsilon_\theta$ã€‚ä¸»è¦æœ‰ä¸¤ç§æµæ´¾ï¼š

### 3.1 CNN-based (1D Temporal CNN / U-Net)
- **åŸç†**: å°†åŠ¨ä½œè½¨è¿¹çœ‹ä½œæ˜¯ä¸€ä¸ª 1D çš„æ—¶é—´åºåˆ— (Sequence Length = $T_p$, Action Dim = $D_a$)ã€‚
- **ç»“æ„**: ä½¿ç”¨ç±»ä¼¼äº U-Net çš„ç»“æ„ï¼Œä½†åœ¨æ—¶é—´ç»´åº¦ä¸Šè¿›è¡Œä¸‹é‡‡æ ·å’Œä¸Šé‡‡æ · (Downsample/Upsample)ã€‚
    - **Conditioning**: å›¾åƒç‰¹å¾ (ResNet/ViT) å’Œ è¯­è¨€ç‰¹å¾ (CLIP) é€šå¸¸é€šè¿‡ **FiLM (Feature-wise Linear Modulation)** å±‚æ³¨å…¥åˆ° U-Net çš„æ¯ä¸ª Residual Block ä¸­ã€‚
    - **Downsample**: Conv1d + GroupNorm + Mish
    - **Upsample**: ConvTranspose1d
    - **Skip Connection**: å°† Encoder çš„ç‰¹å¾æ‹¼æ¥åˆ° Decoderï¼Œä¿ç•™é«˜é¢‘ç»†èŠ‚ã€‚
- **ç‰¹ç‚¹**: è®¡ç®—æ•ˆç‡é«˜ï¼Œé€‚åˆå¤„ç†çŸ­æ—¶åºä¾èµ–ï¼Œæ˜¯ Diffusion Policy è®ºæ–‡ä¸­çš„é»˜è®¤é€‰æ‹©ã€‚

### 3.2 Transformer-based (DiT / Octo)
- **åŸç†**: å°†åŠ¨ä½œè½¨è¿¹åˆ‡æˆ Patchï¼Œæˆ–è€…ç›´æ¥ä½œä¸º Token è¾“å…¥ Transformerã€‚
- **ç»“æ„**: æ ‡å‡†çš„ Transformer Encoder/Decoder (å¦‚ DiT - Diffusion Transformer)ã€‚
- **ç‰¹ç‚¹**: 
    - èƒ½å¤Ÿå¤„ç†æ›´é•¿çš„æ—¶é—´ä¾èµ–ã€‚
    - **å¤šæ¨¡æ€èåˆ**: å¯ä»¥ç›´æ¥ Cross-Attention å›¾åƒ Patch å’Œ è¯­è¨€ Tokenã€‚
    - **Scalability**: å‚æ•°é‡å¯ä»¥åšå¾—å¾ˆå¤§ (e.g., Octo-Base 93M, Octo-Small 27M)ï¼Œé€‚åˆä½œä¸º Foundation Modelã€‚

## 4. æ¨ç†åŠ é€Ÿ (Inference Acceleration)

Diffusion çš„æœ€å¤§ç¼ºç‚¹æ˜¯æ…¢ã€‚DDPM éœ€è¦ 100 æ­¥å»å™ªï¼Œæ¨ç†ä¸€æ¬¡å¯èƒ½è¦å‡ ç™¾æ¯«ç§’ï¼Œæ— æ³•æ»¡è¶³æœºå™¨äºº 50Hz çš„æ§åˆ¶è¦æ±‚ã€‚

### 4.1 DDIM (Denoising Diffusion Implicit Models)
- **åŸç†**: å°†éšæœºæ¸¸èµ°è¿‡ç¨‹å˜ä¸ºç¡®å®šæ€§è¿‡ç¨‹ (Deterministic)ï¼Œè·³è¿‡ä¸­é—´æ­¥éª¤ã€‚DDIM é‡æ–°å®šä¹‰äº†å‰å‘è¿‡ç¨‹ï¼Œä½¿å¾—å®ƒæ˜¯ä¸€ä¸ªéé©¬å°”å¯å¤«è¿‡ç¨‹ï¼Œä»è€Œå…è®¸æ›´å¤§çš„æ­¥é•¿ã€‚
- **å…¬å¼**:

$$
x_{t-1} = \sqrt{\bar{\alpha}_{t-1}} \underbrace{\left( \frac{x_t - \sqrt{1 - \bar{\alpha}_t} \epsilon_\theta}{\sqrt{\bar{\alpha}_t}} \right)}_{\text{predicted } x_0} + \underbrace{\sqrt{1 - \bar{\alpha}_{t-1} - \sigma_t^2} \epsilon_\theta}_{\text{direction pointing to } x_t} + \sigma_t \epsilon_t
$$

- **æ•ˆæœ**: å¯ä»¥å°†æ­¥æ•°ä» 100 æ­¥å‹ç¼©åˆ° **10-15 æ­¥**ï¼ŒåŒæ—¶ä¿æŒè¾ƒé«˜çš„ç”Ÿæˆè´¨é‡ã€‚

### 4.2 Receding Horizon Control (RHC)
- **åŸç†**: æ¨¡å‹ä¸€æ¬¡é¢„æµ‹æœªæ¥ $H$ æ­¥çš„åŠ¨ä½œ (Action Chunk)ï¼Œä½†æœºå™¨äººåªæ‰§è¡Œå‰ $M$ æ­¥ (ä¾‹å¦‚ $M=8$)ï¼Œç„¶åé‡æ–°æ¨ç†ã€‚
- **ä¼˜åŠ¿**: æ©ç›–äº†æ¨ç†å»¶è¿Ÿï¼Œä¿è¯åŠ¨ä½œçš„è¿è´¯æ€§ã€‚

## 5. é¢è¯•å¸¸è§é—®é¢˜ (Q&A)

**Q: Diffusion Policy å’Œ GAN æœ‰ä»€ä¹ˆåŒºåˆ«?**
A: GAN å®¹æ˜“æ¨¡å¼åå¡Œ (Mode Collapse)ï¼Œå³åªå­¦ä¼šä¸€ç§è§£ï¼›Diffusion è®­ç»ƒæ›´ç¨³å®šï¼Œèƒ½è¦†ç›–æ‰€æœ‰æ¨¡æ€ (Mode Coverage)ã€‚

**Q: ä¸ºä»€ä¹ˆ Diffusion æ¨ç†æ…¢? å¦‚ä½•è§£å†³?**
A: å› ä¸ºå®ƒæ˜¯è¿­ä»£å»å™ªã€‚è§£å†³æ–¹æ³•åŒ…æ‹¬ä½¿ç”¨ DDIM å‡å°‘æ­¥æ•°ï¼Œæˆ–è€…ä½¿ç”¨ Consistency Distillation (ä¸€è‡´æ€§è’¸é¦) å°†æ­¥æ•°å‹ç¼©åˆ° 1 æ­¥ã€‚

**Q: ä»€ä¹ˆæ˜¯ Action Chunking?**
A: ä¸€æ¬¡é¢„æµ‹ä¸€æ®µæœªæ¥çš„åŠ¨ä½œåºåˆ—ï¼Œè€Œä¸æ˜¯åªé¢„æµ‹ä¸‹ä¸€æ­¥ã€‚è¿™åˆ©ç”¨äº†åŠ¨ä½œçš„æ—¶é—´ç›¸å…³æ€§ï¼Œæé«˜äº†å¹³æ»‘åº¦ã€‚


---

\newpage

# ç¬¬7ç«  Action Chunking Transformer (ACT)


> **æ ¸å¿ƒè®ºæ–‡**: [Learning Fine-Grained Bimanual Manipulation with Low-Cost Hardware](https://arxiv.org/abs/2304.13705) (Tony Z. Zhao et al., RSS 2023)
> **ä»£è¡¨é¡¹ç›®**: **ALOHA**, **Mobile ALOHA**, **ACT++**

## 0. ä¸»è¦æ•¸å­¸æ€æƒ³ (Main Mathematical Idea)

> **ç¬¬ä¸€æ€§åŸç†**: **Compression of Intent (æ„å›¾çš„å‹ç¼©)**

é«˜ç»´çš„åŠ¨ä½œç©ºé—´ï¼ˆè‚Œè‚‰çº¤ç»´/ç”µæœºæ§åˆ¶ï¼‰å¾€å¾€æ˜¯ç”±ä½ç»´çš„"æ„å›¾"ï¼ˆGrab cupï¼‰é©±åŠ¨çš„ã€‚

- **æ ¸å¿ƒæ•°å­¦å·¥å…·**: **Variational Inference (å˜åˆ†æ¨æ–­ / CVAE)**ã€‚
- **è§£é¢˜é€»è¾‘**:
    1.  **éšå˜é‡å‡è®¾**: å‡è®¾å¤æ‚çš„åŠ¨ä½œåºåˆ— $a$ æ˜¯ç”±ä¸€ä¸ªä¸å¯è§‚æµ‹çš„ä½ç»´å˜é‡ $z$ï¼ˆæ„å›¾/é£æ ¼ï¼‰ç”Ÿæˆçš„ã€‚
    2.  **å¹³è¡¡**: æˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°è¿™ä¸ª $z$ã€‚ELBO (Evidence Lower Bound) æŸå¤±å‡½æ•°åœ¨ä¸¤ä»¶äº‹ä¹‹é—´å¯»æ‰¾å¹³è¡¡ï¼š
        - **é‡å»º (Reconstruction)**: $z$ å¿…é¡»åŒ…å«è¶³å¤Ÿçš„ä¿¡æ¯æ¥è¿˜åŸå‡ºç²¾ç¡®çš„åŠ¨ä½œï¼ˆè¦æŠŠæ´»å¹²å¥½ï¼‰ã€‚
        - **æ­£åˆ™ (Regularization)**: $z$ çš„åˆ†å¸ƒåº”è¯¥å°½å¯èƒ½ç®€å•ï¼ˆå¦‚æ ‡å‡†æ­£æ€åˆ†å¸ƒï¼‰ï¼Œä»¥ä¾¿äºæˆ‘ä»¬åœ¨æ¨ç†æ—¶å¯ä»¥éšæ„é‡‡æ ·ï¼ˆé€šç”¨æ€§/ç”Ÿæˆèƒ½åŠ›ï¼‰ã€‚
    3.  **å¤šæ¨¡æ€**: ä¸åŒçš„ $z$ ä»£è¡¨ä¸åŒçš„æ„å›¾ï¼Œä»è€Œç”Ÿæˆä¸åŒçš„åˆç†åŠ¨ä½œåºåˆ—ï¼Œè§£å†³äº†"å¹³å‡åŒ–"é—®é¢˜ã€‚

## 1. ä¸ºä»€ä¹ˆéœ€è¦ ACT? (Why?)

ä¼ ç»Ÿçš„è¡Œä¸ºå…‹éš† (Behavior Cloning, BC) æ–¹æ³•é€šå¸¸é‡‡ç”¨**å•æ­¥é¢„æµ‹**ï¼šæ¯æ¬¡åªé¢„æµ‹ä¸‹ä¸€æ—¶åˆ»çš„åŠ¨ä½œã€‚è¿™ç§æ–¹å¼å­˜åœ¨ä¸¥é‡çš„**è¯¯å·®ç´¯ç§¯ (Compounding Error)** é—®é¢˜ã€‚

### 1.1 å•æ­¥é¢„æµ‹çš„è‡´å‘½ç¼ºé™·

```
å•æ­¥é¢„æµ‹æµç¨‹:
è§‚æµ‹ o_t â†’ ç­–ç•¥ Ï€(o_t) â†’ åŠ¨ä½œ a_t â†’ æ‰§è¡Œ â†’ è§‚æµ‹ o_{t+1} â†’ ...
```

**é—®é¢˜**:
- **è¯¯å·®ç´¯ç§¯**: æ¯ä¸€æ­¥çš„é¢„æµ‹è¯¯å·®ä¼šä¼ é€’åˆ°ä¸‹ä¸€æ­¥ã€‚å¦‚æœæ¯æ­¥æœ‰ 1% çš„è¯¯å·®ï¼Œ100 æ­¥åè¯¯å·®å¯èƒ½è¾¾åˆ° 100%ã€‚
- **åˆ†å¸ƒåç§» (Distribution Shift)**: è®­ç»ƒæ•°æ®æ¥è‡ªä¸“å®¶è½¨è¿¹ï¼Œä½†æ‰§è¡Œæ—¶çš„çŠ¶æ€åˆ†å¸ƒå¯èƒ½åç¦»ä¸“å®¶ï¼Œå¯¼è‡´"è¶Šé”™è¶Šç¦»è°±"ã€‚
- **é«˜é¢‘é—­ç¯å‹åŠ›**: éœ€è¦æ¯ä¸€å¸§éƒ½ç²¾ç¡®é¢„æµ‹ï¼Œå¯¹æ¨¡å‹è¦æ±‚æé«˜ã€‚

### 1.2 ACT çš„è§£å†³æ€è·¯

ACT æå‡ºäº†ä¸€ä¸ªç®€å•è€Œæœ‰æ•ˆçš„æƒ³æ³•ï¼š**ä¸€æ¬¡é¢„æµ‹ä¸€æ®µæœªæ¥çš„åŠ¨ä½œåºåˆ— (Action Chunk)**ï¼Œè€Œä¸æ˜¯åªé¢„æµ‹ä¸‹ä¸€æ­¥ã€‚


$$
\text{å•æ­¥ BC}: \pi(o_t) \rightarrow a_t
$$



$$
\text{ACT}: \pi(o_t) \rightarrow [a_t, a_{t+1}, ..., a_{t+k-1}]
$$


**æ ¸å¿ƒä¼˜åŠ¿**:
- **å‡å°‘å†³ç­–ç‚¹**: å¦‚æœ chunk å¤§å° $k=100$ï¼Œå†³ç­–é¢‘ç‡ä» 50Hz é™åˆ° 0.5Hzï¼Œå¤§å¤§é™ä½äº†è¯¯å·®ç´¯ç§¯çš„æœºä¼šã€‚
- **éšå¼ä»»åŠ¡åˆ†è§£**: é¢„æµ‹ä¸€æ•´æ®µåŠ¨ä½œï¼Œæ¨¡å‹éœ€è¦"ç†è§£"æ•´ä¸ªå­ä»»åŠ¡çš„ç»“æ„ (å¦‚"ä¼¸æ‰‹â†’æŠ“æ¡â†’æŠ¬èµ·")ï¼Œè€Œä¸åªæ˜¯ç›²ç›®æ¨¡ä»¿ä¸‹ä¸€å¸§ã€‚
- **å¹³æ»‘è½¨è¿¹**: ä¸€æ¬¡ç”Ÿæˆçš„è½¨è¿¹å¤©ç„¶è¿è´¯ï¼Œé¿å…äº†å•æ­¥é¢„æµ‹çš„æŠ–åŠ¨ã€‚

## 2. æ ¸å¿ƒæŠ€æœ¯ (Core Techniques)

### 2.1 åŠ¨ä½œåˆ†å— (Action Chunking)

**å®šä¹‰**: å°†è¿ç»­çš„åŠ¨ä½œåºåˆ—åˆ†æˆå›ºå®šé•¿åº¦ $k$ çš„"å—"ï¼Œæ¨¡å‹ä¸€æ¬¡é¢„æµ‹ä¸€æ•´ä¸ªå—ã€‚

**æ•°å­¦è¡¨ç¤º**:
- è¾“å…¥: å½“å‰è§‚æµ‹ $o_t$ (å›¾åƒ + æœ¬ä½“æ„ŸçŸ¥ + è¯­è¨€æŒ‡ä»¤)
- è¾“å‡º: åŠ¨ä½œåºåˆ— $\mathbf{a} = [a_t, a_{t+1}, ..., a_{t+k-1}] \in \mathbb{R}^{k \times D_a}$
- å…¶ä¸­ $D_a$ æ˜¯åŠ¨ä½œç»´åº¦ (å¦‚ 7-DoF æœºæ¢°è‡‚ + 1 å¤¹çˆª = 8)

**å…¸å‹å‚æ•°**:
- **ALOHA**: $k = 100$ (åœ¨ 50Hz æ§åˆ¶ä¸‹ï¼Œå¯¹åº” 2 ç§’çš„åŠ¨ä½œ)
- **Mobile ALOHA**: $k = 50$ (å¯¹åº” 1 ç§’)

### 2.2 æ—¶é—´é›†æˆ (Temporal Ensemble)

ä»…ç”¨ Action Chunking è¿˜ä¸å¤Ÿã€‚å¦‚æœåœ¨ $t=0$ æ—¶é¢„æµ‹äº† $[a_0, ..., a_{99}]$ï¼Œç„¶ååœ¨ $t=100$ æ—¶å†é¢„æµ‹ $[a_{100}, ..., a_{199}]$ï¼Œä¸¤æ®µè½¨è¿¹çš„äº¤ç•Œå¤„å¯èƒ½ä¸è¿ç»­ã€‚

**è§£å†³æ–¹æ¡ˆ**: **é‡å é¢„æµ‹ + æŒ‡æ•°åŠ æƒå¹³å‡**

```
æ—¶é—´æ­¥ t=0:   é¢„æµ‹ [a_0, a_1, ..., a_99]
æ—¶é—´æ­¥ t=1:   é¢„æµ‹ [a_1', a_2', ..., a_100']
æ—¶é—´æ­¥ t=2:   é¢„æµ‹ [a_2'', a_3'', ..., a_101'']
...

æ‰§è¡Œ a_t æ—¶ï¼Œèåˆæ‰€æœ‰å¯¹ a_t çš„é¢„æµ‹:
a_t^{final} = Î£ w_i * a_t^{(i)}
```

**æŒ‡æ•°åŠ æƒå…¬å¼**:

$$
w_i = \exp(-m \cdot i)
$$


å…¶ä¸­ $m$ æ˜¯è¡°å‡ç³»æ•° (é€šå¸¸ $m=0.01$)ï¼Œ$i$ æ˜¯é¢„æµ‹çš„"å¹´é¾„"(è¶Šæ–°çš„é¢„æµ‹æƒé‡è¶Šå¤§)ã€‚

**æ•ˆæœ**:
- **å¹³æ»‘è¿‡æ¸¡**: æ–°æ—§é¢„æµ‹çš„èåˆæ¶ˆé™¤äº†ä¸è¿ç»­ã€‚
- **é²æ£’æ€§**: å³ä½¿æŸæ¬¡é¢„æµ‹æœ‰è¯¯ï¼Œä¹Ÿä¼šè¢«å…¶ä»–é¢„æµ‹"ç¨€é‡Š"ã€‚

### 2.3 CVAE æ¶æ„ (Conditional Variational Autoencoder)

ACT çš„å¦ä¸€ä¸ªæ ¸å¿ƒåˆ›æ–°æ˜¯ä½¿ç”¨ **CVAE** æ¥å¤„ç†åŠ¨ä½œçš„**å¤šæ¨¡æ€åˆ†å¸ƒ**ã€‚

#### 2.3.1 ä¸ºä»€ä¹ˆéœ€è¦ CVAE?

ä¸ Diffusion Policy ç±»ä¼¼ï¼Œæœºå™¨äººåŠ¨ä½œå­˜åœ¨**å¤šè§£**é—®é¢˜ (å¦‚ç»•éšœç¢ç‰©å¯ä»¥ä»å·¦ç»•æˆ–ä»å³ç»•)ã€‚

- **MSE å›å½’**: ä¼šé¢„æµ‹å·¦å³çš„å¹³å‡å€¼ â†’ æ’å‘éšœç¢ç‰©ã€‚
- **CVAE**: å­¦ä¹ åŠ¨ä½œåˆ†å¸ƒçš„**éšå˜é‡è¡¨ç¤º**ï¼Œé‡‡æ ·ä¸åŒçš„ $z$ å¯ä»¥ç”Ÿæˆä¸åŒçš„åˆç†è½¨è¿¹ã€‚

#### 2.3.2 CVAE æ•°å­¦åŸç†

**è®­ç»ƒæ—¶ (æœ‰çœŸå®åŠ¨ä½œ)**:
1. **ç¼–ç å™¨ (Encoder)** $q_\phi(z | o, a)$: å°†è§‚æµ‹ $o$ å’ŒçœŸå®åŠ¨ä½œåºåˆ— $a$ ç¼–ç ä¸ºéšå˜é‡ $z$ çš„åˆ†å¸ƒ (å‡å€¼ $\mu$, æ–¹å·® $\sigma^2$)ã€‚
2. **è§£ç å™¨ (Decoder)** $p_\theta(a | o, z)$: ä»éšå˜é‡ $z$ å’Œè§‚æµ‹ $o$ é‡å»ºåŠ¨ä½œåºåˆ—ã€‚

**æŸå¤±å‡½æ•°**:

$$
\mathcal{L} = \underbrace{\| a - \hat{a} \|^2}_{\text{é‡å»ºæŸå¤±}} + \beta \cdot \underbrace{D_{KL}(q_\phi(z|o,a) \| \mathcal{N}(0, I))}_{\text{KL æ•£åº¦}}
$$


- **é‡å»ºæŸå¤±**: è®©è§£ç å™¨è¾“å‡ºæ¥è¿‘çœŸå®åŠ¨ä½œã€‚
- **KL æ•£åº¦**: è®©éšå˜é‡åˆ†å¸ƒæ¥è¿‘æ ‡å‡†æ­£æ€åˆ†å¸ƒï¼Œä¾¿äºæ¨ç†æ—¶é‡‡æ ·ã€‚
- **$\beta$**: æƒé‡ç³»æ•° (ACT ä¸­é€šå¸¸ $\beta = 10$)ã€‚

**æ¨ç†æ—¶ (æ— çœŸå®åŠ¨ä½œ)**:
1. ä»æ ‡å‡†æ­£æ€åˆ†å¸ƒé‡‡æ · $z \sim \mathcal{N}(0, I)$ã€‚
2. è§£ç å™¨æ ¹æ® $o$ å’Œ $z$ ç”ŸæˆåŠ¨ä½œåºåˆ—ã€‚

```python
## è®­ç»ƒæ—¶
z_mu, z_logvar = encoder(obs, gt_actions)  # ç¼–ç çœŸå®åŠ¨ä½œ
z = reparameterize(z_mu, z_logvar)         # é‡å‚æ•°åŒ–é‡‡æ ·
pred_actions = decoder(obs, z)             # è§£ç 

recon_loss = mse(pred_actions, gt_actions)
kl_loss = -0.5 * (1 + z_logvar - z_mu**2 - z_logvar.exp()).sum()
loss = recon_loss + beta * kl_loss

## æ¨ç†æ—¶
z = torch.randn(batch_size, z_dim)         # ç›´æ¥ä»æ ‡å‡†æ­£æ€é‡‡æ ·
pred_actions = decoder(obs, z)             # è§£ç 
```

## 3. ç½‘ç»œæ¶æ„ (Network Architecture)

ACT ä½¿ç”¨ **Transformer** ä½œä¸ºéª¨å¹²ç½‘ç»œï¼Œå…·ä½“åŒ…æ‹¬:

### 3.1 è§‚æµ‹ç¼–ç å™¨ (Observation Encoder)

```
è¾“å…¥:
- å›¾åƒ: [B, T, C, H, W] (å¯ä»¥æ˜¯å¤šç›¸æœº)
- æœ¬ä½“æ„ŸçŸ¥: [B, D_p] (å…³èŠ‚è§’åº¦ã€æœ«ç«¯ä½ç½®ç­‰)

å¤„ç†:
- å›¾åƒ â†’ ResNet-18 / ViT â†’ ç‰¹å¾å‘é‡ [B, T, D_v]
- æœ¬ä½“æ„ŸçŸ¥ â†’ Linear â†’ ç‰¹å¾å‘é‡ [B, D_p']
- æ‹¼æ¥ â†’ [B, T+1, D]
```

### 3.2 CVAE ç¼–ç å™¨ (ä»…è®­ç»ƒæ—¶)

```
è¾“å…¥:
- è§‚æµ‹ç‰¹å¾: [B, T+1, D]
- çœŸå®åŠ¨ä½œ: [B, k, D_a] (ç»è¿‡ Linear æ˜ å°„)

ç»“æ„:
- Transformer Encoder (4 å±‚)
- è¾“å‡º: z_mu, z_logvar âˆˆ R^{D_z} (é€šå¸¸ D_z = 32)
```

### 3.3 åŠ¨ä½œè§£ç å™¨ (Action Decoder)

```
è¾“å…¥:
- è§‚æµ‹ç‰¹å¾: [B, T+1, D] (ä½œä¸º Cross-Attention çš„ Key/Value)
- éšå˜é‡ z: [B, D_z] (æ‹¼æ¥åˆ°æ¯ä¸ª Query Token)
- å¯å­¦ä¹ çš„ Action Query: [B, k, D] (k ä¸ªä½ç½®ç¼–ç )

ç»“æ„:
- Transformer Decoder (7 å±‚)
- Cross-Attention: Query å…³æ³¨ è§‚æµ‹ç‰¹å¾
- è¾“å‡º: [B, k, D_a] (k æ­¥åŠ¨ä½œ)
```

### 3.4 å®Œæ•´æ¶æ„å›¾

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚            CVAE Encoder                 â”‚
                    â”‚  (obs_feat, gt_actions) â†’ z_mu, z_var   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚ z (é‡å‚æ•°åŒ–é‡‡æ ·)
                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Images     â”‚â”€â”€â”€â–¶â”‚                                         â”‚
â”‚  (å¤šç›¸æœº)    â”‚    â”‚         Observation Encoder             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚  ResNet-18 / ViT + Positional Emb       â”‚
â”‚  Proprio     â”‚â”€â”€â”€â–¶â”‚                                         â”‚
â”‚  (æœ¬ä½“æ„ŸçŸ¥)  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚ obs_feat [B, T+1, D]
                                       â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚          Action Decoder                 â”‚
                    â”‚  (Action Query + z) Ã— obs_feat          â”‚
                    â”‚      Transformer Decoder                â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â–¼
                              Action Chunk [B, k, D_a]
```

## 4. ä¸å…¶ä»–æ–¹æ³•çš„å¯¹æ¯” (Comparison)

| æ–¹æ³• | é¢„æµ‹æ–¹å¼ | å¤šæ¨¡æ€å¤„ç† | æ¨ç†é€Ÿåº¦ | é€‚ç”¨åœºæ™¯ |
| :--- | :--- | :--- | :--- | :--- |
| **å•æ­¥ BC** | å•å¸§ | æ—  (MSE) | æœ€å¿« | ç®€å•ä»»åŠ¡ |
| **ACT (CVAE)** | Chunk ($k$ æ­¥) | CVAE é‡‡æ · | **å¿«** | é«˜é¢‘ã€ç²¾ç»†æ“ä½œ |
| **Diffusion Policy** | Chunk ($k$ æ­¥) | æ‰©æ•£é‡‡æ · | æ…¢ (å¤šæ­¥å»å™ª) | å¤šæ¨¡æ€å¤æ‚ä»»åŠ¡ |
| **Flow Matching (Ï€0)** | Chunk ($k$ æ­¥) | ODE é‡‡æ · | ä¸­ç­‰ | é€šç”¨åŸºç¡€æ¨¡å‹ |

**ACT çš„ä¼˜åŠ¿**:
- **æ¨ç†é€Ÿåº¦å¿«**: CVAE åªéœ€ä¸€æ¬¡å‰å‘ä¼ æ’­ï¼ŒDiffusion éœ€è¦ 10-100 æ­¥å»å™ªã€‚
- **ç®€å•æ˜“å®ç°**: æ ‡å‡† Transformer + VAEï¼Œæ— éœ€å¤æ‚çš„å™ªå£°è°ƒåº¦å™¨ã€‚
- **æ•°æ®æ•ˆç‡é«˜**: åœ¨ ALOHA é¡¹ç›®ä¸­ï¼Œä»… 50 æ¡æ¼”ç¤ºå°±èƒ½å­¦ä¼šåŒè‡‚ç²¾ç»†æ“ä½œã€‚

**ACT çš„åŠ£åŠ¿**:
- **åˆ†å¸ƒè¦†ç›–æœ‰é™**: CVAE çš„éšç©ºé—´å®¹é‡æœ‰é™ï¼Œå¯èƒ½æ— æ³•è¦†ç›–æ‰€æœ‰åŠ¨ä½œæ¨¡æ€ã€‚
- **KL åå¡Œé£é™©**: å¦‚æœ $\beta$ è®¾ç½®ä¸å½“ï¼Œæ¨¡å‹å¯èƒ½å¿½ç•¥éšå˜é‡ $z$ã€‚

## 5. å®æˆ˜ä»£ç ç¤ºä¾‹ (Code Example)

```python
import torch
import torch.nn as nn
from torch.nn import TransformerEncoder, TransformerDecoder

class ACTPolicy(nn.Module):
    def __init__(
        self,
        obs_dim: int,
        action_dim: int,
        chunk_size: int = 100,
        z_dim: int = 32,
        hidden_dim: int = 512,
        num_encoder_layers: int = 4,
        num_decoder_layers: int = 7,
    ):
        super().__init__()
        self.chunk_size = chunk_size
        self.z_dim = z_dim
        
        # Observation Encoder
        self.obs_encoder = nn.Linear(obs_dim, hidden_dim)
        
        # CVAE Encoder (ç”¨äºè®­ç»ƒ)
        self.cvae_encoder = TransformerEncoder(
            nn.TransformerEncoderLayer(d_model=hidden_dim, nhead=8),
            num_layers=num_encoder_layers
        )
        self.z_mu = nn.Linear(hidden_dim, z_dim)
        self.z_logvar = nn.Linear(hidden_dim, z_dim)
        
        # Action Decoder
        self.action_queries = nn.Parameter(torch.randn(chunk_size, hidden_dim))
        self.z_proj = nn.Linear(z_dim, hidden_dim)
        self.action_decoder = TransformerDecoder(
            nn.TransformerDecoderLayer(d_model=hidden_dim, nhead=8),
            num_layers=num_decoder_layers
        )
        self.action_head = nn.Linear(hidden_dim, action_dim)
        
        # Action embedding for CVAE encoder
        self.action_embed = nn.Linear(action_dim, hidden_dim)
    
    def encode(self, obs_feat, actions):
        """CVAE ç¼–ç å™¨: ç¼–ç è§‚æµ‹å’ŒåŠ¨ä½œåˆ°éšç©ºé—´"""
        # actions: [B, k, action_dim]
        action_feat = self.action_embed(actions)  # [B, k, hidden_dim]
        
        # æ‹¼æ¥è§‚æµ‹å’ŒåŠ¨ä½œ
        combined = torch.cat([obs_feat, action_feat], dim=1)  # [B, T+1+k, D]
        combined = combined.permute(1, 0, 2)  # [T+1+k, B, D]
        
        encoded = self.cvae_encoder(combined)
        pooled = encoded.mean(dim=0)  # [B, D]
        
        return self.z_mu(pooled), self.z_logvar(pooled)
    
    def reparameterize(self, mu, logvar):
        """é‡å‚æ•°åŒ–æŠ€å·§"""
        std = torch.exp(0.5 * logvar)
        eps = torch.randn_like(std)
        return mu + eps * std
    
    def decode(self, obs_feat, z):
        """åŠ¨ä½œè§£ç å™¨: ä»è§‚æµ‹å’Œéšå˜é‡ç”ŸæˆåŠ¨ä½œåºåˆ—"""
        batch_size = obs_feat.shape[0]
        
        # Action queries + z
        queries = self.action_queries.unsqueeze(0).expand(batch_size, -1, -1)
        z_expanded = self.z_proj(z).unsqueeze(1)  # [B, 1, D]
        queries = queries + z_expanded  # å¹¿æ’­åŠ æ³•
        
        queries = queries.permute(1, 0, 2)  # [k, B, D]
        obs_feat = obs_feat.permute(1, 0, 2)  # [T+1, B, D]
        
        decoded = self.action_decoder(queries, obs_feat)
        decoded = decoded.permute(1, 0, 2)  # [B, k, D]
        
        return self.action_head(decoded)
    
    def forward(self, obs, actions=None):
        """
        è®­ç»ƒæ—¶: obs + actions â†’ z â†’ pred_actions
        æ¨ç†æ—¶: obs â†’ sample z â†’ pred_actions
        """
        obs_feat = self.obs_encoder(obs).unsqueeze(1)  # [B, 1, D]
        
        if actions is not None:  # è®­ç»ƒæ¨¡å¼
            z_mu, z_logvar = self.encode(obs_feat, actions)
            z = self.reparameterize(z_mu, z_logvar)
            pred_actions = self.decode(obs_feat, z)
            return pred_actions, z_mu, z_logvar
        else:  # æ¨ç†æ¨¡å¼
            z = torch.randn(obs.shape[0], self.z_dim, device=obs.device)
            pred_actions = self.decode(obs_feat, z)
            return pred_actions


def compute_loss(pred_actions, gt_actions, z_mu, z_logvar, beta=10.0):
    """ACT æŸå¤±å‡½æ•°: é‡å»ºæŸå¤± + Î² * KL æ•£åº¦"""
    recon_loss = nn.functional.mse_loss(pred_actions, gt_actions)
    kl_loss = -0.5 * torch.mean(1 + z_logvar - z_mu.pow(2) - z_logvar.exp())
    return recon_loss + beta * kl_loss, recon_loss, kl_loss
```

## 6. æ—¶é—´é›†æˆçš„å®ç° (Temporal Ensemble)

```python
class TemporalEnsemble:
    def __init__(self, chunk_size, action_dim, decay=0.01):
        self.chunk_size = chunk_size
        self.decay = decay
        self.action_buffer = []  # å­˜å‚¨å†å²é¢„æµ‹
        self.weights = []        # å­˜å‚¨å¯¹åº”æƒé‡
    
    def update(self, new_chunk):
        """æ·»åŠ æ–°é¢„æµ‹çš„ chunk"""
        # new_chunk: [k, action_dim]
        self.action_buffer.append(new_chunk)
        self.weights.append(1.0)
        
        # è¡°å‡æ—§æƒé‡
        self.weights = [w * (1 - self.decay) for w in self.weights]
        
        # ç§»é™¤è¿‡æœŸçš„é¢„æµ‹
        while len(self.action_buffer) > self.chunk_size:
            self.action_buffer.pop(0)
            self.weights.pop(0)
    
    def get_action(self, t):
        """è·å–æ—¶åˆ» t çš„é›†æˆåŠ¨ä½œ"""
        weighted_sum = 0
        total_weight = 0
        
        for i, (chunk, w) in enumerate(zip(self.action_buffer, self.weights)):
            # è®¡ç®—è¯¥ chunk å¯¹æ—¶åˆ» t çš„é¢„æµ‹
            chunk_start_time = t - len(self.action_buffer) + i + 1
            local_idx = t - chunk_start_time
            
            if 0 <= local_idx < len(chunk):
                weighted_sum += w * chunk[local_idx]
                total_weight += w
        
        return weighted_sum / total_weight if total_weight > 0 else None
```

## 7. é¢è¯•å¸¸è§é—®é¢˜ (Q&A)

**Q1: ACT å’Œ Diffusion Policy çš„æ ¸å¿ƒåŒºåˆ«æ˜¯ä»€ä¹ˆ?**

A: 
- **ç”Ÿæˆæœºåˆ¶**: ACT ä½¿ç”¨ **CVAE** (ä¸€æ¬¡å‰å‘ä¼ æ’­)ï¼ŒDiffusion ä½¿ç”¨**è¿­ä»£å»å™ª** (10-100 æ­¥)ã€‚
- **é€Ÿåº¦**: ACT æ¨ç†æ›´å¿«ï¼Œé€‚åˆé«˜é¢‘æ§åˆ¶ (50Hz)ï¼›Diffusion æ…¢ä½†åˆ†å¸ƒè¦†ç›–æ›´å…¨ã€‚
- **å®ç°å¤æ‚åº¦**: ACT æ›´ç®€å• (æ ‡å‡† VAE)ï¼›Diffusion éœ€è¦å™ªå£°è°ƒåº¦å™¨ã€‚

**Q2: ä¸ºä»€ä¹ˆ Action Chunking èƒ½å‡å°‘è¯¯å·®ç´¯ç§¯?**

A:
- å‡å°‘äº†**å†³ç­–ç‚¹æ•°é‡**ï¼šchunk=100 æ—¶ï¼ŒåŸæœ¬ 100 æ¬¡å†³ç­–å˜ä¸º 1 æ¬¡ã€‚
- æ¨¡å‹éœ€è¦**è§„åˆ’æ•´ä¸ªå­ä»»åŠ¡**ï¼Œè€Œéç›²ç›®æ¨¡ä»¿ï¼Œéšå¼å­¦åˆ°äº†ä»»åŠ¡ç»“æ„ã€‚
- é…åˆ**æ—¶é—´é›†æˆ**ï¼Œå•æ¬¡é¢„æµ‹è¯¯å·®è¢«å¤šæ¬¡é¢„æµ‹å¹³å‡æ‰ã€‚

**Q3: CVAE ä¸­çš„ Î² å‚æ•°å¦‚ä½•è°ƒæ•´?**

A:
- **Î² è¿‡å¤§**: KL æ•£åº¦è¢«è¿‡åº¦æƒ©ç½šï¼Œéšå˜é‡ $z$ è¶‹è¿‘äºæ ‡å‡†æ­£æ€ï¼Œæ¨¡å‹é€€åŒ–ä¸ºç¡®å®šæ€§è¾“å‡º (**KL åå¡Œ**)ã€‚
- **Î² è¿‡å°**: éšç©ºé—´ä¸è§„æ•´ï¼Œæ¨ç†æ—¶é‡‡æ ·çš„ $z$ å¯èƒ½è½åœ¨"ç©ºç™½åŒº"ï¼Œç”Ÿæˆä¸åˆç†çš„åŠ¨ä½œã€‚
- **ç»éªŒå€¼**: ALOHA é¡¹ç›®ä¸­ $\beta = 10$ æ•ˆæœæœ€ä½³ï¼›å¯ä»¥ä½¿ç”¨ **Î²-VAE é€€ç«** (ä»å°åˆ°å¤§é€æ¸å¢åŠ )ã€‚

**Q4: æ—¶é—´é›†æˆ (Temporal Ensemble) çš„ä½œç”¨æ˜¯ä»€ä¹ˆ?**

A:
- **å¹³æ»‘è½¨è¿¹**: æ¶ˆé™¤ç›¸é‚» chunk ä¹‹é—´çš„ä¸è¿ç»­ã€‚
- **æé«˜é²æ£’æ€§**: å•æ¬¡é¢„æµ‹çš„é”™è¯¯è¢«å†å²é¢„æµ‹"ç¨€é‡Š"ã€‚
- **æƒè¡¡å»¶è¿Ÿ vs å¹³æ»‘**: è¡°å‡ç³»æ•° $m$ è¶Šå¤§ï¼Œå“åº”è¶Šå¿«ä½†è¶Šä¸å¹³æ»‘ã€‚

**Q5: ACT ä¸ºä»€ä¹ˆåœ¨ ALOHA é¡¹ç›®ä¸­è¡¨ç°å‡ºè‰²?**

A:
- **é«˜é¢‘åŒè‡‚åè°ƒ**: åŒè‡‚æ“ä½œéœ€è¦ 50Hz ç²¾ç»†æ§åˆ¶ï¼ŒACT çš„å¿«é€Ÿæ¨ç†è‡³å…³é‡è¦ã€‚
- **æ•°æ®æ•ˆç‡**: CVAE çš„éšç©ºé—´æä¾›äº†è‰¯å¥½çš„å½’çº³åç½®ï¼Œ50 æ¡æ¼”ç¤ºå³å¯æ³›åŒ–ã€‚
- **ç¡¬ä»¶å‹å¥½**: ç®€å•æ¶æ„æ˜“äºéƒ¨ç½²åˆ°è¾¹ç¼˜è®¾å¤‡ã€‚

## 8. å‚è€ƒèµ„æº (References)

- **è®ºæ–‡**: [Learning Fine-Grained Bimanual Manipulation with Low-Cost Hardware](https://arxiv.org/abs/2304.13705)
- **GitHub**: [ALOHA](https://github.com/tonyzhaozh/aloha)
- **é¡¹ç›®ä¸»é¡µ**: [Mobile ALOHA](https://mobile-aloha.github.io/)
- **è§†é¢‘æ•™ç¨‹**: [ACT è®ºæ–‡ç²¾è¯»](https://www.bilibili.com/video/BV1xxx) (B ç«™)

---


\newpage

# ç¬¬8ç«  Flow Matching


> **æ³¨æ„**: Pi0 å·²äº 2025 å¹´ 2 æœˆå¼€æº (OpenPI / LeRobot)ã€‚ä»¥ä¸‹ä»£ç åŸºäº Flow Matching åŸç†å’Œ VLA æ¶æ„é€šè¯†è¿›è¡Œçš„ **æ ¸å¿ƒé€»è¾‘è§£æ„**ï¼Œæ–¹ä¾¿ç†è§£å…¶æ•°å­¦è¿‡ç¨‹ã€‚

## 0. ä¸»è¦æ•¸å­¸æ€æƒ³ (Main Mathematical Idea)

> **ç¬¬ä¸€æ€§åŸç†**: **The Shortest Path (æœ€çŸ­è·¯å¾„ / Optimal Transport)**

Diffusion å°±åƒä¸€ä¸ªé†‰æ±‰ï¼ˆéšæœºæ¸¸èµ°ï¼‰è·Œè·Œæ’æ’åœ°ä»å™ªå£°èµ°å›æ•°æ®ï¼Œè·¯å¾„æ›²æŠ˜ä¸”ä½æ•ˆã€‚Flow Matching è¯•å›¾æ„å»ºä¸€æ¡**ç›´è¾¾**çš„è·¯å¾„ã€‚

- **æ ¸å¿ƒæ•°å­¦å·¥å…·**: **ODE (å¸¸å¾®åˆ†æ–¹ç¨‹)** ä¸ **Optimal Transport (æœ€ä¼˜ä¼ è¾“)**ã€‚
- **è§£é¢˜é€»è¾‘**:
    1.  **æ‹‰ç›´**: åœ¨æ¦‚ç‡åˆ†å¸ƒç©ºé—´ä¸­ï¼Œä¸¤ç‚¹ä¹‹é—´ï¼ˆå™ªå£°åˆ†å¸ƒ vs æ•°æ®åˆ†å¸ƒï¼‰æœ€çŸ­çš„è·¯å¾„æ˜¯ç›´çº¿ï¼ˆGeodesicï¼‰ã€‚
    2.  **å‘é‡åœº**: å¦‚æœæˆ‘ä»¬èƒ½ç›´æ¥å­¦ä¹ åˆ°è¿™æ¡ç›´çº¿ä¸Šçš„"é€Ÿåº¦å‘é‡"ï¼ˆVector Fieldï¼‰ï¼Œé‚£ä¹ˆæ¨ç†æ—¶åªéœ€è¦æ²¿ç€é€Ÿåº¦æ–¹å‘èµ°å‡ æ­¥ï¼ˆEulerç§¯åˆ†ï¼‰å°±èƒ½åˆ°è¾¾ç»ˆç‚¹ã€‚
    3.  **ç¡®å®šæ€§**: ä»éšæœºçš„å¸ƒæœ—è¿åŠ¨ï¼ˆDiffusionï¼‰è½¬å˜ä¸ºç¡®å®šæ€§çš„æµä½“è¿åŠ¨ï¼ˆFlowï¼‰ï¼Œæå¤§åœ°å‡å°‘äº†æ¨ç†æ­¥æ•°ï¼ˆ100æ­¥ -> 10æ­¥ï¼‰ã€‚

## 1. æ ¸å¿ƒæ€æƒ³ï¼šä»å™ªå£°æµå‘åŠ¨ä½œ (The Math behind Flow)

### 1.1 ä»€ä¹ˆæ˜¯ Flow Matching?
ä¸åŒäº Diffusion Model å­¦ä¹ å»å™ªè¿‡ç¨‹ (Denoising Score Matching)ï¼ŒFlow Matching ç›´æ¥å­¦ä¹ ä¸€ä¸ª **ç¡®å®šæ€§çš„å¸¸å¾®åˆ†æ–¹ç¨‹ (ODE)**ï¼Œå®šä¹‰äº†æ¦‚ç‡å¯†åº¦è·¯å¾„ $p_t(x)$ å¦‚ä½•éšæ—¶é—´ $t$ æ¼”å˜ã€‚

æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª **å‘é‡åœº (Vector Field)** $v_t(x)$ï¼Œå®ƒæè¿°äº†æ ·æœ¬åœ¨æ—¶é—´ $t$ çš„ç§»åŠ¨é€Ÿåº¦å’Œæ–¹å‘ã€‚


$$
\frac{dx}{dt} = v_t(x)
$$


- $x_0$: çœŸå®æ•°æ®åˆ†å¸ƒ (Real Data, e.g., æœºå™¨äººçš„æ­£ç¡®åŠ¨ä½œ)ã€‚
- $x_1$: æ ‡å‡†é«˜æ–¯å™ªå£°åˆ†å¸ƒ (Noise, $\mathcal{N}(0, I)$)ã€‚
- **ç›®æ ‡**: æ‰¾åˆ°ä¸€ä¸ªå‘é‡åœº $v_t$ï¼Œä½¿å¾—å½“æˆ‘ä»¬ä»å™ªå£° $x_1$ å‡ºå‘ï¼Œæ²¿ç€è¿™ä¸ªåœºé€†æµè€Œä¸Š (æˆ–é¡ºæµè€Œä¸‹ï¼Œå–å†³äºå®šä¹‰) ç§¯åˆ†åˆ° $t=0$ æ—¶ï¼Œèƒ½å¤Ÿç²¾ç¡®åœ°å˜å› $x_0$ã€‚

### 1.2 ä¸ºä»€ä¹ˆæ¯” Diffusion å¥½?
- **Diffusion**: è½¨è¿¹æ˜¯éšæœºçš„ (Stochastic)ï¼Œåƒå¸ƒæœ—è¿åŠ¨ä¸€æ ·è·Œè·Œæ’æ’åœ°å»å™ªã€‚æ¨ç†æ­¥æ•°å¤š (50-100æ­¥)ã€‚
- **Flow Matching**: æˆ‘ä»¬å¯ä»¥å¼ºåˆ¶æ¨¡å‹å­¦ä¹ ä¸€æ¡ **"ç›´çš„" (Straight)** è½¨è¿¹ã€‚
    - **Optimal Transport (æœ€ä¼˜ä¼ è¾“)**: ç‚¹å¯¹ç‚¹ä¹‹é—´ç›´çº¿æœ€çŸ­ã€‚Flow Matching å¯ä»¥å­¦ä¹ è¿™ç§ç›´çº¿è·¯å¾„ï¼Œä½¿å¾—æ¨ç†æå…¶é«˜æ•ˆ (10æ­¥ä»¥å†…)ã€‚
    - **ç¡®å®šæ€§ä¸ç¨³å®šæ€§**: ç›¸æ¯”äºéšæœºé‡‡æ ·ï¼ŒODE çš„ç¡®å®šæ€§ä½¿å¾—åŠ¨ä½œç”Ÿæˆæ›´åŠ å¹³æ»‘ï¼Œå‡å°‘äº†é«˜é¢‘æŠ–åŠ¨ (Jitter)ï¼Œè¿™å¯¹æœºæ¢°è‡‚æ§åˆ¶è‡³å…³é‡è¦ã€‚

![Flow Matching vs Diffusion](../assets/flow_matching_vs_diffusion.png)
*å›¾ç¤º: Diffusion çš„éšæœºè½¨è¿¹ (å·¦) vs Flow Matching çš„ç›´çº¿è½¨è¿¹ (å³)*

## 2. æ ¸å¿ƒå…¬å¼è¯¦è§£ (Key Formulas)

### 2.1 çº¿æ€§æ’å€¼è·¯å¾„ (Conditional Flow)
ä¸ºäº†è®­ç»ƒæ¨¡å‹ï¼Œæˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ª"æ­£ç¡®ç­”æ¡ˆ"ã€‚å‡è®¾æˆ‘ä»¬å·²çŸ¥ä¸€ä¸ªçœŸå®æ ·æœ¬ $x_0$ å’Œä¸€ä¸ªé‡‡æ ·å™ªå£° $x_1$ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€æ¡è¿æ¥å®ƒä»¬çš„ç›´çº¿è·¯å¾„ï¼š


$$
x_t = (1 - t)x_0 + t x_1, \quad t \in [0, 1]
$$


- å½“ $t=0$ æ—¶ï¼Œ $x_t = x_0$ (æ•°æ®)ã€‚
- å½“ $t=1$ æ—¶ï¼Œ $x_t = x_1$ (å™ªå£°)ã€‚

### 2.2 ç›®æ ‡é€Ÿåº¦ (Target Velocity)
å¯¹ä¸Šé¢çš„è·¯å¾„ $x_t$ å¯¹æ—¶é—´ $t$ æ±‚å¯¼ï¼Œå¾—åˆ°è¯¥è·¯å¾„ä¸Šçš„ç†æƒ³é€Ÿåº¦ $u_t(x|x_1)$ï¼š


$$
\frac{d}{dt} x_t = \frac{d}{dt} \left( (1 - t)x_0 + t x_1 \right) = x_1 - x_0
$$


- **ç‰©ç†å«ä¹‰**: ç›®æ ‡é€Ÿåº¦æ˜¯ä¸€ä¸ªæ’å®šå‘é‡ï¼Œæ–¹å‘ä» $x_0$ æŒ‡å‘ $x_1$ã€‚è¿™éå¸¸ç›´è§‚ï¼šè¦ä»æ•°æ®å˜åˆ°å™ªå£°ï¼Œå°±ä¸€ç›´å¾€å™ªå£°æ–¹å‘èµ°ï¼›åä¹‹äº¦ç„¶ã€‚

### 2.3 æŸå¤±å‡½æ•° (Loss Function)
æˆ‘ä»¬è®­ç»ƒä¸€ä¸ªç¥ç»ç½‘ç»œ $v_\theta(x_t, t, \text{cond})$ æ¥æ‹Ÿåˆè¿™ä¸ªç›®æ ‡é€Ÿåº¦ã€‚è¿™å°±æ˜¯ **Conditional Flow Matching (CFM)** lossï¼š


$$
\mathcal{L}(\theta) = \mathbb{E}_{t, x_0, x_1} \left[ \Vert v_\theta(x_t, t, \text{cond}) - (x_1 - x_0) \Vert^2 \right]
$$


- **è¾“å…¥**:
    - $x_t$: å½“å‰æ—¶åˆ»çš„æ’å€¼çŠ¶æ€ (æ··åˆäº†æ•°æ®å’Œå™ªå£°)ã€‚
    - $t$: å½“å‰æ—¶é—´æ­¥ã€‚
    - $\text{cond}$: å›¾åƒ/è¯­è¨€ç‰¹å¾ (VLM embedding)ã€‚
- **æ ‡ç­¾ (Target)**: $x_1 - x_0$ (å¸¸æ•°å‘é‡)ã€‚
- **ç›´è§‚è§£é‡Š**: æ— è®ºä½ åœ¨è·¯å¾„çš„å“ªä¸ªä½ç½®ï¼Œç½‘ç»œéƒ½åº”è¯¥å‘Šè¯‰ä½ ï¼š"å¾€é‚£ä¸ªæ–¹å‘èµ°ï¼Œå°±èƒ½åˆ°è¾¾ç»ˆç‚¹"ã€‚

## 3. æ¨¡å‹æ¶æ„ (Pseudo-Code)

### 2.1 VLM Backbone (Conditioning)
ä½¿ç”¨ PaliGemma æˆ–ç±»ä¼¼ VLM æå–å¤šæ¨¡æ€ç‰¹å¾ã€‚

```python
class Pi0VLMBackbone(nn.Module):
    def __init__(self, base_vlm):
        super().__init__()
        self.vlm = base_vlm # e.g., PaliGemma-3B
        
    def forward(self, images, text):
        # 1. æå–å›¾åƒå’Œæ–‡æœ¬ç‰¹å¾
        # output: [batch, seq_len, hidden_dim]
        features = self.vlm.extract_features(images, text)
        
        # 2. Pooling æˆ–æå–ç‰¹å®š Token ä½œä¸º Condition
        # å‡è®¾æˆ‘ä»¬å–æœ€åä¸€ä¸ª Token çš„ embedding ä½œä¸ºå…¨å±€ä¸Šä¸‹æ–‡
        global_cond = features[:, -1, :] 
        return global_cond
```

### 2.2 Flow Matching Policy Head
è¿™æ˜¯ä¸€ä¸ª MLP æˆ– Transformerï¼Œé¢„æµ‹â€œé€Ÿåº¦åœºâ€ã€‚

```python
class FlowMatchingPolicy(nn.Module):
    def __init__(self, action_dim, cond_dim, hidden_dim=1024):
        super().__init__()
        # Time Embedding: å°†æ ‡é‡ t æ˜ å°„ä¸ºé«˜ç»´å‘é‡ï¼Œæ•æ‰ç»†ç²’åº¦çš„æ—¶é—´ä¿¡æ¯
        self.time_mlp = nn.Sequential(
            SinusoidalPositionEmbeddings(dim=256),
            nn.Linear(256, 256),
            nn.SiLU()
        )
        
        # è¾“å…¥: å™ªå£°åŠ¨ä½œ(action_dim) + æ—¶é—´embedding(256) + æ¡ä»¶(cond_dim)
        self.net = nn.Sequential(
            nn.Linear(action_dim + 256 + cond_dim, hidden_dim),
            nn.SiLU(), # Swish/SiLU é€šå¸¸æ¯” ReLU æ•ˆæœæ›´å¥½
            nn.Linear(hidden_dim, hidden_dim),
            nn.SiLU(),
            nn.Linear(hidden_dim, hidden_dim),
            nn.SiLU(),
            nn.Linear(hidden_dim, action_dim) # è¾“å‡º dx/dt
        )

    def forward(self, x_t, t, condition):
        # 1. å¤„ç†æ—¶é—´ t
        # t: [batch_size, 1] -> t_emb: [batch_size, 256]
        t_emb = self.time_mlp(t)
        
        # 2. æ‹¼æ¥è¾“å…¥
        # ç®€å•çš„ Concat ç­–ç•¥ï¼Œæ›´é«˜çº§çš„å¯ä»¥ç”¨ AdaLN (Adaptive Layer Norm) æ³¨å…¥æ¡ä»¶
        input_feat = torch.cat([x_t, t_emb, condition], dim=-1)
        
        # 3. é¢„æµ‹å‘é‡åœº (Velocity)
        velocity = self.net(input_feat)
        return velocity
```

## 3. æ¨ç†è¿‡ç¨‹ (Inference / Sampling)
ä½¿ç”¨ ODE Solver (å¦‚ Euler æ–¹æ³•) ä»å™ªå£°ç”ŸæˆåŠ¨ä½œã€‚

```python
@torch.no_grad()
def generate_action(policy, vlm_cond, action_dim, steps=10, cfg_scale=1.0):
    """
    ä»é«˜æ–¯å™ªå£°ç”ŸæˆåŠ¨ä½œï¼Œæ”¯æŒ Classifier-Free Guidance (CFG)
    """
    batch_size = vlm_cond.shape[0]
    
    # 1. é‡‡æ ·åˆå§‹å™ªå£° x_1 ~ N(0, I)
    x_t = torch.randn(batch_size, action_dim, device=device)
    
    # 2. å®šä¹‰æ—¶é—´æ­¥ (ä» 1 åˆ° 0)
    dt = -1.0 / steps 
    times = torch.linspace(1.0, 0.0, steps + 1, device=device)
    
    # 3. ODE Solver å¾ªç¯ (Euler Method)
    for i in range(steps):
        t_curr = times[i]
        
        # é¢„æµ‹å½“å‰ä½ç½®çš„é€Ÿåº¦å‘é‡ v_t
        # CFG: åŒæ—¶è®¡ç®—æœ‰æ¡ä»¶å’Œæ— æ¡ä»¶çš„é€Ÿåº¦
        if cfg_scale > 1.0:
            # æ„é€ æ— æ¡ä»¶è¾“å…¥ (ç©ºæŒ‡ä»¤/ç©ºå›¾åƒ)
            null_cond = torch.zeros_like(vlm_cond) 
            # æ‰¹é‡é¢„æµ‹
            input_cond = torch.cat([vlm_cond, null_cond])
            input_x = torch.cat([x_t, x_t])
            input_t = torch.cat([t_curr, t_curr])
            
            v_cond, v_uncond = policy(input_x, input_t, input_cond).chunk(2)
            
            # ç»„åˆé€Ÿåº¦å‘é‡
            velocity = v_uncond + cfg_scale * (v_cond - v_uncond)
        else:
            velocity = policy(x_t, t_curr, vlm_cond)
        
        # æ›´æ–°ä½ç½®: x_{t+dt} = x_t + v_t * dt
        x_t = x_t + velocity * dt
        
    return x_t
```

## 4. è®­ç»ƒè¿‡ç¨‹ (Training)
Flow Matching çš„ Loss éå¸¸ç›´è§‚ï¼š**å›å½’ç›®æ ‡é€Ÿåº¦**ã€‚
ç›®æ ‡é€Ÿåº¦å°±æ˜¯ä»å™ªå£° $x_1$ æŒ‡å‘çœŸå®æ•°æ® $x_0$ çš„æ–¹å‘ã€‚

```python
def compute_loss(policy, vlm_cond, real_action):
    batch_size = real_action.shape[0]
    
    # 1. é‡‡æ ·æ—¶é—´ t ~ U[0, 1]
    t = torch.rand(batch_size, 1, device=device)
    
    # 2. é‡‡æ ·å™ªå£° x_1 ~ N(0, I)
    noise = torch.randn_like(real_action)
    
    # 3. æ„å»ºä¸­é—´çŠ¶æ€ x_t (Linear Interpolation / Optimal Transport Path)
    # x_t = (1 - t) * x_0 + t * x_1
    # æ³¨æ„: è¿™é‡Œå®šä¹‰ t=0 æ˜¯æ•°æ®, t=1 æ˜¯å™ªå£°
    x_t = (1 - t) * real_action + t * noise
    
    # 4. è®¡ç®—ç›®æ ‡é€Ÿåº¦ (Target Velocity)
    # ä¹Ÿå°±æ˜¯ x_1 - x_0 (æŒ‡å‘å™ªå£°çš„æ–¹å‘? æˆ–è€…åè¿‡æ¥ï¼Œå–å†³äºå®šä¹‰)
    # åœ¨ Conditional Flow Matching (CFM) ä¸­ï¼Œé€šå¸¸ v_target = x_1 - x_0
    target_velocity = noise - real_action 
    
    # 5. æ¨¡å‹é¢„æµ‹é€Ÿåº¦
    pred_velocity = policy(x_t, t, vlm_cond)
    
    # 6. MSE Loss
    loss = F.mse_loss(pred_velocity, target_velocity)
    return loss
```

## 6. ä¸ºä»€ä¹ˆ Pi0 é€‰æ‹© Flow Matching? (Deep Dive)

### 6.1 è¿ç»­æ€§ vs ç¦»æ•£æ€§ (Continuous vs Discrete)
- **RT-1/RT-2 (Discrete)**: å°†åŠ¨ä½œç©ºé—´åˆ‡åˆ†ä¸º 256 ä¸ªæ ¼å­ã€‚
    - *é—®é¢˜*: ä¸¢å¤±ç²¾åº¦ã€‚å¯¹äºçµå·§æ‰‹è¿™ç§éœ€è¦å¾®ç±³çº§æ§åˆ¶çš„ä»»åŠ¡ï¼Œç¦»æ•£åŒ–ä¼šå¯¼è‡´åŠ¨ä½œ"ä¸€å¡ä¸€å¡çš„" (Jitter)ã€‚
- **Pi0 (Continuous)**: ç›´æ¥è¾“å‡ºæµ®ç‚¹æ•°é€Ÿåº¦å‘é‡ã€‚
    - *ä¼˜åŠ¿*: ç†è®ºä¸Šç²¾åº¦æ— é™ï¼ŒåŠ¨ä½œå¹³æ»‘ï¼Œæ›´ç¬¦åˆç‰©ç†ä¸–ç•Œçš„æœ¬è´¨ã€‚

### 6.2 é«˜é¢‘æ§åˆ¶çš„æ•°å­¦åŸºç¡€
- æœºå™¨äººæ§åˆ¶å›è·¯é€šå¸¸æ˜¯ 500Hzã€‚å¦‚æœæ¨¡å‹æ¨ç†éœ€è¦ 100ms (10Hz)ï¼Œä¸­é—´ 490ms éƒ½åœ¨"ç›²è·‘"ã€‚
- Flow Matching çš„ **ODE æ±‚è§£å™¨** ç‰¹æ€§å…è®¸æˆ‘ä»¬åœ¨æ¨ç†æ—¶è¿›è¡Œ **æ—¶é—´æ­¥ç¼©æ”¾ (Time-step Scaling)**ã€‚
    - æˆ‘ä»¬å¯ä»¥åªè·‘ ODE çš„ 1 æ­¥ (Euler Step)ï¼Œè™½ç„¶ç²¾åº¦ç•¥ä½ï¼Œä½†é€Ÿåº¦æå¿«ï¼Œå¯ä»¥å®ç°é«˜é¢‘å“åº”ã€‚
    - ä¹Ÿå¯ä»¥è·‘ 10 æ­¥ï¼Œè·å¾—é«˜ç²¾åº¦åŠ¨ä½œã€‚
    - è¿™ç§ **Compute-Accuracy Trade-off** æ˜¯ Transformer åšä¸åˆ°çš„ã€‚

### 6.3 ä¸ºä»€ä¹ˆæ˜¯ç›´çº¿? (Optimal Transport)
- **Wasserstein Distance**: åœ¨æ¦‚ç‡åˆ†å¸ƒç©ºé—´ä¸­ï¼Œå°†ä¸€ä¸ªåˆ†å¸ƒæ¬è¿åˆ°å¦ä¸€ä¸ªåˆ†å¸ƒçš„"æœ€å°ä»£ä»·"è·¯å¾„å°±æ˜¯ç›´çº¿ (Geodesic)ã€‚
- **OT-CFM**: æˆ‘ä»¬æ„é€ çš„ $x_t = (1-t)x_0 + t x_1$ æ­£æ˜¯ Optimal Transport çš„ä½ç§»æ’å€¼ (Displacement Interpolation)ã€‚
- **Rectified Flow**: è¿™ä¸ Stable Diffusion 3 ä½¿ç”¨çš„ Rectified Flow æ€æƒ³ä¸€è‡´ï¼Œæ—¨åœ¨å°†å¼¯æ›²çš„æ‰©æ•£è·¯å¾„"æ‹‰ç›´"ï¼Œä»è€Œå…è®¸æå°‘æ­¥æ•°çš„æ¨ç† (1-step generation)ã€‚

### 6.4 ODE Solver çš„é€‰æ‹©
- **Euler (1st order)**: æœ€ç®€å•ï¼Œä¸€æ­¥èµ°åˆ°åº•ã€‚$x_{t+dt} = x_t + v_t dt$ã€‚é€Ÿåº¦æœ€å¿«ï¼Œä½†è¯¯å·®æœ€å¤§ã€‚
- **Midpoint / Heun (2nd order)**: å…ˆè¯•æ¢æ€§èµ°åŠæ­¥ï¼Œçœ‹æ–œç‡ï¼Œå†ä¿®æ­£ã€‚ç²¾åº¦æ›´é«˜ï¼Œä½†éœ€è¦ 2 å€çš„ NFE (Number of Function Evaluations)ã€‚
- **RK4 (4th order)**: ç»å…¸çš„é«˜ç²¾åº¦æ±‚è§£å™¨ï¼Œéœ€è¦ 4 å€ NFEã€‚
- **ç»“è®º**: åœ¨æœºå™¨äººæ§åˆ¶ä¸­ï¼Œé€šå¸¸ä½¿ç”¨ **Euler** (è¿½æ±‚æé€Ÿ) æˆ– **Heun** (è¿½æ±‚å¹³è¡¡)ã€‚ç”±äº Flow Matching è®­ç»ƒå‡ºçš„å‘é‡åœºéå¸¸å¹³æ»‘ (ç›´çº¿)ï¼ŒEuler æ–¹æ³•é€šå¸¸å·²ç»è¶³å¤Ÿå¥½ç”¨ã€‚



---

\newpage

# ç¬¬9ç«  FAST åŠ¨ä½œåºåˆ—ç¼–ç 


> [!IMPORTANT]
> **FAST** (Frequency-space Action Sequence Tokenizationï¼Œé¢‘åŸŸåŠ¨ä½œåºåˆ— Token åŒ–) æ˜¯ **Physical Intelligence** å¼€å‘çš„ä¸€ç§é«˜æ•ˆåŠ¨ä½œ Token åŒ–æ–¹æ³•ï¼Œä¸“ä¸ºè§£å†³ VLA æ¨¡å‹ä¸­è¿ç»­åŠ¨ä½œè½¬æ¢ä¸ºç¦»æ•£ token çš„éš¾é¢˜è€Œè®¾è®¡ã€‚

## 1. æ¦‚è¿°
åœ¨ VLA æ¨¡å‹ä¸­ï¼ŒåŠ¨ä½œçš„è¡¨ç¤ºæ–¹å¼è‡³å…³é‡è¦ã€‚ä¼ ç»Ÿçš„ç¦»æ•£åŒ–æ–¹æ³•ï¼ˆå¦‚ç®€å•åˆ†æ¡¶ï¼‰åœ¨å¤„ç†é«˜é¢‘ã€çµå·§çš„æœºå™¨äººæ“ä½œæ—¶æ•ˆæœä¸ä½³ã€‚FAST é€šè¿‡**ç¦»æ•£ä½™å¼¦å˜æ¢ (DCT)** å’Œ**å­—èŠ‚å¯¹ç¼–ç  (BPE)** çš„ç»„åˆï¼Œå®ç°äº†é«˜æ•ˆçš„åŠ¨ä½œå‹ç¼©å’Œ token åŒ–ã€‚

-   **å¼€å‘è€…**: Physical Intelligence
-   **è®ºæ–‡**: [FAST: Efficient Action Tokenization for VLA Models (arXiv:2501.09747)](https://arxiv.org/abs/2501.09747)
-   **æ ¸å¿ƒç›®æ ‡**: å°†è¿ç»­çš„æœºå™¨äººåŠ¨ä½œåºåˆ—å‹ç¼©ä¸ºç´§å‡‘çš„ç¦»æ•£ tokenï¼ŒåŒæ—¶ä¿æŒé«˜é¢‘åŠ¨ä½œçš„ç²¾åº¦ã€‚
-   **åº”ç”¨**: å·²æˆåŠŸé›†æˆåˆ° **OpenVLA** ä¸­ï¼Œæ˜¾è‘—æå‡è®­ç»ƒé€Ÿåº¦ï¼ˆ**æœ€é«˜ 5 å€åŠ é€Ÿ**ï¼‰ã€‚

## 2. æ ¸å¿ƒé—®é¢˜ï¼šä¸ºä»€ä¹ˆéœ€è¦ FASTï¼Ÿ
ä¼ ç»Ÿ VLA æ¨¡å‹ä¸­çš„åŠ¨ä½œ Token åŒ–é¢ä¸´å‡ ä¸ªæŒ‘æˆ˜ï¼š

### 2.1. ç®€å•åˆ†æ¡¶çš„å±€é™æ€§
-   **Token æ•°é‡çˆ†ç‚¸**: å¯¹äº 7-DoF æœºæ¢°è‡‚ï¼Œå¦‚æœæ¯ä¸ªå…³èŠ‚åˆ†æˆ 256 ä¸ª binï¼Œæ€» token æ•°å¯è¾¾ 256^7ï¼Œå¯¼è‡´éš¾ä»¥å­¦ä¹ ã€‚
-   **é«˜é¢‘åŠ¨ä½œä¸¢å¤±**: ç®€å•åˆ†æ¡¶æ— æ³•æ•æ‰å¹³æ»‘ã€é«˜é¢‘çš„è½¨è¿¹å˜åŒ–ï¼ˆå¦‚å¿«é€ŸæŠ˜å è¡£ç‰©ã€ç²¾ç»†æŠ“å–ï¼‰ã€‚

### 2.2. è¿ç»­åŠ¨ä½œçš„è‡ªç›¸å…³æ€§
-   æœºå™¨äººåŠ¨ä½œåœ¨æ—¶é—´ä¸Šé«˜åº¦è‡ªç›¸å…³ï¼ˆt å’Œ t+1 çš„åŠ¨ä½œéå¸¸ç›¸ä¼¼ï¼‰ã€‚
-   è‡ªå›å½’æ¨¡å‹ï¼ˆå¦‚ Transformerï¼‰åœ¨å¤„ç†è¿™ç§é«˜ç›¸å…³æ€§æ•°æ®æ—¶æ•ˆç‡ä½ä¸‹ã€‚

FAST é€šè¿‡**é¢‘åŸŸå˜æ¢**è§£å†³äº†è¿™äº›é—®é¢˜ã€‚

## 3. FAST çš„æ ¸å¿ƒæŠ€æœ¯

### 3.1. ç¦»æ•£ä½™å¼¦å˜æ¢ (DCT)
FAST å€Ÿé‰´äº† **JPEG å›¾åƒå‹ç¼©**çš„æ€æƒ³ï¼Œä½¿ç”¨ DCT å°†æ—¶åŸŸçš„åŠ¨ä½œåºåˆ—è½¬æ¢åˆ°é¢‘åŸŸã€‚

#### 3.1.1. ä¸ºä»€ä¹ˆéœ€è¦ DCTï¼Ÿ
æœºå™¨äººåŠ¨ä½œåºåˆ—æœ‰ä¸¤ä¸ªå…³é”®ç‰¹æ€§ï¼š
1.  **æ—¶é—´å¹³æ»‘æ€§**: ç›¸é‚»æ—¶åˆ»çš„å…³èŠ‚è§’åº¦å˜åŒ–å¾ˆå°ï¼ˆé«˜è‡ªç›¸å…³æ€§ï¼‰ã€‚
2.  **èƒ½é‡é›†ä¸­**: å¤§éƒ¨åˆ†"ä¿¡æ¯"é›†ä¸­åœ¨ä½é¢‘å˜åŒ–ï¼ˆç¼“æ…¢ç§»åŠ¨ï¼‰ï¼Œé«˜é¢‘æŠ–åŠ¨æ˜¯å™ªå£°ã€‚

**ç›´æ¥ Token åŒ–çš„é—®é¢˜**:
-   å¦‚æœç›´æ¥å¯¹æ¯ä¸ªæ—¶é—´æ­¥çš„æ¯ä¸ªå…³èŠ‚åˆ†æ¡¶ï¼Œä¼šäº§ç”Ÿå¤§é‡**å†—ä½™ token**ï¼ˆå› ä¸ºè¿ç»­æ—¶åˆ»éå¸¸ç›¸ä¼¼ï¼‰ã€‚
-   è‡ªå›å½’æ¨¡å‹ï¼ˆTransformerï¼‰éœ€è¦é€ä¸ªé¢„æµ‹è¿™äº›é«˜åº¦ç›¸å…³çš„ tokenï¼Œ**æå…¶ä½æ•ˆ**ã€‚

**DCT çš„è§£å†³æ–¹æ¡ˆ**:
-   å°†æ—¶é—´åºåˆ—ä»**æ—¶åŸŸ**è½¬æ¢åˆ°**é¢‘åŸŸ**ï¼Œåˆ†ç¦»å‡ºä½é¢‘ï¼ˆä¸»è¦ä¿¡æ¯ï¼‰å’Œé«˜é¢‘ï¼ˆå™ªå£°ï¼‰ã€‚
-   åªä¿ç•™**ä½é¢‘ç³»æ•°**ï¼Œå¤§å¹…å‡å°‘æ•°æ®é‡ï¼ŒåŒæ—¶ä¿ç•™åŠ¨ä½œçš„æœ¬è´¨ç‰¹å¾ã€‚

#### 3.1.2. DCT å·¥ä½œåŸç†
**è¾“å…¥**: ä¸€æ®µåŠ¨ä½œåºåˆ—ï¼Œä¾‹å¦‚ 10 ä¸ªæ—¶é—´æ­¥çš„ 7-DoF å…³èŠ‚è§’åº¦ï¼š
```
[ [Î¸1_t0, Î¸2_t0, ..., Î¸7_t0],
  [Î¸1_t1, Î¸2_t1, ..., Î¸7_t1],
  ...
  [Î¸1_t9, Î¸2_t9, ..., Î¸7_t9] ]  # å½¢çŠ¶: [10, 7]
```

**æ­¥éª¤**:
1.  **å¯¹æ¯ä¸ªå…³èŠ‚ç»´åº¦ç‹¬ç«‹åº”ç”¨ DCT**:
    -   DCT å°† 10 ä¸ªæ—¶é—´æ­¥çš„å…³èŠ‚è§’åº¦åˆ†è§£ä¸º 10 ä¸ªé¢‘ç‡åˆ†é‡ã€‚
    -   å…¬å¼: `X_k = Î£(x_n * cos(Ï€/10 * (n + 0.5) * k))`, k=0,1,...,9
    -   `X_0` æ˜¯ DC åˆ†é‡ï¼ˆå¹³å‡å€¼ï¼‰ï¼Œ`X_1, X_2` æ˜¯ä½é¢‘ï¼Œ`X_8, X_9` æ˜¯é«˜é¢‘ã€‚

2.  **ä½é¢‘ä¿ç•™**:
    -   ç”±äºåŠ¨ä½œå¹³æ»‘ï¼Œèƒ½é‡ä¸»è¦åœ¨å‰ K ä¸ªç³»æ•°ï¼ˆä¾‹å¦‚ K=4ï¼‰ã€‚
    -   ä¸¢å¼ƒå 6 ä¸ªé«˜é¢‘ç³»æ•°ï¼Œ**å‹ç¼©æ¯” 2.5:1**ï¼ˆ10 â†’ 4ï¼‰ã€‚

3.  **é‡åŒ–**:
    -   å°†æµ®ç‚¹ DCT ç³»æ•°é‡åŒ–ä¸ºæ•´æ•°ï¼ˆä¾‹å¦‚ 0-255ï¼‰ï¼Œæ–¹ä¾¿åç»­ token åŒ–ã€‚

**ç±»æ¯” JPEG**:
-   **JPEG å‹ç¼©å›¾åƒ**: å¯¹ 8Ã—8 åƒç´ å—åš 2D DCTï¼Œä¿ç•™ä½é¢‘ï¼Œä¸¢å¼ƒé«˜é¢‘ï¼ˆäººçœ¼ä¸æ•æ„Ÿçš„ç»†èŠ‚ï¼‰ã€‚
-   **FAST å‹ç¼©åŠ¨ä½œ**: å¯¹æ—¶é—´åºåˆ—åš 1D DCTï¼Œä¿ç•™ä½é¢‘ï¼ˆç¼“æ…¢ç§»åŠ¨ï¼‰ï¼Œä¸¢å¼ƒé«˜é¢‘ï¼ˆæŠ–åŠ¨å™ªå£°ï¼‰ã€‚
-   **æœ¬è´¨**: éƒ½æ˜¯åˆ©ç”¨**ä¿¡å·çš„é¢‘åŸŸç¨€ç–æ€§**è¿›è¡Œå‹ç¼©ã€‚

#### 3.1.3. ä¸ºä»€ä¹ˆ DCT è€Œä¸æ˜¯ FFTï¼Ÿ
-   **DCT åªæœ‰å®æ•°**: æ›´é€‚åˆå®å€¼ä¿¡å·ï¼ˆå…³èŠ‚è§’åº¦ï¼‰ï¼ŒFFT ä¼šäº§ç”Ÿå¤æ•°ã€‚
-   **è¾¹ç•Œå‹å¥½**: DCT å‡è®¾ä¿¡å·å¯¹ç§°å»¶æ‹“ï¼Œé¿å…è¾¹ç•Œä¸è¿ç»­å¯¼è‡´çš„é«˜é¢‘ä¼ªå½±ã€‚
-   **å‹ç¼©æ•ˆç‡**: DCT çš„èƒ½é‡é›†ä¸­æ€§æ¯” FFT æ›´å¥½ï¼ˆè¿™ä¹Ÿæ˜¯ JPEG é€‰æ‹© DCT çš„åŸå› ï¼‰ã€‚

### 3.2. å­—èŠ‚å¯¹ç¼–ç  (BPE)
ç»è¿‡ DCT é‡åŒ–åï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªæ•´æ•°åºåˆ—ï¼Œä¾‹å¦‚ï¼š
```
[42, 15, 3, 1, 0, 0, 0]  # 7-DoFï¼Œæ¯ä¸ªå…³èŠ‚çš„å‰ K=4 ä¸ª DCT ç³»æ•°
```
å¯¹äº 10 ä¸ªæ—¶é—´æ­¥ï¼Œä¼šæœ‰ `10 Ã— 7 Ã— 4 = 280` ä¸ªæ•´æ•°å€¼ã€‚è¿™ä»ç„¶å¤ªå¤šï¼

#### 3.2.1. ä¸ºä»€ä¹ˆéœ€è¦ BPEï¼Ÿ
-   **ç»Ÿè®¡æ¨¡å¼**: DCT ç³»æ•°çš„åˆ†å¸ƒä¸æ˜¯å‡åŒ€çš„ï¼ŒæŸäº›**ç³»æ•°ç»„åˆ**ä¼šé¢‘ç¹å‡ºç°ã€‚
-   **å‡å°‘ token æ•°**: BPE èƒ½å°†å¸¸è§çš„ç³»æ•°å¯¹åˆå¹¶ä¸ºå•ä¸ª tokenï¼Œå¤§å¹…å‡å°‘åºåˆ—é•¿åº¦ã€‚

#### 3.2.2. BPE å·¥ä½œåŸç†
**åˆå§‹åŒ–**:
-   è¯æ±‡è¡¨ = `{0, 1, 2, ..., 255}` ï¼ˆæ‰€æœ‰å¯èƒ½çš„é‡åŒ– DCT ç³»æ•°ï¼‰ã€‚

**è¿­ä»£åˆå¹¶**:
1.  **ç»Ÿè®¡**: åœ¨è®­ç»ƒæ•°æ®ä¸­ï¼Œç»Ÿè®¡æ‰€æœ‰ç›¸é‚»ç³»æ•°å¯¹çš„é¢‘ç‡ã€‚
    -   ä¾‹å¦‚ï¼Œ`[42, 15]` è¿™ä¸ªç»„åˆå‡ºç°äº† 10000 æ¬¡ï¼ˆæœ€é«˜é¢‘ï¼‰ã€‚
2.  **åˆå¹¶**: å°† `[42, 15]` åˆå¹¶ä¸ºä¸€ä¸ªæ–° token `token_256`ã€‚
    -   è¯æ±‡è¡¨æ›´æ–°: `{0, 1, ..., 255, 256=[42,15]}`
3.  **é‡å¤**: ä¸æ–­æ‰¾æœ€é«˜é¢‘çš„å¯¹ï¼Œåˆå¹¶ï¼Œç›´åˆ°è¯æ±‡è¡¨è¾¾åˆ°ç›®æ ‡å¤§å°ï¼ˆä¾‹å¦‚ 8000ï¼‰ã€‚

**æ•ˆæœ**:
-   åŸå§‹åºåˆ—: `[42, 15, 3, 1, 0, 0, 0]` (7 ä¸ª token)
-   BPE å: `[token_256, token_512, 0]` (3 ä¸ª token)
-   **å‹ç¼©æ¯”**: 2.3:1

**ç±»æ¯” GPT çš„ BPE**:
-   **GPT æ–‡æœ¬ BPE**: å°†å¸¸è§çš„å­—æ¯ç»„åˆï¼ˆå¦‚ "ing", "the"ï¼‰åˆå¹¶ä¸ºå•ä¸ª tokenï¼Œå‡å°‘åºåˆ—é•¿åº¦ã€‚
    -   ä¾‹: "running" â†’ `["run", "ning"]` è€Œä¸æ˜¯ 7 ä¸ªå­—æ¯ã€‚
-   **FAST åŠ¨ä½œ BPE**: å°†å¸¸è§çš„ DCT ç³»æ•°ç»„åˆåˆå¹¶ä¸ºå•ä¸ª tokenï¼Œå‡å°‘åŠ¨ä½œåºåˆ—é•¿åº¦ã€‚
    -   ä¾‹: `[42, 15]` â†’ `token_256`
-   **æœ¬è´¨**: éƒ½æ˜¯åŸºäº**ç»Ÿè®¡é¢‘ç‡**çš„æ•°æ®å‹ç¼©ï¼Œåˆ©ç”¨æ•°æ®çš„**å±€éƒ¨ç›¸å…³æ€§**ã€‚

#### 3.2.3. ä¸ºä»€ä¹ˆ BPE æœ‰æ•ˆï¼Ÿ
-   **æœºå™¨äººåŠ¨ä½œçš„æ¨¡å¼**: æŸäº›åŠ¨ä½œæ¨¡å¼ï¼ˆå¦‚ "æŠ“å–+æèµ·"ï¼‰çš„ DCT ç³»æ•°æ¨¡å¼ä¼šé‡å¤å‡ºç°ã€‚
-   **å‡å°‘å†—ä½™**: BPE èƒ½è‡ªåŠ¨å‘ç°è¿™äº›æ¨¡å¼ï¼Œå¹¶ç”¨å•ä¸ª token è¡¨ç¤ºï¼Œ**é¿å…é‡å¤ç¼–ç **ã€‚
-   **ä¿æŒè¯­ä¹‰**: é«˜é¢‘çš„ç³»æ•°ç»„åˆé€šå¸¸å¯¹åº”æœ‰æ„ä¹‰çš„åŠ¨ä½œç‰‡æ®µï¼ŒBPE ä¿ç•™äº†è¿™ç§è¯­ä¹‰ç»“æ„ã€‚

### 3.3. FAST+ (Universal Tokenizer)
FAST+ æ˜¯åœ¨ **100 ä¸‡+çœŸå®æœºå™¨äººåŠ¨ä½œåºåˆ—**ä¸Šé¢„è®­ç»ƒçš„é€šç”¨ token åŒ–å™¨ã€‚
-   **è·¨å¹³å°**: é€‚ç”¨äºä¸åŒçš„æœºå™¨äººï¼ˆæœºæ¢°è‡‚ã€äººå½¢æœºå™¨äººã€ç§»åŠ¨æœºå™¨äººï¼‰ã€‚
-   **è·¨é¢‘ç‡**: é€‚åº”ä¸åŒçš„æ§åˆ¶é¢‘ç‡ï¼ˆ10Hz åˆ° 100Hzï¼‰ã€‚
-   **å¼€ç®±å³ç”¨**: æ— éœ€ä¸ºæ¯ä¸ªæ–°ä»»åŠ¡é‡æ–°è®­ç»ƒ tokenizerã€‚

## 4. FAST çš„ä¼˜åŠ¿
| ç‰¹æ€§ | ç®€å•åˆ†æ¡¶ | FAST (DCT + BPE) |
| :--- | :--- | :--- |
| **Token æ•°é‡** | é«˜ï¼ˆ256^7ï¼‰| **ä½ï¼ˆ2-3 ä¸ª token/åºåˆ—ï¼‰** |
| **é«˜é¢‘ç²¾åº¦** | å·®ï¼ˆæŠ–åŠ¨ï¼‰| **å¼ºï¼ˆå¹³æ»‘ï¼‰** |
| **è®­ç»ƒé€Ÿåº¦** | æ…¢ | **å¿«ï¼ˆ5 å€åŠ é€Ÿï¼‰** |
| **æ³›åŒ–èƒ½åŠ›** | å¼± | **å¼ºï¼ˆFAST+ è·¨ä»»åŠ¡æ³›åŒ–ï¼‰** |

## 5. åœ¨ OpenVLA ä¸­çš„åº”ç”¨
FAST å·²è¢«é›†æˆåˆ° **OpenVLA** æ¡†æ¶ä¸­ï¼š
-   **è®­ç»ƒ**: ä½¿ç”¨ FAST tokenizer å°† Open X-Embodiment æ•°æ®é›†ä¸­çš„åŠ¨ä½œåºåˆ— token åŒ–ã€‚
-   **æ¨ç†**: ç”Ÿæˆçš„ token é€šè¿‡é€† DCT è½¬æ¢å›è¿ç»­åŠ¨ä½œã€‚
-   **æ•ˆæœ**: åœ¨æŠ˜å è¡£ç‰©ã€æ¸…ç†æ¡Œå­ç­‰é«˜é¢‘ä»»åŠ¡ä¸Šï¼ŒæˆåŠŸç‡æå‡ **30-50%**ã€‚

## 6. ä¸å…¶ä»–åŠ¨ä½œè¡¨ç¤ºçš„å¯¹æ¯”
| æ–¹æ³• | åŸç† | ä¼˜ç‚¹ | ç¼ºç‚¹ |
| :--- | :--- | :--- | :--- |
| **åˆ†æ¡¶ (Binning)** | å°†è¿ç»­å€¼åˆ†æˆç¦»æ•£åŒºé—´ | ç®€å• | Token çˆ†ç‚¸ï¼Œç²¾åº¦å·® |
| **æ‰©æ•£ (Diffusion)** | é€šè¿‡å»å™ªç”ŸæˆåŠ¨ä½œ | å¹³æ»‘ï¼Œé«˜ç²¾åº¦ | æ¨ç†æ…¢ï¼ˆå¤šæ­¥å»å™ªï¼‰|
| **æµåŒ¹é… (Flow Matching)** | ODE æ±‚è§£å™¨ç”Ÿæˆè½¨è¿¹ | å¿«é€Ÿï¼Œé«˜è´¨é‡ | éœ€è¦é¢å¤–è®­ç»ƒå¤´ |
| **FAST (DCT + BPE)** | é¢‘åŸŸå‹ç¼© + Token åŒ– | **å¿«é€Ÿï¼Œå…¼å®¹è‡ªå›å½’æ¨¡å‹** | éœ€è¦é¢„è®­ç»ƒ tokenizer |

## 7. é¢è¯•è¦ç‚¹
-   **DCT æ˜¯æ ¸å¿ƒ**: è®°ä½ "åƒ JPEG å‹ç¼©å›¾ç‰‡ä¸€æ ·å‹ç¼©åŠ¨ä½œè½¨è¿¹"ã€‚
-   **BPE è¿›ä¸€æ­¥å‹ç¼©**: ç±»ä¼¼ GPT çš„ token åŒ–ï¼Œå°† DCT ç³»æ•°å‹ç¼©ä¸ºå°‘é‡ tokenã€‚
-   **5 å€åŠ é€Ÿ**: FAST ä½¿ OpenVLA çš„è®­ç»ƒé€Ÿåº¦æå‡ 5 å€ã€‚
-   **FAST+ æ˜¯é€šç”¨ tokenizer**: åœ¨ 100 ä¸‡+çœŸå®æœºå™¨äººæ•°æ®ä¸Šé¢„è®­ç»ƒï¼Œè·¨å¹³å°æ³›åŒ–ã€‚
-   **é€‚åˆè‡ªå›å½’æ¨¡å‹**: FAST çš„ token è¾“å‡ºå¯ä»¥ç›´æ¥å–‚ç»™ Transformerï¼Œæ— éœ€ä¿®æ”¹æ¶æ„ã€‚

## 8. å‚è€ƒèµ„æº
-   **è®ºæ–‡**: [FAST: Efficient Action Tokenization for VLA Models (arXiv:2501.09747)](https://arxiv.org/abs/2501.09747)
-   **å®˜æ–¹åšå®¢**: [Physical Intelligence - FAST](https://physicalintelligence.company/blog/fast)
-   **GitHub**: [OpenVLA](https://github.com/openvla/openvla)
-   **Hugging Face**: [FAST+ Tokenizer](https://huggingface.co/pi0/FAST-plus)


\newpage

# ç¬¬ä¸‰éƒ¨åˆ†ï¼šè®­ç»ƒæŠ€æœ¯ä¸ä¼˜åŒ–


\newpage

# ç¬¬10ç«  å‚æ•°é«˜æ•ˆå¾®è°ƒ (PEFT/LoRA)


åœ¨ VLA æ—¶ä»£ï¼Œæˆ‘ä»¬é€šå¸¸åŸºäº 7B+ çš„å¤§æ¨¡å‹è¿›è¡Œå¾®è°ƒã€‚å…¨é‡å¾®è°ƒ (Full Fine-tuning) æå…¶æ˜‚è´µï¼Œå› æ­¤å‚æ•°é«˜æ•ˆå¾®è°ƒ (PEFT) æˆä¸ºäº†å¿…ä¿®è¯¾ã€‚

## 0. ä¸»è¦æ•¸å­¸æ€æƒ³ (Main Mathematical Idea)

> **ç¬¬ä¸€æ€§åŸç†**: **Redundancy of Information (ä¿¡æ¯çš„å†—ä½™ / Intrinsic Dimension)**

ä¸€ä¸ªæ‹¥æœ‰ 70 äº¿å‚æ•°çš„é€šç”¨æ¨¡å‹ï¼Œåœ¨å­¦ä¹ ä¸€ä¸ªç‰¹å®šæŠ€èƒ½ï¼ˆå¦‚"æ‹¿èµ·æ¯å­"ï¼‰æ—¶ï¼Œå¹¶ä¸éœ€è¦æ”¹å˜æ‰€æœ‰ 70 äº¿ä¸ªè‡ªç”±åº¦ã€‚ä»»åŠ¡çš„æœ¬è´¨å˜åŒ–é€šå¸¸å‘ç”Ÿåœ¨æä½ç»´çš„å­ç©ºé—´ä¸­ã€‚

- **æ ¸å¿ƒæ•°å­¦å·¥å…·**: **Low-Rank Matrix Decomposition (ä½ç§©çŸ©é˜µåˆ†è§£ / SVD)**ã€‚
- **è§£é¢˜é€»è¾‘**:
    1.  **å‡è®¾**: æƒé‡çŸ©é˜µçš„å˜åŒ–é‡ $\Delta W$ æ˜¯ä½ç§©çš„ (Low Rank)ã€‚å³ $\text{rank}(\Delta W) \ll \min(d, k)$ã€‚
    2.  **åˆ†è§£**: ä»»ä½•ä½ç§©çŸ©é˜µéƒ½å¯ä»¥åˆ†è§£ä¸ºä¸¤ä¸ªå°çŸ©é˜µçš„ä¹˜ç§¯ ($B \times A$)ã€‚
    3.  **é«˜æ•ˆ**: æˆ‘ä»¬ä¸ç›´æ¥è®­ç»ƒå·¨å¤§çš„ $\Delta W$ ($d \times k$)ï¼Œè€Œæ˜¯è®­ç»ƒå¾®å°çš„ $A$ å’Œ $B$ ($r \times (d+k)$)ã€‚è¿™å°±åƒç”¨å‡ ä¸ªä¸»æˆåˆ†ï¼ˆPrincipal Componentsï¼‰æ¥è¿‘ä¼¼å¤æ‚çš„å˜æ¢ã€‚

## 1. LoRA (Low-Rank Adaptation)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LoRA æ¶æ„ç¤ºæ„å›¾                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚         è¾“å…¥ x                                                  â”‚
â”‚           â”‚                                                     â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”                                               â”‚
â”‚     â”‚           â”‚                                               â”‚
â”‚     â–¼           â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚  â”‚  Wâ‚€  â”‚   â”‚  A   â”‚  â† ä½ç§©çŸ©é˜µ (r << d)                       â”‚
â”‚  â”‚      â”‚   â”‚ rÃ—k  â”‚    å¯è®­ç»ƒ                                  â”‚
â”‚  â”‚ dÃ—k  â”‚   â””â”€â”€â”¬â”€â”€â”€â”˜                                            â”‚
â”‚  â”‚      â”‚      â”‚                                                â”‚
â”‚  â”‚ å†»ç»“ â”‚      â–¼                                                â”‚
â”‚  â””â”€â”€â”¬â”€â”€â”€â”˜   â”Œâ”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚     â”‚       â”‚  B   â”‚  â† ä½ç§©çŸ©é˜µ                                â”‚
â”‚     â”‚       â”‚ dÃ—r  â”‚    å¯è®­ç»ƒ                                  â”‚
â”‚     â”‚       â””â”€â”€â”¬â”€â”€â”€â”˜                                            â”‚
â”‚     â”‚          â”‚                                                â”‚
â”‚     â”‚    Î”W = BÂ·A                                               â”‚
â”‚     â”‚          â”‚                                                â”‚
â”‚     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                                â”‚
â”‚          â”‚  W = Wâ‚€ + Î±Â·BA                                       â”‚
â”‚          â–¼                                                      â”‚
â”‚        è¾“å‡º h                                                   â”‚
â”‚                                                                 â”‚
â”‚  å‚æ•°é‡: dÃ—k (å†»ç»“) + rÃ—(d+k) (è®­ç»ƒ) â‰ˆ 0.1% ~ 1%                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.1. æ ¸å¿ƒæ€æƒ³
å¤§æ¨¡å‹çš„æƒé‡çŸ©é˜µ $W \in \mathbb{R}^{d \times k}$ è™½ç„¶å‚æ•°å¾ˆå¤šï¼Œä½†åœ¨ç‰¹å®šä»»åŠ¡ (å¦‚æœºå™¨äººæ§åˆ¶) ä¸Šï¼Œå…¶**å†…åœ¨ç»´åº¦ (Intrinsic Dimension)** å…¶å®å¾ˆä½ã€‚
æˆ‘ä»¬ä¸éœ€è¦æ›´æ–°æ•´ä¸ª $W$ï¼Œåªéœ€è¦å­¦ä¹ ä¸€ä¸ªä½ç§©çš„å¢é‡çŸ©é˜µ $\Delta W$ã€‚

### 1.2. æ•°å­¦åŸç†
å‡è®¾é¢„è®­ç»ƒæƒé‡ä¸º $W_0$ï¼Œå¾®è°ƒåçš„æƒé‡ä¸º $W_0 + \Delta W$ã€‚
æˆ‘ä»¬å°† $\Delta W$ åˆ†è§£ä¸ºä¸¤ä¸ªä½ç§©çŸ©é˜µ $A$ å’Œ $B$ çš„ä¹˜ç§¯ï¼š


$$
W = W_0 + \Delta W = W_0 + B A
$$

å…¶ä¸­ï¼š
- $B \in \mathbb{R}^{d \times r}, A \in \mathbb{R}^{r \times k}$
- $r \ll \min(d, k)$ æ˜¯ç§© (Rank)ï¼Œé€šå¸¸å– 8, 16, 32ã€‚
- **å‚æ•°é‡å¯¹æ¯”**: $d \times k$ (å…¨é‡) vs $r \times (d + k)$ (LoRA)ã€‚å¯¹äº 7B æ¨¡å‹ï¼ŒLoRA å‚æ•°é‡é€šå¸¸ä¸åˆ° 1%ã€‚

### 1.3. è®­ç»ƒä¸æ¨ç†
- **åˆå§‹åŒ–**: $A$ ä½¿ç”¨é«˜æ–¯åˆå§‹åŒ–ï¼Œ$B$ åˆå§‹åŒ–ä¸º 0ã€‚è¿™æ ·åˆå§‹çŠ¶æ€ä¸‹ $\Delta W = 0$ï¼Œæ¨¡å‹è¾“å‡ºä¸é¢„è®­ç»ƒæ¨¡å‹ä¸€è‡´ã€‚
- **è®­ç»ƒ**: å†»ç»“ $W_0$ï¼Œåªæ›´æ–° $A$ å’Œ $B$ã€‚
- **æ¨ç†**: å¯ä»¥å°† $BA$ åŠ å›åˆ° $W_0$ ä¸­ (Merge)ï¼Œæ¨ç†é€Ÿåº¦ä¸åŸæ¨¡å‹å®Œå…¨ä¸€è‡´ï¼Œæ— é¢å¤–å»¶è¿Ÿã€‚


$$
W_{merged} = W_0 + \alpha \cdot BA
$$


  ($\alpha$ æ˜¯ç¼©æ”¾ç³»æ•°ï¼Œé€šå¸¸ $\alpha/r$ ç”¨äºå½’ä¸€åŒ–)ã€‚

---

## 2. QLoRA (Quantized LoRA)

### 2.1. ç—›ç‚¹
LoRA è™½ç„¶å‡å°‘äº†å¯è®­ç»ƒå‚æ•°ï¼Œä½†**åŸºç¡€æ¨¡å‹ $W_0$ ä¾ç„¶éœ€è¦ä»¥ FP16 åŠ è½½åˆ°æ˜¾å­˜ä¸­**ã€‚å¯¹äº 65B çš„æ¨¡å‹ï¼Œå…‰åŠ è½½å°±éœ€è¦ 130GB æ˜¾å­˜ï¼Œå•å¡ 4090 æ ¹æœ¬è·‘ä¸åŠ¨ã€‚

### 2.2. æ ¸å¿ƒåˆ›æ–°
QLoRA ç»“åˆäº† **4-bit é‡åŒ–** å’Œ **LoRA**ï¼Œä½¿å¾— 65B æ¨¡å‹å¯ä»¥åœ¨ 48GB æ˜¾å­˜ä¸Šå¾®è°ƒã€‚

1.  **4-bit NormalFloat (NF4)**: ä¸€ç§ç†è®ºæœ€ä¼˜çš„ 4-bit é‡åŒ–æ•°æ®ç±»å‹ï¼Œä¸“é—¨é’ˆå¯¹æ­£æ€åˆ†å¸ƒçš„æƒé‡è®¾è®¡ã€‚
2.  **Double Quantization**: å¯¹é‡åŒ–å¸¸æ•° (Quantization Constants) å†è¿›è¡Œä¸€æ¬¡é‡åŒ–ï¼Œè¿›ä¸€æ­¥èŠ‚çœæ˜¾å­˜ (æ¯å‚æ•°å¹³å‡èŠ‚çœ 0.37 bit)ã€‚
3.  **Paged Optimizers**: åˆ©ç”¨ CPU å†…å­˜æ¥ç¼“å­˜ä¼˜åŒ–å™¨çŠ¶æ€ (Optimizer States)ï¼Œé˜²æ­¢æ˜¾å­˜ OOMã€‚

### 2.3. æ˜¾å­˜è®¡ç®— (7B Model)
- **Full Fine-tuning (Adam)**: ~112 GB (æƒé‡+æ¢¯åº¦+ä¼˜åŒ–å™¨çŠ¶æ€)
- **LoRA (FP16)**: ~16 GB (æƒé‡) + ~1 GB (LoRA) = ~17 GB
- **QLoRA (4-bit)**: ~4 GB (æƒé‡) + ~1 GB (LoRA) = ~5 GB (å¯ä»¥åœ¨ RTX 3060 ä¸Šè·‘ï¼)

---

## 3. å…¶ä»– PEFT æ–¹æ³•

### 3.1. Adapters (Houlsby et al.)
- åœ¨ Transformer çš„æ¯ä¸€å±‚ä¸­æ’å…¥å°çš„å…¨è¿æ¥ç½‘ç»œ (Adapter Layers)ã€‚
- **ç¼ºç‚¹**: å¢åŠ äº†æ¨ç†å»¶è¿Ÿ (å› ä¸ºæ˜¯ä¸²è¡Œçš„å±‚)ï¼Œæ— æ³•åƒ LoRA é‚£æ ·åˆå¹¶æƒé‡ã€‚

### 3.2. Prefix Tuning / P-Tuning
- åœ¨ Input Token å‰é¢æ‹¼æ¥ä¸€ç»„å¯å­¦ä¹ çš„ Virtual Tokensã€‚
- **ç¼ºç‚¹**: å ç”¨äº†å®è´µçš„ Context Window é•¿åº¦ã€‚

### 3.3. P-Tuning v2
- åœ¨æ¯ä¸€å±‚éƒ½åŠ å…¥å¯å­¦ä¹ çš„ Prefixï¼Œè€Œä¸ä»…ä»…æ˜¯è¾“å…¥å±‚ã€‚
- **ä¼˜ç‚¹**: æ¯” P-Tuning v1 æ•ˆæœæ›´å¥½ï¼Œæ¥è¿‘å…¨é‡å¾®è°ƒã€‚
- **ç¼ºç‚¹**: ä»ç„¶å ç”¨ Context Windowã€‚

---

## 4. PEFT æ–¹æ³•å¯¹æ¯” (Comparison)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PEFT æ–¹æ³•å¯¹æ¯”ä¸€è§ˆ                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   æ–¹æ³•          åŸç†              æ¨ç†å»¶è¿Ÿ   å¯åˆå¹¶   å‚æ•°é‡     â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚   LoRA          ä½ç§©åˆ†è§£ Î”W=BA    æ— é¢å¤–     âœ…       ~0.1-1%   â”‚
â”‚   Adapter       ä¸²è¡Œæ’å…¥ MLP      æœ‰é¢å¤–     âŒ       ~1-5%     â”‚
â”‚   P-Tuning      å¯å­¦ä¹  Prompt     å  Context âŒ       ~0.01%    â”‚
â”‚   Prefix-Tuning å¯å­¦ä¹  KV å‰ç¼€    å  Context âŒ       ~0.1%     â”‚
â”‚   P-Tuning v2   æ¯å±‚ Prefix       å  Context âŒ       ~0.1-1%   â”‚
â”‚                                                                 â”‚
â”‚   ğŸ’¡ VLA é¦–é€‰: LoRA (å¯åˆå¹¶ï¼Œæ— æ¨ç†å»¶è¿Ÿ)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| æ–¹æ³• | åŸç† | æ¨ç†å»¶è¿Ÿ | å¯åˆå¹¶æƒé‡ | å‚æ•°é‡ | æ•ˆæœ |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **LoRA** | ä½ç§©åˆ†è§£ $\Delta W = BA$ | æ—  | âœ… | ~0.1-1% | â­â­â­â­ |
| **Adapter** | ä¸²è¡Œæ’å…¥ MLP | æœ‰ | âŒ | ~1-5% | â­â­â­ |
| **P-Tuning** | å¯å­¦ä¹  Soft Prompt | å  Context | âŒ | ~0.01% | â­â­ |
| **Prefix-Tuning** | å¯å­¦ä¹  KV å‰ç¼€ | å  Context | âŒ | ~0.1% | â­â­â­ |
| **P-Tuning v2** | æ¯å±‚ Prefix | å  Context | âŒ | ~0.1-1% | â­â­â­â­ |

### LoRA vs P-Tuning vs Adapter æ ¸å¿ƒå·®å¼‚

| å¯¹æ¯”ç»´åº¦ | LoRA | P-Tuning | Adapter |
| :--- | :--- | :--- | :--- |
| **ä¿®æ”¹ä½ç½®** | æƒé‡çŸ©é˜µ (W) | è¾“å…¥å±‚ / æ¯å±‚ | å±‚é—´æ’å…¥ |
| **æ¨ç†æ—¶** | å¯åˆå¹¶ï¼Œæ— å»¶è¿Ÿ | éœ€ä¿ç•™ Prompt | éœ€ä¿ç•™ Adapter |
| **Context å ç”¨** | æ—  | æœ‰ (å‡ å~å‡ ç™¾ Token) | æ—  |
| **é€‚ç”¨åœºæ™¯** | é€šç”¨é¦–é€‰ | å°æ¨¡å‹ / ç‰¹å®šä»»åŠ¡ | å¤šä»»åŠ¡åˆ‡æ¢ |

---

## 5. LoRA å‚æ•°é€‰æ‹©æŒ‡å— (Hyperparameter Guide)

### 5.1 Rank (ç§© $r$) çš„å½±å“

| $r$ å€¼ | å‚æ•°é‡ | é€‚ç”¨åœºæ™¯ | é£é™© |
| :--- | :--- | :--- | :--- |
| **4-8** | æœ€å°‘ | ç®€å•ä»»åŠ¡ (æŒ‡ä»¤è·Ÿéšã€é£æ ¼è¿ç§») | æ¬ æ‹Ÿåˆ |
| **16-32** | é€‚ä¸­ | é€šç”¨å¾®è°ƒ (VLA æ¨è) | å¹³è¡¡ |
| **64-128** | è¾ƒå¤š | å¤æ‚æ¨ç†ã€çŸ¥è¯†æ³¨å…¥ | è¿‡æ‹Ÿåˆ |
| **256+** | æ¥è¿‘å…¨é‡ | å‡ ä¹ç­‰ä»·äºå…¨é‡å¾®è°ƒ | å¤±å» LoRA ä¼˜åŠ¿ |

### 5.2 Alpha ($\alpha$) çš„å½±å“


$$
W = W_0 + \frac{\alpha}{r} \cdot BA
$$


- **$\alpha / r$ æ¯”å€¼**: æ§åˆ¶ LoRA æ›´æ–°çš„"å¼ºåº¦"
- **å¸¸è§è®¾ç½®**: $\alpha = 2r$ (å³ $\alpha/r = 2$)
- **$\alpha$ å¤§**: æ›´æ¿€è¿›çš„æ›´æ–°ï¼Œæ”¶æ•›å¿«ä½†å¯èƒ½ä¸ç¨³å®š
- **$\alpha$ å°**: æ›´ä¿å®ˆçš„æ›´æ–°ï¼Œç¨³å®šä½†æ”¶æ•›æ…¢

### 5.3 ç›®æ ‡å±‚é€‰æ‹©

| é…ç½® | ç›®æ ‡å±‚ | å‚æ•°é‡ | æ•ˆæœ |
| :--- | :--- | :--- | :--- |
| **æœ€å°é…ç½®** | `q_proj, v_proj` | ~0.1% | åŸºç¡€æ•ˆæœ |
| **æ¨èé…ç½®** | `q_proj, k_proj, v_proj, o_proj` | ~0.2% | è¾ƒå¥½æ•ˆæœ |
| **å®Œæ•´é…ç½®** | Attention + MLP å…¨éƒ¨ | ~1% | æœ€ä½³æ•ˆæœ |

```python
## PEFT é…ç½®ç¤ºä¾‹
from peft import LoraConfig

lora_config = LoraConfig(
    r=16,                    # ç§©
    lora_alpha=32,           # alpha = 2r
    target_modules=[
        "q_proj", "k_proj", "v_proj", "o_proj",  # Attention
        "gate_proj", "up_proj", "down_proj"       # MLP
    ],
    lora_dropout=0.05,
    bias="none",
    task_type="CAUSAL_LM"
)
```

---

## 6. é¢è¯•é«˜é¢‘è€ƒç‚¹

**Q: LoRA çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿä¸ P-Tuningã€Adapter çš„å¼‚åŒç‚¹ï¼Ÿ**
A: 
- **LoRA**: å°†æƒé‡å¢é‡ $\Delta W$ åˆ†è§£ä¸ºä½ç§©çŸ©é˜µ $BA$ï¼Œå†»ç»“åŸå§‹æƒé‡åªè®­ç»ƒ $A, B$ã€‚æ¨ç†æ—¶å¯åˆå¹¶å›åŸæƒé‡ï¼Œæ— é¢å¤–å»¶è¿Ÿã€‚
- **P-Tuning**: åœ¨è¾“å…¥å‰åŠ å¯å­¦ä¹ çš„ Soft Promptï¼Œå ç”¨ Context Windowã€‚
- **Adapter**: åœ¨ Transformer å±‚é—´æ’å…¥å°å‹ MLPï¼Œæ¨ç†æ—¶æœ‰é¢å¤–å»¶è¿Ÿã€‚
- **æ ¸å¿ƒåŒºåˆ«**: LoRA ä¿®æ”¹æƒé‡æœ¬èº«ï¼ŒP-Tuning ä¿®æ”¹è¾“å…¥ï¼ŒAdapter ä¿®æ”¹ç»“æ„ã€‚LoRA æ˜¯å”¯ä¸€å¯ä»¥"æ— ç—•åˆå¹¶"çš„æ–¹æ³•ã€‚

**Q: LoRA çš„å‚æ•°é€‰æ‹©å¯¹æ¨¡å‹æ€§èƒ½æœ‰ä½•å½±å“ï¼Ÿ**
A:
- **Rank $r$**: æ§åˆ¶è¡¨è¾¾èƒ½åŠ›ã€‚$r$ å° (4-8) é€‚åˆç®€å•ä»»åŠ¡ï¼Œ$r$ å¤§ (64+) é€‚åˆå¤æ‚ä»»åŠ¡ä½†æ˜“è¿‡æ‹Ÿåˆã€‚
- **Alpha $\alpha$**: æ§åˆ¶æ›´æ–°å¼ºåº¦ã€‚é€šå¸¸ $\alpha = 2r$ã€‚
- **ç›®æ ‡å±‚**: åªè®­ç»ƒ `q_proj, v_proj` æ˜¯æœ€å°é…ç½®ï¼ŒåŠ ä¸Š MLP æ•ˆæœæ›´å¥½ã€‚

**Q: LoRA çš„ç§© $r$ è¶Šå¤§è¶Šå¥½å—ï¼Ÿ**
A: ä¸ä¸€å®šã€‚å¯¹äºç®€å•çš„ä»»åŠ¡ (å¦‚æŒ‡ä»¤è·Ÿéš)ï¼Œ$r=8$ è¶³çŸ£ã€‚å¯¹äºå¤æ‚çš„é€»è¾‘æ¨ç†æˆ–çŸ¥è¯†æ³¨å…¥ï¼Œ$r$ å¯èƒ½éœ€è¦è®¾å¤§ä¸€ç‚¹ (64 æˆ– 128)ã€‚ä½†è¿‡å¤§å®¹æ˜“è¿‡æ‹Ÿåˆï¼Œä¸”å¤±å»å‚æ•°é«˜æ•ˆçš„ä¼˜åŠ¿ã€‚

**Q: ä¸ºä»€ä¹ˆ QLoRA æ¯” LoRA æ…¢ï¼Ÿ**
A: å› ä¸º QLoRA åœ¨è®¡ç®—æ¢¯åº¦æ—¶ï¼Œéœ€è¦å°† 4-bit æƒé‡**åé‡åŒ– (Dequantize)** å› FP16/BF16 è¿›è¡Œè®¡ç®—ã€‚è¿™ä¸ªåé‡åŒ–è¿‡ç¨‹å¢åŠ äº†è®¡ç®—å¼€é”€ã€‚

**Q: VLA æ¨¡å‹å¾®è°ƒåº”è¯¥å¾®è°ƒå“ªäº›å±‚ï¼Ÿ**
A: é€šå¸¸å¾®è°ƒ **Attention (q_proj, v_proj)** å’Œ **MLP (gate_proj, up_proj, down_proj)** æ•ˆæœæœ€å¥½ã€‚åªå¾®è°ƒ Attention æœ‰æ—¶ä¸å¤Ÿã€‚

\newpage

# ç¬¬11ç«  å¼ºåŒ–å­¦ä¹ åŸºç¡€ä¸ RLHF


> **æ ¸å¿ƒæ¦‚å¿µ**: å¼ºåŒ–å­¦ä¹  (Reinforcement Learning, RL) æ˜¯ä¸€ç§é€šè¿‡ä¸ç¯å¢ƒäº¤äº’æ¥å­¦ä¹ æœ€ä¼˜ç­–ç•¥çš„æ–¹æ³•ã€‚æ™ºèƒ½ä½“é€šè¿‡**è¯•é”™** (Trial-and-Error) å’Œ**å¥–åŠ±åé¦ˆ** (Reward Feedback) ä¸æ–­æ”¹è¿›è¡Œä¸ºã€‚

## 0. ä¸»è¦æ•¸å­¸æ€æƒ³ (Main Mathematical Idea)

> **ç¬¬ä¸€æ€§åŸç†**: **Trial and Error with Feedback (è¯•é”™ä¸åé¦ˆ)**

åœ¨ç°å®ä¸–ç•Œä¸­ï¼Œæ™ºèƒ½ä½“ï¼ˆæ— è®ºæ˜¯ç”Ÿç‰©è¿˜æ˜¯æœºå™¨ï¼‰å¾€å¾€æ— æ³•è·å¾—"æ­£ç¡®ç­”æ¡ˆ"çš„ç›´æ¥æŒ‡å¯¼ï¼Œåªèƒ½é€šè¿‡ä½“éªŒè¡Œä¸ºçš„**åæœ**ï¼ˆå¥–åŠ±æˆ–æƒ©ç½šï¼‰æ¥å­¦ä¹ ã€‚

- **æ ¸å¿ƒæ•°å­¦å·¥å…·**: **åŠ¨æ€è§„åˆ’ (Dynamic Programming)** ä¸ **Bellman æœ€ä¼˜æ€§åŸç†**ã€‚
- **è§£é¢˜é€»è¾‘**:
    1.  **åˆ†è§£**: å°†å¤æ‚çš„é•¿æœŸå†³ç­–é—®é¢˜åˆ†è§£ä¸ºé€’å½’çš„å•æ­¥å†³ç­–å­é—®é¢˜ã€‚
    2.  **å‰ç»**: å½“å‰çš„æœ€ä¼˜é€‰æ‹©ä¸ä»…ä»…å–å†³äºçœ¼å‰çš„æ”¶ç›Šï¼Œè¿˜å¿…é¡»åŒ…å«å¯¹æœªæ¥æ‰€æœ‰å¯èƒ½æ”¶ç›Šçš„æœŸæœ›ï¼ˆå³ä»·å€¼å‡½æ•° $V$ æˆ– $Q$ï¼‰ã€‚
    3.  **è¿­ä»£**: é€šè¿‡ä¸æ–­æ›´æ–°ä»·å€¼ä¼°è®¡ï¼Œæœ€ç»ˆæ”¶æ•›åˆ°æœ€ä¼˜ç­–ç•¥ã€‚

## 1. ä¸ºä»€ä¹ˆ VLA éœ€è¦å¼ºåŒ–å­¦ä¹ ? (Why RL for VLA?)

### 1.1 è¡Œä¸ºå…‹éš† (BC) çš„å±€é™

ä¼ ç»Ÿ VLA ä¸»è¦ä¾èµ– **è¡Œä¸ºå…‹éš† (Behavior Cloning)**ï¼šæ¨¡ä»¿äººç±»æ¼”ç¤ºã€‚

| æ–¹æ³• | ä¼˜ç‚¹ | ç¼ºç‚¹ |
| :--- | :--- | :--- |
| **BC** | ç®€å•ï¼Œæ•°æ®æ•ˆç‡é«˜ | ä¸Šé™æ˜¯äººç±»æ°´å¹³ï¼Œæ— æ³•è¶…è¶Šæ¼”ç¤ºè€… |
| **RL** | å¯ä»¥è¶…è¶Šäººç±»ï¼Œè‡ªæˆ‘è¿›åŒ– | éœ€è¦å¤§é‡äº¤äº’ï¼Œç¨€ç–å¥–åŠ±éš¾ä¼˜åŒ– |

### 1.2 RL åœ¨ VLA ä¸­çš„ä»·å€¼

- **è¶…è¶Šäººç±»ç¤ºæ•™**: é€šè¿‡è‡ªæˆ‘åšå¼ˆ/æ¢ç´¢å‘ç°æ›´ä¼˜ç­–ç•¥
- **é•¿åºåˆ—ä¼˜åŒ–**: BC åªæ¨¡ä»¿æ¯æ­¥åŠ¨ä½œï¼ŒRL ä¼˜åŒ–æ•´ä¸ªè½¨è¿¹çš„ç´¯ç§¯å›æŠ¥
- **é€‚åº”æ€§å­¦ä¹ **: åœ¨çœŸæœºéƒ¨ç½²æ—¶æŒç»­è‡ªæˆ‘æ”¹è¿›
- **ç¨€ç–å¥–åŠ±ä»»åŠ¡**: åªæœ‰ä»»åŠ¡æˆåŠŸæ—¶ç»™å¥–åŠ±çš„åœºæ™¯ï¼ˆå¦‚ç»„è£…ï¼‰

### 1.3 VLA ä¸­çš„ RL åº”ç”¨æ¡ˆä¾‹

- **Ï€*0.6 (Pi-Star)**: ä½¿ç”¨ Recap ç®—æ³•ï¼ˆOffline RLï¼‰è¶…è¶Šäººç±»ç¤ºæ•™
- **RT-2**: ä½¿ç”¨ RL from Human Feedback (RLHF) æ”¹è¿›è¯­ä¹‰æ¨ç†
- **RoboCasa**: ä½¿ç”¨ PPO è®­ç»ƒå®¶åº­æ“ä½œç­–ç•¥

## 2. RL åŸºç¡€æ¦‚å¿µ (RL Fundamentals)

### 2.1 é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ (MDP)

```
MDP = (S, A, P, R, Î³)
```

- **S**: çŠ¶æ€ç©ºé—´ (State Space) - æœºå™¨äººè§‚æµ‹åˆ°çš„ä¸€åˆ‡
- **A**: åŠ¨ä½œç©ºé—´ (Action Space) - å¯æ‰§è¡Œçš„åŠ¨ä½œ
- **P(s'|s,a)**: çŠ¶æ€è½¬ç§»æ¦‚ç‡ - ç¯å¢ƒåŠ¨åŠ›å­¦
- **R(s,a)**: å¥–åŠ±å‡½æ•° - è¡Œä¸ºå¥½åçš„åé¦ˆ
- **Î³**: æŠ˜æ‰£å› å­ - æœªæ¥å¥–åŠ±çš„æƒé‡ (é€šå¸¸ 0.99)

### 2.2 é©¬å°”å¯å¤«æ€§ (Markov Property)

**å®šä¹‰**: ä¸‹ä¸€çŠ¶æ€åªä¾èµ–äºå½“å‰çŠ¶æ€å’ŒåŠ¨ä½œï¼Œä¸å†å²æ— å…³ã€‚

```
P(s_{t+1} | s_t, a_t, s_{t-1}, a_{t-1}, ...) = P(s_{t+1} | s_t, a_t)
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    é©¬å°”å¯å¤«æ€§å›¾è§£                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   éé©¬å°”å¯å¤«:  sâ‚€ â†’ sâ‚ â†’ sâ‚‚ â†’ sâ‚ƒ â†’ sâ‚„                           â”‚
â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                  æ‰€æœ‰å†å²éƒ½å½±å“æœªæ¥                               â”‚
â”‚                                                                 â”‚
â”‚   é©¬å°”å¯å¤«:    sâ‚€ â†’ sâ‚ â†’ sâ‚‚ â†’ sâ‚ƒ â†’ sâ‚„                           â”‚
â”‚                          â””â”€â”€â”€â”˜                                  â”‚
â”‚                    åªæœ‰ sâ‚ƒ å½±å“ sâ‚„                               â”‚
â”‚                                                                 â”‚
â”‚   ğŸ’¡ "å½“å‰çŠ¶æ€æ˜¯å¯¹å†å²çš„å……åˆ†ç»Ÿè®¡é‡"                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¸ºä»€ä¹ˆé‡è¦**:
- **ç®€åŒ–è®¡ç®—**: ä¸éœ€è¦è®°å¿†æ•´ä¸ªå†å²ï¼Œåªéœ€å½“å‰çŠ¶æ€
- **Bellman æ–¹ç¨‹æˆç«‹**: ä»·å€¼å‡½æ•°å¯ä»¥é€’å½’å®šä¹‰
- **å®é™…åº”ç”¨**: æœºå™¨äººçŠ¶æ€é€šå¸¸åŒ…å«ä½ç½®+é€Ÿåº¦ï¼Œæ»¡è¶³é©¬å°”å¯å¤«æ€§ï¼›è‹¥åªæœ‰ä½ç½®åˆ™ä¸æ»¡è¶³

### 2.3 æ ¸å¿ƒç›®æ ‡

æœ€å¤§åŒ–**ç´¯ç§¯æŠ˜æ‰£å›æŠ¥ (Cumulative Discounted Return)**:

```
G_t = Î£_{k=0}^{âˆ} Î³^k Ã— R_{t+k+1}
```

### 2.4 ä»·å€¼å‡½æ•° (Value Functions)

**çŠ¶æ€ä»·å€¼å‡½æ•° (State Value)**:

```
V^Ï€(s) = E_Ï€[ G_t | S_t = s ]
```

**åŠ¨ä½œä»·å€¼å‡½æ•° (Action Value / Q-Function)**:

```
Q^Ï€(s, a) = E_Ï€[ G_t | S_t = s, A_t = a ]
```

**Bellman æ–¹ç¨‹**:

```
Q^Ï€(s, a) = R(s, a) + Î³ Ã— E_{s' ~ P}[ V^Ï€(s') ]
```

### 2.5 æœ€ä¼˜ä»·å€¼å‡½æ•°ä¸æœ€ä¼˜ç­–ç•¥

**æœ€ä¼˜ä»·å€¼å‡½æ•°**:

```
V*(s) = max_Ï€ V^Ï€(s)
Q*(s, a) = max_Ï€ Q^Ï€(s, a)
```

**æœ€ä¼˜ç­–ç•¥**:

```
Ï€*(s) = argmax_a Q*(s, a)
```

**ä¸ºä»€ä¹ˆæœ€ä¼˜ä»·å€¼å‡½æ•°å°±æ˜¯æœ€ä¼˜ç­–ç•¥ï¼Ÿ**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                æœ€ä¼˜ä»·å€¼å‡½æ•° â†” æœ€ä¼˜ç­–ç•¥                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   æ ¸å¿ƒå®šç†: ç»™å®š Q*(s, a)ï¼Œæœ€ä¼˜ç­–ç•¥å¯ç›´æ¥å¯¼å‡º                    â”‚
â”‚                                                                 â”‚
â”‚   Ï€*(s) = argmax_a Q*(s, a)                                     â”‚
â”‚                                                                 â”‚
â”‚   è¯æ˜æ€è·¯:                                                     â”‚
â”‚   1. Q*(s,a) è¡¨ç¤ºåœ¨çŠ¶æ€ s æ‰§è¡ŒåŠ¨ä½œ a åï¼ŒæŒ‰æœ€ä¼˜ç­–ç•¥è¡ŒåŠ¨çš„æœŸæœ›å›æŠ¥ â”‚
â”‚   2. è¦æœ€å¤§åŒ–å›æŠ¥ï¼Œåªéœ€åœ¨æ¯ä¸ªçŠ¶æ€é€‰æ‹© Q* æœ€å¤§çš„åŠ¨ä½œ              â”‚
â”‚   3. è¿™æ­£æ˜¯è´ªå¿ƒç­–ç•¥ï¼Œè€Œå¯¹äº Q* è´ªå¿ƒå°±æ˜¯æœ€ä¼˜çš„                    â”‚
â”‚                                                                 â”‚
â”‚   åè¿‡æ¥:                                                       â”‚
â”‚   ç»™å®šæœ€ä¼˜ç­–ç•¥ Ï€*ï¼Œå¯ä»¥è®¡ç®—å‡º Q*(s,a) = Q^{Ï€*}(s,a)             â”‚
â”‚                                                                 â”‚
â”‚   ğŸ’¡ æœ€ä¼˜ä»·å€¼å‡½æ•°å’Œæœ€ä¼˜ç­–ç•¥æ˜¯"ä¸€ä½“ä¸¤é¢"                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ•°å­¦æ¨å¯¼**:
1. **Bellman æœ€ä¼˜æ–¹ç¨‹**: `V*(s) = max_a [ R(s,a) + Î³ Ã— Î£_{s'} P(s'|s,a) Ã— V*(s') ]`
2. å¦‚æœæˆ‘ä»¬çŸ¥é“ `V*`ï¼Œåˆ™æœ€ä¼˜åŠ¨ä½œæ˜¯ä½¿ä¸Šå¼å–æœ€å¤§å€¼çš„ `a`
3. è¿™ç­‰ä»·äº `Ï€*(s) = argmax_a Q*(s,a)`

### 2.6 ç­–ç•¥ (Policy)

ç­–ç•¥ `Ï€(a|s)` å®šä¹‰äº†åœ¨çŠ¶æ€ `s` ä¸‹é‡‡å–åŠ¨ä½œ `a` çš„æ¦‚ç‡ã€‚

- **ç¡®å®šæ€§ç­–ç•¥**: `a = Ï€(s)`
- **éšæœºç­–ç•¥**: `a ~ Ï€(Â·|s)`

## 3. RL ç®—æ³•åˆ†ç±» (RL Algorithm Taxonomy)

```
                        RL ç®—æ³•
                           â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚               â”‚               â”‚
      Model-Free      Model-Based    Offline RL
           â”‚               â”‚               â”‚
     â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”         â”‚          â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
     â”‚           â”‚         â”‚          â”‚         â”‚
 Value-Based  Policy-Based â”‚       CQL/IQL   Recap
     â”‚           â”‚         â”‚
   DQN/SAC   PPO/TRPO   Dreamer/MBPO
```

### 3.1 Model-Free vs Model-Based

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Model-Free vs Model-Based                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   Model-Free (æ— æ¨¡å‹):                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  Agent â†â”€â”€â”€â”€ äº¤äº’ â”€â”€â”€â”€â†’ Environment                     â”‚   â”‚
â”‚   â”‚    â”‚                         â”‚                          â”‚   â”‚
â”‚   â”‚    â””â”€â”€ ç›´æ¥å­¦ä¹  Ï€ æˆ– Q â”€â”€â”€â”€â”€â”€â”˜                          â”‚   â”‚
â”‚   â”‚        (ä¸å…³å¿ƒç¯å¢ƒå¦‚ä½•å·¥ä½œ)                              â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚   ä»£è¡¨: DQN, PPO, SAC                                           â”‚
â”‚   ç‰¹ç‚¹: ç®€å•ç›´æ¥ï¼Œä½†éœ€è¦å¤§é‡äº¤äº’æ•°æ®                            â”‚
â”‚                                                                 â”‚
â”‚   Model-Based (åŸºäºæ¨¡å‹):                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  Agent â†â”€â”€â”€â”€ äº¤äº’ â”€â”€â”€â”€â†’ Environment                     â”‚   â”‚
â”‚   â”‚    â”‚                         â”‚                          â”‚   â”‚
â”‚   â”‚    â”œâ”€â”€ å­¦ä¹ ç¯å¢ƒæ¨¡å‹ P(s'|s,a) â”˜                         â”‚   â”‚
â”‚   â”‚    â”‚                                                    â”‚   â”‚
â”‚   â”‚    â””â”€â”€ åœ¨æ¨¡å‹ä¸­è§„åˆ’/æ¨¡æ‹Ÿ â”€â”€â†’ ç­–ç•¥                       â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚   ä»£è¡¨: Dreamer, MBPO, MuZero                                   â”‚
â”‚   ç‰¹ç‚¹: æ ·æœ¬é«˜æ•ˆï¼Œä½†æ¨¡å‹è¯¯å·®ä¼šç´¯ç§¯                              â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| ç±»å‹ | åŸç† | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
| :--- | :--- | :--- | :--- | :--- |
| **Model-Free** | ç›´æ¥å­¦ä¹ ç­–ç•¥/ä»·å€¼ | ç®€å•ï¼Œæ— æ¨¡å‹åå·® | æ ·æœ¬æ•ˆç‡ä½ | çœŸæœºäº¤äº’æˆæœ¬ä½ |
| **Model-Based** | å­¦ä¹ ç¯å¢ƒåŠ¨åŠ›å­¦ $P(s'|s,a)$ | æ ·æœ¬æ•ˆç‡é«˜ | æ¨¡å‹è¯¯å·®ç´¯ç§¯ | ä»¿çœŸç¯å¢ƒã€Sim-to-Real |

**å…³é”®åŒºåˆ«**:
- **Model-Free**: ä¸å°è¯•ç†è§£ç¯å¢ƒå¦‚ä½•å·¥ä½œï¼Œåªå…³å¿ƒ"ä»€ä¹ˆåŠ¨ä½œèƒ½è·å¾—é«˜å›æŠ¥"
- **Model-Based**: å…ˆå­¦ä¹ ç¯å¢ƒçš„"è§„åˆ™"ï¼ˆçŠ¶æ€è½¬ç§»ï¼‰ï¼Œå†åˆ©ç”¨è§„åˆ™è¿›è¡Œè§„åˆ’

**VLA ä¸­çš„åº”ç”¨**:
- **Model-Free**: Ï€0.6 çš„ Recap ç®—æ³•ï¼ˆç›´æ¥ä»æ•°æ®å­¦ä¹ ç­–ç•¥ï¼‰
- **Model-Based**: ä¸–ç•Œæ¨¡å‹ (World Model) ç”¨äºé¢„æµ‹æœªæ¥çŠ¶æ€ï¼Œè¾…åŠ©è§„åˆ’

### 3.2 ç­–ç•¥è¿­ä»£ vs å€¼è¿­ä»£ (Policy Iteration vs Value Iteration)

ä¸¤ç§ç»å…¸çš„åŠ¨æ€è§„åˆ’ç®—æ³•ï¼Œç”¨äºæ±‚è§£ MDPã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ç­–ç•¥è¿­ä»£ vs å€¼è¿­ä»£                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   ç­–ç•¥è¿­ä»£ (Policy Iteration):                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  åˆå§‹åŒ– Ï€â‚€                                               â”‚   â”‚
â”‚   â”‚      â”‚                                                   â”‚   â”‚
â”‚   â”‚      â–¼                                                   â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚   â”‚
â”‚   â”‚  â”‚ ç­–ç•¥è¯„ä¼° (PE)    â”‚ â† è®¡ç®— V^Ï€ (è¿­ä»£è‡³æ”¶æ•›)            â”‚   â”‚
â”‚   â”‚  â”‚ V^Ï€(s) = E[...]  â”‚                                    â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚   â”‚
â”‚   â”‚           â”‚                                              â”‚   â”‚
â”‚   â”‚           â–¼                                              â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚   â”‚
â”‚   â”‚  â”‚ ç­–ç•¥æ”¹è¿› (PI)    â”‚ â† Ï€(s) = argmax_a Q(s,a)           â”‚   â”‚
â”‚   â”‚  â”‚ Ï€ â† greedy(V)    â”‚                                    â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚   â”‚
â”‚   â”‚           â”‚                                              â”‚   â”‚
â”‚   â”‚           â””â”€â”€â”€â”€ é‡å¤ç›´åˆ° Ï€ ä¸å†å˜åŒ– â”€â”€â”€â”€â”˜                â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚   å€¼è¿­ä»£ (Value Iteration):                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  åˆå§‹åŒ– Vâ‚€                                               â”‚   â”‚
â”‚   â”‚      â”‚                                                   â”‚   â”‚
â”‚   â”‚      â–¼                                                   â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚   â”‚  â”‚ V(s) â† max_a [R(s,a) + Î³ Î£ P(s'|s,a) V(s')]      â”‚   â”‚   â”‚
â”‚   â”‚  â”‚       (Bellman æœ€ä¼˜æ–¹ç¨‹çš„è¿­ä»£æ›´æ–°)                â”‚   â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚   â”‚           â”‚                                              â”‚   â”‚
â”‚   â”‚           â””â”€â”€â”€â”€ é‡å¤ç›´åˆ° V æ”¶æ•› â”€â”€â”€â”€â”˜                    â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚  æœ€å: Ï€(s) = argmax_a Q(s,a)                            â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| å¯¹æ¯” | ç­–ç•¥è¿­ä»£ | å€¼è¿­ä»£ |
| :--- | :--- | :--- |
| **æ ¸å¿ƒæ“ä½œ** | è¯„ä¼° + æ”¹è¿›äº¤æ›¿ | ç›´æ¥è¿­ä»£ Bellman æœ€ä¼˜æ–¹ç¨‹ |
| **æ¯è½®è®¡ç®—** | ç­–ç•¥è¯„ä¼°éœ€è¿­ä»£è‡³æ”¶æ•› | åªåšä¸€æ¬¡ Bellman æ›´æ–° |
| **æ”¶æ•›é€Ÿåº¦** | è¿­ä»£æ¬¡æ•°å°‘ | æ¯è½®è®¡ç®—é‡å° |
| **æ€»ä½“æ•ˆç‡** | å¤§çŠ¶æ€ç©ºé—´æ›´å¿« | å°çŠ¶æ€ç©ºé—´æ›´å¿« |
| **ç­–ç•¥è¾“å‡º** | æ¯è½®éƒ½æœ‰æ˜¾å¼ç­–ç•¥ | æœ€åæ‰æå–ç­–ç•¥ |

**ç›´è§‰ç†è§£**:
- **ç­–ç•¥è¿­ä»£**: "å…ˆå®Œæ•´è¯„ä¼°å½“å‰ç­–ç•¥æœ‰å¤šå¥½ï¼Œå†æ”¹è¿›"
- **å€¼è¿­ä»£**: "ç›´æ¥æœæœ€ä¼˜ä»·å€¼å‡½æ•°è¿­ä»£ï¼Œæœ€åå†æå–ç­–ç•¥"

### 3.3 On-Policy vs Off-Policy

| ç±»å‹ | ä»£è¡¨ç®—æ³• | ç‰¹ç‚¹ |
| :--- | :--- | :--- |
| **On-Policy** | PPO, TRPO | åªç”¨å½“å‰ç­–ç•¥çš„æ•°æ®ï¼Œç¨³å®šä½†ä½æ•ˆ |
| **Off-Policy** | SAC, TD3 | å¯å¤ç”¨å†å²æ•°æ®ï¼Œé«˜æ•ˆä½†ä¸ç¨³å®š |

## 4. VLA å¸¸ç”¨ RL ç®—æ³• (RL Algorithms for VLA)

### 4.1 PPO (Proximal Policy Optimization)

**æ ¸å¿ƒæ€æƒ³**: é™åˆ¶ç­–ç•¥æ›´æ–°å¹…åº¦ï¼Œé˜²æ­¢è®­ç»ƒå´©æºƒã€‚

**ç›®æ ‡å‡½æ•°**:

```
L_CLIP(Î¸) = E_t[ min( r_t(Î¸) Ã— Ã‚_t, clip(r_t(Î¸), 1-Îµ, 1+Îµ) Ã— Ã‚_t ) ]
```

å…¶ä¸­ `r_t(Î¸) = Ï€_Î¸(a_t|s_t) / Ï€_{Î¸_old}(a_t|s_t)` æ˜¯é‡è¦æ€§é‡‡æ ·æ¯”ç‡ã€‚

```python
import torch
import torch.nn as nn
import torch.nn.functional as F

class PPO:
    def __init__(self, policy, value_net, clip_epsilon=0.2, lr=3e-4):
        self.policy = policy
        self.value_net = value_net
        self.clip_epsilon = clip_epsilon
        self.optimizer = torch.optim.Adam(
            list(policy.parameters()) + list(value_net.parameters()), lr=lr
        )
    
    def compute_gae(self, rewards, values, dones, gamma=0.99, lam=0.95):
        """Generalized Advantage Estimation"""
        advantages = []
        gae = 0
        for t in reversed(range(len(rewards))):
            if t == len(rewards) - 1:
                next_value = 0
            else:
                next_value = values[t + 1]
            
            delta = rewards[t] + gamma * next_value * (1 - dones[t]) - values[t]
            gae = delta + gamma * lam * (1 - dones[t]) * gae
            advantages.insert(0, gae)
        
        return torch.tensor(advantages)
    
    def update(self, states, actions, old_log_probs, rewards, dones):
        # è®¡ç®—ä»·å€¼å’Œä¼˜åŠ¿
        values = self.value_net(states).squeeze()
        advantages = self.compute_gae(rewards, values.detach(), dones)
        returns = advantages + values.detach()
        
        # å½’ä¸€åŒ–ä¼˜åŠ¿
        advantages = (advantages - advantages.mean()) / (advantages.std() + 1e-8)
        
        # PPO æ›´æ–°
        for _ in range(10):  # å¤šè½®æ›´æ–°
            # è®¡ç®—æ–°çš„ log_prob
            dist = self.policy(states)
            new_log_probs = dist.log_prob(actions)
            
            # é‡è¦æ€§é‡‡æ ·æ¯”ç‡
            ratio = torch.exp(new_log_probs - old_log_probs)
            
            # Clipped ç›®æ ‡
            surr1 = ratio * advantages
            surr2 = torch.clamp(ratio, 1 - self.clip_epsilon, 1 + self.clip_epsilon) * advantages
            policy_loss = -torch.min(surr1, surr2).mean()
            
            # ä»·å€¼æŸå¤±
            value_loss = F.mse_loss(self.value_net(states).squeeze(), returns)
            
            # ç†µæ­£åˆ™åŒ– (é¼“åŠ±æ¢ç´¢)
            entropy = dist.entropy().mean()
            
            # æ€»æŸå¤±
            loss = policy_loss + 0.5 * value_loss - 0.01 * entropy
            
            self.optimizer.zero_grad()
            loss.backward()
            self.optimizer.step()
```

### 4.2 SAC (Soft Actor-Critic)

**æ ¸å¿ƒæ€æƒ³**: æœ€å¤§åŒ–å¥–åŠ±çš„åŒæ—¶æœ€å¤§åŒ–ç­–ç•¥ç†µï¼ˆé¼“åŠ±æ¢ç´¢ï¼‰ã€‚

**ç›®æ ‡**:

```
J(Ï€) = E_{Ï„ ~ Ï€}[ Î£_t R(s_t, a_t) + Î± Ã— H(Ï€(Â·|s_t)) ]
```

```python
class SAC:
    def __init__(self, actor, critic1, critic2, target_critic1, target_critic2, 
                 alpha=0.2, gamma=0.99, tau=0.005):
        self.actor = actor
        self.critic1 = critic1
        self.critic2 = critic2
        self.target_critic1 = target_critic1
        self.target_critic2 = target_critic2
        self.alpha = alpha  # ç†µç³»æ•°
        self.gamma = gamma
        self.tau = tau
    
    def update(self, batch):
        states, actions, rewards, next_states, dones = batch
        
        # ===== Critic æ›´æ–° =====
        with torch.no_grad():
            # ä»å½“å‰ç­–ç•¥é‡‡æ ·ä¸‹ä¸€ä¸ªåŠ¨ä½œ
            next_actions, next_log_probs = self.actor.sample(next_states)
            
            # ç›®æ ‡ Q å€¼ (å–ä¸¤ä¸ª critic çš„æœ€å°å€¼)
            target_q1 = self.target_critic1(next_states, next_actions)
            target_q2 = self.target_critic2(next_states, next_actions)
            target_q = torch.min(target_q1, target_q2) - self.alpha * next_log_probs
            
            # TD ç›®æ ‡
            target = rewards + self.gamma * (1 - dones) * target_q
        
        # å½“å‰ Q å€¼
        current_q1 = self.critic1(states, actions)
        current_q2 = self.critic2(states, actions)
        
        critic_loss = F.mse_loss(current_q1, target) + F.mse_loss(current_q2, target)
        
        # ===== Actor æ›´æ–° =====
        new_actions, log_probs = self.actor.sample(states)
        q1 = self.critic1(states, new_actions)
        q2 = self.critic2(states, new_actions)
        q = torch.min(q1, q2)
        
        # æœ€å¤§åŒ– Q - Î± * log_prob
        actor_loss = (self.alpha * log_probs - q).mean()
        
        # ===== è½¯æ›´æ–°ç›®æ ‡ç½‘ç»œ =====
        self.soft_update(self.critic1, self.target_critic1)
        self.soft_update(self.critic2, self.target_critic2)
        
        return critic_loss, actor_loss
    
    def soft_update(self, source, target):
        for src_param, tgt_param in zip(source.parameters(), target.parameters()):
            tgt_param.data.copy_(self.tau * src_param.data + (1 - self.tau) * tgt_param.data)
```

### 4.3 Offline RL (ç¦»çº¿å¼ºåŒ–å­¦ä¹ )

**æ ¸å¿ƒé—®é¢˜**: åªæœ‰å›ºå®šçš„å†å²æ•°æ®é›†ï¼Œæ— æ³•ä¸ç¯å¢ƒäº¤äº’ã€‚

**æŒ‘æˆ˜**: åˆ†å¸ƒåç§» (Distribution Shift) - ç­–ç•¥å¯èƒ½é€‰æ‹©æ•°æ®é›†ä¸­æ²¡è§è¿‡çš„åŠ¨ä½œã€‚

#### 4.3.1 CQL (Conservative Q-Learning)

**æ€æƒ³**: ä¿å®ˆä¼°è®¡ Q å€¼ï¼Œæƒ©ç½šæ•°æ®é›†å¤–çš„åŠ¨ä½œã€‚

```
L_CQL = Î± Ã— E_{s ~ D}[ log Î£_a exp(Q(s,a)) - E_{a ~ D}[Q(s,a)] ] + L_TD
```

#### 4.3.2 IQL (Implicit Q-Learning)

**æ€æƒ³**: ä½¿ç”¨åˆ†ä½æ•°å›å½’é¿å…æ˜¾å¼æœ€å¤§åŒ– Qã€‚

#### 4.3.3 Recap (Ï€*0.6 çš„æ ¸å¿ƒç®—æ³•)

+**æ€æƒ³**: ä»æˆåŠŸå’Œå¤±è´¥çš„è½¨è¿¹ä¸­å­¦ä¹ ï¼ˆè¯¦ç»†æœºåˆ¶å¯å‚è€ƒ [pi0_6_dissection.md](./pi0_6_dissection.md) ä¸­çš„ Recap è§£æï¼‰ã€‚

```python
class RecapAlgorithm:
    """Ï€*0.6 çš„ Recap ç¦»çº¿ RL ç®—æ³•"""
    def __init__(self, policy, value_net):
        self.policy = policy
        self.value_net = value_net
    
    def label_trajectories(self, trajectories):
        """æ ‡æ³¨è½¨è¿¹: æˆåŠŸ vs å¤±è´¥"""
        labeled = []
        for traj in trajectories:
            success = traj['final_reward'] > 0  # ä»»åŠ¡æ˜¯å¦æˆåŠŸ
            for t, transition in enumerate(traj['transitions']):
                # å…³é”®: æ‰¾åˆ°å¤±è´¥è½¨è¿¹ä¸­"å¼€å§‹å‡ºé”™"çš„æ—¶åˆ»
                if not success and self.is_critical_failure(traj, t):
                    transition['label'] = 'negative'  # è´Ÿæ ·æœ¬
                elif success:
                    transition['label'] = 'positive'  # æ­£æ ·æœ¬
                labeled.append(transition)
        return labeled
    
    def is_critical_failure(self, traj, t):
        """åˆ¤æ–­æ˜¯å¦æ˜¯å¯¼è‡´å¤±è´¥çš„å…³é”®æ—¶åˆ»"""
        # ä½¿ç”¨ä»·å€¼å‡½æ•°ä¼°è®¡: å¦‚æœ V éª¤é™ï¼Œè¯´æ˜è¿™æ­¥å‡ºé”™äº†
        v_t = self.value_net(traj['states'][t])
        v_t1 = self.value_net(traj['states'][t+1])
        return (v_t - v_t1) > threshold
    
    def update(self, labeled_data):
        """å¯¹æ¯”å­¦ä¹ : æå‡æ­£æ ·æœ¬æ¦‚ç‡ï¼Œé™ä½è´Ÿæ ·æœ¬æ¦‚ç‡"""
        loss = 0
        for sample in labeled_data:
            state, action = sample['state'], sample['action']
            log_prob = self.policy.log_prob(state, action)
            
            if sample['label'] == 'positive':
                loss -= log_prob  # æå‡æ­£æ ·æœ¬æ¦‚ç‡
            else:
                loss += log_prob  # é™ä½è´Ÿæ ·æœ¬æ¦‚ç‡
        
        return loss / len(labeled_data)
```

## 5. å¥–åŠ±è®¾è®¡ (Reward Engineering)

### 5.1 ç¨€ç–å¥–åŠ± vs ç¨ å¯†å¥–åŠ±

| ç±»å‹ | ç¤ºä¾‹ | ä¼˜ç‚¹ | ç¼ºç‚¹ |
| :--- | :--- | :--- | :--- |
| **ç¨€ç–** | ä»»åŠ¡æˆåŠŸ +1ï¼Œå¦åˆ™ 0 | ä¸éœ€è¦äººå·¥è®¾è®¡ | éš¾ä»¥å­¦ä¹  |
| **ç¨ å¯†** | è·ç¦»ç›®æ ‡è¶Šè¿‘å¥–åŠ±è¶Šé«˜ | å­¦ä¹ å®¹æ˜“ | å¯èƒ½å¯¼è‡´å±€éƒ¨æœ€ä¼˜ |

### 5.2 å¥–åŠ±è®¾è®¡ç¤ºä¾‹

```python
def compute_reward(state, action, next_state, task_type="pick_and_place"):
    """æœºå™¨äººæ“ä½œä»»åŠ¡çš„å¥–åŠ±å‡½æ•°"""
    
    if task_type == "pick_and_place":
        gripper_pos = state['gripper_position']
        object_pos = state['object_position']
        target_pos = state['target_position']
        
        # é˜¶æ®µ 1: æ¥è¿‘ç‰©ä½“
        dist_to_object = np.linalg.norm(gripper_pos - object_pos)
        
        # é˜¶æ®µ 2: æŠ“å–ç‰©ä½“
        is_grasping = state['gripper_closed'] and dist_to_object < 0.02
        
        # é˜¶æ®µ 3: ç§»åŠ¨åˆ°ç›®æ ‡
        if is_grasping:
            dist_to_target = np.linalg.norm(object_pos - target_pos)
        else:
            dist_to_target = 1.0  # æƒ©ç½šæ²¡æŠ“åˆ°ç‰©ä½“
        
        # ç»„åˆå¥–åŠ±
        reward = -0.1 * dist_to_object  # æ¥è¿‘ç‰©ä½“
        reward += 0.5 * is_grasping     # æŠ“å–å¥–åŠ±
        reward -= 0.1 * dist_to_target  # æ¥è¿‘ç›®æ ‡
        
        # ç¨€ç–æˆåŠŸå¥–åŠ±
        if dist_to_target < 0.05 and is_grasping:
            reward += 10.0  # ä»»åŠ¡æˆåŠŸ
        
        return reward
```

### 5.3 å¥–åŠ±å¡‘å½¢ (Reward Shaping)

```python
def shaped_reward(state, next_state, potential_func, gamma=0.99):
    """
    åŸºäºåŠ¿å‡½æ•°çš„å¥–åŠ±å¡‘å½¢ (ä¸æ”¹å˜æœ€ä¼˜ç­–ç•¥)
    F(s, s') = Î³ * Î¦(s') - Î¦(s)
    """
    phi_s = potential_func(state)
    phi_s_next = potential_func(next_state)
    shaping = gamma * phi_s_next - phi_s
    return shaping
```

## 6. RL + VLA çš„ç»“åˆ (RL + VLA Integration)

### 6.1 RLHF å®Œæ•´æµç¨‹ (RLHF Pipeline)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    RLHF ä¸‰é˜¶æ®µæµç¨‹                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   é˜¶æ®µ 1: SFT (Supervised Fine-Tuning)                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  é¢„è®­ç»ƒæ¨¡å‹ + é«˜è´¨é‡æ•°æ® â†’ åŸºç¡€ç­–ç•¥ Ï€_SFT                 â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â”‚                                      â”‚
â”‚                          â–¼                                      â”‚
â”‚   é˜¶æ®µ 2: Reward Model Training                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  æ”¶é›†äººç±»åå¥½ (A > B) â†’ è®­ç»ƒå¥–åŠ±æ¨¡å‹ R(s, a)              â”‚   â”‚
â”‚   â”‚  Loss: -log Ïƒ(R(y_w) - R(y_l))  (Bradley-Terry)          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â”‚                                      â”‚
â”‚                          â–¼                                      â”‚
â”‚   é˜¶æ®µ 3: RL Fine-tuning (PPO)                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  ä½¿ç”¨ R(s, a) ä½œä¸ºå¥–åŠ±ï¼ŒPPO ä¼˜åŒ–ç­–ç•¥                      â”‚   â”‚
â”‚   â”‚  + KL æƒ©ç½š: é˜²æ­¢åç¦» Ï€_SFT å¤ªè¿œ                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚   éœ€è¦åŒæ—¶åŠ è½½: Ï€_SFT (å‚è€ƒ), Ï€_Î¸ (è®­ç»ƒ), R (å¥–åŠ±), V (ä»·å€¼)    â”‚
â”‚   æ˜¾å­˜éœ€æ±‚: 4 ä¸ªæ¨¡å‹ â†’ éå¸¸æ˜‚è´µ!                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```python
class RLHF_VLA:
    """ä½¿ç”¨äººç±»åé¦ˆå¼ºåŒ–å­¦ä¹ æ”¹è¿› VLA"""
    def __init__(self, vla_model, reward_model):
        self.vla = vla_model
        self.reward_model = reward_model  # ä»äººç±»åå¥½è®­ç»ƒ
    
    def collect_comparisons(self, states, num_samples=2):
        """æ”¶é›†äººç±»åå¥½æ¯”è¾ƒ"""
        actions = [self.vla.sample(states) for _ in range(num_samples)]
        # äººç±»é€‰æ‹©æ›´å¥½çš„åŠ¨ä½œ
        human_preference = get_human_preference(states, actions)
        return actions, human_preference
    
    def train_reward_model(self, comparisons):
        """ä»åå¥½æ•°æ®è®­ç»ƒå¥–åŠ±æ¨¡å‹"""
        for (action_win, action_lose, state) in comparisons:
            r_win = self.reward_model(state, action_win)
            r_lose = self.reward_model(state, action_lose)
            
            # Bradley-Terry æ¨¡å‹
            loss = -torch.log(torch.sigmoid(r_win - r_lose))
            loss.backward()
    
    def rl_finetune(self, states):
        """ä½¿ç”¨å­¦åˆ°çš„å¥–åŠ±è¿›è¡Œ RL å¾®è°ƒ"""
        actions = self.vla.sample(states)
        rewards = self.reward_model(states, actions)
        
        # PPO æ›´æ–°
        self.ppo_update(states, actions, rewards)
```

### 6.2 ä»æ¼”ç¤ºåˆå§‹åŒ– RL (Demo-Guided RL)

```python
class DemoGuidedRL:
    """ç»“åˆ BC é¢„è®­ç»ƒå’Œ RL å¾®è°ƒ"""
    def __init__(self, policy):
        self.policy = policy
    
    def phase1_bc_pretrain(self, demonstrations):
        """Phase 1: è¡Œä¸ºå…‹éš†é¢„è®­ç»ƒ"""
        for state, action in demonstrations:
            pred_action = self.policy(state)
            loss = F.mse_loss(pred_action, action)
            loss.backward()
    
    def phase2_rl_finetune(self, env, num_episodes=1000):
        """Phase 2: RL å¾®è°ƒè¶…è¶Šæ¼”ç¤º"""
        for episode in range(num_episodes):
            state = env.reset()
            while not done:
                action = self.policy.sample(state)
                next_state, reward, done, _ = env.step(action)
                
                # å­˜å‚¨ç»éªŒ
                self.buffer.add(state, action, reward, next_state, done)
                state = next_state
            
            # SAC/PPO æ›´æ–°
            self.rl_update()
```

## 7. GR-RL: VLA + RL èåˆæ¡†æ¶æ¡ˆä¾‹ (ByteDance Seed)

> **GR-RL**: å­—èŠ‚è·³åŠ¨ Seed å›¢é˜Ÿ 2025 å¹´å‘å¸ƒçš„æœºå™¨äººå­¦ä¹ æ¡†æ¶ï¼Œä¸“ä¸º**é•¿æ—¶ç¨‹ã€çµå·§ã€é«˜ç²¾åº¦æ“ä½œ**è®¾è®¡ã€‚
> [[å®˜ç½‘](https://seed.bytedance.com/en/gr_rl)]

### 7.1 æ ¸å¿ƒæ´å¯Ÿ

GR-RL æ­ç¤ºäº†ä¸€ä¸ªè¢«è¡Œä¸šé•¿æœŸå¿½ç•¥çš„äº‹å®ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               GR-RL è§£å†³çš„ä¸‰å¤§æ ¸å¿ƒé—®é¢˜                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   é—®é¢˜ 1: æ¼”ç¤ºæ•°æ®æœ‰å™ªå£°                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  äººç±»æ¼”ç¤ºä¸­å­˜åœ¨å¤±è¯¯ï¼ˆé‹å¸¦æ»‘è„±ã€åå¤å°è¯•ï¼‰                  â”‚   â”‚
â”‚   â”‚  ç›´æ¥å–‚ç»™æ¨¡å‹ â†’ å­¦ä¼š"æ€ä¹ˆçŠ¯é”™"                           â”‚   â”‚
â”‚   â”‚  ğŸ’¡ è§£å†³: Offline RL Critic ç­›é€‰é«˜è´¨é‡æ•°æ®                â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚   é—®é¢˜ 2: è®­ç»ƒ-éƒ¨ç½²ä¸ä¸€è‡´                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  è®­ç»ƒ: è¾“å‡º"åŸå§‹åŠ¨ä½œ"                                    â”‚   â”‚
â”‚   â”‚  éƒ¨ç½²: æ‰§è¡Œ"å¹³æ»‘åå¤„ç†åŠ¨ä½œ"                              â”‚   â”‚
â”‚   â”‚  ğŸ’¡ è§£å†³: åœ¨çº¿ RL å¯¹é½ï¼ˆæ½œåœ¨ç©ºé—´æ¢ç´¢ï¼‰                    â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚   é—®é¢˜ 3: æ•°æ®é‡æœ‰é™                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  é«˜ç²¾åº¦ä»»åŠ¡çš„æ¼”ç¤ºæ•°æ®é‡‡é›†æˆæœ¬é«˜                           â”‚   â”‚
â”‚   â”‚  ğŸ’¡ è§£å†³: å½¢æ€å¯¹ç§°æ€§å¢å¼ºï¼ˆé•œåƒç¿»è½¬æ•°æ®ç¿»å€ï¼‰              â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 æ¨¡å‹æ¶æ„

GR-RL é‡‡ç”¨ **Mixture-of-Transformer (MoT)** æ··åˆæ¶æ„ï¼Œæ€»å‚æ•°é‡ **50 äº¿**ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GR-RL æ¶æ„ (5B å‚æ•°)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚              VLA Policy (Ï€)                              â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚   Vision Encoder â”€â”€â”                                     â”‚   â”‚
â”‚   â”‚                    â”‚                                     â”‚   â”‚
â”‚   â”‚   Language Encoder â”œâ”€â”€â†’ MoT Backbone â”€â”€â†’ Action Head     â”‚   â”‚
â”‚   â”‚                    â”‚                                     â”‚   â”‚
â”‚   â”‚   State Encoder â”€â”€â”€â”˜                                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                            â”‚                                    â”‚
â”‚                            â”‚ å…±äº«ç‰¹å¾                           â”‚
â”‚                            â–¼                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚           Multi-task Critic (ä»»åŠ¡è¿›åº¦è¯„ä¼°)               â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚   è¾“å…¥: (state, action, task_embedding)                  â”‚   â”‚
â”‚   â”‚   è¾“å‡º: ä»»åŠ¡è¿›åº¦å€¼ V(s) âˆˆ [0, 1]                         â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚   åŠŸèƒ½:                                                  â”‚   â”‚
â”‚   â”‚   â€¢ è¯„ä¼°æ¯ä¸€æ­¥å¯¹æ•´ä½“ä»»åŠ¡çš„è´¡çŒ®                           â”‚   â”‚
â”‚   â”‚   â€¢ è¿›å±•å¿« â†’ å€¼é«˜ï¼›å‡ºé”™ â†’ å€¼éª¤é™                        â”‚   â”‚
â”‚   â”‚   â€¢ ç”¨äºç­›é€‰"éæœ€ä¼˜æ•°æ®"                                â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.3 å¤šé˜¶æ®µè®­ç»ƒæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 GR-RL ä¸‰é˜¶æ®µè®­ç»ƒæµç¨‹                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   é˜¶æ®µ 1: æ¼”ç¤ºè½¨è¿¹ç­›é€‰ (Offline RL Critic)                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  åŸå§‹æ¼”ç¤ºæ•°æ® (å«å¤±è¯¯)                                   â”‚   â”‚
â”‚   â”‚        â”‚                                                 â”‚   â”‚
â”‚   â”‚        â–¼                                                 â”‚   â”‚
â”‚   â”‚  Critic è¯„ä¼°æ¯æ­¥è¿›åº¦å€¼ V(s)                              â”‚   â”‚
â”‚   â”‚        â”‚                                                 â”‚   â”‚
â”‚   â”‚        â”œâ”€â”€ V éª¤é™ â†’ æ ‡è®°ä¸º"å¤±è´¥æ—¶åˆ»"â†’ å‰”é™¤              â”‚   â”‚
â”‚   â”‚        â”‚                                                 â”‚   â”‚
â”‚   â”‚        â””â”€â”€ V ç¨³æ­¥ä¸Šå‡ â†’ ä¿ç•™ä¸ºé«˜è´¨é‡æ•°æ®                 â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â”‚                                      â”‚
â”‚                          â–¼                                      â”‚
â”‚   é˜¶æ®µ 2: å½¢æ€å¯¹ç§°æ€§å¢å¼º (Data Augmentation)                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  å¯¹ç­›é€‰åçš„æ•°æ®è¿›è¡Œé•œåƒç¿»è½¬:                             â”‚   â”‚
â”‚   â”‚  â€¢ å›¾åƒæ°´å¹³ç¿»è½¬ + å·¦å³æ‰‹è§†è§’äº¤æ¢                         â”‚   â”‚
â”‚   â”‚  â€¢ çŠ¶æ€/åŠ¨ä½œåœ¨ä¸–ç•Œåæ ‡ç³»é•œåƒå˜æ¢                         â”‚   â”‚
â”‚   â”‚  â€¢ è¯­è¨€æŒ‡ä»¤ç©ºé—´æè¿°è°ƒæ•´ ("å·¦è¾¹" â†’ "å³è¾¹")               â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚  æ•ˆæœ: æ•°æ®é‡ç¿»å€ï¼Œæ— éœ€é¢å¤–é‡‡é›†æˆæœ¬                      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â”‚                                      â”‚
â”‚                          â–¼                                      â”‚
â”‚   é˜¶æ®µ 3: åœ¨çº¿å¼ºåŒ–å­¦ä¹ ä¼˜åŒ– (Online RL Alignment)                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  é—®é¢˜: è®­ç»ƒæ—¶è¾“å‡º â‰  éƒ¨ç½²æ—¶æ‰§è¡Œçš„åŠ¨ä½œ                     â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚  æ–¹æ¡ˆ: åœ¨æ‰©æ•£æ¨¡å‹çš„æ½œåœ¨å™ªå£°ç©ºé—´ä¸­è¿›è¡Œç»“æ„åŒ–æ¢ç´¢          â”‚   â”‚
â”‚   â”‚        (ä¸åœ¨åŸå§‹åŠ¨ä½œç©ºé—´ç›²ç›®åŠ å™ªå£°)                       â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚  æ•ˆæœ: å¼¥åˆè®­ç»ƒ-éƒ¨ç½²é¸¿æ²Ÿï¼Œç¨³å®šé•¿æ—¶ç¨‹ç²¾ç»†æ“ä½œ             â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.4 Critic è¿›åº¦è¯„ä¼°åŸç†

```python
class TaskProgressCritic:
    """GR-RL çš„ä»»åŠ¡è¿›åº¦è¯„ä¼°å™¨"""
    def __init__(self, encoder, threshold=0.3):
        self.encoder = encoder  # å…±äº« VLA ç¼–ç å™¨
        self.value_head = nn.Linear(hidden_dim, 1)
        self.threshold = threshold  # è¿›åº¦éª¤é™é˜ˆå€¼
    
    def forward(self, state, task_embedding):
        """è¯„ä¼°å½“å‰çŠ¶æ€çš„ä»»åŠ¡è¿›åº¦"""
        features = self.encoder(state, task_embedding)
        progress = torch.sigmoid(self.value_head(features))  # [0, 1]
        return progress
    
    def filter_demonstrations(self, trajectory):
        """ç­›é€‰é«˜è´¨é‡æ¼”ç¤ºæ•°æ®"""
        filtered = []
        for t in range(len(trajectory) - 1):
            v_t = self.forward(trajectory[t]['state'], trajectory[t]['task'])
            v_t1 = self.forward(trajectory[t+1]['state'], trajectory[t+1]['task'])
            
            progress_drop = v_t - v_t1
            
            if progress_drop > self.threshold:
                # è¿›åº¦éª¤é™ â†’ å¤±è´¥æ—¶åˆ»ï¼Œå‰”é™¤
                print(f"âš ï¸ æ£€æµ‹åˆ°å¤±è´¥æ—¶åˆ» t={t}, drop={progress_drop:.2f}")
                continue
            
            filtered.append(trajectory[t])
        
        return filtered
```

### 7.5 ä¸å…¶ä»– VLA æ–¹æ³•å¯¹æ¯”

| æ–¹æ³• | æ ¸å¿ƒæ€è·¯ | æ•°æ®åˆ©ç”¨ | åœ¨çº¿å­¦ä¹  | ç²¾ç»†æ“ä½œ |
| :--- | :--- | :--- | :--- | :--- |
| **BC (ä¼ ç»Ÿ VLA)** | çº¯æ¨¡ä»¿ | ä¸ç­›é€‰ | âŒ | å—é™ |
| **Ï€0.6 (Recap)** | Offline RL ç­›é€‰ | âœ… ç­›é€‰ | âŒ | ä¸­ç­‰ |
| **GR-RL** | Offline + Online RL | âœ… ç­›é€‰ + å¢å¼º | âœ… | âœ… é«˜ç²¾åº¦ |

### 7.6 GR-RL çš„"é€šæ‰è½¬ä¸“å®¶"èŒƒå¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               GR-RL "é€šæ‰è½¬ä¸“å®¶" æ–¹æ³•è®º                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   Step 1: é€šæ‰é¢„è®­ç»ƒ (å¦‚ GR-3, 40B VLA)                         â”‚
â”‚           æ³›åŒ–ã€æ–°ç¯å¢ƒé€‚åº”ã€åŸºç¡€æ“ä½œèƒ½åŠ›                         â”‚
â”‚                    â”‚                                            â”‚
â”‚                    â–¼                                            â”‚
â”‚   Step 2: ä¸“å®¶å¾®è°ƒ (GR-RL)                                      â”‚
â”‚           â€¢ RL Critic ç­›é€‰é«˜è´¨é‡ä¸“å®¶æ•°æ®                        â”‚
â”‚           â€¢ å½¢æ€å¯¹ç§°å¢å¼ºæå‡æ³›åŒ–                                â”‚
â”‚           â€¢ åœ¨çº¿ RL å¯¹é½éƒ¨ç½²å·®å¼‚                                â”‚
â”‚                    â”‚                                            â”‚
â”‚                    â–¼                                            â”‚
â”‚   Step 3: é«˜ç²¾åº¦ä»»åŠ¡ (å¦‚ç©¿é‹å¸¦)                                 â”‚
â”‚           é•¿æ—¶ç¨‹ã€çµå·§ã€é«˜ç²¾åº¦æ“ä½œ                               â”‚
â”‚                                                                 â”‚
â”‚   ğŸ’¡ æ ¸å¿ƒ: RL ä¸æ˜¯æ›¿ä»£ BCï¼Œè€Œæ˜¯"æçº¯" + "å¯¹é½"                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.7 é¢è¯• Q&A

**Q1: GR-RL ä¸ Ï€0.6 çš„ Recap æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ**

A:
| å¯¹æ¯” | Ï€0.6 Recap | GR-RL |
| :--- | :--- | :--- |
| **æ•°æ®ç­›é€‰** | åŸºäºæˆåŠŸ/å¤±è´¥æ ‡ç­¾ | åŸºäºè¿›åº¦å€¼éª¤é™æ£€æµ‹ |
| **åœ¨çº¿å­¦ä¹ ** | âŒ çº¯ Offline | âœ… Offline + Online |
| **æ¢ç´¢ç©ºé—´** | - | æ‰©æ•£æ¨¡å‹æ½œåœ¨ç©ºé—´ |
| **æ•°æ®å¢å¼º** | æ—  | å½¢æ€å¯¹ç§°é•œåƒ |

**Q2: ä¸ºä»€ä¹ˆåœ¨æ½œåœ¨å™ªå£°ç©ºé—´æ¢ç´¢è€Œä¸æ˜¯åŠ¨ä½œç©ºé—´ï¼Ÿ**

A:
- **åŠ¨ä½œç©ºé—´å™ªå£°**: å¯èƒ½äº§ç”Ÿä¸åˆç†åŠ¨ä½œï¼ˆå¦‚å…³èŠ‚è¶…é™ï¼‰
- **æ½œåœ¨ç©ºé—´å™ªå£°**: ç»“æ„åŒ–ï¼Œä¿æŒåŠ¨ä½œè¯­ä¹‰åˆç†æ€§
- **æ•ˆç‡**: æ½œåœ¨ç©ºé—´ç»´åº¦ä½ï¼Œæ¢ç´¢æ•ˆç‡æ›´é«˜

**Q3: GR-RL çš„å±€é™æ€§æ˜¯ä»€ä¹ˆï¼Ÿ**

A:
- **å®éªŒæ¡ä»¶**: è®ºæ–‡ä¸­é‹å­”å¤„äº"ç†æƒ³çŠ¶æ€"ï¼ŒçœŸå®åœºæ™¯æ›´å¤æ‚
- **æ³›åŒ–æ€§**: å¯¹æœªè§è¿‡çš„ç‰©ä½“/åœºæ™¯ä»éœ€éªŒè¯
- **è®¡ç®—æˆæœ¬**: 50B å‚æ•° + åœ¨çº¿ RL è®­ç»ƒæˆæœ¬é«˜

## 8. é¢è¯•é«˜é¢‘é—®é¢˜ (Q&A)

**Q1: VLA ä¸­ BC å’Œ RL å¦‚ä½•å–èˆ?**

A:
- **ä¼˜å…ˆ BC**: æ•°æ®å……è¶³ã€ä»»åŠ¡ç®€å•ã€éœ€è¦å¿«é€Ÿè¿­ä»£
- **å¼•å…¥ RL**: éœ€è¦è¶…è¶Šäººç±»ã€é•¿åºåˆ—ä¼˜åŒ–ã€ç¨€ç–å¥–åŠ±ä»»åŠ¡
- **æœ€ä½³å®è·µ**: BC é¢„è®­ç»ƒ + RL å¾®è°ƒ (å¦‚ Ï€*0.6)

**Q2: Offline RL å’Œ Online RL çš„æ ¸å¿ƒåŒºåˆ«?**

A:
- **Online RL**: å¯ä»¥ä¸ç¯å¢ƒäº¤äº’ï¼Œæ¢ç´¢æ–°çŠ¶æ€
- **Offline RL**: åªæœ‰å›ºå®šæ•°æ®é›†ï¼Œéœ€è¦å¤„ç†åˆ†å¸ƒåç§»
- **VLA ç°çŠ¶**: å› ä¸ºçœŸæœºäº¤äº’æˆæœ¬é«˜ï¼ŒOffline RL æ›´å®ç”¨

**Q3: SAC ä¸­æ¸©åº¦å‚æ•° Î± çš„ä½œç”¨?**

A:
- **Î± å¤§**: æ›´é‡è§†ç†µ â†’ æ›´å¤šæ¢ç´¢ â†’ ç­–ç•¥æ›´éšæœº
- **Î± å°**: æ›´é‡è§†å¥–åŠ± â†’ æ›´å¤šåˆ©ç”¨ â†’ ç­–ç•¥æ›´ç¡®å®š
- **è‡ªåŠ¨è°ƒèŠ‚**: å¯ä»¥å°† Î± è®¾ä¸ºå¯å­¦ä¹ å‚æ•°

**Q4: ä¸ºä»€ä¹ˆ PPO æ¯” TRPO æ›´æµè¡Œ?**

A:
- **ç®€å•**: PPO åªéœ€ Clipï¼ŒTRPO éœ€è¦è®¡ç®— Fisher çŸ©é˜µ
- **é«˜æ•ˆ**: PPO å¯ä»¥ç”¨ SGDï¼ŒTRPO éœ€è¦å…±è½­æ¢¯åº¦
- **æ•ˆæœ**: åœ¨å¤§å¤šæ•°ä»»åŠ¡ä¸Šæ€§èƒ½ç›¸å½“

**Q5: Recap ç®—æ³•ç›¸æ¯”ä¼ ç»Ÿ Offline RL çš„ä¼˜åŠ¿?**

A:
- **åˆ©ç”¨å¤±è´¥æ•°æ®**: ä¼ ç»Ÿæ–¹æ³•åªæ¨¡ä»¿æˆåŠŸè½¨è¿¹ï¼ŒRecap ä»å¤±è´¥ä¸­å­¦ä¹ 
- **å…³é”®æ—¶åˆ»è¯†åˆ«**: é€šè¿‡ä»·å€¼å‡½æ•°å®šä½"å‡ºé”™ç‚¹"
- **ç®€å•é«˜æ•ˆ**: ä¸éœ€è¦å¤æ‚çš„çº¦æŸä¼˜åŒ–

**Q6: RLHF çš„åŸºæœ¬æµç¨‹æ˜¯ä»€ä¹ˆï¼Ÿä¸ DPO çš„å·®å¼‚æ˜¯ä»€ä¹ˆï¼Ÿ**

A: **RLHF ä¸‰é˜¶æ®µæµç¨‹**:
1. **SFT**: åœ¨é«˜è´¨é‡æ•°æ®ä¸Šç›‘ç£å¾®è°ƒï¼Œå¾—åˆ°åŸºç¡€ç­–ç•¥ $\pi_{SFT}$
2. **Reward Model**: ä»äººç±»åå¥½æ•°æ®è®­ç»ƒå¥–åŠ±æ¨¡å‹ $R(s, a)$
3. **RL (PPO)**: ä½¿ç”¨ $R$ ä½œä¸ºå¥–åŠ±ï¼ŒPPO ä¼˜åŒ–ç­–ç•¥ï¼ŒåŠ  KL æƒ©ç½šé˜²æ­¢åç¦» $\pi_{SFT}$

**DPO (Direct Preference Optimization)** çš„å·®å¼‚:
- **è·³è¿‡ Reward Model**: ç›´æ¥ä»åå¥½æ•°æ®ä¼˜åŒ–ç­–ç•¥
- **æ•°å­¦æ¨å¯¼**: å°† RL ç›®æ ‡é‡å‚æ•°åŒ–ä¸ºåˆ†ç±»é—®é¢˜

```
L_DPO = -E[ log Ïƒ( Î² Ã— log(Ï€_Î¸(y_w|x) / Ï€_ref(y_w|x)) - Î² Ã— log(Ï€_Î¸(y_l|x) / Ï€_ref(y_l|x)) ) ]
```

| å¯¹æ¯” | RLHF | DPO |
| :--- | :--- | :--- |
| **é˜¶æ®µæ•°** | 3 é˜¶æ®µ | 1 é˜¶æ®µ |
| **æ¨¡å‹æ•°** | 4 ä¸ª (Ï€, Ï€_ref, R, V) | 2 ä¸ª (Ï€, Ï€_ref) |
| **ç¨³å®šæ€§** | PPO æ˜“å´© | æ›´ç¨³å®š |
| **è®¡ç®—é‡** | é«˜ | ä½ |
| **æ•ˆæœ** | ç•¥ä¼˜ (ç†è®ºä¸Š) | æ¥è¿‘ RLHF |

## 9. ä¸»æµ RL æ¡†æ¶ (RL Frameworks)

### 8.1 æ¡†æ¶å¯¹æ¯”

| æ¡†æ¶ | å®šä½ | ä¼˜åŠ¿ | é€‚ç”¨åœºæ™¯ |
| :--- | :--- | :--- | :--- |
| **Stable Baselines3** | æ˜“ç”¨ã€ç¨³å®š | æ–‡æ¡£å®Œå–„ï¼ŒAPI ç®€æ´ | å¿«é€Ÿå®éªŒã€æ•™å­¦ |
| **RLlib** | åˆ†å¸ƒå¼ã€å¯æ‰©å±• | Ray ç”Ÿæ€ï¼Œå¤š GPU/èŠ‚ç‚¹ | å¤§è§„æ¨¡è®­ç»ƒ |
| **CleanRL** | å•æ–‡ä»¶å®ç° | ä»£ç æ¸…æ™°ï¼Œæ˜“äºä¿®æ”¹ | å­¦ä¹ ã€ç ”ç©¶ |
| **TorchRL** | PyTorch å®˜æ–¹ | ä¸ PyTorch æ·±åº¦é›†æˆ | ç”Ÿäº§çº§åº”ç”¨ |
| **SKRL** | Isaac Lab é›†æˆ | GPU å¹¶è¡Œï¼Œæœºå™¨äººä¸“ç”¨ | æœºå™¨äºº RL |

### 8.2 Stable Baselines3 (SB3)

**ç‰¹ç‚¹**: æœ€æ˜“ä¸Šæ‰‹çš„ RL åº“ï¼ŒAPI è®¾è®¡ä¼˜é›…ã€‚

```python
## Stable Baselines3 å¿«é€Ÿä¸Šæ‰‹
from stable_baselines3 import PPO, SAC, TD3
from stable_baselines3.common.env_util import make_vec_env
from stable_baselines3.common.callbacks import EvalCallback

## åˆ›å»ºå‘é‡åŒ–ç¯å¢ƒ
env = make_vec_env("Pendulum-v1", n_envs=4)

## åˆ›å»ºæ¨¡å‹
model = PPO(
    "MlpPolicy",
    env,
    learning_rate=3e-4,
    n_steps=2048,
    batch_size=64,
    n_epochs=10,
    gamma=0.99,
    verbose=1,
    tensorboard_log="./logs/"
)

## è®­ç»ƒ
model.learn(total_timesteps=100_000, callback=EvalCallback(env))

## ä¿å­˜/åŠ è½½
model.save("ppo_pendulum")
model = PPO.load("ppo_pendulum")

## æ¨ç†
obs = env.reset()
for _ in range(1000):
    action, _ = model.predict(obs, deterministic=True)
    obs, reward, done, info = env.step(action)
```

**è‡ªå®šä¹‰ç½‘ç»œ**:

```python
from stable_baselines3.common.torch_layers import BaseFeaturesExtractor
import torch.nn as nn

class CustomCNN(BaseFeaturesExtractor):
    """è‡ªå®šä¹‰ CNN ç‰¹å¾æå–å™¨ (ç”¨äºå›¾åƒè¾“å…¥)"""
    def __init__(self, observation_space, features_dim=256):
        super().__init__(observation_space, features_dim)
        n_input_channels = observation_space.shape[0]
        self.cnn = nn.Sequential(
            nn.Conv2d(n_input_channels, 32, kernel_size=8, stride=4),
            nn.ReLU(),
            nn.Conv2d(32, 64, kernel_size=4, stride=2),
            nn.ReLU(),
            nn.Conv2d(64, 64, kernel_size=3, stride=1),
            nn.ReLU(),
            nn.Flatten(),
        )
        # è®¡ç®—è¾“å‡ºç»´åº¦
        with torch.no_grad():
            n_flatten = self.cnn(torch.zeros(1, *observation_space.shape)).shape[1]
        self.linear = nn.Linear(n_flatten, features_dim)
    
    def forward(self, observations):
        return self.linear(self.cnn(observations))

## ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œ
policy_kwargs = dict(
    features_extractor_class=CustomCNN,
    features_extractor_kwargs=dict(features_dim=256),
)
model = PPO("CnnPolicy", env, policy_kwargs=policy_kwargs)
```

### 8.3 RLlib (Ray)

**ç‰¹ç‚¹**: åˆ†å¸ƒå¼è®­ç»ƒé¦–é€‰ï¼Œæ”¯æŒå¤š GPU/å¤šèŠ‚ç‚¹ã€‚

```python
## RLlib åˆ†å¸ƒå¼è®­ç»ƒ
from ray import tune
from ray.rllib.algorithms.ppo import PPOConfig

## é…ç½®
config = (
    PPOConfig()
    .environment("CartPole-v1")
    .framework("torch")
    .rollouts(
        num_rollout_workers=4,      # å¹¶è¡Œ worker æ•°
        num_envs_per_worker=2,      # æ¯ä¸ª worker çš„ç¯å¢ƒæ•°
    )
    .training(
        lr=5e-5,
        gamma=0.99,
        train_batch_size=4000,
        sgd_minibatch_size=128,
        num_sgd_iter=30,
        model={"fcnet_hiddens": [256, 256]},
    )
    .resources(
        num_gpus=1,                  # è®­ç»ƒç”¨ GPU
        num_cpus_per_worker=1,
    )
)

## è®­ç»ƒ
algo = config.build()
for i in range(100):
    result = algo.train()
    print(f"Iter {i}: reward = {result['episode_reward_mean']:.2f}")

## æˆ–ä½¿ç”¨ Ray Tune è¿›è¡Œè¶…å‚æœç´¢
tune.run(
    "PPO",
    config=config.to_dict(),
    stop={"episode_reward_mean": 200},
    num_samples=4,  # å¹¶è¡Œæœç´¢ 4 ç»„è¶…å‚
)
```

**å¤šæ™ºèƒ½ä½“ RL**:

```python
## RLlib å¤šæ™ºèƒ½ä½“
from ray.rllib.algorithms.ppo import PPOConfig

config = (
    PPOConfig()
    .environment("MultiAgentCartPole")
    .multi_agent(
        policies={"policy_0", "policy_1"},
        policy_mapping_fn=lambda agent_id, episode, **kwargs: f"policy_{agent_id}",
    )
)
```

### 8.4 SKRL (Isaac Lab é›†æˆ)

**ç‰¹ç‚¹**: ä¸“ä¸º Isaac Lab è®¾è®¡ï¼ŒGPU å¹¶è¡Œè®­ç»ƒã€‚

```python
## SKRL + Isaac Lab
from skrl.agents.torch.ppo import PPO, PPO_DEFAULT_CONFIG
from skrl.trainers.torch import SequentialTrainer
from skrl.envs.wrappers.torch import wrap_env

## åŒ…è£… Isaac Lab ç¯å¢ƒ
env = wrap_env(isaac_lab_env)

## é…ç½®
cfg = PPO_DEFAULT_CONFIG.copy()
cfg["rollouts"] = 16
cfg["learning_epochs"] = 8
cfg["mini_batches"] = 4
cfg["discount_factor"] = 0.99
cfg["lambda"] = 0.95
cfg["learning_rate"] = 3e-4

## åˆ›å»º Agent
agent = PPO(
    models={"policy": policy_net, "value": value_net},
    memory=memory,
    cfg=cfg,
    observation_space=env.observation_space,
    action_space=env.action_space,
)

## è®­ç»ƒ
trainer = SequentialTrainer(cfg=trainer_cfg, env=env, agents=agent)
trainer.train()
```

### 8.5 æ¡†æ¶é€‰æ‹©æŒ‡å—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    RL æ¡†æ¶é€‰æ‹©å†³ç­–æ ‘                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   Q1: æ˜¯å¦éœ€è¦åˆ†å¸ƒå¼è®­ç»ƒ (å¤š GPU/å¤šèŠ‚ç‚¹)?                        â”‚
â”‚       â”‚                                                         â”‚
â”‚       â”œâ”€â”€ æ˜¯ â†’ RLlib (Ray ç”Ÿæ€ï¼Œåˆ†å¸ƒå¼é¦–é€‰)                     â”‚
â”‚       â”‚                                                         â”‚
â”‚       â””â”€â”€ å¦ â†’ Q2: æ˜¯å¦ä½¿ç”¨ Isaac Lab?                          â”‚
â”‚                    â”‚                                            â”‚
â”‚                    â”œâ”€â”€ æ˜¯ â†’ SKRL (å®˜æ–¹æ¨è)                     â”‚
â”‚                    â”‚                                            â”‚
â”‚                    â””â”€â”€ å¦ â†’ Q3: ç›®æ ‡æ˜¯ä»€ä¹ˆ?                     â”‚
â”‚                                 â”‚                               â”‚
â”‚                                 â”œâ”€â”€ å¿«é€Ÿå®éªŒ â†’ SB3              â”‚
â”‚                                 â”œâ”€â”€ å­¦ä¹ ç ”ç©¶ â†’ CleanRL          â”‚
â”‚                                 â””â”€â”€ ç”Ÿäº§éƒ¨ç½² â†’ TorchRL          â”‚
â”‚                                                                 â”‚
â”‚   ğŸ’¡ VLA å¸¸ç”¨ç»„åˆ:                                              â”‚
â”‚   â€¢ ä»¿çœŸè®­ç»ƒ: Isaac Lab + SKRL/RSL-RL                           â”‚
â”‚   â€¢ å¤§è§„æ¨¡: RLlib + Ray Cluster                                 â”‚
â”‚   â€¢ å¿«é€ŸéªŒè¯: SB3 + Gymnasium                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.6 TORCS ä¸è‡ªåŠ¨é©¾é©¶ RL

**TORCS** (The Open Racing Car Simulator) æ˜¯ç»å…¸çš„è‡ªåŠ¨é©¾é©¶ RL æµ‹è¯•å¹³å°ã€‚

```python
## TORCS ç¯å¢ƒä½¿ç”¨ (gym_torcs)
import gym
import gym_torcs

env = gym.make("Torcs-v0", vision=True, throttle=True)

## è§‚æµ‹ç©ºé—´: è½¦è¾†çŠ¶æ€ + å¯é€‰è§†è§‰
## - speed, angle, trackPos, track sensors (19)
## - å¯é€‰: RGB å›¾åƒ (64x64x3)

## åŠ¨ä½œç©ºé—´: [steering, throttle, brake]
## - steering: [-1, 1]
## - throttle: [0, 1]
## - brake: [0, 1]

obs = env.reset()
for _ in range(1000):
    action = agent.act(obs)  # ä½ çš„ç­–ç•¥
    obs, reward, done, info = env.step(action)
    if done:
        obs = env.reset()
```

**æ³¨**: TORCS ä¸»è¦ç”¨äºè‡ªåŠ¨é©¾é©¶ç ”ç©¶ï¼ŒVLA æœºå™¨äººé¢†åŸŸæ›´å¸¸ç”¨ Isaac Lab/MuJoCoã€‚

## 10. LIBERO ç»ˆèº«å­¦ä¹ åŸºå‡† (Lifelong Learning Benchmark)

> **LIBERO**: Benchmarking Knowledge Transfer for Lifelong Robot Learning [[GitHub](https://github.com/Lifelong-Robot-Learning/LIBERO)] [[Paper](https://arxiv.org/abs/2306.03310)]

### 9.1 ä¸ºä»€ä¹ˆå…³æ³¨ LIBERO?

- **ä¸»æµåŸºå‡†**: å¤šä»»åŠ¡ / ç»ˆèº«å­¦ä¹  / çŸ¥è¯†è¿ç§»ç ”ç©¶é»˜è®¤å¼•ç”¨çš„æ•°æ®ä¸ä»»åŠ¡é›†
- **ä»»åŠ¡è¦†ç›–å…¨é¢**: æä¾›å—æ§åˆ†å¸ƒåç§» (Spatial / Object / Goal) ä¸ entangled ä»»åŠ¡ (LIBERO-100)
- **å¼€ç®±å³ç”¨**: æ‰“åŒ…ç¤ºèŒƒæ•°æ®ã€è¯„æµ‹è„šæœ¬ã€ç­–ç•¥ç½‘ç»œ (BC-RNN / BC-Transformer / BC-ViLT) ä¸ç®—æ³• (baseã€ERã€EWCã€PackNetã€Multitask)
- **å¯æ‰©å±•**: Procedural generation pipeline æ”¯æŒç”Ÿæˆæ›´å¤š manipulation ä»»åŠ¡ï¼Œæ–¹ä¾¿è‡ªå®šä¹‰ç ”ç©¶

### 9.2 ä»»åŠ¡å¥—ä»¶æ€»è§ˆ

| å¥—ä»¶ | ä»»åŠ¡æ•° | è¿ç§»æŒ‘æˆ˜ | è¯´æ˜ |
| :--- | :--- | :--- | :--- |
| **LIBERO-Spatial** | 30 | ç©ºé—´å…³ç³» | ç›¸åŒç‰©ä½“ï¼Œä¸åŒç©ºé—´å¸ƒç½® |
| **LIBERO-Object** | 30 | ç‰©ä½“ç±»å‹ | ä¸åŒç‰©ä½“å±æ€§ï¼Œè€ƒéªŒè¯­ä¹‰+æŠ“å–æ³›åŒ– |
| **LIBERO-Goal** | 30 | ç›®æ ‡å˜åŒ– | åŒåœºæ™¯ï¼Œå¤šç›®æ ‡ç»„åˆ |
| **LIBERO-100** | 100 | æ··åˆ (Entangled) | æ‹†æˆ **LIBERO-90** (é¢„è®­ç»ƒ) + **LIBERO-10** (ç»ˆèº«å­¦ä¹ æµ‹è¯•) |

### 9.3 æ•°æ®ä¸ç¯å¢ƒ

```bash
## ç¯å¢ƒå®‰è£…
conda create -n libero python=3.8.13
conda activate libero
git clone https://github.com/Lifelong-Robot-Learning/LIBERO.git
cd LIBERO
pip install -r requirements.txt
pip install torch==1.11.0+cu113 torchvision==0.12.0+cu113 \
            torchaudio==0.11.0 --extra-index-url https://download.pytorch.org/whl/cu113
pip install -e .

## ä¸‹è½½ç¤ºèŒƒ (å¯é€‰ --datasets æŒ‡å®šå¥—ä»¶)
python benchmark_scripts/download_libero_datasets.py --use-huggingface
```

### 9.4 è®­ç»ƒ / è¯„æµ‹å…¥å£

```bash
## ç»ˆèº«å­¦ä¹ è®­ç»ƒ
export CUDA_VISIBLE_DEVICES=0
python libero/lifelong/main.py \
    seed=0 \
    benchmark_name=LIBERO_90 \
    policy=bc_transformer_policy \
    lifelong=ewc

## è„±æœºè¯„æµ‹
python libero/lifelong/evaluate.py \
    --benchmark LIBERO_10 \
    --task_id 0 \
    --algo ewc \
    --policy bc_transformer_policy \
    --ep 50 \
    --device_id 0
```

### 9.5 ä¸ VLA çš„ç»“åˆæ–¹å¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                LIBERO + VLA ç»“åˆæµç¨‹                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   1. æ•°æ®å±‚: å¤ç”¨ LIBERO ç¤ºèŒƒè®­ç»ƒ / å¾®è°ƒ VLA çš„ Action Head     â”‚
â”‚                                                                 â”‚
â”‚   2. è¯„æµ‹å±‚: ä½œä¸º"ç»ˆèº«å­¦ä¹ å›å½’æµ‹è¯•é›†"ï¼Œæ£€æŸ¥ Catastrophic        â”‚
â”‚              Forgetting                                         â”‚
â”‚                                                                 â”‚
â”‚   3. è·¨åŸŸè¿ç§»: å…ˆç”¨ LIBERO-90 é¢„è®­ç»ƒï¼Œå†åœ¨ LIBERO-10 /          â”‚
â”‚               è‡ªå®šä¹‰ä»»åŠ¡ â†’ çœŸæœºéªŒè¯ Sim-to-Real                  â”‚
â”‚                                                                 â”‚
â”‚   4. ç®—æ³•ç»„åˆ: å°† RLHF / DPO ç­‰ä¸Šå±‚ä¼˜åŒ–ä¸ EWC / PackNet ç­‰      â”‚
â”‚               åº•å±‚æ­£åˆ™ç»“åˆï¼Œå½¢æˆæ··åˆ pipeline                    â”‚
â”‚                                                                 â”‚
â”‚   ğŸ’¡ é¢è¯•å¸¸é—®: "å¦‚ä½•è¯„ä¼° VLA çš„ç»ˆèº«å­¦ä¹ èƒ½åŠ›ï¼Ÿ"                   â”‚
â”‚      â†’ ä½¿ç”¨ LIBERO-90 é¢„è®­ç»ƒ + LIBERO-10 æµ‹è¯•é—å¿˜ç¨‹åº¦            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.6 é¢è¯• Q&A

**Q: å¦‚ä½•ä½¿ç”¨ LIBERO è¯„ä¼° VLA çš„ç»ˆèº«å­¦ä¹ èƒ½åŠ›ï¼Ÿ**

A:
1. **é¢„è®­ç»ƒ**: åœ¨ LIBERO-90 ä¸Šè®­ç»ƒ VLA ç­–ç•¥
2. **ç»ˆèº«å­¦ä¹ **: åœ¨ LIBERO-10 çš„ 10 ä¸ªä»»åŠ¡ä¸Šé¡ºåºå¾®è°ƒ
3. **è¯„ä¼°é—å¿˜**: æ¯å­¦å®Œä¸€ä¸ªæ–°ä»»åŠ¡åï¼Œæµ‹è¯•æ‰€æœ‰æ—§ä»»åŠ¡çš„æˆåŠŸç‡
4. **å¯¹æ¯”ç®—æ³•**: æ¯”è¾ƒ Sequential Fine-tuning (baseline) vs EWC / PackNet / ER
5. **å…³é”®æŒ‡æ ‡**: Forward Transfer (æ–°ä»»åŠ¡å­¦ä¹ é€Ÿåº¦) + Backward Transfer (æ—§ä»»åŠ¡é—å¿˜ç¨‹åº¦)

## 11. å‚è€ƒèµ„æº (References)

- **PPO**: [Proximal Policy Optimization Algorithms](https://arxiv.org/abs/1707.06347)
- **SAC**: [Soft Actor-Critic: Off-Policy Maximum Entropy Deep RL](https://arxiv.org/abs/1801.01290)
- **CQL**: [Conservative Q-Learning for Offline RL](https://arxiv.org/abs/2006.04779)
- **IQL**: [Offline RL with Implicit Q-Learning](https://arxiv.org/abs/2110.06169)
- **Spinning Up**: [OpenAI Spinning Up in Deep RL](https://spinningup.openai.com/)
- **Stable Baselines3**: [Docs](https://stable-baselines3.readthedocs.io/)
- **RLlib**: [Docs](https://docs.ray.io/en/latest/rllib/)
- **SKRL**: [Docs](https://skrl.readthedocs.io/)

---

\newpage

# ç¬¬12ç«  çŸ¥è¯†è’¸é¦


> **æ ¸å¿ƒæ¦‚å¿µ**: çŸ¥è¯†è’¸é¦ (Knowledge Distillation, KD) æ˜¯ä¸€ç§æ¨¡å‹å‹ç¼©æŠ€æœ¯ï¼Œé€šè¿‡è®©å°æ¨¡å‹ï¼ˆå­¦ç”Ÿï¼‰æ¨¡ä»¿å¤§æ¨¡å‹ï¼ˆæ•™å¸ˆï¼‰çš„è¡Œä¸ºï¼Œå®ç°çŸ¥è¯†çš„è¿ç§»ã€‚åœ¨ VLA é¢†åŸŸï¼ŒçŸ¥è¯†è’¸é¦æ˜¯å®ç°è¾¹ç¼˜ç«¯éƒ¨ç½²çš„å…³é”®æŠ€æœ¯ã€‚

## 0. ä¸»è¦æ•¸å­¸æ€æƒ³ (Main Mathematical Idea)

> **ç¬¬ä¸€æ€§åŸç†**: **Smoothing the Decision Boundary (å†³ç­–è¾¹ç•Œçš„å¹³æ»‘ / Dark Knowledge)**

ä¸€ä¸ª"ç¡¬æ ‡ç­¾"ï¼ˆè¿™å¼ å›¾æ˜¯çŒ«ï¼‰åªåŒ…å« 1 bit ä¿¡æ¯ã€‚ä½†ä¸€ä¸ªæ¨¡å‹çš„é¢„æµ‹åˆ†å¸ƒï¼ˆ90%çŒ«ï¼Œ9%ç‹—ï¼Œ1%è½¦ï¼‰åŒ…å«äº†æå…¶ä¸°å¯Œçš„**ç»“æ„ä¿¡æ¯**ï¼ˆçŒ«å’Œç‹—é•¿å¾—åƒï¼Œå’Œè½¦ä¸åƒï¼‰ã€‚

- **æ ¸å¿ƒæ•°å­¦å·¥å…·**: **KL Divergence (KL æ•£åº¦)** ä¸ **Temperature Scaling (æ¸©åº¦ç¼©æ”¾)**ã€‚
- **è§£é¢˜é€»è¾‘**:
    1.  **æš—çŸ¥è¯† (Dark Knowledge)**: Hinton æŒ‡å‡ºï¼Œæ•™å¸ˆæ¨¡å‹å¯¹é”™è¯¯ç±»åˆ«çš„é¢„æµ‹æ¦‚ç‡å¹¶ééšæœºå™ªå£°ï¼Œè€Œæ˜¯åæ˜ äº†æ•°æ®çš„æµå½¢ç»“æ„ã€‚
    2.  **è½¯åŒ–**: ç›´æ¥åŒ¹é…æ¦‚ç‡åˆ†å¸ƒå¯èƒ½å¤ªå°–é”ï¼ˆæ¢¯åº¦æ¶ˆå¤±ï¼‰ã€‚é€šè¿‡å¼•å…¥æ¸©åº¦å‚æ•° $T$ï¼Œæˆ‘ä»¬"è½¯åŒ–"äº†åˆ†å¸ƒï¼Œæ”¾å¤§äº†ç»†å¾®çš„æ¦‚ç‡å·®å¼‚ï¼Œè¿«ä½¿å­¦ç”Ÿæ¨¡å‹ä¸ä»…å­¦ä¼š"æ˜¯ä»€ä¹ˆ"ï¼Œè¿˜å­¦ä¼š"åƒä»€ä¹ˆ"ã€‚
    3.  **å¯¹é½**: æ•°å­¦æœ¬è´¨æ˜¯æœ€å°åŒ–ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒä¹‹é—´çš„è·ç¦» ($D_{KL}(P || Q)$)ï¼Œä½¿å­¦ç”Ÿæ¨¡å‹çš„æ€ç»´æ–¹å¼ï¼ˆç‰¹å¾ç©ºé—´ç»“æ„ï¼‰è¶‹è¿‘äºæ•™å¸ˆã€‚

## 1. ä¸ºä»€ä¹ˆ VLA éœ€è¦çŸ¥è¯†è’¸é¦? (Why KD for VLA?)

### 1.1 VLA éƒ¨ç½²æŒ‘æˆ˜

| æ¨¡å‹ | å‚æ•°é‡ | æ¨ç†å»¶è¿Ÿ | æ˜¾å­˜éœ€æ±‚ |
| :--- | :--- | :--- | :--- |
| **RT-2 (PaLI-X)** | 55B | ~5s | 100+ GB |
| **OpenVLA** | 7B | ~200ms | 16 GB |
| **ç›®æ ‡ (è¾¹ç¼˜)** | < 1B | < 50ms | < 4 GB |

**ç°å®çº¦æŸ**:
- **å®æ—¶æ€§**: æœºå™¨äººæ§åˆ¶éœ€è¦ 20-50Hz (20-50ms)
- **ç¡¬ä»¶é™åˆ¶**: æœºè½½è®¡ç®—é€šå¸¸åªæœ‰ Jetson Orin (8-32GB)
- **åŠŸè€—**: ç§»åŠ¨æœºå™¨äººå¯¹åŠŸè€—æ•æ„Ÿ

### 1.2 çŸ¥è¯†è’¸é¦çš„ä»·å€¼


$$
\text{å°æ¨¡å‹æ€§èƒ½} + \text{å¤§æ¨¡å‹çŸ¥è¯†} \approx \text{å¤§æ¨¡å‹æ€§èƒ½}
$$


- **æ¨¡å‹å‹ç¼©**: 10x å‚æ•°å‡å°‘ï¼Œæ€§èƒ½æŸå¤± < 10%
- **æ¨ç†åŠ é€Ÿ**: é™ä½å»¶è¿Ÿï¼Œæ»¡è¶³å®æ—¶æ§åˆ¶éœ€æ±‚
- **é™ä½æˆæœ¬**: å‡å°‘éƒ¨ç½²ç¡¬ä»¶éœ€æ±‚

## 2. çŸ¥è¯†è’¸é¦åŸºç¡€ (KD Fundamentals)

### 2.1 åŸºæœ¬æ¡†æ¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Teacher Model (å¤§æ¨¡å‹)                    â”‚
â”‚                    - é¢„è®­ç»ƒå¥½çš„ VLA                          â”‚
â”‚                    - å‚æ•°å†»ç»“                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ Soft Labels / Logits
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Distillation Loss                       â”‚
â”‚              L = Î± * L_hard + (1-Î±) * L_soft                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Student Model (å°æ¨¡å‹)                     â”‚
â”‚                    - ç›®æ ‡éƒ¨ç½²æ¨¡å‹                            â”‚
â”‚                    - å¯è®­ç»ƒ                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 è½¯æ ‡ç­¾ (Soft Labels)

**ç¡¬æ ‡ç­¾ (Hard Labels)**: One-hot å‘é‡ï¼Œåªæœ‰æ­£ç¡®ç±»åˆ«ä¸º 1ã€‚

**è½¯æ ‡ç­¾ (Soft Labels)**: æ•™å¸ˆæ¨¡å‹çš„ softmax æ¦‚ç‡åˆ†å¸ƒã€‚


$$
p_i^{(T)} = \frac{\exp(z_i / T)}{\sum_j \exp(z_j / T)}
$$


å…¶ä¸­ $T$ æ˜¯**æ¸©åº¦å‚æ•°** (Temperature)ï¼š
- **T = 1**: æ­£å¸¸ softmax
- **T > 1**: åˆ†å¸ƒæ›´å¹³æ»‘ï¼Œä¿ç•™æ›´å¤š"æš—çŸ¥è¯†"
- **T â†’ âˆ**: å‡åŒ€åˆ†å¸ƒ

### 2.3 è’¸é¦æŸå¤± (Distillation Loss)

```python
import torch
import torch.nn as nn
import torch.nn.functional as F

class DistillationLoss(nn.Module):
    def __init__(self, temperature=4.0, alpha=0.5):
        super().__init__()
        self.temperature = temperature
        self.alpha = alpha
    
    def forward(self, student_logits, teacher_logits, labels):
        """
        student_logits: å­¦ç”Ÿæ¨¡å‹è¾“å‡º
        teacher_logits: æ•™å¸ˆæ¨¡å‹è¾“å‡º
        labels: çœŸå®æ ‡ç­¾ (ç”¨äºç¡¬æ ‡ç­¾æŸå¤±)
        """
        # ç¡¬æ ‡ç­¾æŸå¤± (ä¸çœŸå®æ ‡ç­¾)
        hard_loss = F.cross_entropy(student_logits, labels)
        
        # è½¯æ ‡ç­¾æŸå¤± (ä¸æ•™å¸ˆ)
        soft_student = F.log_softmax(student_logits / self.temperature, dim=-1)
        soft_teacher = F.softmax(teacher_logits / self.temperature, dim=-1)
        soft_loss = F.kl_div(soft_student, soft_teacher, reduction='batchmean')
        soft_loss = soft_loss * (self.temperature ** 2)  # æ¸©åº¦ç¼©æ”¾
        
        # ç»„åˆæŸå¤±
        total_loss = self.alpha * hard_loss + (1 - self.alpha) * soft_loss
        return total_loss
```

## 3. VLA ä¸­çš„çŸ¥è¯†è’¸é¦ç­–ç•¥ (KD Strategies for VLA)

### 3.1 ç‰¹å¾è’¸é¦ (Feature Distillation)

é™¤äº†è¾“å‡ºå±‚ï¼Œè¿˜è’¸é¦ä¸­é—´ç‰¹å¾ã€‚

```python
class FeatureDistillation(nn.Module):
    def __init__(self, teacher, student, feature_layers):
        super().__init__()
        self.teacher = teacher
        self.student = student
        self.feature_layers = feature_layers
        
        # ç‰¹å¾æŠ•å½±å±‚ (å¯¹é½ç»´åº¦)
        self.projectors = nn.ModuleDict()
        for name in feature_layers:
            t_dim = teacher.get_feature_dim(name)
            s_dim = student.get_feature_dim(name)
            if t_dim != s_dim:
                self.projectors[name] = nn.Linear(s_dim, t_dim)
    
    def forward(self, inputs):
        # è·å–æ•™å¸ˆç‰¹å¾
        with torch.no_grad():
            teacher_features = self.teacher.get_features(inputs, self.feature_layers)
        
        # è·å–å­¦ç”Ÿç‰¹å¾
        student_features = self.student.get_features(inputs, self.feature_layers)
        
        # ç‰¹å¾å¯¹é½æŸå¤±
        feature_loss = 0
        for name in self.feature_layers:
            t_feat = teacher_features[name]
            s_feat = student_features[name]
            
            if name in self.projectors:
                s_feat = self.projectors[name](s_feat)
            
            feature_loss += F.mse_loss(s_feat, t_feat)
        
        return feature_loss / len(self.feature_layers)
```

### 3.2 æ³¨æ„åŠ›è’¸é¦ (Attention Distillation)

è®©å­¦ç”Ÿæ¨¡å‹å­¦ä¹ æ•™å¸ˆçš„æ³¨æ„åŠ›æ¨¡å¼ã€‚

```python
class AttentionDistillation(nn.Module):
    def __init__(self, teacher, student):
        super().__init__()
        self.teacher = teacher
        self.student = student
    
    def forward(self, inputs):
        # è·å–æ³¨æ„åŠ›æƒé‡
        with torch.no_grad():
            _, teacher_attns = self.teacher(inputs, output_attentions=True)
        
        _, student_attns = self.student(inputs, output_attentions=True)
        
        # æ³¨æ„åŠ›å¯¹é½æŸå¤±
        attn_loss = 0
        for t_attn, s_attn in zip(teacher_attns, student_attns):
            # t_attn, s_attn: [B, num_heads, seq_len, seq_len]
            attn_loss += F.mse_loss(s_attn, t_attn)
        
        return attn_loss / len(teacher_attns)
```

### 3.3 åŠ¨ä½œè½¨è¿¹è’¸é¦ (Action Trajectory Distillation)

VLA ç‰¹æœ‰ï¼šè’¸é¦æ•´ä¸ªåŠ¨ä½œåºåˆ—ã€‚

```python
class ActionTrajectoryDistillation(nn.Module):
    """VLA ä¸“ç”¨: è’¸é¦åŠ¨ä½œè½¨è¿¹"""
    def __init__(self, teacher_vla, student_vla, chunk_size=16):
        super().__init__()
        self.teacher = teacher_vla
        self.student = student_vla
        self.chunk_size = chunk_size
    
    def forward(self, obs, instruction):
        """
        obs: è§‚æµ‹ [B, C, H, W]
        instruction: è¯­è¨€æŒ‡ä»¤
        """
        # æ•™å¸ˆç”ŸæˆåŠ¨ä½œè½¨è¿¹
        with torch.no_grad():
            teacher_actions = self.teacher.generate_actions(obs, instruction)
            # teacher_actions: [B, chunk_size, action_dim]
        
        # å­¦ç”Ÿç”ŸæˆåŠ¨ä½œè½¨è¿¹
        student_actions = self.student.generate_actions(obs, instruction)
        
        # è½¨è¿¹çº§åˆ«çš„è’¸é¦æŸå¤±
        trajectory_loss = F.mse_loss(student_actions, teacher_actions)
        
        # å¯é€‰: æ—¶é—´åŠ æƒ (æ›´é‡è§†è¿‘æœŸåŠ¨ä½œ)
        time_weights = torch.exp(-0.1 * torch.arange(self.chunk_size))
        weighted_loss = (trajectory_loss * time_weights.unsqueeze(-1)).mean()
        
        return weighted_loss
```

### 3.4 åˆ†å¸ƒè’¸é¦ (Distribution Distillation)

å¯¹äº Diffusion/Flow Matching ç­–ç•¥ï¼Œè’¸é¦åŠ¨ä½œåˆ†å¸ƒã€‚

```python
class DiffusionDistillation(nn.Module):
    """Diffusion Policy çš„è’¸é¦"""
    def __init__(self, teacher_diffusion, student_diffusion, num_steps=10):
        super().__init__()
        self.teacher = teacher_diffusion
        self.student = student_diffusion
        self.num_steps = num_steps
    
    def forward(self, obs, condition):
        # æ•™å¸ˆé¢„æµ‹çš„å™ªå£°
        with torch.no_grad():
            x_t = torch.randn(obs.shape[0], self.action_dim)
            for t in reversed(range(self.num_steps)):
                teacher_eps = self.teacher.predict_noise(x_t, t, condition)
                x_t = self.ddim_step(x_t, teacher_eps, t)
            teacher_trajectory = x_t
        
        # å­¦ç”Ÿé¢„æµ‹ (ç›´æ¥é¢„æµ‹æœ€ç»ˆè½¨è¿¹ï¼Œä¸€æ­¥åˆ°ä½)
        student_trajectory = self.student(obs, condition)
        
        # è’¸é¦æŸå¤±
        loss = F.mse_loss(student_trajectory, teacher_trajectory)
        return loss
```

## 4. VLA è’¸é¦çš„ç‰¹æ®Šè€ƒè™‘ (Special Considerations)

### 4.1 è§†è§‰ç¼–ç å™¨è’¸é¦

```python
class VisionEncoderDistillation:
    """è’¸é¦è§†è§‰ç¼–ç å™¨: SigLIP (L) â†’ MobileViT (S)"""
    
    def __init__(self, teacher_vision, student_vision):
        self.teacher = teacher_vision  # SigLIP-L (400M)
        self.student = student_vision  # MobileViT (6M)
        
        # CLS token å¯¹é½
        self.cls_projector = nn.Linear(student.embed_dim, teacher.embed_dim)
        
        # Patch token å¯¹é½
        self.patch_projector = nn.Conv1d(student.embed_dim, teacher.embed_dim, 1)
    
    def distill(self, images):
        with torch.no_grad():
            t_cls, t_patches = self.teacher(images)
        
        s_cls, s_patches = self.student(images)
        
        # CLS æŸå¤±
        cls_loss = F.mse_loss(self.cls_projector(s_cls), t_cls)
        
        # Patch æŸå¤± (éœ€è¦å¤„ç†åˆ†è¾¨ç‡ä¸åŒ¹é…)
        t_patches_interp = F.interpolate(t_patches, size=s_patches.shape[-1])
        patch_loss = F.mse_loss(self.patch_projector(s_patches), t_patches_interp)
        
        return cls_loss + 0.5 * patch_loss
```

### 4.2 è¯­è¨€æ¨¡å‹è’¸é¦

```python
class LLMDistillation:
    """è’¸é¦è¯­è¨€æ¨¡å‹: Llama-7B â†’ TinyLlama-1B"""
    
    def __init__(self, teacher_llm, student_llm):
        self.teacher = teacher_llm
        self.student = student_llm
    
    def distill(self, input_ids, attention_mask):
        # æ•™å¸ˆè¾“å‡º
        with torch.no_grad():
            teacher_outputs = self.teacher(
                input_ids=input_ids,
                attention_mask=attention_mask,
                output_hidden_states=True
            )
        
        # å­¦ç”Ÿè¾“å‡º
        student_outputs = self.student(
            input_ids=input_ids,
            attention_mask=attention_mask,
            output_hidden_states=True
        )
        
        # Logit è’¸é¦
        logit_loss = self.soft_cross_entropy(
            student_outputs.logits,
            teacher_outputs.logits,
            temperature=2.0
        )
        
        # éšè—å±‚è’¸é¦ (è·³å±‚å¯¹é½)
        # Teacher 32 å±‚ â†’ Student 12 å±‚, æ¯éš” ~2.7 å±‚å¯¹é½
        layer_mapping = [0, 3, 6, 9, 12, 15, 18, 21, 24, 27, 30, 31]
        hidden_loss = 0
        for s_idx, t_idx in enumerate(layer_mapping):
            t_hidden = teacher_outputs.hidden_states[t_idx]
            s_hidden = student_outputs.hidden_states[s_idx]
            hidden_loss += F.mse_loss(s_hidden, t_hidden)
        
        return logit_loss + 0.1 * hidden_loss
```

### 4.3 å¤šé˜¶æ®µè’¸é¦ (Progressive Distillation)

```python
class ProgressiveDistillation:
    """æ¸è¿›å¼è’¸é¦: é€æ­¥ç¼©å°æ¨¡å‹"""
    
    def __init__(self, teacher, intermediate_sizes=[4B, 2B, 1B]):
        self.teacher = teacher
        self.stages = []
        
        prev_model = teacher
        for size in intermediate_sizes:
            student = create_model(size)
            self.stages.append((prev_model, student))
            prev_model = student
    
    def train(self, data):
        for stage_idx, (teacher, student) in enumerate(self.stages):
            print(f"Stage {stage_idx + 1}: {teacher.num_params}B â†’ {student.num_params}B")
            
            for epoch in range(num_epochs):
                for batch in data:
                    loss = self.distill_step(teacher, student, batch)
                    loss.backward()
                    optimizer.step()
            
            # å†»ç»“å½“å‰å­¦ç”Ÿï¼Œä½œä¸ºä¸‹ä¸€é˜¶æ®µçš„æ•™å¸ˆ
            for param in student.parameters():
                param.requires_grad = False
```

## 5. è’¸é¦ + é‡åŒ–è”åˆä¼˜åŒ– (KD + Quantization)

### 5.1 é‡åŒ–æ„ŸçŸ¥è’¸é¦ (Quantization-Aware Distillation)

```python
class QADistillation:
    """é‡åŒ–æ„ŸçŸ¥è’¸é¦"""
    
    def __init__(self, teacher, student, quant_bits=4):
        self.teacher = teacher
        self.student = student
        self.quant_bits = quant_bits
    
    def forward(self, inputs):
        # æ•™å¸ˆ (FP16)
        with torch.no_grad():
            teacher_out = self.teacher(inputs)
        
        # å­¦ç”Ÿ (æ¨¡æ‹Ÿé‡åŒ–)
        student_out = self.quantized_forward(self.student, inputs)
        
        # è’¸é¦æŸå¤±
        loss = F.mse_loss(student_out, teacher_out)
        return loss
    
    def quantized_forward(self, model, inputs):
        """æ¨¡æ‹Ÿ INT4 é‡åŒ–çš„å‰å‘ä¼ æ’­"""
        # ä¼ªé‡åŒ–: æ¨¡æ‹Ÿé‡åŒ–è¯¯å·®ï¼Œä½†ä¿æŒæ¢¯åº¦å¯ä¼ æ’­
        for name, module in model.named_modules():
            if isinstance(module, nn.Linear):
                # é‡åŒ–æƒé‡
                w = module.weight
                scale = w.abs().max() / (2 ** (self.quant_bits - 1) - 1)
                w_quant = torch.round(w / scale) * scale
                
                # Straight-Through Estimator
                module.weight.data = w + (w_quant - w).detach()
        
        return model(inputs)
```

### 5.2 è’¸é¦åé‡åŒ– (Post-Distillation Quantization)

```python
def post_distillation_quantize(distilled_model, calibration_data, bits=4):
    """è’¸é¦åè¿›è¡Œ PTQ"""
    from transformers import BitsAndBytesConfig
    
    # æ”¶é›†æ¿€æ´»ç»Ÿè®¡
    activations = collect_activations(distilled_model, calibration_data)
    
    # è®¡ç®—é‡åŒ–å‚æ•°
    quant_config = BitsAndBytesConfig(
        load_in_4bit=True,
        bnb_4bit_compute_dtype=torch.float16,
        bnb_4bit_quant_type="nf4",  # NormalFloat4
    )
    
    # é‡åŒ–æ¨¡å‹
    quantized_model = quantize_model(distilled_model, quant_config)
    
    return quantized_model
```

## 6. å®æˆ˜ï¼šOpenVLA è’¸é¦åˆ° 1B æ¨¡å‹

```python
class OpenVLADistillation:
    """å°† OpenVLA (7B) è’¸é¦åˆ° 1B æ¨¡å‹"""
    
    def __init__(self):
        # æ•™å¸ˆ: OpenVLA 7B
        self.teacher = AutoModelForVision2Seq.from_pretrained("openvla/openvla-7b")
        
        # å­¦ç”Ÿ: TinyLlama 1B + MobileViT
        self.student = TinyVLA(
            vision_encoder="mobilevit_small",
            language_model="TinyLlama/TinyLlama-1.1B",
            action_head_dim=7
        )
        
        # è’¸é¦é…ç½®
        self.temperature = 4.0
        self.alpha = 0.7  # è½¯æ ‡ç­¾æƒé‡
    
    def train_step(self, batch):
        images = batch['images']
        instructions = batch['instructions']
        gt_actions = batch['actions']
        
        # æ•™å¸ˆé¢„æµ‹
        with torch.no_grad():
            teacher_actions, teacher_logits = self.teacher(
                images, instructions, return_logits=True
            )
        
        # å­¦ç”Ÿé¢„æµ‹
        student_actions, student_logits = self.student(
            images, instructions, return_logits=True
        )
        
        # å¤šä»»åŠ¡è’¸é¦æŸå¤±
        
        # 1. åŠ¨ä½œè’¸é¦
        action_distill = F.mse_loss(student_actions, teacher_actions)
        
        # 2. Logit è’¸é¦ (å¦‚æœæœ‰è¯­è¨€è¾“å‡º)
        soft_loss = F.kl_div(
            F.log_softmax(student_logits / self.temperature, dim=-1),
            F.softmax(teacher_logits / self.temperature, dim=-1),
            reduction='batchmean'
        ) * (self.temperature ** 2)
        
        # 3. ç¡¬æ ‡ç­¾æŸå¤± (ä¸çœŸå®åŠ¨ä½œ)
        hard_loss = F.mse_loss(student_actions, gt_actions)
        
        # ç»„åˆ
        total_loss = (
            self.alpha * soft_loss + 
            (1 - self.alpha) * hard_loss +
            0.5 * action_distill
        )
        
        return total_loss


## è®­ç»ƒè„šæœ¬
distiller = OpenVLADistillation()
optimizer = torch.optim.AdamW(distiller.student.parameters(), lr=1e-4)

for epoch in range(10):
    for batch in dataloader:
        loss = distiller.train_step(batch)
        
        optimizer.zero_grad()
        loss.backward()
        optimizer.step()

## ä¿å­˜è’¸é¦åçš„å°æ¨¡å‹
distiller.student.save_pretrained("./openvla-1b-distilled")
```

## 7. æ•ˆæœå¯¹æ¯” (Performance Comparison)

| æ¨¡å‹ | å‚æ•°é‡ | å»¶è¿Ÿ (Jetson) | CALVIN æˆåŠŸç‡ | æ˜¾å­˜ |
| :--- | :--- | :--- | :--- | :--- |
| **OpenVLA (Teacher)** | 7B | 500ms | 78% | 16GB |
| **OpenVLA-1B (Distilled)** | 1B | 80ms | 72% | 4GB |
| **OpenVLA-1B + INT4** | 1B | 50ms | 70% | 2GB |
| **ä»å¤´è®­ç»ƒ 1B** | 1B | 80ms | 58% | 4GB |

**ç»“è®º**: è’¸é¦åçš„ 1B æ¨¡å‹æ¯”ä»å¤´è®­ç»ƒæå‡ 14%ï¼

## 8. é¢è¯•é«˜é¢‘é—®é¢˜ (Q&A)

**Q1: æ¸©åº¦å‚æ•° T çš„ä½œç”¨æ˜¯ä»€ä¹ˆ? å¦‚ä½•é€‰æ‹©?**

A:
- **T çš„ä½œç”¨**: è½¯åŒ– softmax åˆ†å¸ƒï¼Œä¿ç•™æ›´å¤š"æš—çŸ¥è¯†"ï¼ˆå¦‚ç›¸ä¼¼ç±»çš„å…³ç³»ï¼‰
- **T å° (1-2)**: åˆ†å¸ƒå°–é”ï¼Œä¿¡æ¯ä¸»è¦æ¥è‡ª top-1 é¢„æµ‹
- **T å¤§ (4-10)**: åˆ†å¸ƒå¹³æ»‘ï¼Œä¿ç•™æ›´å¤šç±»é—´å…³ç³»
- **ç»éªŒå€¼**: VLA ä¸­é€šå¸¸ T=4-6

**Q2: ä¸ºä»€ä¹ˆè’¸é¦æ¯”ä»å¤´è®­ç»ƒå°æ¨¡å‹æ•ˆæœå¥½?**

A:
- **è½¯æ ‡ç­¾ä¿¡æ¯**: åŒ…å«ç±»é—´å…³ç³»ï¼ˆå¦‚"çº¢è‰²è‹¹æœ"å’Œ"ç»¿è‰²è‹¹æœ"æ›´ç›¸ä¼¼ï¼‰
- **æ­£åˆ™åŒ–æ•ˆæœ**: è½¯æ ‡ç­¾æ¯” one-hot æ›´å¹³æ»‘ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆ
- **æ•°æ®æ•ˆç‡**: å°æ¨¡å‹éš¾ä»¥ä»æœ‰é™æ•°æ®å­¦åˆ°å¤æ‚æ¨¡å¼ï¼Œæ•™å¸ˆ"æ€»ç»“"äº†çŸ¥è¯†

**Q3: è’¸é¦ VLA æ—¶åº”è¯¥è’¸é¦å“ªäº›ç»„ä»¶?**

A:
- **å¿…é¡»è’¸é¦**: Logits (è¾“å‡ºåˆ†å¸ƒ)ã€åŠ¨ä½œè½¨è¿¹
- **æ¨èè’¸é¦**: æ³¨æ„åŠ›æƒé‡ã€ä¸­é—´ç‰¹å¾
- **å¯é€‰è’¸é¦**: è§†è§‰ç¼–ç å™¨ç‰¹å¾ï¼ˆå¦‚æœå­¦ç”Ÿç¼–ç å™¨ä¸åŒï¼‰

**Q4: è’¸é¦å’Œé‡åŒ–çš„é¡ºåº?**

A:
- **æ¨è**: å…ˆè’¸é¦ï¼Œå†é‡åŒ–
- **åŸå› **: è’¸é¦ä¿ç•™çŸ¥è¯†ï¼Œé‡åŒ–å‹ç¼©è¡¨ç¤ºï¼›å…ˆé‡åŒ–ä¼šä¸¢å¤±å¤ªå¤šä¿¡æ¯
- **é«˜çº§**: é‡åŒ–æ„ŸçŸ¥è’¸é¦ï¼ˆQADï¼‰ï¼Œåœ¨è’¸é¦æ—¶æ¨¡æ‹Ÿé‡åŒ–è¯¯å·®

**Q5: Self-Distillation æ˜¯ä»€ä¹ˆ?**

A:
- **å®šä¹‰**: æ¨¡å‹è‡ªå·±è’¸é¦è‡ªå·±ï¼ˆæ•™å¸ˆå’Œå­¦ç”Ÿæ˜¯åŒä¸€æ¨¡å‹ï¼‰
- **æ–¹æ³•**: ç”¨æ¨¡å‹çš„å†å² checkpoint ä½œä¸ºæ•™å¸ˆ
- **æ•ˆæœ**: æå‡æ¨¡å‹çš„æ ¡å‡†æ€§ (Calibration)ï¼Œå¸¸ç”¨äºå¤§æ¨¡å‹è®­ç»ƒåæœŸ

## 9. å‚è€ƒèµ„æº (References)

- **Original KD**: [Distilling the Knowledge in a Neural Network](https://arxiv.org/abs/1503.02531)
- **Feature Distillation**: [FitNets: Hints for Thin Deep Nets](https://arxiv.org/abs/1412.6550)
- **Attention Transfer**: [Paying More Attention to Attention](https://arxiv.org/abs/1612.03928)
- **Progressive Distillation**: [On the Efficacy of Knowledge Distillation](https://arxiv.org/abs/1910.01348)

---


\newpage

# ç¬¬13ç«  è‡ªç›‘ç£å­¦ä¹ 


> **æ ¸å¿ƒæ¦‚å¿µ**: è‡ªç›‘ç£å­¦ä¹  (Self-Supervised Learning, SSL) æ˜¯ä¸€ç§ä»æ— æ ‡ç­¾æ•°æ®ä¸­å­¦ä¹ æœ‰æ„ä¹‰è¡¨ç¤ºçš„æ–¹æ³•ã€‚é€šè¿‡è®¾è®¡ **Pretext Task (ä»£ç†ä»»åŠ¡)**ï¼Œè®©æ¨¡å‹ä»æ•°æ®æœ¬èº«çš„ç»“æ„ä¸­å­¦ä¹ ã€‚

## 0. ä¸»è¦æ•¸å­¸æ€æƒ³ (Main Mathematical Idea)

> **ç¬¬ä¸€æ€§åŸç†**: **Structure is Supervision (ç»“æ„å³ç›‘ç£)**

äººç±»å­¦ä¹ ä¸éœ€è¦æ¯æ—¶æ¯åˆ»çš„å¤–éƒ¨æ ‡ç­¾ï¼Œå› ä¸ºæ•°æ®æœ¬èº«å†…éƒ¨è•´å«ç€ä¸°å¯Œçš„**ç»“æ„ä¿¡æ¯**ï¼ˆæ—¶ç©ºè¿ç»­æ€§ã€å¤šè§†è§’ä¸€è‡´æ€§ï¼‰ã€‚

- **æ ¸å¿ƒæ•°å­¦å·¥å…·**: **Manifold Learning (æµå½¢å­¦ä¹ )** ä¸ **Mutual Information Maximization (äº’ä¿¡æ¯æœ€å¤§åŒ–)**ã€‚
- **è§£é¢˜é€»è¾‘**:
    1.  **ä¸å˜æ€§ (Invariance)**: åŒä¸€ä¸ªç‰©ä½“ï¼Œæ— è®ºå…‰ç…§ã€è§’åº¦å¦‚ä½•å˜åŒ–ï¼Œå…¶æœ¬è´¨ï¼ˆè¯­ä¹‰ï¼‰ä¸å˜ã€‚é€šè¿‡æ‹‰è¿‘åŒä¸€ç‰©ä½“ä¸åŒè§†å›¾çš„è·ç¦»ï¼ˆå¯¹æ¯”å­¦ä¹ ï¼‰ï¼Œæ¨¡å‹å­¦ä¼šäº†å¿½ç•¥æ— å…³å¹²æ‰°ï¼ˆå¦‚åƒç´ å™ªå£°ï¼‰ï¼ŒæŠ“ä½æ ¸å¿ƒè¯­ä¹‰ã€‚
    2.  **é¢„æµ‹æ€§ (Predictability)**: ä¸–ç•Œæ˜¯æœ‰è§„å¾‹çš„ã€‚å¦‚æœæˆ‘çŸ¥é“äº†ç°åœ¨çš„çŠ¶æ€ï¼Œæˆ‘åº”è¯¥èƒ½æŸç§ç¨‹åº¦ä¸Šé¢„æµ‹æœªæ¥ï¼ˆé¢„æµ‹å­¦ä¹ ï¼‰æˆ–å¡«è¡¥ç¼ºå¤±ï¼ˆæ©ç é¢„æµ‹ï¼‰ã€‚è¿™ç§é¢„æµ‹èƒ½åŠ›è¿«ä½¿æ¨¡å‹ç†è§£æ•°æ®çš„å†…åœ¨é€»è¾‘å’Œç‰©ç†è§„å¾‹ã€‚

## 1. ä¸ºä»€ä¹ˆ VLA éœ€è¦è‡ªç›‘ç£å­¦ä¹ ? (Why SSL for VLA?)

### 1.1 æœºå™¨äººæ•°æ®çš„å›°å¢ƒ

| æ•°æ®ç±»å‹ | è§„æ¨¡ | æ ‡æ³¨æˆæœ¬ |
| :--- | :--- | :--- |
| äº’è”ç½‘å›¾æ–‡ | æ•°åäº¿ | ä½ï¼ˆç½‘é¡µè‡ªåŠ¨çˆ¬å–ï¼‰ |
| è§†é¢‘æ•°æ® | æ•°äº¿å°æ—¶ | æä½ï¼ˆæ— éœ€æ ‡æ³¨ï¼‰ |
| **æœºå™¨äººæ“ä½œæ•°æ®** | **æ•°åä¸‡** | **æé«˜ï¼ˆéœ€çœŸæœºé¥æ“ï¼‰** |

**é—®é¢˜**: æœ‰æ ‡ç­¾çš„æœºå™¨äººæ•°æ®ç¨€ç¼ºï¼Œæ— æ³•æ”¯æ’‘å¤§æ¨¡å‹è®­ç»ƒã€‚

### 1.2 SSL çš„ä»·å€¼


$$
\text{å¤§é‡æ— æ ‡ç­¾æ•°æ®} \xrightarrow{\text{SSL é¢„è®­ç»ƒ}} \text{é€šç”¨è¡¨ç¤º} \xrightarrow{\text{å°‘é‡æ ‡ç­¾å¾®è°ƒ}} \text{é«˜æ€§èƒ½ç­–ç•¥}
$$


- **è§†è§‰è¡¨ç¤º**: ä»æµ·é‡å›¾åƒ/è§†é¢‘ä¸­å­¦ä¹ é€šç”¨è§†è§‰ç‰¹å¾
- **åŠ¨ä½œè¡¨ç¤º**: ä»äººç±»è§†é¢‘ä¸­å­¦ä¹ åŠ¨ä½œå…ˆéªŒ
- **ä¸–ç•Œæ¨¡å‹**: ä»è§†é¢‘ä¸­å­¦ä¹ ç‰©ç†è§„å¾‹

## 2. è‡ªç›‘ç£å­¦ä¹ èŒƒå¼ (SSL Paradigms)

### 2.1 å¯¹æ¯”å­¦ä¹  (Contrastive Learning)

**æ ¸å¿ƒæ€æƒ³**: æ‹‰è¿‘ç›¸ä¼¼æ ·æœ¬ï¼Œæ¨è¿œä¸åŒæ ·æœ¬ã€‚

#### 2.1.1 InfoNCE æŸå¤±


$$
\mathcal{L}_{\text{InfoNCE}} = -\log \frac{\exp(\text{sim}(z_i, z_j) / \tau)}{\sum_{k=1}^{2N} \mathbf{1}_{k \neq i} \exp(\text{sim}(z_i, z_k) / \tau)}
$$


å…¶ä¸­:
- $z_i, z_j$: åŒä¸€æ ·æœ¬çš„ä¸¤ä¸ªå¢å¼ºè§†å›¾çš„è¡¨ç¤º
- $\tau$: æ¸©åº¦ç³»æ•° (é€šå¸¸ 0.07)
- $\text{sim}(\cdot)$: ä½™å¼¦ç›¸ä¼¼åº¦

#### 2.1.2 SimCLR æ¡†æ¶

```
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚           åŸå§‹å›¾åƒ x                  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ æ•°æ®å¢å¼º T    â”‚               â”‚ æ•°æ®å¢å¼º T'
         â–¼               â”‚               â–¼
      â”Œâ”€â”€â”€â”€â”€â”            â”‚            â”Œâ”€â”€â”€â”€â”€â”
      â”‚ x_i â”‚            â”‚            â”‚ x_j â”‚
      â””â”€â”€â”¬â”€â”€â”˜            â”‚            â””â”€â”€â”¬â”€â”€â”˜
         â”‚               â”‚               â”‚
         â–¼               â”‚               â–¼
      Encoder f          â”‚            Encoder f
         â”‚               â”‚               â”‚
         â–¼               â”‚               â–¼
      â”Œâ”€â”€â”€â”€â”€â”            â”‚            â”Œâ”€â”€â”€â”€â”€â”
      â”‚ h_i â”‚            â”‚            â”‚ h_j â”‚
      â””â”€â”€â”¬â”€â”€â”˜            â”‚            â””â”€â”€â”¬â”€â”€â”˜
         â”‚               â”‚               â”‚
         â–¼               â”‚               â–¼
      Projector g        â”‚            Projector g
         â”‚               â”‚               â”‚
         â–¼               â”‚               â–¼
      â”Œâ”€â”€â”€â”€â”€â”            â”‚            â”Œâ”€â”€â”€â”€â”€â”
      â”‚ z_i â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ z_j â”‚
      â””â”€â”€â”€â”€â”€â”˜       å¯¹æ¯”æŸå¤±           â””â”€â”€â”€â”€â”€â”˜
                   (æœ€å¤§åŒ–ç›¸ä¼¼åº¦)
```

**æ•°æ®å¢å¼ºç­–ç•¥**:
- éšæœºè£å‰ª + ç¼©æ”¾
- é¢œè‰²æŠ–åŠ¨ (Color Jittering)
- é«˜æ–¯æ¨¡ç³Š
- æ°´å¹³ç¿»è½¬

```python
import torch
import torch.nn as nn
import torch.nn.functional as F

class SimCLR(nn.Module):
    def __init__(self, encoder, proj_dim=128, temperature=0.07):
        super().__init__()
        self.encoder = encoder
        self.projector = nn.Sequential(
            nn.Linear(encoder.output_dim, 512),
            nn.ReLU(),
            nn.Linear(512, proj_dim)
        )
        self.temperature = temperature
    
    def forward(self, x_i, x_j):
        # ç¼–ç 
        h_i = self.encoder(x_i)  # [B, D]
        h_j = self.encoder(x_j)
        
        # æŠ•å½±
        z_i = F.normalize(self.projector(h_i), dim=1)
        z_j = F.normalize(self.projector(h_j), dim=1)
        
        # è®¡ç®—ç›¸ä¼¼åº¦çŸ©é˜µ
        batch_size = z_i.shape[0]
        z = torch.cat([z_i, z_j], dim=0)  # [2B, D]
        sim_matrix = torch.mm(z, z.t()) / self.temperature  # [2B, 2B]
        
        # æ„å»ºæ ‡ç­¾: æ­£æ ·æœ¬å¯¹åœ¨å¯¹è§’çº¿ä¸Š
        labels = torch.arange(batch_size, device=z.device)
        labels = torch.cat([labels + batch_size, labels])  # [2B]
        
        # ç§»é™¤è‡ªèº«ç›¸ä¼¼åº¦
        mask = torch.eye(2 * batch_size, dtype=torch.bool, device=z.device)
        sim_matrix.masked_fill_(mask, -float('inf'))
        
        # InfoNCE æŸå¤±
        loss = F.cross_entropy(sim_matrix, labels)
        return loss
```

#### 2.1.3 CLIP: è§†è§‰-è¯­è¨€å¯¹æ¯”å­¦ä¹ 

```python
def clip_loss(image_features, text_features, temperature=0.07):
    """
    image_features: [B, D] - å›¾åƒç¼–ç 
    text_features: [B, D] - æ–‡æœ¬ç¼–ç 
    """
    # å½’ä¸€åŒ–
    image_features = F.normalize(image_features, dim=1)
    text_features = F.normalize(text_features, dim=1)
    
    # ç›¸ä¼¼åº¦çŸ©é˜µ
    logits = torch.mm(image_features, text_features.t()) / temperature
    
    # å¯¹ç§°æŸå¤±
    labels = torch.arange(len(logits), device=logits.device)
    loss_i2t = F.cross_entropy(logits, labels)      # å›¾åƒâ†’æ–‡æœ¬
    loss_t2i = F.cross_entropy(logits.t(), labels)  # æ–‡æœ¬â†’å›¾åƒ
    
    return (loss_i2t + loss_t2i) / 2
```

### 2.2 æ©ç é¢„æµ‹ (Masked Prediction)

**æ ¸å¿ƒæ€æƒ³**: é®ä½éƒ¨åˆ†è¾“å…¥ï¼Œè®©æ¨¡å‹é¢„æµ‹è¢«é®ä½çš„éƒ¨åˆ†ã€‚

#### 2.2.1 MAE (Masked Autoencoder)

```
åŸå§‹å›¾åƒ (224x224)
    â”‚
    â–¼ Patch åˆ†å‰² (16x16)
196 ä¸ª Patches
    â”‚
    â–¼ éšæœº Mask (75%)
49 ä¸ªå¯è§ Patches + 147 ä¸ª Mask Tokens
    â”‚
    â–¼ ViT Encoder (åªå¤„ç†å¯è§ Patches)
    â”‚
    â–¼ æ·»åŠ  Mask Tokens + ä½ç½®ç¼–ç 
    â”‚
    â–¼ è½»é‡ Decoder (é‡å»ºå…¨éƒ¨ Patches)
    â”‚
    â–¼ MSE Loss (åªè®¡ç®—è¢« Mask çš„ Patches)
```

**å…³é”®è®¾è®¡**:
- **é«˜ Mask æ¯”ä¾‹ (75%)**: ä»»åŠ¡è¶³å¤Ÿéš¾ï¼Œå¼ºè¿«å­¦ä¹ è¯­ä¹‰
- **éå¯¹ç§°æ¶æ„**: é‡ç¼–ç å™¨ (ViT-L)ï¼Œè½»è§£ç å™¨ (å° Transformer)
- **åªç¼–ç å¯è§ Patches**: å¤§å¹…å‡å°‘è®¡ç®—é‡

```python
class MAE(nn.Module):
    def __init__(self, encoder, decoder, mask_ratio=0.75):
        super().__init__()
        self.encoder = encoder
        self.decoder = decoder
        self.mask_ratio = mask_ratio
        
        # Mask token
        self.mask_token = nn.Parameter(torch.zeros(1, 1, encoder.embed_dim))
    
    def random_masking(self, x, mask_ratio):
        """éšæœº Mask ç­–ç•¥"""
        B, N, D = x.shape  # [Batch, N_patches, Dim]
        num_keep = int(N * (1 - mask_ratio))
        
        # éšæœºæ‰“ä¹±
        noise = torch.rand(B, N, device=x.device)
        ids_shuffle = torch.argsort(noise, dim=1)
        ids_restore = torch.argsort(ids_shuffle, dim=1)
        
        # ä¿ç•™å‰ num_keep ä¸ª
        ids_keep = ids_shuffle[:, :num_keep]
        x_masked = torch.gather(x, 1, ids_keep.unsqueeze(-1).expand(-1, -1, D))
        
        # ç”Ÿæˆ mask (1 è¡¨ç¤ºè¢«ç§»é™¤)
        mask = torch.ones(B, N, device=x.device)
        mask[:, :num_keep] = 0
        mask = torch.gather(mask, 1, ids_restore)
        
        return x_masked, mask, ids_restore
    
    def forward(self, images):
        # Patch embedding
        patches = self.encoder.patch_embed(images)  # [B, N, D]
        
        # Random masking
        patches_masked, mask, ids_restore = self.random_masking(patches, self.mask_ratio)
        
        # Encode (åªå¤„ç†å¯è§ patches)
        latent = self.encoder.forward_encoder(patches_masked)
        
        # Decode (è¡¥å…… mask tokens)
        B, N_vis, D = latent.shape
        mask_tokens = self.mask_token.expand(B, ids_restore.shape[1] - N_vis, -1)
        latent_full = torch.cat([latent, mask_tokens], dim=1)
        latent_full = torch.gather(latent_full, 1, ids_restore.unsqueeze(-1).expand(-1, -1, D))
        
        pred = self.decoder(latent_full)  # [B, N, patch_size^2 * 3]
        
        # Loss (åªè®¡ç®— masked patches)
        target = self.patchify(images)
        loss = (pred - target) ** 2
        loss = (loss.mean(dim=-1) * mask).sum() / mask.sum()
        
        return loss
```

#### 2.2.2 VideoMAE: è§†é¢‘ç‰ˆ MAE

**å…³é”®æ”¹è¿›**:
- **æ—¶ç©º Masking**: å¯¹è§†é¢‘çš„æ—¶é—´å’Œç©ºé—´ç»´åº¦åŒæ—¶ Mask
- **Tube Masking**: åœ¨æ—¶é—´ä¸Šè¿ç»­ Mask åŒä¸€ä½ç½®ï¼ˆæ›´éš¾ï¼‰
- **è¿åŠ¨å…ˆéªŒ**: å­¦ä¹ æ—¶åºåŠ¨æ€

**å¯¹ VLA çš„ä»·å€¼**: ä»äººç±»è§†é¢‘ä¸­å­¦ä¹ åŠ¨ä½œçš„æ—¶åºæ¨¡å¼

### 2.3 é¢„æµ‹å­¦ä¹  (Predictive Learning)

#### 2.3.1 æ—¶é—´å¯¹æ¯”å­¦ä¹ 

```python
class TemporalContrastive(nn.Module):
    """å­¦ä¹ è§†é¢‘å¸§çš„æ—¶åºå…³ç³»"""
    def __init__(self, encoder, pred_steps=3):
        super().__init__()
        self.encoder = encoder
        self.predictor = nn.GRU(hidden_size, hidden_size)
        self.pred_steps = pred_steps
    
    def forward(self, video_frames):
        """
        video_frames: [B, T, C, H, W]
        """
        B, T, C, H, W = video_frames.shape
        
        # ç¼–ç æ¯å¸§
        features = []
        for t in range(T):
            feat = self.encoder(video_frames[:, t])
            features.append(feat)
        features = torch.stack(features, dim=1)  # [B, T, D]
        
        # é¢„æµ‹æœªæ¥å¸§ç‰¹å¾
        loss = 0
        for t in range(T - self.pred_steps):
            context = features[:, :t+1]  # å†å²å¸§
            pred, _ = self.predictor(context)
            pred = pred[:, -1]  # æœ€åä¸€æ­¥çš„é¢„æµ‹
            
            # å¯¹æ¯”å­¦ä¹ : æ­£æ ·æœ¬æ˜¯æœªæ¥å¸§
            target = features[:, t + self.pred_steps]
            loss += contrastive_loss(pred, target)
        
        return loss / (T - self.pred_steps)
```

#### 2.3.2 R3M: ä»äººç±»è§†é¢‘å­¦ä¹ æœºå™¨äººè¡¨ç¤º

**æ ¸å¿ƒæ€æƒ³**: äººç±»çš„æ‰‹éƒ¨åŠ¨ä½œä¸æœºå™¨äºº gripper ç±»ä¼¼ï¼Œå¯ä»¥è¿ç§»ã€‚

```
äººç±»è§†é¢‘ (Ego4D æ•°æ®é›†)
    â”‚
    â”œâ”€â–¶ æ—¶é—´å¯¹æ¯”å­¦ä¹  (Time Contrastive)
    â”‚   - ç›¸é‚»å¸§ç‰¹å¾åº”è¯¥ç›¸ä¼¼
    â”‚
    â”œâ”€â–¶ è§†é¢‘-è¯­è¨€å¯¹é½ (Video-Language Alignment)
    â”‚   - è§†é¢‘ä¸æ–‡å­—æè¿°å¯¹é½
    â”‚
    â””â”€â–¶ è¯­è¨€æ¡ä»¶æ—¶é—´å¯¹æ¯” (L3)
        - è¯­è¨€å¼•å¯¼çš„æ—¶åºé¢„æµ‹

    â”‚
    â–¼
é€šç”¨è§†è§‰è¡¨ç¤º (é€‚ç”¨äºæœºå™¨äºº)
```

## 3. VLA ä¸­çš„ SSL åº”ç”¨ (SSL in VLA)

### 3.1 è§†è§‰ç¼–ç å™¨é¢„è®­ç»ƒ

| æ–¹æ³• | æ•°æ® | ç”¨äº VLA |
| :--- | :--- | :--- |
| **ImageNet ç›‘ç£** | 1M å›¾åƒ + æ ‡ç­¾ | åŸºç¡€ç‰¹å¾ |
| **CLIP** | 400M å›¾æ–‡å¯¹ | è¯­ä¹‰å¯¹é½ |
| **DINOv2** | 142M æ— æ ‡ç­¾å›¾åƒ | ç©ºé—´ç‰¹å¾ |
| **R3M** | Ego4D äººç±»è§†é¢‘ | æ“ä½œç›¸å…³ç‰¹å¾ |

### 3.2 ä¸–ç•Œæ¨¡å‹é¢„è®­ç»ƒ

```python
class WorldModelSSL(nn.Module):
    """ä»è§†é¢‘é¢„æµ‹æœªæ¥å¸§ï¼Œå­¦ä¹ ç‰©ç†è§„å¾‹"""
    def __init__(self):
        self.encoder = ViTEncoder()
        self.dynamics = TransformerDynamics()
        self.decoder = ViTDecoder()
    
    def forward(self, video, actions=None):
        """
        video: [B, T, C, H, W]
        actions: [B, T-1, A] (å¯é€‰ï¼ŒåŠ¨ä½œæ¡ä»¶)
        """
        # ç¼–ç å†å²å¸§
        B, T, C, H, W = video.shape
        latents = []
        for t in range(T):
            z_t = self.encoder(video[:, t])
            latents.append(z_t)
        latents = torch.stack(latents, dim=1)  # [B, T, D]
        
        # é¢„æµ‹ä¸‹ä¸€å¸§
        pred_latents = self.dynamics(latents[:, :-1], actions)
        
        # é‡å»º
        pred_frames = self.decoder(pred_latents)
        
        # æŸå¤±: é¢„æµ‹ä¸çœŸå®æœªæ¥å¸§çš„å·®å¼‚
        loss = F.mse_loss(pred_frames, video[:, 1:])
        return loss
```

### 3.3 åŠ¨ä½œè¡¨ç¤ºå­¦ä¹ 

```python
class ActionSSL(nn.Module):
    """ä»è§†é¢‘ä¸­å­¦ä¹ éšå¼åŠ¨ä½œè¡¨ç¤º"""
    def __init__(self):
        self.encoder = VideoEncoder()
        self.action_predictor = MLP()
    
    def forward(self, frame_t, frame_t1):
        """é¢„æµ‹ä¸¤å¸§ä¹‹é—´çš„éšå¼åŠ¨ä½œ"""
        z_t = self.encoder(frame_t)
        z_t1 = self.encoder(frame_t1)
        
        # é¢„æµ‹"åŠ¨ä½œ"ä½¿å¾— z_t â†’ z_t1
        pred_action = self.action_predictor(torch.cat([z_t, z_t1], dim=-1))
        
        # è‡ªç›‘ç£ç›®æ ‡: åŠ¨ä½œåº”è¯¥èƒ½å¤Ÿé¢„æµ‹çŠ¶æ€å˜åŒ–
        pred_z_t1 = self.dynamics(z_t, pred_action)
        loss = F.mse_loss(pred_z_t1, z_t1.detach())
        
        return loss, pred_action
```

## 4. æ•°æ®å¢å¼ºç­–ç•¥ (Data Augmentation)

### 4.1 å›¾åƒå¢å¼º

```python
import torchvision.transforms as T

## VLA å¸¸ç”¨å¢å¼º
train_transform = T.Compose([
    T.RandomResizedCrop(224, scale=(0.8, 1.0)),
    T.RandomHorizontalFlip(p=0.5),  # æ³¨æ„: æœºå™¨äººä»»åŠ¡å¯èƒ½éœ€è¦ç¦ç”¨
    T.ColorJitter(0.4, 0.4, 0.4, 0.1),
    T.GaussianBlur(kernel_size=23, sigma=(0.1, 2.0)),
    T.ToTensor(),
    T.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
])
```

### 4.2 æœºå™¨äººç‰¹å®šå¢å¼º

```python
class RobotAugmentation:
    """æœºå™¨äººåœºæ™¯çš„æ•°æ®å¢å¼º"""
    
    @staticmethod
    def camera_shift(image, proprio, max_shift=10):
        """æ¨¡æ‹Ÿç›¸æœºä½ç½®è½»å¾®åç§»"""
        shift_x = random.randint(-max_shift, max_shift)
        shift_y = random.randint(-max_shift, max_shift)
        image = T.functional.affine(image, angle=0, translate=(shift_x, shift_y), scale=1, shear=0)
        return image, proprio
    
    @staticmethod
    def action_noise(action, noise_std=0.01):
        """ç»™åŠ¨ä½œæ·»åŠ å™ªå£°ï¼ˆç”¨äº BCï¼‰"""
        noise = torch.randn_like(action) * noise_std
        return action + noise
    
    @staticmethod
    def temporal_crop(video, crop_ratio=0.8):
        """æ—¶é—´ç»´åº¦è£å‰ª"""
        T = video.shape[0]
        crop_len = int(T * crop_ratio)
        start = random.randint(0, T - crop_len)
        return video[start:start + crop_len]
```

## 5. å¯¹æ¯”å­¦ä¹  vs æ©ç é¢„æµ‹ (Comparison)

| ç‰¹æ€§ | å¯¹æ¯”å­¦ä¹  (Contrastive) | æ©ç é¢„æµ‹ (Masked) |
| :--- | :--- | :--- |
| **ä»£è¡¨** | SimCLR, CLIP, MoCo | MAE, BEiT |
| **ç›®æ ‡** | å­¦ä¹ ä¸å˜æ€§è¡¨ç¤º | å­¦ä¹ é‡å»ºèƒ½åŠ› |
| **æ•°æ®å¢å¼º** | å¼ºä¾èµ– | ä¸ä¾èµ– |
| **è´Ÿæ ·æœ¬** | éœ€è¦ (å¤§ batch) | ä¸éœ€è¦ |
| **è®¡ç®—æ•ˆç‡** | ä½ (å¤§ batch) | é«˜ (åªç¼–ç  25%) |
| **ä¸‹æ¸¸ä»»åŠ¡** | åˆ†ç±»ã€æ£€ç´¢ | æ£€æµ‹ã€åˆ†å‰² |
| **VLA é€‚ç”¨** | è¯­ä¹‰ç†è§£ | ç©ºé—´ç²¾ç»†ä»»åŠ¡ |

## 6. é¢è¯•é«˜é¢‘é—®é¢˜ (Q&A)

**Q1: å¯¹æ¯”å­¦ä¹ ä¸­æ¸©åº¦ç³»æ•° Ï„ çš„ä½œç”¨æ˜¯ä»€ä¹ˆ?**

A:
- **Ï„ å°**: åˆ†å¸ƒæ›´ sharpï¼Œå¯¹è´Ÿæ ·æœ¬åŒºåˆ†æ›´ä¸¥æ ¼ï¼Œä½†å®¹æ˜“è¿‡æ‹Ÿåˆå™ªå£°
- **Ï„ å¤§**: åˆ†å¸ƒæ›´ uniformï¼Œå¯¹æ¯”æ›´"è½¯"ï¼Œä½†éš¾ä»¥å­¦ä¹ ç»†ç²’åº¦åŒºåˆ†
- **ç»éªŒå€¼**: 0.07 (CLIP), 0.1 (SimCLR)

**Q2: MAE ä¸ºä»€ä¹ˆè¦ Mask 75% è¿™ä¹ˆé«˜çš„æ¯”ä¾‹?**

A:
- **ä»»åŠ¡éš¾åº¦**: æ¯”ä¾‹ä½æ—¶ä»»åŠ¡å¤ªç®€å•ï¼Œé€šè¿‡æ’å€¼å°±èƒ½é‡å»º
- **è¯­ä¹‰å­¦ä¹ **: é«˜æ¯”ä¾‹å¼ºè¿«æ¨¡å‹ç†è§£å›¾åƒçš„æ•´ä½“è¯­ä¹‰ç»“æ„
- **æ•ˆç‡**: åªç¼–ç  25% patchesï¼Œè®¡ç®—é‡å‡å°‘ 4 å€
- **å¯¹æ¯”**: NLP çš„ BERT åª Mask 15%ï¼Œå› ä¸ºè¯­è¨€å†—ä½™æ›´ä½

**Q3: R3M å¦‚ä½•ä»äººç±»è§†é¢‘è¿ç§»åˆ°æœºå™¨äºº?**

A:
- **å‡è®¾**: äººç±»æ‰‹éƒ¨æ“ä½œçš„è§†è§‰ç‰¹å¾ä¸æœºå™¨äºº gripper ç±»ä¼¼
- **æ•°æ®**: Ego4D (ç¬¬ä¸€äººç§°è§†é¢‘) å«å¤§é‡æ‰‹-ç‰©äº¤äº’
- **æ–¹æ³•**: æ—¶é—´å¯¹æ¯” + è¯­è¨€å¯¹é½ï¼Œå­¦ä¹ "åŠ¨ä½œç›¸å…³"çš„è§†è§‰è¡¨ç¤º
- **è¿ç§»**: å†»ç»“ç¼–ç å™¨ï¼Œåªè®­ç»ƒç­–ç•¥å¤´

**Q4: è‡ªç›‘ç£å­¦ä¹ åœ¨ VLA ä¸­æœ€å¤§çš„ä»·å€¼æ˜¯ä»€ä¹ˆ?**

A:
- **æ•°æ®æ•ˆç‡**: åˆ©ç”¨æµ·é‡æ— æ ‡ç­¾æ•°æ®é¢„è®­ç»ƒï¼Œå‡å°‘å¯¹ç¨€ç¼ºæœºå™¨äººæ•°æ®çš„ä¾èµ–
- **æ³›åŒ–èƒ½åŠ›**: é¢„è®­ç»ƒç‰¹å¾å…·æœ‰æ›´å¥½çš„è·¨åŸŸæ³›åŒ–èƒ½åŠ›
- **ä¸–ç•Œæ¨¡å‹**: ä»è§†é¢‘å­¦ä¹ ç‰©ç†è§„å¾‹ï¼Œæ”¯æŒæ¨¡å‹é¢„æµ‹æ§åˆ¶

**Q5: å¦‚ä½•é€‰æ‹© SSL æ–¹æ³•è¿›è¡Œ VLA é¢„è®­ç»ƒ?**

A:
- **è¯­ä¹‰ç†è§£ä»»åŠ¡** (å¦‚æŒ‡ä»¤è·Ÿéš): CLIP / å¯¹æ¯”å­¦ä¹ 
- **ç©ºé—´ç²¾ç»†ä»»åŠ¡** (å¦‚ç²¾å¯†è£…é…): MAE / DINOv2
- **åŠ¨ä½œé¢„æµ‹ä»»åŠ¡**: R3M / VideoMAE

## 7. å‚è€ƒèµ„æº (References)

- **SimCLR**: [A Simple Framework for Contrastive Learning](https://arxiv.org/abs/2002.05709)
- **MAE**: [Masked Autoencoders Are Scalable Vision Learners](https://arxiv.org/abs/2111.06377)
- **CLIP**: [Learning Transferable Visual Models](https://arxiv.org/abs/2103.00020)
- **R3M**: [R3M: A Universal Visual Representation for Robot Manipulation](https://arxiv.org/abs/2203.12601)
- **DINOv2**: [DINOv2: Learning Robust Visual Features](https://arxiv.org/abs/2304.07193)

---


\newpage

# ç¬¬14ç«  è¿ç§»å­¦ä¹ ä¸ Co-training


## ä¸»è¦æ•°å­¦æ€æƒ³ (Main Mathematical Idea)

> **"Distribution Alignment (åˆ†å¸ƒå¯¹é½) & Representation Invariance (è¡¨ç¤ºä¸å˜æ€§)"**

è¿ç§»å­¦ä¹ çš„æ ¸å¿ƒæ•°å­¦é—®é¢˜æ˜¯è§£å†³ **Domain Shift (åŸŸåç§»)**ï¼Œå³æºåŸŸåˆ†å¸ƒ $P_S(X, Y)$ ä¸ç›®æ ‡åŸŸåˆ†å¸ƒ $P_T(X, Y)$ ä¸ä¸€è‡´ ($P_S \neq P_T$)ã€‚

è§£å†³è¿™ä¸€é—®é¢˜çš„ç¬¬ä¸€æ€§åŸç†æ˜¯å¯»æ‰¾ä¸€ä¸ªæ˜ å°„å‡½æ•° $\Phi$ï¼Œä½¿å¾—æ˜ å°„åçš„ç‰¹å¾åˆ†å¸ƒå°½å¯èƒ½æ¥è¿‘ï¼š
$$ \text{Minimize } \text{Distance}(P_S(\Phi(X)), P_T(\Phi(X))) $$
å…¶ä¸­ Distance é€šå¸¸ç”± MMD (æœ€å¤§å‡å€¼å·®å¼‚) æˆ– Adversarial Loss (å¯¹æŠ—æŸå¤±) æ¥è¡¡é‡ã€‚æœ¬è´¨ä¸Šï¼Œè¿™æ˜¯åœ¨å¯»æ‰¾ä¸€ç§**è·¨åŸŸä¸å˜çš„è¡¨ç¤º (Invariant Representation)**ï¼Œä½¿å¾—æ¨¡å‹åœ¨æ–°çš„ç¯å¢ƒä¸­ä¾ç„¶èƒ½è¯†åˆ«å‡ºæœ¬è´¨ç‰¹å¾ã€‚

---

> **æ ¸å¿ƒæ¦‚å¿µ**: è¿ç§»å­¦ä¹  (Transfer Learning) æ˜¯å°†åœ¨**æºåŸŸ (Source Domain)** å­¦åˆ°çš„çŸ¥è¯†åº”ç”¨åˆ°**ç›®æ ‡åŸŸ (Target Domain)** çš„æŠ€æœ¯ã€‚åœ¨ VLA é¢†åŸŸï¼Œè¿ç§»å­¦ä¹ æ˜¯å®ç°è·¨æœºå™¨äººã€è·¨åœºæ™¯æ³›åŒ–çš„å…³é”®ã€‚

## 1. ä¸ºä»€ä¹ˆ VLA éœ€è¦è¿ç§»å­¦ä¹ ? (Why Transfer Learning?)

### 1.1 æœºå™¨äººå­¦ä¹ çš„è¿ç§»æŒ‘æˆ˜

| è¿ç§»ç±»å‹ | æºåŸŸ | ç›®æ ‡åŸŸ | æŒ‘æˆ˜ |
| :--- | :--- | :--- | :--- |
| **è·¨å½¢æ€ (Cross-Embodiment)** | å•è‡‚æœºå™¨äºº | åŒè‡‚æœºå™¨äºº | åŠ¨ä½œç©ºé—´ä¸åŒ |
| **è·¨åœºæ™¯ (Cross-Environment)** | å®éªŒå®¤ | çœŸå®å®¶åº­ | è§†è§‰åˆ†å¸ƒåç§» |
| **è·¨ä»»åŠ¡ (Cross-Task)** | æŠ“å–ç‰©ä½“ | æŠ˜å è¡£ç‰© | æŠ€èƒ½å·®å¼‚å¤§ |
| **ä»¿çœŸåˆ°çœŸå® (Sim-to-Real)** | ä»¿çœŸç¯å¢ƒ | çœŸæœº | ç‰©ç†å·®å¼‚ |

### 1.2 è¿ç§»å­¦ä¹ çš„ä»·å€¼

$$
\text{æ•°æ®æ”¶é›†æˆæœ¬} = \frac{\text{æ‰€éœ€æ•°æ®é‡}}{\text{æ•°æ®æ”¶é›†æ•ˆç‡}} \propto \frac{1}{\text{è¿ç§»èƒ½åŠ›}}
$$

- **å‡å°‘æ•°æ®éœ€æ±‚**: é¢„è®­ç»ƒæ¨¡å‹åªéœ€å°‘é‡ç›®æ ‡åŸŸæ•°æ®å¾®è°ƒ
- **æé«˜æ³›åŒ–èƒ½åŠ›**: å­¦ä¹ è·¨åŸŸä¸å˜çš„ç‰¹å¾è¡¨ç¤º
- **åŠ é€Ÿéƒ¨ç½²**: æ–°æœºå™¨äºº/åœºæ™¯æ— éœ€ä»å¤´è®­ç»ƒ

## 2. è¿ç§»å­¦ä¹ èŒƒå¼ (Transfer Learning Paradigms)

### 2.1 é¢„è®­ç»ƒ-å¾®è°ƒ (Pre-training + Fine-tuning)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Phase 1: Pre-training                    â”‚
â”‚                                                             â”‚
â”‚   å¤§è§„æ¨¡æ•°æ® (ImageNet/CLIP/OXE)                            â”‚
â”‚              â”‚                                              â”‚
â”‚              â–¼                                              â”‚
â”‚        é¢„è®­ç»ƒæ¨¡å‹ (é€šç”¨ç‰¹å¾)                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Phase 2: Fine-tuning                     â”‚
â”‚                                                             â”‚
â”‚   ç›®æ ‡åŸŸå°‘é‡æ•°æ® (50-500 episodes)                           â”‚
â”‚              â”‚                                              â”‚
â”‚              â–¼                                              â”‚
â”‚        å¾®è°ƒåæ¨¡å‹ (ç›®æ ‡ä»»åŠ¡ç‰¹å®š)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 å†»ç»“ç‰¹å¾æå– (Feature Extraction)

åªè®­ç»ƒä»»åŠ¡å¤´ï¼Œå†»ç»“é¢„è®­ç»ƒçš„ backboneã€‚

```python
class FeatureExtraction(nn.Module):
    def __init__(self, pretrained_encoder, action_dim):
        super().__init__()
        self.encoder = pretrained_encoder
        
        # å†»ç»“ç¼–ç å™¨
        for param in self.encoder.parameters():
            param.requires_grad = False
        
        # åªè®­ç»ƒç­–ç•¥å¤´
        self.policy_head = nn.Sequential(
            nn.Linear(encoder.output_dim, 256),
            nn.ReLU(),
            nn.Linear(256, action_dim)
        )
    
    def forward(self, obs):
        with torch.no_grad():
            features = self.encoder(obs)
        action = self.policy_head(features)
        return action
```

**é€‚ç”¨**: ç›®æ ‡åŸŸæ•°æ®æå°‘ (< 50 episodes)

### 2.3 å…¨é‡å¾®è°ƒ (Full Fine-tuning)

è§£å†»æ‰€æœ‰å‚æ•°è¿›è¡Œè®­ç»ƒã€‚

```python
class FullFineTuning(nn.Module):
    def __init__(self, pretrained_model):
        super().__init__()
        self.model = pretrained_model
        
        # æ‰€æœ‰å‚æ•°å¯è®­ç»ƒ
        for param in self.model.parameters():
            param.requires_grad = True
    
    def forward(self, obs):
        return self.model(obs)
```

**é€‚ç”¨**: ç›®æ ‡åŸŸæ•°æ®å……è¶³ï¼Œä¸”ä¸æºåŸŸå·®å¼‚è¾ƒå¤§

### 2.4 å‚æ•°é«˜æ•ˆå¾®è°ƒ (Parameter-Efficient Fine-Tuning, PEFT)

åªè®­ç»ƒå°‘é‡æ–°å¢å‚æ•°å³å¯é€‚é…æ–°ä»»åŠ¡ï¼Œå¸¸è§å·¥å…·åŒ…æ‹¬ LoRAã€Prompt Tuningã€Adapter ç­‰ã€‚

LoRA é€šè¿‡åœ¨æŠ•å½±å±‚ä¸­ä¸²æ¥ä½ç§©å¢é‡ï¼ˆ$W' = W_0 + BA$ï¼‰æ¥æ¨¡æ‹Ÿå¾®è°ƒæ•ˆæœï¼Œå¤§å¹…å‡å°‘å¯è®­ç»ƒå‚æ•°ã€å‡è½»æ˜¾å­˜å‹åŠ›ï¼Œè¿˜å¯ä»¥ä¸ºä¸åŒä»»åŠ¡ä¿å­˜å¤šä¸ªé€‚é…å™¨ã€‚

è¯¦ç»†çš„ LoRA æ•°å­¦æ¨å¯¼ä¸å®è·µç¤ºä¾‹è¯·å‚è€ƒ **[theory/peft_lora.md](./peft_lora.md)**ï¼ˆè¯¥æ–‡æ¡£ä¹Ÿæ˜¯ VLA ä¸­ PEFT çš„æƒå¨å‚è€ƒï¼‰ï¼Œè¿™é‡Œåªä¿ç•™é«˜å±‚æ€»ç»“å’Œç»éªŒå€¼ã€‚

## 3. è·¨å½¢æ€è¿ç§» (Cross-Embodiment Transfer)

### 3.1 åŠ¨ä½œç©ºé—´å¯¹é½

ä¸åŒæœºå™¨äººçš„åŠ¨ä½œç©ºé—´å·®å¼‚æ˜¯è·¨å½¢æ€è¿ç§»çš„æ ¸å¿ƒæŒ‘æˆ˜ã€‚

```python
class ActionSpaceAdapter(nn.Module):
    """å°†æºåŸŸåŠ¨ä½œæ˜ å°„åˆ°ç›®æ ‡åŸŸ"""
    def __init__(self, source_action_dim, target_action_dim):
        super().__init__()
        self.adapter = nn.Sequential(
            nn.Linear(source_action_dim, 128),
            nn.ReLU(),
            nn.Linear(128, target_action_dim)
        )
    
    def forward(self, source_action):
        return self.adapter(source_action)
```

### 3.2 ç»Ÿä¸€åŠ¨ä½œè¡¨ç¤º

**RDT/OpenVLA çš„æ–¹æ¡ˆ**: ç»Ÿä¸€å¡«å……åˆ°æœ€å¤§ç»´åº¦

```python
def unify_action_space(action, embodiment_type, max_dim=32):
    """ç»Ÿä¸€ä¸åŒæœºå™¨äººçš„åŠ¨ä½œç©ºé—´"""
    action_mapping = {
        "franka_7dof": 7,
        "ur5_6dof": 6,
        "bimanual_14dof": 14,
        "mobile_3dof": 3
    }
    
    original_dim = action_mapping[embodiment_type]
    
    # å¡«å……åˆ°ç»Ÿä¸€ç»´åº¦
    padded_action = F.pad(action, (0, max_dim - original_dim))
    
    # åˆ›å»ºæœ‰æ•ˆç»´åº¦ mask
    mask = torch.zeros(max_dim)
    mask[:original_dim] = 1
    
    return padded_action, mask
```

### 3.3 å½¢æ€æ— å…³ç‰¹å¾å­¦ä¹ 

```python
class EmbodimentInvariantEncoder(nn.Module):
    """å­¦ä¹ ä¸æœºå™¨äººå½¢æ€æ— å…³çš„ç‰¹å¾"""
    def __init__(self, obs_encoder, action_encoder):
        super().__init__()
        self.obs_encoder = obs_encoder
        self.action_encoder = action_encoder
        
        # å¯¹æŠ—å­¦ä¹ : åˆ†ç±»å™¨è¯•å›¾åŒºåˆ†å½¢æ€
        self.embodiment_classifier = nn.Linear(hidden_dim, num_embodiments)
        self.gradient_reversal = GradientReversalLayer()
    
    def forward(self, obs, action, embodiment_label):
        # ç¼–ç è§‚æµ‹
        obs_feat = self.obs_encoder(obs)
        
        # å¯¹æŠ—è®­ç»ƒ: è®©ç‰¹å¾æ— æ³•åŒºåˆ†å½¢æ€
        reversed_feat = self.gradient_reversal(obs_feat)
        embodiment_pred = self.embodiment_classifier(reversed_feat)
        adversarial_loss = F.cross_entropy(embodiment_pred, embodiment_label)
        
        return obs_feat, adversarial_loss
```

## 4. ä»¿çœŸåˆ°çœŸå®è¿ç§» (Sim-to-Real Transfer)

### 4.1 Domain Randomization (åŸŸéšæœºåŒ–)

åœ¨ä»¿çœŸä¸­éšæœºåŒ–å„ç§å‚æ•°ï¼Œè®©æ¨¡å‹å¯¹å˜åŒ–é²æ£’ã€‚

```python
class DomainRandomization:
    """ä»¿çœŸç¯å¢ƒçš„åŸŸéšæœºåŒ–"""
    
    @staticmethod
    def visual_randomization(image):
        """è§†è§‰éšæœºåŒ–"""
        transforms = [
            T.ColorJitter(brightness=0.3, contrast=0.3, saturation=0.3),
            T.GaussianBlur(kernel_size=5),
            T.RandomAdjustSharpness(sharpness_factor=2),
        ]
        for t in transforms:
            if random.random() > 0.5:
                image = t(image)
        return image
    
    @staticmethod
    def physics_randomization(env):
        """ç‰©ç†å‚æ•°éšæœºåŒ–"""
        # æ‘©æ“¦ç³»æ•°
        env.set_friction(random.uniform(0.5, 1.5))
        # ç‰©ä½“è´¨é‡
        env.set_object_mass(random.uniform(0.8, 1.2) * default_mass)
        # ç”µæœºå»¶è¿Ÿ
        env.set_actuator_delay(random.uniform(0, 0.05))
        return env
    
    @staticmethod
    def camera_randomization(env):
        """ç›¸æœºå‚æ•°éšæœºåŒ–"""
        # ç›¸æœºä½ç½®æ‰°åŠ¨
        env.camera_pos += np.random.uniform(-0.02, 0.02, size=3)
        # FOV å˜åŒ–
        env.camera_fov = random.uniform(55, 65)
        return env
```

### 4.2 System Identification (ç³»ç»Ÿè¾¨è¯†)

```python
class SystemIdentification(nn.Module):
    """ä»çœŸå®æ•°æ®æ¨æ–­ä»¿çœŸå‚æ•°"""
    def __init__(self):
        self.encoder = nn.LSTM(obs_dim, hidden_dim)
        self.param_predictor = nn.Linear(hidden_dim, physics_param_dim)
    
    def forward(self, trajectory):
        """
        trajectory: [T, obs_dim] - çœŸå®è½¨è¿¹
        """
        _, (h_n, _) = self.encoder(trajectory)
        predicted_params = self.param_predictor(h_n.squeeze())
        return predicted_params  # e.g., æ‘©æ“¦ç³»æ•°ã€è´¨é‡ç­‰
```

### 4.3 Real-to-Sim-to-Real

```
çœŸå®æ•°æ® (å°‘é‡)
    â”‚
    â–¼ System Identification
ä»¿çœŸå‚æ•°æ ¡å‡†
    â”‚
    â–¼ å¤§é‡ä»¿çœŸæ•°æ®ç”Ÿæˆ
    â”‚
    â–¼ ä»¿çœŸè®­ç»ƒ
    â”‚
    â–¼ Sim-to-Real Fine-tuning
çœŸæœºéƒ¨ç½²
```

## 5. åŸŸé€‚åº” (Domain Adaptation)

### 5.1 å¯¹æŠ—åŸŸé€‚åº” (Adversarial Domain Adaptation)

```python
class DANN(nn.Module):
    """Domain-Adversarial Neural Network"""
    def __init__(self):
        self.feature_extractor = FeatureExtractor()
        self.task_classifier = TaskClassifier()
        self.domain_classifier = DomainClassifier()
    
    def forward(self, source_data, target_data, alpha=1.0):
        # æºåŸŸç‰¹å¾
        source_feat = self.feature_extractor(source_data)
        source_task_pred = self.task_classifier(source_feat)
        
        # ç›®æ ‡åŸŸç‰¹å¾
        target_feat = self.feature_extractor(target_data)
        
        # åŸŸåˆ†ç±»å™¨ (é€šè¿‡æ¢¯åº¦åè½¬å¯¹æŠ—è®­ç»ƒ)
        source_domain = self.domain_classifier(
            GradientReversal.apply(source_feat, alpha)
        )
        target_domain = self.domain_classifier(
            GradientReversal.apply(target_feat, alpha)
        )
        
        # åŸŸåˆ†ç±»æŸå¤±: è®©ç‰¹å¾æ— æ³•åŒºåˆ†æ¥è‡ªå“ªä¸ªåŸŸ
        domain_loss = F.binary_cross_entropy(
            torch.cat([source_domain, target_domain]),
            torch.cat([torch.zeros_like(source_domain), 
                       torch.ones_like(target_domain)])
        )
        
        return source_task_pred, domain_loss


class GradientReversal(torch.autograd.Function):
    @staticmethod
    def forward(ctx, x, alpha):
        ctx.alpha = alpha
        return x.view_as(x)
    
    @staticmethod
    def backward(ctx, grad_output):
        # åè½¬æ¢¯åº¦
        return -ctx.alpha * grad_output, None
```

### 5.2 æœ€å¤§å‡å€¼å·®å¼‚ (MMD)

```python
def mmd_loss(source_features, target_features, kernel='rbf'):
    """Maximum Mean Discrepancy æŸå¤±"""
    def rbf_kernel(x, y, sigma=1.0):
        dist = torch.cdist(x, y) ** 2
        return torch.exp(-dist / (2 * sigma ** 2))
    
    K_ss = rbf_kernel(source_features, source_features)
    K_tt = rbf_kernel(target_features, target_features)
    K_st = rbf_kernel(source_features, target_features)
    
    mmd = K_ss.mean() + K_tt.mean() - 2 * K_st.mean()
    return mmd
```

## 6. é›¶æ ·æœ¬/å°‘æ ·æœ¬è¿ç§» (Zero/Few-Shot Transfer)

### 6.1 è¯­è¨€å¼•å¯¼çš„é›¶æ ·æœ¬è¿ç§»

```python
class LanguageGuidedTransfer(nn.Module):
    """é€šè¿‡è¯­è¨€æè¿°å®ç°é›¶æ ·æœ¬è¿ç§»"""
    def __init__(self, vlm_backbone):
        super().__init__()
        self.vlm = vlm_backbone
        
    def forward(self, image, task_description):
        """
        task_description: "pick up the red cup and place it on the tray"
        æ— éœ€è¯¥ä»»åŠ¡çš„è®­ç»ƒæ•°æ®ï¼Œä¾é  VLM çš„è¯­ä¹‰ç†è§£
        """
        # VLM ç›´æ¥ç†è§£æ–°ä»»åŠ¡
        action = self.vlm.generate_action(image, task_description)
        return action
```

### 6.2 å°‘æ ·æœ¬å­¦ä¹ ç­–ç•¥

```python
class FewShotPolicy(nn.Module):
    """å°‘æ ·æœ¬å­¦ä¹ ç­–ç•¥"""
    def __init__(self, base_policy, adaptation_steps=5):
        super().__init__()
        self.base_policy = base_policy
        self.adaptation_steps = adaptation_steps
    
    def adapt(self, support_set, lr=0.01):
        """åœ¨å°‘é‡æ”¯æŒæ ·æœ¬ä¸Šå¿«é€Ÿé€‚åº”"""
        # å¤åˆ¶å‚æ•°
        adapted_params = {k: v.clone() for k, v in self.base_policy.named_parameters()}
        
        for _ in range(self.adaptation_steps):
            # è®¡ç®—æ”¯æŒé›†ä¸Šçš„æŸå¤±
            loss = 0
            for obs, action in support_set:
                pred_action = self.base_policy(obs)
                loss += F.mse_loss(pred_action, action)
            loss /= len(support_set)
            
            # æ¢¯åº¦æ›´æ–°
            grads = torch.autograd.grad(loss, adapted_params.values())
            adapted_params = {
                k: v - lr * g 
                for (k, v), g in zip(adapted_params.items(), grads)
            }
        
        return adapted_params
```

## 7. VLA ä¸­çš„è¿ç§»å­¦ä¹ å®è·µ (Practical Transfer in VLA)

### 7.1 OpenVLA çš„è¿ç§»æµç¨‹

```python
## 1. åŠ è½½é¢„è®­ç»ƒæ¨¡å‹
from transformers import AutoModelForVision2Seq
model = AutoModelForVision2Seq.from_pretrained("openvla/openvla-7b")

## 2. é…ç½® LoRA
from peft import LoraConfig, get_peft_model

lora_config = LoraConfig(
    r=16,
    lora_alpha=32,
    target_modules=["q_proj", "v_proj", "k_proj", "o_proj"],
    lora_dropout=0.05,
)
model = get_peft_model(model, lora_config)

## 3. åœ¨ç›®æ ‡æ•°æ®ä¸Šå¾®è°ƒ
for batch in target_dataloader:
    loss = model.compute_loss(**batch)
    loss.backward()
    optimizer.step()

## 4. ä¿å­˜é€‚é…å™¨
model.save_pretrained("./openvla-adapted-myrobot")
```

### 7.2 è¿ç§»æ•ˆæœå¯¹æ¯”

| æ–¹æ³• | ç›®æ ‡åŸŸæ•°æ®é‡ | æˆåŠŸç‡ | è®­ç»ƒæ—¶é—´ |
| :--- | :--- | :--- | :--- |
| ä»å¤´è®­ç»ƒ | 1000 episodes | 65% | 10 hours |
| å…¨é‡å¾®è°ƒ | 100 episodes | 72% | 2 hours |
| LoRA å¾®è°ƒ | 50 episodes | **78%** | **30 min** |
| å†»ç»“+ç­–ç•¥å¤´ | 20 episodes | 60% | 10 min |

## 8. é¢è¯•é«˜é¢‘é—®é¢˜ (Q&A)

**Q1: è¿ç§»å­¦ä¹ å’ŒåŸŸé€‚åº”çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ?**

A:
- **è¿ç§»å­¦ä¹ **: å¹¿ä¹‰æ¦‚å¿µï¼Œä»»ä½•åˆ©ç”¨æºåŸŸçŸ¥è¯†å¸®åŠ©ç›®æ ‡åŸŸå­¦ä¹ çš„æ–¹æ³•
- **åŸŸé€‚åº”**: è¿ç§»å­¦ä¹ çš„å­ç±»ï¼Œä¸“æ³¨äºè§£å†³æºåŸŸå’Œç›®æ ‡åŸŸ**åˆ†å¸ƒä¸åŒ**çš„é—®é¢˜
- **å…³ç³»**: åŸŸé€‚åº”æ˜¯å®ç°è¿ç§»å­¦ä¹ çš„ä¸€ç§å…·ä½“æŠ€æœ¯

**Q2: ä¸ºä»€ä¹ˆ LoRA åœ¨ VLA ä¸­æ•ˆæœå¥½?**

A:
- **æ•°æ®æ•ˆç‡**: æœºå™¨äººæ•°æ®ç¨€ç¼ºï¼Œå°‘é‡å‚æ•°æ›´ä¸æ˜“è¿‡æ‹Ÿåˆ
- **çŸ¥è¯†ä¿ç•™**: VLM çš„é¢„è®­ç»ƒçŸ¥è¯†é€šè¿‡å†»ç»“ä¸»å¹²è¢«ä¿æŠ¤
- **å¤šä»»åŠ¡é€‚é…**: å¯ä»¥ä¸ºä¸åŒä»»åŠ¡/æœºå™¨äººä¿å­˜ç‹¬ç«‹çš„ LoRA é€‚é…å™¨
- **éƒ¨ç½²é«˜æ•ˆ**: æ¨ç†æ—¶å¯ä»¥åˆå¹¶ LoRA æƒé‡ï¼Œæ— é¢å¤–å¼€é”€

**Q3: Sim-to-Real ä¸­ Domain Randomization çš„å±€é™æ€§?**

A:
- **å‚æ•°æ•æ„Ÿ**: éšæœºåŒ–èŒƒå›´éœ€è¦ç²¾å¿ƒè°ƒæ•´ï¼Œè¿‡å¤§ä¼šé™ä½æ€§èƒ½
- **æ— æ³•è¦†ç›–æ‰€æœ‰å·®å¼‚**: æœ‰äº›çœŸå®ä¸–ç•Œçš„å¤æ‚æ€§éš¾ä»¥åœ¨ä»¿çœŸä¸­å»ºæ¨¡
- **è®­ç»ƒæ•ˆç‡**: æç«¯éšæœºåŒ–å¯èƒ½å¯¼è‡´å­¦ä¹ å›°éš¾
- **æ”¹è¿›æ–¹æ¡ˆ**: ç»“åˆ System Identification æˆ– Real-to-Sim

**Q4: è·¨å½¢æ€è¿ç§»çš„æ ¸å¿ƒæŒ‘æˆ˜æ˜¯ä»€ä¹ˆ?**

A:
- **åŠ¨ä½œç©ºé—´ä¸ä¸€è‡´**: ä¸åŒæœºå™¨äºº DoF ä¸åŒ
- **è§‚æµ‹ç©ºé—´å·®å¼‚**: ç›¸æœºä½ç½®ã€åˆ†è¾¨ç‡ä¸åŒ
- **åŠ¨åŠ›å­¦å·®å¼‚**: ä¸åŒæœºå™¨äººçš„è¿åŠ¨ç‰¹æ€§ä¸åŒ
- **è§£å†³æ–¹æ¡ˆ**: ç»Ÿä¸€åŠ¨ä½œè¡¨ç¤º + å½¢æ€æ— å…³ç‰¹å¾å­¦ä¹  + å¯¹æŠ—è®­ç»ƒ

**Q5: å¦‚ä½•åˆ¤æ–­æ˜¯å¦éœ€è¦å…¨é‡å¾®è°ƒ vs LoRA?**

A:
- **LoRA é€‚ç”¨**: ç›®æ ‡åŸŸä¸æºåŸŸç›¸ä¼¼ï¼Œæ•°æ®é‡å°‘ (< 500 episodes)
- **å…¨é‡å¾®è°ƒé€‚ç”¨**: ç›®æ ‡åŸŸå·®å¼‚å¤§ï¼Œæœ‰è¶³å¤Ÿæ•°æ® (> 1000 episodes)
- **ç»éªŒæ³•åˆ™**: å…ˆå°è¯• LoRAï¼Œæ•ˆæœä¸ä½³å†è€ƒè™‘å…¨é‡å¾®è°ƒ

## 9. å‚è€ƒèµ„æº (References)

- **LoRA**: [Low-Rank Adaptation of Large Language Models](https://arxiv.org/abs/2106.09685)
- **Domain Randomization**: [Domain Randomization for Transferring Deep Neural Networks](https://arxiv.org/abs/1703.06907)
- **DANN**: [Domain-Adversarial Training of Neural Networks](https://arxiv.org/abs/1505.07818)
- **Open X-Embodiment**: [Open X-Embodiment: Robotic Learning Datasets and RT-X Models](https://arxiv.org/abs/2310.08864)

---


\newpage

# ç¬¬14ç« é™„ Co-training


> **å®šä¹‰**: åœ¨è®­ç»ƒ VLA æ¨¡å‹æ—¶ï¼ŒåŒæ—¶æ··åˆ **æœºå™¨äººåŠ¨ä½œæ•°æ® (Robot Action Data)** å’Œ **äº’è”ç½‘è§†è§‰è¯­è¨€æ•°æ® (Internet Vision-Language Data)**ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Co-training æ•°æ®æ··åˆç­–ç•¥                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚   æœºå™¨äººæ•°æ®      â”‚       â”‚   äº’è”ç½‘æ•°æ®      â”‚               â”‚
â”‚  â”‚   (Robot Data)   â”‚       â”‚   (Web Data)     â”‚               â”‚
â”‚  â”‚                  â”‚       â”‚                  â”‚               â”‚
â”‚  â”‚  ğŸ“· + ğŸ¯ + ğŸ¦¾    â”‚       â”‚  ğŸ“· + ğŸ“         â”‚               â”‚
â”‚  â”‚  å›¾åƒ æŒ‡ä»¤ åŠ¨ä½œ   â”‚       â”‚  å›¾åƒ æ–‡æœ¬        â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚           â”‚                          â”‚                          â”‚
â”‚           â”‚    æ··åˆæ¯”ä¾‹ 1:1          â”‚                          â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                      â–¼                                          â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚           â”‚      VLA æ¨¡å‹        â”‚                              â”‚
â”‚           â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”   â”‚                              â”‚
â”‚           â”‚   â”‚Actionâ”‚ Text â”‚   â”‚                              â”‚
â”‚           â”‚   â”‚ Head â”‚ Head â”‚   â”‚                              â”‚
â”‚           â”‚   â””â”€â”€â”¬â”€â”€â”€â”´â”€â”€â”¬â”€â”€â”€â”˜   â”‚                              â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                  â”‚      â”‚                                       â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â” â”Œâ”€â”´â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚           â”‚ Action  â”‚ â”‚  Text  â”‚                               â”‚
â”‚           â”‚  Loss   â”‚ â”‚  Loss  â”‚                               â”‚
â”‚           â”‚ (æœºå™¨äºº)â”‚ â”‚ (äº’è”ç½‘)â”‚                               â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                                                 â”‚
â”‚   æ•ˆæœ: ä¿æŒè¯­ä¹‰èƒ½åŠ› âœ“  å­¦ä¹ åŠ¨ä½œæ§åˆ¶ âœ“  é˜²æ­¢ç¾éš¾æ€§é—å¿˜ âœ“         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 1. ä¸ºä»€ä¹ˆéœ€è¦ Co-training?

### 1.1. é˜²æ­¢ç¾éš¾æ€§é—å¿˜ (Catastrophic Forgetting)
VLA æ¨¡å‹é€šå¸¸åŸºäºé¢„è®­ç»ƒçš„ VLM (å¦‚ LLaVA, PaLI) å¾®è°ƒã€‚å¦‚æœåªç”¨æœºå™¨äººæ•°æ® (é€šå¸¸åªæœ‰ç®€å•çš„æŒ‡ä»¤å¦‚ "Pick apple") è®­ç»ƒï¼Œæ¨¡å‹ä¼šè¿…é€Ÿå¿˜è®°é€šç”¨çš„è§†è§‰è¯­ä¹‰çŸ¥è¯†ã€‚
- **ç°è±¡**: æ¨¡å‹èƒ½æŠ“è‹¹æœï¼Œä½†è®¤ä¸å‡º"è‹¹æœ"æ˜¯"æ°´æœ"ï¼Œæˆ–è€…è®¤ä¸å‡ºæœªè§è¿‡çš„ç‰©ä½“ã€‚
- **åæœ**: ä¸§å¤±äº† VLM æœ€å®è´µçš„é€šç”¨å¸¸è¯† (Common Sense)ã€‚

### 1.2. ä¿æŒé€šç”¨æ³›åŒ–èƒ½åŠ› (Generalization)
äº’è”ç½‘æ•°æ®åŒ…å«äº†ä¸°å¯Œçš„ç‰©ä½“ã€åœºæ™¯å’Œæ¦‚å¿µï¼ŒCo-training èƒ½è®©æœºå™¨äººåˆ©ç”¨è¿™äº›çŸ¥è¯†å¤„ç†æœªè§è¿‡çš„æŒ‡ä»¤ (Zero-shot)ã€‚
- **ä¸¾ä¾‹**: è®­ç»ƒæ•°æ®é‡Œåªæœ‰ "Pick up the apple"ï¼Œä½†ç”¨æˆ·æŒ‡ä»¤æ˜¯ "Pick up the red fruit"ã€‚å¦‚æœæ¨¡å‹ä¿ç•™äº† VLM çš„çŸ¥è¯†ï¼Œå®ƒå°±èƒ½ç†è§£ "red fruit" æŒ‡çš„æ˜¯ appleã€‚

## 2. å®æ–½ç­–ç•¥ (Implementation)

### 2.1. æ•°æ®é…æ¯” (Mixing Ratio)
é€šå¸¸é‡‡ç”¨ **1:1** æˆ– **1:X** çš„æ¯”ä¾‹æ··åˆã€‚
- **RT-2**: æœºå™¨äººæ•°æ® : äº’è”ç½‘æ•°æ® = **1 : 1** (Batch å†…éƒ¨æ··åˆ)ã€‚
- **OpenVLA**: æœºå™¨äººæ•°æ® (Bridge/DROID) : LLaVA Instruct Data = **50% : 50%**ã€‚

### 2.2. Loss è®¡ç®— (Loss Masking)
ç”±äºä¸¤ç§æ•°æ®çš„æ ‡ç­¾ä¸åŒï¼Œè®¡ç®— Loss æ—¶éœ€è¦è¿›è¡Œ Maskingï¼š

| æ•°æ®ç±»å‹ | è¾“å…¥ (Input) | è¾“å‡º (Output) | Loss è®¡ç®— |
| :--- | :--- | :--- | :--- |
| **æœºå™¨äººæ•°æ®** | Image + Instruction | Action + (Optional) Text | **Action Head Loss** (MSE/CE) + Text Loss |
| **äº’è”ç½‘æ•°æ®** | Image + Text | Text (Caption/VQA) | **Text Token Loss** (Next Token Prediction) |

> **æ³¨æ„**: å¯¹äºäº’è”ç½‘æ•°æ®ï¼ŒAction Head çš„è¾“å‡ºè¢« Mask æ‰ï¼Œä¸äº§ç”Ÿæ¢¯åº¦ï¼Œå› ä¸ºè¿™äº›æ•°æ®æ²¡æœ‰åŠ¨ä½œæ ‡ç­¾ã€‚

### 2.3. ä»£ç é€»è¾‘ (Pseudo-code)

```python
## åœ¨ä¸€ä¸ª Batch ä¸­æ··åˆä¸¤ç§æ•°æ®
batch_robot = get_robot_batch() # {image, text, action}
batch_web = get_web_batch()     # {image, text, action=None}

## 1. Forward Robot Data
out_robot = model(batch_robot.image, batch_robot.text)
## è®¡ç®—åŠ¨ä½œæŸå¤± (e.g., MSE for diffusion, CE for tokenization)
loss_action = mse_loss(out_robot.pred_action, batch_robot.gt_action)

## 2. Forward Web Data
out_web = model(batch_web.image, batch_web.text)
## è®¡ç®—æ–‡æœ¬æŸå¤± (Next Token Prediction)
loss_text = cross_entropy(out_web.logits, batch_web.gt_text)

## 3. Combined Loss
## lambda é€šå¸¸ä¸º 1.0ï¼Œä¹Ÿå¯ä»¥æ ¹æ®ä»»åŠ¡è°ƒæ•´
total_loss = loss_action + lambda * loss_text

total_loss.backward()
```

## 3. æ¡ˆä¾‹åˆ†æ (Case Studies)

### 3.1. RT-2 (Google DeepMind)
- **å‘ç°**: Co-training å¯¹äºä¿æŒæ¨¡å‹çš„é€»è¾‘æ¨ç†èƒ½åŠ›è‡³å…³é‡è¦ã€‚
- **å®éªŒ**: å¦‚æœä¸åŠ  Web Dataï¼Œæ¨¡å‹åœ¨"å°†å¯ä¹ç½æ”¾åˆ°æ³°å‹’æ–¯å¨å¤«ç‰¹ç…§ç‰‡ä¸Š"è¿™ç§éœ€è¦è¯­ä¹‰ç†è§£çš„ä»»åŠ¡ä¸ŠæˆåŠŸç‡ä¼šæš´è·Œã€‚å› ä¸ºæ¨¡å‹å¿˜è®°äº†"æ³°å‹’æ–¯å¨å¤«ç‰¹"æ˜¯è°ã€‚

### 3.2. OpenVLA (Stanford/Berkeley)
- **ç­–ç•¥**: ä½¿ç”¨ LLaVA çš„å¾®è°ƒæ•°æ® (COCO, GQA, ScienceQA) è¿›è¡Œ Co-trainingã€‚
- **æ•ˆæœ**: ç¡®ä¿äº†æ¨¡å‹åœ¨å¾®è°ƒåŠ¨ä½œæ§åˆ¶çš„åŒæ—¶ï¼Œä¾ç„¶æ˜¯ä¸€ä¸ªåˆæ ¼çš„ VLM (èƒ½èŠå¤©ï¼Œèƒ½æè¿°å›¾åƒ)ã€‚è¿™ä½¿å¾— OpenVLA æ—¢èƒ½æ§åˆ¶æœºå™¨äººï¼Œä¹Ÿèƒ½å½“ VLM ç”¨ã€‚

## 4. é¢è¯•é«˜é¢‘é—®é¢˜

**Q: ä¸ºä»€ä¹ˆ Co-training èƒ½æé«˜ Zero-shot èƒ½åŠ›ï¼Ÿ**
A: æœºå™¨äººæ•°æ®é€šå¸¸æ˜¯ Narrow Domain çš„ï¼ˆç‰¹å®šåœºæ™¯ã€ç‰¹å®šç‰©ä½“ï¼‰ã€‚é€šè¿‡æ··åˆ Web Dataï¼Œæ¨¡å‹ä¿æŒäº†å¯¹ Wide Domainï¼ˆé€šç”¨ç‰©ä½“ã€å¤æ‚è¯­ä¹‰ï¼‰çš„ç†è§£ã€‚å½“é‡åˆ°æœªè§è¿‡çš„ç‰©ä½“ï¼ˆå¦‚"æé¾™ç©å…·"ï¼‰æ—¶ï¼Œæ¨¡å‹å¯ä»¥åˆ©ç”¨ VLM çš„çŸ¥è¯†è¯†åˆ«å®ƒï¼Œå¹¶ç»“åˆå­¦åˆ°çš„æŠ“å–åŠ¨ä½œè¿›è¡Œæ“ä½œã€‚

**Q: æ··åˆæ¯”ä¾‹å¯¹æ€§èƒ½æœ‰ä»€ä¹ˆå½±å“ï¼Ÿ**
A: 
- **Web Data è¿‡å°‘**: ç¾éš¾æ€§é—å¿˜ï¼Œé€šç”¨èƒ½åŠ›ä¸‹é™ã€‚
- **Web Data è¿‡å¤š**: æœºå™¨äººåŠ¨ä½œå­¦ä¹ å˜æ…¢ï¼Œå› ä¸º Action Loss çš„æƒé‡è¢«ç¨€é‡Šã€‚
- **ç»éªŒå€¼**: 1:1 æ˜¯ä¸€ä¸ªç¨³å¥çš„èµ·ç‚¹ã€‚

\newpage

# ç¬¬15ç«  é‡åŒ–æŠ€æœ¯


é‡åŒ– (Quantization) æ˜¯å°†é«˜ç²¾åº¦æµ®ç‚¹æ•° (FP32/FP16) æ˜ å°„åˆ°ä½ç²¾åº¦æ•´æ•° (INT8/INT4) çš„è¿‡ç¨‹ã€‚å®ƒæ˜¯ VLA æ¨¡å‹è¾¹ç¼˜éƒ¨ç½²çš„æ ¸å¿ƒæŠ€æœ¯ã€‚

## 0. ä¸»è¦æ•¸å­¸æ€æƒ³ (Main Mathematical Idea)

> **ç¬¬ä¸€æ€§åŸç†**: **Resolution vs. Range (åˆ†è¾¨ç‡ä¸èŒƒå›´çš„æƒè¡¡)**

ä¸–ç•Œæ˜¯è¿ç»­çš„ï¼Œè®¡ç®—æœºæ˜¯ç¦»æ•£çš„ã€‚é‡åŒ–å°±æ˜¯ç”¨æœ‰é™çš„"æ¡¶"ï¼ˆBucketsï¼Œå¦‚ INT8 çš„ 256 ä¸ªæ¡¶ï¼‰å»è£…æ— é™çš„å®æ•°ã€‚

- **æ ¸å¿ƒæ•°å­¦å·¥å…·**: **Affine Mapping (ä»¿å°„æ˜ å°„)** ä¸ **Rounding Error Minimization**ã€‚
- **è§£é¢˜é€»è¾‘**:
    1.  **æ˜ å°„**: å°†è¿ç»­åŒºé—´ $[min, max]$ çº¿æ€§æ˜ å°„åˆ°æ•´æ•°åŒºé—´ $[0, 2^{b}-1]$ã€‚å…¬å¼ï¼š$q = \text{round}(x/S + Z)$ã€‚
    2.  **æƒè¡¡**: Scale ($S$) å†³å®šäº†æ¡¶çš„å¤§å°ï¼ˆåˆ†è¾¨ç‡ï¼‰ã€‚Scale è¶Šå°ï¼Œåˆ†è¾¨ç‡è¶Šé«˜ï¼Œä½†èƒ½è¦†ç›–çš„èŒƒå›´ï¼ˆRangeï¼‰è¶Šå°ã€‚
    3.  **æŒ‘æˆ˜**: å¦‚æœæ•°æ®ä¸­æœ‰ç¦»ç¾¤å€¼ï¼ˆOutliersï¼‰ï¼Œä¸ºäº†åŒ…ä½å®ƒï¼ŒScale å¿…é¡»å¾ˆå¤§ï¼Œå¯¼è‡´å¤§éƒ¨åˆ†æ­£å¸¸æ•°æ®çš„åˆ†è¾¨ç‡æä½ï¼ˆæ‰€æœ‰æ¡¶éƒ½ç©ºäº†ï¼‰ã€‚é‡åŒ–çš„è‰ºæœ¯å°±åœ¨äºå¦‚ä½•å¤„ç†è¿™äº›"æ£ä¹±"çš„ç¦»ç¾¤å€¼ã€‚

## 1. åŸºç¡€åŸç†
â”‚                                                                 â”‚
â”‚   FP32 æƒé‡                    INT8/INT4 æƒé‡                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚   â”‚ 0.0234  â”‚                  â”‚   3     â”‚                      â”‚
â”‚   â”‚ 0.1567  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶    â”‚   20    â”‚                      â”‚
â”‚   â”‚-0.0891  â”‚    é‡åŒ– (Q)      â”‚  -11    â”‚                      â”‚
â”‚   â”‚ 0.2103  â”‚                  â”‚   27    â”‚                      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚       â–²                             â”‚                           â”‚
â”‚       â”‚                             â”‚                           â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚              åé‡åŒ– (DeQ)                                        â”‚
â”‚                                                                 â”‚
â”‚   å­˜å‚¨: 32-bit â”€â”€â”€â”€â”€â”€â”€â”€â–¶ 4-bit (8x å‹ç¼©)                        â”‚
â”‚   ç²¾åº¦: é«˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ ä½ (æœ‰æŸå¤±)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 1. åŸºç¡€åŸç†

### 1.1. æ˜ å°„å…¬å¼
å°†æµ®ç‚¹æ•° $x$ æ˜ å°„åˆ°æ•´æ•° $q$ï¼š


$$
q = \text{round}\left( \frac{x}{S} + Z \right)
$$


åé‡åŒ– (Dequantization)ï¼š


$$
\hat{x} = S(q - Z)
$$

å…¶ä¸­ï¼š
- $S$ (Scale): ç¼©æ”¾å› å­ï¼Œå†³å®šäº†é‡åŒ–çš„ç²’åº¦ã€‚
- $Z$ (Zero-point): é›¶ç‚¹åç§»ï¼Œç”¨äºå¯¹é½é›¶ç‚¹ã€‚

### 1.2. å¯¹ç§° vs éå¯¹ç§° (Symmetric vs Asymmetric)

```
å¯¹ç§°é‡åŒ– (Symmetric)              éå¯¹ç§°é‡åŒ– (Asymmetric)
        Z = 0                           Z â‰  0

    -127 â—€â”€â”€â”€â”€â”€â”€â–¶ +127              0 â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ 255
      â”‚     0     â”‚                 â”‚      Z       â”‚
      â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤                 â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
      â”‚     â”‚     â”‚                 â”‚      â”‚       â”‚
   â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€           â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€
     min   0    max               min    0       max
      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                              â”‚
       æ•°æ®åˆ†å¸ƒå¯¹ç§°                    æ•°æ®åˆ†å¸ƒåç§»
     (é€‚åˆæƒé‡ weights)           (é€‚åˆæ¿€æ´»å€¼ activations)
```

#### å¯¹ç§°é‡åŒ– (Symmetric)
- **ç‰¹ç‚¹**: $Z=0$ã€‚æ˜ å°„èŒƒå›´æ˜¯å¯¹ç§°çš„ (e.g., INT8: $[-127, 127]$)ã€‚
- **å…¬å¼**: $q = \text{round}(x / S)$ã€‚
- **ä¼˜ç‚¹**: è®¡ç®—å¿« (ä¸éœ€è¦åŠ å‡ Zero-point)ã€‚
- **ç¼ºç‚¹**: å¦‚æœæ•°æ®åˆ†å¸ƒä¸¥é‡ä¸å¯¹ç§° (e.g., ReLU åçš„æ¿€æ´»å€¼å…¨æ˜¯æ­£çš„)ï¼Œä¼šæµªè´¹ä¸€åŠçš„é‡åŒ–èŒƒå›´ã€‚

#### éå¯¹ç§°é‡åŒ– (Asymmetric)
- **ç‰¹ç‚¹**: $Z \neq 0$ã€‚æ˜ å°„èŒƒå›´å¯ä»¥é€‚é…æ•°æ®åˆ†å¸ƒ (e.g., $[min, max]$ æ˜ å°„åˆ° $[0, 255]$)ã€‚
- **ä¼˜ç‚¹**: ç²¾åº¦æ›´é«˜ï¼Œå……åˆ†åˆ©ç”¨ bit ä½ã€‚
- **ç¼ºç‚¹**: è®¡ç®—ç¨æ…¢ã€‚

---

## 2. ç²’åº¦ (Granularity)

é‡åŒ–å‚æ•° $S$ å’Œ $Z$ æ˜¯æ€ä¹ˆç®—çš„ï¼Ÿå–å†³äºç²’åº¦ã€‚

### 2.1. Per-Tensor (Layer-wise)
- æ•´ä¸ª Tensor å…±äº«ä¸€ç»„ $(S, Z)$ã€‚
- **ä¼˜ç‚¹**: ç¡¬ä»¶å®ç°ç®€å•ã€‚
- **ç¼ºç‚¹**: ç²¾åº¦æœ€å·®ã€‚å¦‚æœ Tensor é‡Œæœ‰ä¸€ä¸ªæå¤§çš„ç¦»ç¾¤å€¼ (Outlier)ï¼Œæ•´ä¸ª Tensor çš„ Scale éƒ½ä¼šè¢«æ‹‰å¤§ï¼Œå¯¼è‡´å°æ•°å€¼å…¨éƒ¨å˜æˆ 0ã€‚

### 2.2. Per-Channel (Channel-wise)
- æ¯ä¸€è¡Œ (æˆ–æ¯ä¸€åˆ—) æœ‰ä¸€ç»„ $(S, Z)$ã€‚
- **ä¼˜ç‚¹**: ç²¾åº¦æ˜¾è‘—æå‡ï¼Œæ˜¯ CNN/LLM æƒé‡é‡åŒ–çš„æ ‡å‡†åšæ³•ã€‚
- **ç¼ºç‚¹**: å­˜å‚¨ Scale éœ€è¦é¢å¤–ç©ºé—´ (ä½†åœ¨å¤§æ¨¡å‹ä¸­å¯å¿½ç•¥)ã€‚

### 2.3. Per-Token / Per-Group
- **Per-Token**: é’ˆå¯¹æ¿€æ´»å€¼ (Activation)ï¼Œæ¯ä¸ª Token åŠ¨æ€è®¡ç®— Scaleã€‚
- **Per-Group**: å°†æƒé‡æ¯ 128 ä¸ªæ•°åˆ†ä¸ºä¸€ç»„ (Group)ï¼Œæ¯ç»„ä¸€ä¸ª Scaleã€‚è¿™æ˜¯ **4-bit é‡åŒ– (å¦‚ AWQ, GPTQ)** çš„æ ‡é…ï¼Œå› ä¸º 4-bit ç²¾åº¦å¤ªä½ï¼Œå¿…é¡»ç”¨ç»†ç²’åº¦ Scale æ¥è¡¥ã€‚

---

## 3. è¿›é˜¶éš¾é¢˜ï¼šç¦»ç¾¤å€¼ (Outliers)

LLM / VLA æ¨¡å‹æœ‰ä¸€ä¸ªç‰¹æ€§ï¼š**æ¿€æ´»å€¼ä¸­å­˜åœ¨æç«¯çš„ç¦»ç¾¤å€¼** (Outliers)ã€‚è¿™äº›å€¼è™½ç„¶å¾ˆå°‘ï¼Œä½†å¯¹æ¨¡å‹æ€§èƒ½è‡³å…³é‡è¦ã€‚

### 3.1. ä¸ºä»€ä¹ˆç›´æ¥é‡åŒ–ä¼šå¤±è´¥ï¼Ÿ
å¦‚æœç›´æ¥åš INT8 é‡åŒ–ï¼Œä¸ºäº†åŒ…ä½é‚£ä¸ªå·¨å¤§çš„ Outlierï¼ŒScale ä¼šå˜å¾—å¾ˆå¤§ï¼Œå¯¼è‡´å…¶ä»– 99.9% çš„æ­£å¸¸æ•°å€¼éƒ½è¢«å‹ç¼©åˆ°äº† 0ï¼Œæ¨¡å‹ç›´æ¥å‚»æ‰ã€‚

### 3.2. è§£å†³æ–¹æ¡ˆï¼šSmoothQuant / AWQ
- **SmoothQuant**: æ•°å­¦ç­‰ä»·å˜æ¢ã€‚
  $$ Y = X W = (X \cdot s^{-1}) \cdot (s \cdot W) $$
  æŠŠæ¿€æ´»å€¼ $X$ é‡Œçš„ Outlier "å¹³æ‘Š" (Smooth) åˆ°æƒé‡ $W$ ä¸Šã€‚è®© $X$ å˜å°ï¼Œè®© $W$ å˜å¤§ã€‚å› ä¸ºæƒé‡é€šå¸¸æ¯”è¾ƒå‡åŒ€ï¼Œæ›´å®¹æ˜“é‡åŒ–ã€‚
- **AWQ (Activation-aware Weight Quantization)**:
  ä¸é‡åŒ–é‚£äº›å¯¹åº”é‡è¦æ¿€æ´»å€¼ (Salient Weights) çš„æƒé‡ï¼Œæˆ–è€…ä¿ç•™æ›´é«˜çš„ç²¾åº¦ã€‚

---

## 4. é¢è¯•é«˜é¢‘è€ƒç‚¹

**Q: ä¸ºä»€ä¹ˆ 4-bit é‡åŒ–é€šå¸¸æ¯” 8-bit é‡åŒ–æ›´éš¾ï¼Ÿ**
A: 4-bit åªæœ‰ 16 ä¸ªæ ¼å­ã€‚å¦‚æœ Scale ç¨å¾®æ²¡é€‰å¥½ï¼Œè¯¯å·®å°±ä¼šå·¨å¤§ã€‚æ‰€ä»¥ 4-bit é€šå¸¸éœ€è¦ **Per-Group** é‡åŒ– (Group Size=128) å’Œæ›´å¤æ‚çš„æ ¡å‡†ç®—æ³• (å¦‚ GPTQ)ã€‚

**Q: Post-Training Quantization (PTQ) vs Quantization-Aware Training (QAT)**
- **PTQ**: æ‹¿è®­ç»ƒå¥½çš„æ¨¡å‹ç›´æ¥é‡åŒ– (åŠ å°‘é‡æ ¡å‡†æ•°æ®)ã€‚ç®€å•ï¼Œä¸»æµã€‚
- **QAT**: è®­ç»ƒæ—¶å°±æ¨¡æ‹Ÿé‡åŒ–è¯¯å·® (Fake Quantization)ã€‚ç²¾åº¦æœ€é«˜ï¼Œä½†è®­ç»ƒæˆæœ¬é«˜ï¼ŒVLA é¢†åŸŸè¾ƒå°‘ç”¨ã€‚

**Q: æƒé‡é‡åŒ– (Weight-only) vs æ¿€æ´»é‡åŒ– (Activation Quantization)**
- **W4A16**: æƒé‡ 4-bitï¼Œæ¿€æ´» FP16ã€‚çœæ˜¾å­˜ï¼Œæ¨ç†é€Ÿåº¦å—é™äºåé‡åŒ–å¸¦å®½ã€‚
- **W8A8**: æƒé‡ 8-bitï¼Œæ¿€æ´» 8-bitã€‚å¯ä»¥ä½¿ç”¨ INT8 Tensor Core åŠ é€Ÿè®¡ç®—ï¼ŒçœŸæ­£çš„æ¨ç†åŠ é€Ÿã€‚

\newpage

# ç¬¬å››éƒ¨åˆ†ï¼šæ„ŸçŸ¥ä¸ç©ºé—´æ™ºèƒ½


\newpage

# ç¬¬16ç«  ç©ºé—´æ•°å­¦åŸºç¡€


å¯¹äº AI èƒŒæ™¯çš„åŒå­¦æ¥è¯´ï¼Œæœºå™¨äººå­¦æœ€ä»¤äººå¤´å¤§çš„å¾€å¾€ä¸æ˜¯æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œè€Œæ˜¯**åæ ‡å˜æ¢ (Coordinate Transformations)**ã€‚ç†è§£ç©ºé—´å…³ç³»æ˜¯è®­ç»ƒ VLA æ¨¡å‹çš„åŸºç¡€ã€‚

## 0. ä¸»è¦æ•¸å­¸æ€æƒ³ (Main Mathematical Idea)

> **ç¬¬ä¸€æ€§åŸç†**: **Rigid Body Invariance (åˆšä½“ä¸å˜æ€§ / Lie Group SE(3))**

ç‰©ç†ä¸–ç•Œä¸­çš„ç‰©ä½“æ˜¯"åˆšæ€§"çš„ï¼Œç§»åŠ¨æˆ–æ—‹è½¬å®ƒä»¬ä¸ä¼šæ”¹å˜å®ƒä»¬çš„å½¢çŠ¶æˆ–å†…éƒ¨è·ç¦»ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬ä¸èƒ½ç”¨æ™®é€šçš„åŠ æ³•æ¥å¤„ç†æ—‹è½¬ï¼ˆ$R_1 + R_2$ æ²¡æœ‰ç‰©ç†æ„ä¹‰ï¼‰ï¼Œè€Œå¿…é¡»éµå¾ª**ç¾¤è®º (Group Theory)** çš„è§„åˆ™ã€‚

- **æ ¸å¿ƒæ•°å­¦å·¥å…·**: **Lie Groups (æç¾¤ SE(3))** ä¸ **Lie Algebras (æä»£æ•° se(3))**ã€‚
- **è§£é¢˜é€»è¾‘**:
    1.  **éæ¬§å‡ ä½•**: æ—‹è½¬ç©ºé—´æ˜¯å¼¯æ›²çš„ï¼ˆæµå½¢ï¼‰ã€‚ä¸ºäº†åœ¨ç¥ç»ç½‘ç»œä¸­å¤„ç†å®ƒï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°åˆé€‚çš„è¡¨ç¤ºï¼ˆå¦‚å››å…ƒæ•°ã€6Dè¡¨ç¤ºï¼‰ï¼Œä»¥é¿å…å¥‡å¼‚æ€§ï¼ˆä¸‡å‘èŠ‚æ­»é”ï¼‰å’Œä¸è¿ç»­æ€§ã€‚
    2.  **ç›¸å¯¹æ€§**: æ‰€æœ‰çš„ä½å§¿éƒ½æ˜¯ç›¸å¯¹çš„ ($T_A^B$)ã€‚æ•°å­¦æ ¸å¿ƒæ˜¯**é“¾å¼æ³•åˆ™** ($T_A^C = T_A^B \times T_B^C$)ï¼Œè¿™å¯¹åº”äºåœ¨ä¸åŒåæ ‡ç³»ä¹‹é—´æ— æŸåœ°ä¼ é€’ä¿¡æ¯ã€‚

## 1. æ ¸å¿ƒåæ ‡ç³» (Core Frames)

åœ¨æœºå™¨äººæ“ä½œä¸­ï¼Œæˆ‘ä»¬å¿…é¡»æ—¶åˆ»æ¸…æ¥šæ•°æ®æ˜¯åœ¨å“ªä¸ªåæ ‡ç³»ä¸‹å®šä¹‰çš„ã€‚

### 1.1. World Frame (ä¸–ç•Œåæ ‡ç³») $\{W\}$
- **å®šä¹‰**: å…¨å±€å›ºå®šçš„å‚è€ƒç³»ï¼Œé€šå¸¸æ˜¯æœºå™¨äººåº•åº§å›ºå®šçš„æ¡Œå­è§’ï¼Œæˆ–è€…æˆ¿é—´çš„æŸä¸ªè§’è½ã€‚
- **ä½œç”¨**: å¤šæœºå™¨äººåä½œæ—¶çš„ç»Ÿä¸€åŸºå‡†ã€‚

### 1.2. Base Frame (åŸºåº§åæ ‡ç³») $\{B\}$
- **å®šä¹‰**: æœºå™¨äººåº•åº§ (Base Link) çš„ä¸­å¿ƒã€‚
- **ä½œç”¨**: **ç»å¤§å¤šæ•°å•è‡‚æœºå™¨äººçš„ Action éƒ½æ˜¯ç›¸å¯¹äº Base Frame å®šä¹‰çš„**ã€‚
- **æ³¨æ„**: å¦‚æœæœºå™¨äººæ˜¯ç§»åŠ¨çš„ (Mobile Manipulator)ï¼ŒBase Frame æœ¬èº«æ˜¯åœ¨ World Frame ä¸­ç§»åŠ¨çš„ã€‚

### 1.3. End-effector Frame (æœ«ç«¯åæ ‡ç³» / TCP) $\{E\}$
- **å®šä¹‰**: æœºæ¢°è‡‚æœ«ç«¯æ‰§è¡Œå™¨ (Gripper) çš„ä¸­å¿ƒç‚¹ (Tool Center Point, TCP)ã€‚é€šå¸¸ $Z$ è½´æŒ‡å‘å¤¹çˆªå»¶ä¼¸æ–¹å‘ï¼Œ$X$ è½´æŒ‡å‘å¤¹çˆªé—­åˆæ–¹å‘ã€‚
- **ä½œç”¨**: æè¿°â€œæ‰‹â€çš„ä½ç½®å’Œæœå‘ã€‚
- **Delta Action**: å¾ˆå¤šæ—¶å€™æ¨¡å‹é¢„æµ‹çš„æ˜¯ TCP ç›¸å¯¹äº**å½“å‰æ—¶åˆ» TCP** çš„ç§»åŠ¨é‡ (å³åœ¨è‡ªå·±çš„åæ ‡ç³»ä¸‹å¾€å‰èµ° 1cm)ã€‚

### 1.4. Camera Frame (ç›¸æœºåæ ‡ç³») $\{C\}$
- **å®šä¹‰**: ä»¥ç›¸æœºå…‰å¿ƒä¸ºåŸç‚¹ï¼Œ$Z$ è½´é€šå¸¸æŒ‡å‘å‰æ–¹ï¼Œ$X$ è½´å‘å³ï¼Œ$Y$ è½´å‘ä¸‹ (OpenCV æ ‡å‡†)ã€‚
- **ä½œç”¨**: è§†è§‰è¾“å…¥ (RGB/Depth) æœ€åˆéƒ½æ˜¯åœ¨ Camera Frame ä¸‹çš„ã€‚

---

## 2. é½æ¬¡å˜æ¢çŸ©é˜µ (Homogeneous Transformation Matrix)

ä¸ºäº†ç»Ÿä¸€æè¿°æ—‹è½¬ (Rotation) å’Œå¹³ç§» (Translation)ï¼Œæˆ‘ä»¬ä½¿ç”¨ $4 \times 4$ çš„é½æ¬¡å˜æ¢çŸ©é˜µ $T$ã€‚


$$
T_{A}^{B} = \begin{bmatrix} R_{3\times3} & t_{3\times1} \\ 0_{1\times3} & 1 \end{bmatrix} \in SE(3)
$$


- **ç‰©ç†å«ä¹‰**: æè¿°äº†åæ ‡ç³» $\{A\}$ ç›¸å¯¹äºåæ ‡ç³» $\{B\}$ çš„ä½å§¿ã€‚
- **ç‚¹çš„å˜æ¢**: å¦‚æœç‚¹ $P$ åœ¨ $\{A\}$ ä¸­çš„åæ ‡æ˜¯ $P_A = [x, y, z, 1]^T$ï¼Œé‚£ä¹ˆå®ƒåœ¨ $\{B\}$ ä¸­çš„åæ ‡æ˜¯ï¼š
  $$ P_B = T_{A}^{B} \times P_A $$

### 2.1. é€†å˜æ¢ (Inverse)
æ±‚é€†çŸ©é˜µå¯¹åº”äºåå‘å˜æ¢ $T_{B}^{A} = (T_{A}^{B})^{-1}$ï¼š

$$
(T_{A}^{B})^{-1} = \begin{bmatrix} R^T & -R^T t \\ 0 & 1 \end{bmatrix}
$$

> **æ³¨æ„**: æ—‹è½¬çŸ©é˜µæ˜¯æ­£äº¤çŸ©é˜µï¼Œæ‰€ä»¥ $R^{-1} = R^T$ï¼Œè®¡ç®—éå¸¸å¿«ã€‚

### 2.2. é“¾å¼æ³•åˆ™ (Chain Rule)
è¿™æ˜¯æœºå™¨äººå­¦ä¸­æœ€å¼ºå¤§çš„å·¥å…·ã€‚ä¾‹å¦‚ï¼Œå·²çŸ¥ç›¸æœºç›¸å¯¹äºä¸–ç•Œçš„å¤–å‚ $T_{C}^{W}$ï¼Œä»¥åŠç‰©ä½“ç›¸å¯¹äºç›¸æœºçš„ä½å§¿ $T_{O}^{C}$ï¼Œæ±‚ç‰©ä½“åœ¨ä¸–ç•Œç³»ä¸‹çš„ä½å§¿ï¼š

$$
T_{O}^{W} = T_{C}^{W} \times T_{O}^{C}
$$


---

## 3. æ—‹è½¬è¡¨ç¤ºæ·±åº¦è§£æ (Rotation Representations Deep Dive)

ä½ç½® $t \in \mathbb{R}^3$ å¾ˆå¥½è¡¨ç¤ºï¼Œä½†æ—‹è½¬ $R \in SO(3)$ æ˜¯éçº¿æ€§çš„æµå½¢ç»“æ„ï¼Œç¥ç»ç½‘ç»œå¾ˆéš¾ç›´æ¥é¢„æµ‹ã€‚

### 3.1. æ¬§æ‹‰è§’ (Euler Angles)
- **è¡¨ç¤º**: $(roll, pitch, yaw)$ æˆ– $(\alpha, \beta, \gamma)$ã€‚
- **è‡´å‘½ç¼ºé™·**: **ä¸‡å‘èŠ‚æ­»é” (Gimbal Lock)**ã€‚å½“ä¸­é—´è½´æ—‹è½¬ 90 åº¦æ—¶ï¼Œç¬¬ä¸€è½´å’Œç¬¬ä¸‰è½´é‡åˆï¼Œä¸¢å¤±ä¸€ä¸ªè‡ªç”±åº¦ã€‚
- **ä¸è¿ç»­æ€§**: $\pi$ å’Œ $-\pi$ æ˜¯åŒä¸€ä¸ªè§’åº¦ï¼Œä½†æ•°å€¼ç›¸å·®å·¨å¤§ã€‚è¿™ä¼šå¯¼è‡´ Loss çˆ†ç‚¸ã€‚
- **ç»“è®º**: âŒ **VLA æ¨¡å‹ä¸¥ç¦ç›´æ¥é¢„æµ‹æ¬§æ‹‰è§’**ã€‚

### 3.2. å››å…ƒæ•° (Quaternion)
- **è¡¨ç¤º**: $q = w + xi + yj + zk$ï¼Œé€šå¸¸å†™ä¸ºå‘é‡ $[w, x, y, z]$ã€‚
- **æ€§è´¨**: å¿…é¡»æ»¡è¶³å•ä½æ¨¡çº¦æŸ $\|q\|_2 = 1$ã€‚
- **åŒå€è¦†ç›– (Double Cover)**: $q$ å’Œ $-q$ è¡¨ç¤ºå®Œå…¨ç›¸åŒçš„æ—‹è½¬ã€‚
    - **è®­ç»ƒå‘ç‚¹**: å¦‚æœçœŸå€¼æ˜¯ $q$ï¼Œæ¨¡å‹é¢„æµ‹çš„æ˜¯ $-q$ (å®é™…ä¸Šæ˜¯å¯¹çš„)ï¼Œä½† MSE Loss ä¼šå¾ˆå¤§ã€‚
    - **è§£å†³æ–¹æ¡ˆ**: åœ¨è®¡ç®— Loss å‰ï¼Œå¦‚æœ $\langle q_{pred}, q_{gt} \rangle < 0$ï¼Œåˆ™å°† $q_{gt}$ ç¿»è½¬ä¸º $-q_{gt}$ã€‚
- **ç»“è®º**: âœ… **ä¸»æµé€‰æ‹©** (å¦‚ RT-1)ï¼Œä½†éœ€è¦å¤„ç†å½’ä¸€åŒ–å’ŒåŒå€è¦†ç›–ã€‚

### 3.3. 6D æ—‹è½¬è¡¨ç¤º (6D Rotation Representation) [SOTA]
- **æ¥æº**: *On the Continuity of Rotation Representations in Neural Networks* (Zhou et al., CVPR 2019).
- **æ ¸å¿ƒæ€æƒ³**: ç¥ç»ç½‘ç»œé¢„æµ‹ $3 \times 3$ æ—‹è½¬çŸ©é˜µçš„å‰ä¸¤åˆ— $r_1, r_2$ (å…± 6 ä¸ªæ•°)ã€‚
    - $r_1$ æ˜¯ $X$ è½´æ–¹å‘ (æœªå½’ä¸€åŒ–)ã€‚
    - $r_2$ æ˜¯ $Y$ è½´æ–¹å‘ (æœªå½’ä¸€åŒ–ï¼Œä¸”ä¸ä¸€å®šå‚ç›´äº $X$)ã€‚
- **è¿˜åŸæ­¥éª¤ (Gram-Schmidt æ­£äº¤åŒ–)**:
    1. å½’ä¸€åŒ– $x = \frac{r_1}{\|r_1\|}$
    2. è®¡ç®— $z = x \times r_2$ (å‰ä¹˜å¾—åˆ°å‚ç›´äº $x, r_2$ å¹³é¢çš„è½´)
    3. å½’ä¸€åŒ– $z = \frac{z}{\|z\|}$
    4. è®¡ç®— $y = z \times x$ (å¾—åˆ°å®Œç¾çš„æ­£äº¤ç³»)
    5. ç»„è£… $R = [x, y, z]$
- **ä¼˜ç‚¹**: **è¿ç»­æ€§ (Continuity)**ã€‚è¿™æ˜¯å”¯ä¸€ä¸€ç§åœ¨æ¬§å‡ é‡Œå¾—ç©ºé—´ä¸­è¿ç»­çš„æ—‹è½¬è¡¨ç¤ºï¼Œæœ€é€‚åˆç¥ç»ç½‘ç»œå›å½’ã€‚
- **ç»“è®º**: âœ…âœ… **Diffusion Policy / Pi0 çš„é¦–é€‰**ã€‚

#### PyTorch å®ç°
```python
import torch
import torch.nn.functional as F

def compute_rotation_matrix_from_ortho6d(ortho6d):
    x_raw = ortho6d[:, 0:3]
    y_raw = ortho6d[:, 3:6]
    
    x = F.normalize(x_raw, dim=-1)
    z = torch.cross(x, y_raw, dim=-1)
    z = F.normalize(z, dim=-1)
    y = torch.cross(z, x, dim=-1)
    
    matrix = torch.stack([x, y, z], dim=-1) # (B, 3, 3)
    return matrix
```

---

## 4. ç›¸æœºæŠ•å½±å‡ ä½• (Camera Projection)

VLA æ¨¡å‹å¦‚ä½•ç†è§£ 3D ä¸–ç•Œï¼Ÿé€šè¿‡ç›¸æœºå†…å‚ã€‚

### 4.1. é’ˆå­”ç›¸æœºæ¨¡å‹ (Pinhole Model)
å°† 3D ç‚¹ $P_C = [X, Y, Z]^T$ æŠ•å½±åˆ° 2D åƒç´ å¹³é¢ $p = [u, v]^T$ï¼š


$$
Z \begin{bmatrix} u \\ v \\ 1 \end{bmatrix} = K \begin{bmatrix} X \\ Y \\ Z \end{bmatrix}
$$


å…¶ä¸­ $K$ æ˜¯ **ç›¸æœºå†…å‚çŸ©é˜µ (Intrinsics Matrix)**ï¼š

$$
K = \begin{bmatrix} f_x & 0 & c_x \\ 0 & f_y & c_y \\ 0 & 0 & 1 \end{bmatrix}
$$

- $f_x, f_y$: ç„¦è· (Focal Length)ï¼Œå•ä½æ˜¯åƒç´ ã€‚
- $c_x, c_y$: å…‰å¿ƒ (Principal Point)ï¼Œé€šå¸¸æ˜¯å›¾åƒä¸­å¿ƒã€‚

### 4.2. æ·±åº¦åæŠ•å½± (Deprojection)
å¦‚æœæˆ‘ä»¬æœ‰æ·±åº¦å›¾ $D(u, v) = Z$ï¼Œå¯ä»¥å°†åƒç´  $(u, v)$ è¿˜åŸä¸º 3D ç‚¹ï¼š

$$
X = \frac{(u - c_x) \cdot Z}{f_x}, \quad Y = \frac{(v - c_y) \cdot Z}{f_y}
$$

è¿™å°±æ˜¯ **PointCloud** ç”Ÿæˆçš„åŸç†ã€‚

---

## 5. è¿åŠ¨å­¦ (Kinematics)

### 5.1. æ­£è¿åŠ¨å­¦ (Forward Kinematics, FK)
- **è¾“å…¥**: å…³èŠ‚è§’åº¦ $\theta = [\theta_1, \dots, \theta_7]$ã€‚
- **è¾“å‡º**: æœ«ç«¯ä½å§¿ $T_{E}^{B}$ã€‚
- **è®¡ç®—**: ç®€å•çš„çŸ©é˜µè¿ä¹˜ã€‚$T_{E}^{B} = T_{1}^{B}(\theta_1) \times T_{2}^{1}(\theta_2) \dots$

### 5.2. é€†è¿åŠ¨å­¦ (Inverse Kinematics, IK)
- **è¾“å…¥**: æœŸæœ›çš„æœ«ç«¯ä½å§¿ $T_{target}$ã€‚
- **è¾“å‡º**: å…³èŠ‚è§’åº¦ $\theta$ã€‚
- **éš¾ç‚¹**: 
    - **å¤šè§£**: åŒä¸€ä¸ªä½ç½®ï¼Œæœºæ¢°è‡‚å¯èƒ½æœ‰å¤šç§å§¿æ€åˆ°è¾¾ (Elbow up / Elbow down)ã€‚
    - **æ— è§£**: ç›®æ ‡ç‚¹è¶…å‡ºå·¥ä½œç©ºé—´ã€‚
- **VLA ä¸­çš„åº”ç”¨**: 
    - é€šå¸¸ VLA æ¨¡å‹é¢„æµ‹ **End-effector Pose** (Task Space)ï¼Œç„¶åé€šè¿‡ **IK Solver** (å¦‚ PyBullet IK æˆ– Franka IK) è®¡ç®—å‡ºå…³èŠ‚è§’åº¦å‘é€ç»™ç”µæœºã€‚

---

## 6. é¢è¯•é«˜é¢‘è€ƒç‚¹

**Q: ä¸ºä»€ä¹ˆ VLA æ¨¡å‹é€šå¸¸é¢„æµ‹ Delta Pose è€Œä¸æ˜¯ Absolute Poseï¼Ÿ**
A: 
1. **æ³›åŒ–æ€§**: Delta Action (å¦‚â€œå‘å‰ç§»åŠ¨ 1cmâ€) åœ¨ä¸åŒä½ç½®ã€ä¸åŒæœºå™¨äººå°ºå¯¸ä¸‹æ›´é€šç”¨ã€‚
2. **è¯¯å·®è§£è€¦**: ç»å¯¹åæ ‡å¼ºä¾èµ–äº Base Frame çš„æ ‡å®šã€‚å¦‚æœç›¸æœºå¤–å‚ $T_{C}^{B}$ æœ‰ 1cm çš„è¯¯å·®ï¼Œé¢„æµ‹ç»å¯¹åæ ‡å°±ä¼šå…¨ç¨‹åå·® 1cmã€‚è€Œ Delta Action é…åˆé«˜é¢‘é—­ç¯ (Closed-loop)ï¼Œæ¨¡å‹å¯ä»¥åƒäººçœ¼ä¸€æ ·ï¼Œâ€œçœ‹ç€æ‰‹â€è¿›è¡Œå¾®è°ƒï¼Œå¯¹å¤–å‚è¯¯å·®ä¸æ•æ„Ÿã€‚

**Q: ä¸ºä»€ä¹ˆæ—‹è½¬çŸ©é˜µä¸é€‚åˆç›´æ¥ä½œä¸ºç¥ç»ç½‘ç»œè¾“å‡ºï¼Ÿ**
A: æ—‹è½¬çŸ©é˜µå¿…é¡»æ»¡è¶³æ­£äº¤çº¦æŸ $R^T R = I$ å’Œè¡Œåˆ—å¼ $\det(R)=1$ã€‚è¿™æ˜¯ä¸€ä¸ªä½äºæµå½¢ (Manifold) ä¸Šçš„çº¦æŸã€‚ç¥ç»ç½‘ç»œè¾“å‡ºçš„æ˜¯æ— çº¦æŸçš„ $\mathbb{R}^9$ å‘é‡ï¼Œå¾ˆéš¾ä¿è¯æ­£äº¤æ€§ã€‚å¼ºè¡Œæ­£äº¤åŒ– (SVD) ä¼šç ´åæ¢¯åº¦ã€‚

**Q: è§£é‡Šä¸€ä¸‹ 6D Rotation çš„è¿ç»­æ€§ä¼˜åŠ¿ã€‚**
A: åœ¨ 3D æ—‹è½¬ç©ºé—´ $SO(3)$ ä¸­ï¼Œæ¬§æ‹‰è§’æœ‰å¥‡å¼‚ç‚¹ï¼Œå››å…ƒæ•°æœ‰åŒå€è¦†ç›– (æ‹“æ‰‘ä¸Šæ˜¯çƒé¢çš„åŒå€è¦†å )ã€‚è¿™å¯¼è‡´ä»ç¥ç»ç½‘ç»œçš„æ¬§å‡ é‡Œå¾—ç©ºé—´ $\mathbb{R}^n$ åˆ° $SO(3)$ çš„æ˜ å°„åœ¨æŸäº›ç‚¹æ˜¯ä¸è¿ç»­çš„ã€‚6D è¡¨ç¤ºé€šè¿‡èˆå¼ƒå†—ä½™çº¦æŸ (æ­£äº¤æ€§ç”±åå¤„ç†ä¿è¯)ï¼Œå®ç°äº† $\mathbb{R}^6 \to SO(3)$ çš„è¿ç»­æ˜ å°„ï¼Œä½¿å¾—è®­ç»ƒæ›´ç¨³å®šã€‚

\newpage

# ç¬¬17ç«  æœºå™¨äººæ§åˆ¶æ–¹æ³•


> **é¢è¯•åœºæ™¯**: "ä»‹ç»ä¸€ä¸‹æœºæ¢°è‡‚çš„æ­£é€†è¿åŠ¨å­¦ï¼Œä»¥åŠå¸¸ç”¨çš„æ§åˆ¶æ–¹æ³•ï¼ˆPIDã€MPCã€é˜»æŠ—æ§åˆ¶ï¼‰çš„åŒºåˆ«ï¼Ÿ"

æœ¬æ–‡æ¶µç›–æœºæ¢°è‡‚çš„è¿åŠ¨å­¦å»ºæ¨¡ã€åŠ¨åŠ›å­¦å»ºæ¨¡ï¼Œä»¥åŠä¸»æµæ§åˆ¶æ–¹æ³•çš„åŸç†ä¸åº”ç”¨ã€‚

## 0. ä¸»è¦æ•¸å­¸æ€æƒ³ (Main Mathematical Idea)

> **ç¬¬ä¸€æ€§åŸç†**: **Error Correction (è¯¯å·®ä¿®æ­£ / Feedback Control)**

æ§åˆ¶ç³»ç»Ÿçš„æ ¸å¿ƒç›®æ ‡æ˜¯æ¶ˆé™¤"æœŸæœ›çŠ¶æ€"ä¸"å®é™…çŠ¶æ€"ä¹‹é—´çš„å·®å¼‚ã€‚

- **æ ¸å¿ƒæ•°å­¦å·¥å…·**: **Differential Equations (å¾®åˆ†æ–¹ç¨‹)** ä¸ **Energy Shaping (èƒ½é‡æ•´å½¢)**ã€‚
- **è§£é¢˜é€»è¾‘**:
    1.  **PID**: åˆ©ç”¨æ³°å‹’çº§æ•°å±•å¼€çš„æ€æƒ³ã€‚Pæ˜¯0é˜¶é¡¹ï¼ˆå½“å‰è¯¯å·®ï¼‰ï¼ŒDæ˜¯1é˜¶é¡¹ï¼ˆå˜åŒ–ç‡/è¶‹åŠ¿ï¼‰ï¼ŒIæ˜¯ç§¯åˆ†é¡¹ï¼ˆå†å²ç´¯ç§¯ï¼‰ã€‚é€šè¿‡è¿™ä¸‰é¡¹çš„çº¿æ€§ç»„åˆæ¥æ‹Ÿåˆæ‰€éœ€çš„æ§åˆ¶é‡ã€‚
    2.  **MPC**: å°†æ§åˆ¶é—®é¢˜è½¬åŒ–ä¸º**ä¼˜åŒ–é—®é¢˜**ã€‚ä¸æ˜¯åªçœ‹è¿™ä¸€æ­¥æ€ä¹ˆèµ°ï¼Œè€Œæ˜¯å‘åå¤šçœ‹ $N$ æ­¥ï¼Œæ‰¾åˆ°ä¸€æ¡æ€»ä»£ä»·æœ€å°çš„è½¨è¿¹ã€‚è¿™æœ¬è´¨ä¸Šæ˜¯åœ¨ç”¨ç®—åŠ›æ¢æ€§èƒ½ï¼ˆSolve optimization at every stepï¼‰ã€‚
    3.  **é˜»æŠ—æ§åˆ¶**: ä¸ç›´æ¥æ§åˆ¶ä½ç½®ï¼Œè€Œæ˜¯æ§åˆ¶åŠ›ä¸ä½ç½®çš„å…³ç³»ï¼ˆåˆšåº¦ $K$ å’Œé˜»å°¼ $B$ï¼‰ã€‚æ•°å­¦ä¸Šæ˜¯æŠŠæœºå™¨äººæ¨¡æ‹Ÿæˆä¸€ä¸ªç‰©ç†ç³»ç»Ÿï¼ˆå¼¹ç°§-é˜»å°¼ç³»ç»Ÿï¼‰ï¼Œè®©å®ƒåœ¨æ¥è§¦ç¯å¢ƒæ—¶è¡¨ç°å‡ºé¡ºåº”æ€§ã€‚

---

## ğŸ“Š æ§åˆ¶æ–¹æ³•å…¨æ™¯å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æœºæ¢°è‡‚æ§åˆ¶æ–¹æ³•åˆ†ç±»                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   æ§åˆ¶å±‚çº§              æ–¹æ³•                    ç‰¹ç‚¹                         â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                                                             â”‚
â”‚   å…³èŠ‚ç©ºé—´æ§åˆ¶          PID                    ç®€å•ã€å¿«é€Ÿã€æ— éœ€æ¨¡å‹          â”‚
â”‚   (Joint Space)        Computed Torque        åŸºäºåŠ¨åŠ›å­¦æ¨¡å‹                â”‚
â”‚                                                                             â”‚
â”‚   ç¬›å¡å°”ç©ºé—´æ§åˆ¶        ä½ç½®æ§åˆ¶               ç²¾ç¡®ä½ç½®è·Ÿè¸ª                  â”‚
â”‚   (Cartesian Space)    é€Ÿåº¦æ§åˆ¶               è½¨è¿¹è·Ÿè¸ª                      â”‚
â”‚                                                                             â”‚
â”‚   åŠ›/æŸ”é¡ºæ§åˆ¶           é˜»æŠ—æ§åˆ¶               å¼¹ç°§-é˜»å°¼è¡Œä¸º                 â”‚
â”‚   (Force/Compliance)   å¯¼çº³æ§åˆ¶               åŠ›è¾“å…¥â†’ä½ç½®è¾“å‡º               â”‚
â”‚                        æ··åˆåŠ›ä½æ§åˆ¶           ä¸åŒæ–¹å‘ä¸åŒæ§åˆ¶              â”‚
â”‚                                                                             â”‚
â”‚   æœ€ä¼˜æ§åˆ¶              MPC                    é¢„æµ‹+ä¼˜åŒ–ï¼Œå¤„ç†çº¦æŸ           â”‚
â”‚   (Optimal Control)    LQR                    çº¿æ€§ç³»ç»Ÿæœ€ä¼˜                  â”‚
â”‚                                                                             â”‚
â”‚   å­¦ä¹ å‹æ§åˆ¶            RL (PPO/SAC)           ç«¯åˆ°ç«¯ç­–ç•¥                    â”‚
â”‚   (Learning-based)     IL (BC)                æ¨¡ä»¿å­¦ä¹                       â”‚
â”‚                                                                             â”‚
â”‚   ğŸ’¡ VLA è¶‹åŠ¿: é«˜å±‚ç”¨ VLA è§„åˆ’åŠ¨ä½œ â†’ åº•å±‚ç”¨ä¼ ç»Ÿæ§åˆ¶æ‰§è¡Œ                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1. è¿åŠ¨å­¦ (Kinematics)

### 1.1 æ­£è¿åŠ¨å­¦ (Forward Kinematics, FK)

**å®šä¹‰**: ç»™å®šå…³èŠ‚è§’åº¦ $\mathbf{q}$ï¼Œæ±‚æœ«ç«¯æ‰§è¡Œå™¨ä½å§¿ $\mathbf{T}_{ee}$ã€‚


$$
\mathbf{T}_{ee} = FK(\mathbf{q}) = \mathbf{T}_1(\theta_1) \cdot \mathbf{T}_2(\theta_2) \cdots \mathbf{T}_n(\theta_n)
$$


```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æ­£è¿åŠ¨å­¦ç¤ºæ„å›¾                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   å…³èŠ‚è§’åº¦                                         æœ«ç«¯ä½å§¿                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚   â”‚ Î¸â‚      â”‚                                    â”‚ x, y, z â”‚               â”‚
â”‚   â”‚ Î¸â‚‚      â”‚  â”€â”€â”€â”€â–º FK (DH å‚æ•°) â”€â”€â”€â”€â–º          â”‚ R (æ—‹è½¬)â”‚               â”‚
â”‚   â”‚ ...     â”‚                                    â”‚         â”‚               â”‚
â”‚   â”‚ Î¸â‚™      â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                              â”‚
â”‚                                                                             â”‚
â”‚   DH å‚æ•° (Denavit-Hartenberg):                                            â”‚
â”‚   â€¢ a_i: è¿æ†é•¿åº¦ (æ²¿ x è½´)                                                 â”‚
â”‚   â€¢ Î±_i: è¿æ†æ‰­è½¬ (ç»• x è½´)                                                 â”‚
â”‚   â€¢ d_i: è¿æ†åè· (æ²¿ z è½´)                                                 â”‚
â”‚   â€¢ Î¸_i: å…³èŠ‚è§’åº¦ (ç»• z è½´)                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä»£ç å®ç°**:

```python
import numpy as np
from scipy.spatial.transform import Rotation as R

def dh_transform(theta, d, a, alpha):
    """å•ä¸ªå…³èŠ‚çš„ DH å˜æ¢çŸ©é˜µ"""
    ct, st = np.cos(theta), np.sin(theta)
    ca, sa = np.cos(alpha), np.sin(alpha)
    return np.array([
        [ct, -st*ca,  st*sa, a*ct],
        [st,  ct*ca, -ct*sa, a*st],
        [0,   sa,     ca,    d   ],
        [0,   0,      0,     1   ]
    ])

def forward_kinematics(joint_angles, dh_params):
    """
    æ­£è¿åŠ¨å­¦è®¡ç®—
    
    Args:
        joint_angles: å…³èŠ‚è§’åº¦ [Î¸â‚, Î¸â‚‚, ..., Î¸â‚™]
        dh_params: DH å‚æ•°è¡¨ [(d, a, Î±), ...]
    
    Returns:
        T_ee: æœ«ç«¯æ‰§è¡Œå™¨å˜æ¢çŸ©é˜µ (4x4)
    """
    T = np.eye(4)
    for i, (theta, (d, a, alpha)) in enumerate(zip(joint_angles, dh_params)):
        T = T @ dh_transform(theta, d, a, alpha)
    return T

## Franka Panda ç¤ºä¾‹ DH å‚æ•° (ç®€åŒ–)
franka_dh = [
    (0.333, 0,      0),       # Joint 1
    (0,     0,     -np.pi/2), # Joint 2
    (0.316, 0,      np.pi/2), # Joint 3
    (0,     0.0825, np.pi/2), # Joint 4
    (0.384, -0.0825,-np.pi/2),# Joint 5
    (0,     0,      np.pi/2), # Joint 6
    (0.107, 0.088,  np.pi/2), # Joint 7 (flange)
]

## è®¡ç®—æœ«ç«¯ä½å§¿
q = [0, -np.pi/4, 0, -3*np.pi/4, 0, np.pi/2, np.pi/4]
T_ee = forward_kinematics(q, franka_dh)
position = T_ee[:3, 3]
rotation = R.from_matrix(T_ee[:3, :3])
```

### 1.2 é€†è¿åŠ¨å­¦ (Inverse Kinematics, IK)

**å®šä¹‰**: ç»™å®šæœ«ç«¯æ‰§è¡Œå™¨ç›®æ ‡ä½å§¿ $\mathbf{T}_{target}$ï¼Œæ±‚å…³èŠ‚è§’åº¦ $\mathbf{q}$ã€‚


$$
\mathbf{q} = IK(\mathbf{T}_{target})
$$


**æ–¹æ³•å¯¹æ¯”**:

| æ–¹æ³• | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
| :--- | :--- | :--- | :--- |
| **è§£æè§£** | ç²¾ç¡®ã€å¿«é€Ÿ | åªé€‚ç”¨äºç‰¹å®šæ„å‹ | 6 è½´å·¥ä¸šè‡‚ |
| **æ•°å€¼è¿­ä»£ (Jacobian)** | é€šç”¨ | å¯èƒ½ä¸æ”¶æ•› | é€šç”¨æœºæ¢°è‡‚ |
| **ä¼˜åŒ–æ–¹æ³•** | å¯åŠ çº¦æŸ | è¾ƒæ…¢ | å†—ä½™è‡‚ã€é¿éšœ |
| **å­¦ä¹ æ–¹æ³• (NN)** | å¿«é€Ÿ | éœ€è¦å¤§é‡æ•°æ® | å®æ—¶åº”ç”¨ |

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     é€†è¿åŠ¨å­¦æ–¹æ³•å¯¹æ¯”                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   è§£æè§£ (Analytic):                                                        â”‚
â”‚   â€¢ å‡ ä½•æ–¹æ³•ï¼šåˆ©ç”¨è‡‚çš„å‡ ä½•å…³ç³»ç›´æ¥æ±‚è§£                                       â”‚
â”‚   â€¢ é€‚ç”¨äº 6 è‡ªç”±åº¦æ ‡å‡†æ„å‹ (å¦‚ UR, Panda)                                  â”‚
â”‚   â€¢ é€šå¸¸æœ‰å¤šè§£ (æœ€å¤š 8 ç»„)ï¼Œéœ€é€‰æ‹©æœ€ä¼˜è§£                                    â”‚
â”‚                                                                             â”‚
â”‚   æ•°å€¼è¿­ä»£ (Jacobian Pseudoinverse):                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   Î”x = J(q) Â· Î”q                                                   â”‚   â”‚
â”‚   â”‚   Î”q = Jâº(q) Â· Î”x   (Jâº ä¸ºä¼ªé€†)                                    â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   è¿­ä»£: q_{k+1} = q_k + Î± Â· Jâº(q_k) Â· (x_target - FK(q_k))         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   ä¼˜åŒ–æ–¹æ³• (å¯åŠ çº¦æŸ):                                                      â”‚
â”‚   min_q  ||FK(q) - T_target||Â² + Î»||q - q_ref||Â²                          â”‚
â”‚   s.t.   q_min â‰¤ q â‰¤ q_max        (å…³èŠ‚é™ä½)                               â”‚
â”‚          ||qÌ‡|| â‰¤ v_max            (é€Ÿåº¦é™åˆ¶)                               â”‚
â”‚          é¿éšœçº¦æŸ                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ•°å€¼ IK å®ç°**:

```python
def jacobian_ik(target_pose, q_init, dh_params, max_iter=100, tol=1e-6):
    """
    åŸºäº Jacobian ä¼ªé€†çš„æ•°å€¼ IK
    
    Args:
        target_pose: ç›®æ ‡ä½å§¿ (4x4 å˜æ¢çŸ©é˜µ)
        q_init: åˆå§‹å…³èŠ‚è§’åº¦
        dh_params: DH å‚æ•°
        
    Returns:
        q: è§£å‡ºçš„å…³èŠ‚è§’åº¦
    """
    q = q_init.copy()
    
    for _ in range(max_iter):
        # å½“å‰ä½å§¿
        T_current = forward_kinematics(q, dh_params)
        
        # ä½å§¿è¯¯å·®
        pos_error = target_pose[:3, 3] - T_current[:3, 3]
        rot_error = rotation_error(T_current[:3, :3], target_pose[:3, :3])
        error = np.concatenate([pos_error, rot_error])
        
        if np.linalg.norm(error) < tol:
            return q
        
        # è®¡ç®— Jacobian
        J = compute_jacobian(q, dh_params)
        
        # ä¼ªé€†æ±‚è§£
        J_pinv = np.linalg.pinv(J)
        dq = J_pinv @ error
        
        # æ›´æ–°
        q = q + 0.5 * dq  # æ­¥é•¿ 0.5
        
        # å…³èŠ‚é™ä½
        q = np.clip(q, q_min, q_max)
    
    return q

def rotation_error(R_current, R_target):
    """è®¡ç®—æ—‹è½¬è¯¯å·® (è½´è§’å½¢å¼)"""
    R_err = R_target @ R_current.T
    axis_angle = R.from_matrix(R_err).as_rotvec()
    return axis_angle
```

### 1.3 é›…å¯æ¯”çŸ©é˜µ (Jacobian)

**å®šä¹‰**: å…³èŠ‚é€Ÿåº¦åˆ°æœ«ç«¯é€Ÿåº¦çš„æ˜ å°„ã€‚


$$
\dot{\mathbf{x}} = \mathbf{J}(\mathbf{q}) \cdot \dot{\mathbf{q}}
$$


å…¶ä¸­ $\dot{\mathbf{x}} = [v_x, v_y, v_z, \omega_x, \omega_y, \omega_z]^T$

**åº”ç”¨**:
- **é€Ÿåº¦æ§åˆ¶**: $\dot{\mathbf{q}} = \mathbf{J}^{-1} \dot{\mathbf{x}}$
- **å¥‡å¼‚æ€§åˆ†æ**: $\det(\mathbf{J}) = 0$ æ—¶å¥‡å¼‚
- **åŠ›ä¼ é€’**: $\boldsymbol{\tau} = \mathbf{J}^T \mathbf{F}$ (æœ«ç«¯åŠ›åˆ°å…³èŠ‚åŠ›çŸ©)

---

## 2. åŠ¨åŠ›å­¦ (Dynamics)

### 2.1 åŠ¨åŠ›å­¦æ–¹ç¨‹

**æ‹‰æ ¼æœ—æ—¥æ–¹ç¨‹**:


$$
\mathbf{M}(\mathbf{q})\ddot{\mathbf{q}} + \mathbf{C}(\mathbf{q}, \dot{\mathbf{q}})\dot{\mathbf{q}} + \mathbf{g}(\mathbf{q}) = \boldsymbol{\tau}
$$


- $\mathbf{M}(\mathbf{q})$: æƒ¯æ€§çŸ©é˜µ (Mass Matrix)
- $\mathbf{C}(\mathbf{q}, \dot{\mathbf{q}})$: ç§‘æ°åŠ›/ç¦»å¿ƒåŠ›çŸ©é˜µ
- $\mathbf{g}(\mathbf{q})$: é‡åŠ›å‘é‡
- $\boldsymbol{\tau}$: å…³èŠ‚åŠ›çŸ©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     åŠ¨åŠ›å­¦å»ºæ¨¡æ–¹æ³•                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   è§£æå»ºæ¨¡ (åŸºäºæ¨¡å‹):                                                      â”‚
â”‚   â€¢ ç‰›é¡¿-æ¬§æ‹‰æ³• (Newton-Euler): é€’å½’è®¡ç®—ï¼Œé«˜æ•ˆ                              â”‚
â”‚   â€¢ æ‹‰æ ¼æœ—æ—¥æ³• (Lagrangian): èƒ½é‡æ–¹æ³•ï¼Œç›´è§‚                                 â”‚
â”‚   â€¢ éœ€è¦ç²¾ç¡®çš„æƒ¯æ€§å‚æ•° (è´¨é‡ã€æƒ¯é‡ã€è´¨å¿ƒä½ç½®)                                â”‚
â”‚                                                                             â”‚
â”‚   æ•°æ®é©±åŠ¨ (å­¦ä¹ å‹):                                                        â”‚
â”‚   â€¢ ç¥ç»ç½‘ç»œæ‹Ÿåˆ: è¾“å…¥ (q, qÌ‡, qÌˆ) â†’ è¾“å‡º Ï„                                   â”‚
â”‚   â€¢ Gaussian Process: ä¸ç¡®å®šæ€§ä¼°è®¡                                         â”‚
â”‚   â€¢ é€‚åˆéš¾ä»¥ç²¾ç¡®å»ºæ¨¡çš„åœºæ™¯ (æŸ”æ€§ã€æ‘©æ“¦)                                     â”‚
â”‚                                                                             â”‚
â”‚   å¸¸ç”¨åº“:                                                                   â”‚
â”‚   â€¢ Pinocchio: C++/Python, é«˜æ•ˆåŠ¨åŠ›å­¦è®¡ç®—                                  â”‚
â”‚   â€¢ PyBullet: ä»¿çœŸå†…ç½®                                                     â”‚
â”‚   â€¢ Drake: å¤šä½“åŠ¨åŠ›å­¦                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 åŠ¨åŠ›å­¦åº“ä½¿ç”¨ (Pinocchio)

```python
import pinocchio as pin
import numpy as np

## åŠ è½½æœºå™¨äººæ¨¡å‹
model = pin.buildModelFromUrdf("panda.urdf")
data = model.createData()

## å½“å‰çŠ¶æ€
q = np.array([0, -np.pi/4, 0, -3*np.pi/4, 0, np.pi/2, np.pi/4])
dq = np.zeros(7)
ddq = np.zeros(7)

## æ­£è¿åŠ¨å­¦
pin.forwardKinematics(model, data, q)
ee_pose = data.oMi[-1]  # æœ«ç«¯ä½å§¿

## åŠ¨åŠ›å­¦è®¡ç®—
## æƒ¯æ€§çŸ©é˜µ M(q)
M = pin.crba(model, data, q)

## ç§‘æ°åŠ› + ç¦»å¿ƒåŠ› C(q, dq) * dq
C_dq = pin.nle(model, data, q, dq) - pin.computeGeneralizedGravity(model, data, q)

## é‡åŠ› g(q)
g = pin.computeGeneralizedGravity(model, data, q)

## é€†åŠ¨åŠ›å­¦: Ï„ = M * ddq + C * dq + g
tau = pin.rnea(model, data, q, dq, ddq)

## æ­£åŠ¨åŠ›å­¦: ddq = M^(-1) * (Ï„ - C * dq - g)
ddq = pin.aba(model, data, q, dq, tau)

## Jacobian
J = pin.computeFrameJacobian(model, data, q, frame_id, pin.ReferenceFrame.LOCAL_WORLD_ALIGNED)
```

---

## 3. æ§åˆ¶æ–¹æ³• (Control Methods)

### 3.0 ç»å…¸åé¦ˆæ§åˆ¶å…¥é—¨ (Control 101)

> **é¢è¯•åœºæ™¯**: "è§£é‡Šä¸€ä¸‹ PID æ§åˆ¶å™¨çš„åŸç†ï¼ŒP/I/D å„é¡¹æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"

#### ä»€ä¹ˆæ˜¯åé¦ˆæ§åˆ¶ï¼Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       åé¦ˆæ§åˆ¶åŸºæœ¬æ¡†å›¾                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   ç›®æ ‡å€¼         è¯¯å·®           æ§åˆ¶å™¨          æ‰§è¡Œå™¨          å®é™…è¾“å‡º      â”‚
â”‚     r    â”€â”€â–¶ âŠ• â”€â”€â–¶ e â”€â”€â–¶ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”€â”€â–¶ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”€â”€â–¶ y            â”‚
â”‚            -â”‚            â”‚ PID/MPC â”‚     â”‚ ç”µæœº/é˜€é—¨â”‚                     â”‚
â”‚             â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚             â”‚                                   â”‚                         â”‚
â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                          åé¦ˆ (ä¼ æ„Ÿå™¨æµ‹é‡)                                  â”‚
â”‚                                                                             â”‚
â”‚   æ ¸å¿ƒæ€æƒ³: æµ‹é‡è¯¯å·® â†’ è°ƒæ•´è¾“å‡º â†’ å‡å°è¯¯å·® â†’ è¾¾åˆ°ç›®æ ‡                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### PID = P + I + D

**PID** = **P**roportionalï¼ˆæ¯”ä¾‹ï¼‰+ **I**ntegralï¼ˆç§¯åˆ†ï¼‰+ **D**erivativeï¼ˆå¾®åˆ†ï¼‰

```
u(t) = Kp Ã— e(t) + Ki Ã— âˆ«e(t)dt + Kd Ã— de(t)/dt
       â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          P            I              D

å…¶ä¸­ e(t) = ç›®æ ‡å€¼ - å½“å‰å€¼ (è¯¯å·®)
```

#### ç›´è§‚ç±»æ¯”ï¼šå¼€è½¦åˆ°ç›®æ ‡ä½ç½®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å¼€è½¦ç±»æ¯”ç†è§£ P/I/D                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   ç›®æ ‡: åœåœ¨ 100 ç±³å¤„                                                        â”‚
â”‚   å½“å‰: åœ¨ 0 ç±³å¤„                                                            â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ P (æ¯”ä¾‹): ç¦»ç›®æ ‡è¶Šè¿œï¼Œè¸©æ²¹é—¨è¶ŠçŒ›                                     â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   90ç±³å¤„ â†’ è½»è¸©æ²¹é—¨     â”‚    10ç±³å¤„ â†’ çŒ›è¸©æ²¹é—¨                       â”‚   â”‚
â”‚   â”‚   "å·®å¾—å¤šå°±ç”¨åŠ›æ¨"                                                  â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   âš ï¸ é—®é¢˜: åªæœ‰ P ä¼šéœ‡è¡ (å†²è¿‡å¤´â†’é€€å›æ¥â†’åˆå†²è¿‡å¤´...)                â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ I (ç§¯åˆ†): æ¶ˆé™¤ç´¯ç§¯è¯¯å·® (ä¸Šå¡æ—¶æ…¢æ…¢åŠ åŠ›)                              â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   "æˆ‘å·²ç»å·®äº† 5 ç§’äº†ï¼Œç´¯ç§¯è¯¯å·®å¤ªå¤šï¼Œå†åŠ ç‚¹æ²¹ï¼"                      â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   âš ï¸ é—®é¢˜: I å¤ªå¤§ä¼šå¯¼è‡´"ç§¯åˆ†é¥±å’Œ"ï¼Œå“åº”å˜æ…¢                        â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ D (å¾®åˆ†): é¢„æµ‹è¶‹åŠ¿ï¼Œé˜²æ­¢è¿‡å†² (å¿«åˆ°äº†å°±è¸©åˆ¹è½¦)                        â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   "é€Ÿåº¦å¤ªå¿«äº†ï¼Œå¿«åˆ°ç›®æ ‡äº†ï¼Œè¸©åˆ¹è½¦ï¼"                                 â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   âš ï¸ é—®é¢˜: D å¯¹å™ªå£°æ•æ„Ÿï¼Œéœ€è¦æ»¤æ³¢                                  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### P/I/D å„é¡¹ä½œç”¨æ€»ç»“

| é¡¹ | å…¬å¼ | ä½œç”¨ | è°ƒå¤§äº†ä¼šæ€æ · | è°ƒå°äº†ä¼šæ€æ · |
| :--- | :--- | :--- | :--- | :--- |
| **P** | `Kp Ã— e` | å‡å°å½“å‰è¯¯å·® | å“åº”å¿«ï¼Œä½†éœ‡è¡ | å“åº”æ…¢ï¼Œç¨³æ€è¯¯å·®å¤§ |
| **I** | `Ki Ã— âˆ«e` | æ¶ˆé™¤ç´¯ç§¯è¯¯å·® | æ¶ˆé™¤ç¨³æ€è¯¯å·®ï¼Œä½†è¿‡å†² | ç¨³æ€è¯¯å·®æ¶ˆä¸æ‰ |
| **D** | `Kd Ã— Ä—` | æŠ‘åˆ¶å˜åŒ–ï¼Œé˜²è¿‡å†² | å“åº”æ…¢ï¼Œå¯¹å™ªå£°æ•æ„Ÿ | è¿‡å†²ä¸¥é‡ |

#### è°ƒå‚å£è¯€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       PID è°ƒå‚å£è¯€                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   Step 1: å…ˆè°ƒ P                                                            â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                         â”‚
â”‚   ä»å°åˆ°å¤§ï¼Œç›´åˆ°ç³»ç»Ÿå¿«é€Ÿå“åº”ä½†ä¸å‰§çƒˆéœ‡è¡                                      â”‚
â”‚   "å®æ¬ å‹¿è¿‡ï¼Œæ…¢æ…¢åŠ "                                                         â”‚
â”‚                                                                             â”‚
â”‚   Step 2: å†è°ƒ D                                                            â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                         â”‚
â”‚   åŠ å…¥ D æŠ‘åˆ¶è¿‡å†²å’Œéœ‡è¡                                                      â”‚
â”‚   "çœ‹åˆ°è¦è¿‡å¤´äº†å°±è¸©åˆ¹è½¦"                                                     â”‚
â”‚                                                                             â”‚
â”‚   Step 3: æœ€åè°ƒ I                                                          â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                         â”‚
â”‚   å¦‚æœæœ‰ç¨³æ€è¯¯å·®ï¼Œæ…¢æ…¢åŠ  I                                                   â”‚
â”‚   "å°å¿ƒç§¯åˆ†é¥±å’Œï¼Œè®¾ä¸Šä¸‹é™ï¼"                                                 â”‚
â”‚                                                                             â”‚
â”‚   ç»éªŒå€¼ (ä»…ä¾›å‚è€ƒ):                                                        â”‚
â”‚   â€¢ å…³èŠ‚ä¼ºæœ: Kp=100~500, Kd=10~50, Ki=0~10                                â”‚
â”‚   â€¢ éœ€è¦æ ¹æ®å®é™…ç³»ç»Ÿè°ƒæ•´                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ä¸ºä»€ä¹ˆ VLA è¿˜éœ€è¦åº•å±‚ PIDï¼Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    VLA æ§åˆ¶å±‚çº§                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                    VLA æ¨¡å‹ (é«˜å±‚)                                   â”‚   â”‚
â”‚   â”‚        è¾“å…¥: å›¾åƒ + è¯­è¨€æŒ‡ä»¤                                         â”‚   â”‚
â”‚   â”‚        è¾“å‡º: æœ«ç«¯ç›®æ ‡ä½å§¿ (x, y, z, rx, ry, rz)                     â”‚   â”‚
â”‚   â”‚        é¢‘ç‡: 1-50 Hz                                                â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                   é€†è¿åŠ¨å­¦ (IK)                                      â”‚   â”‚
â”‚   â”‚        è¾“å…¥: æœ«ç«¯ç›®æ ‡ä½å§¿                                            â”‚   â”‚
â”‚   â”‚        è¾“å‡º: å…³èŠ‚ç›®æ ‡è§’åº¦ (Î¸1, Î¸2, ..., Î¸n)                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                   PID æ§åˆ¶å™¨ (åº•å±‚)                                  â”‚   â”‚
â”‚   â”‚        è¾“å…¥: å…³èŠ‚ç›®æ ‡è§’åº¦ + å½“å‰è§’åº¦                                 â”‚   â”‚
â”‚   â”‚        è¾“å‡º: ç”µæœºåŠ›çŸ©/ç”µæµ                                          â”‚   â”‚
â”‚   â”‚        é¢‘ç‡: 1000 Hz (å®æ—¶!)                                        â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚                               ğŸ¦¾ ç”µæœºè¿åŠ¨                                   â”‚
â”‚                                                                             â”‚
â”‚   ğŸ’¡ VLA è´Ÿè´£"æƒ³åšä»€ä¹ˆ"ï¼ŒPID è´Ÿè´£"æ€ä¹ˆåšåˆ°"                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å¸¸è§é¢è¯•é—®é¢˜

**Q1: åªç”¨ P æ§åˆ¶ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ**

A: ä¸¤ä¸ªé—®é¢˜ï¼š
1. **éœ‡è¡**: P å¤ªå¤§ä¼šå†²è¿‡ç›®æ ‡ï¼Œç„¶åé€€å›æ¥ï¼Œåå¤éœ‡è¡
2. **ç¨³æ€è¯¯å·®**: P æ§åˆ¶éœ€è¦è¯¯å·®æ‰èƒ½äº§ç”Ÿè¾“å‡ºï¼Œæ‰€ä»¥æ°¸è¿œæœ‰ä¸€ç‚¹è¯¯å·®

**Q2: I é¡¹çš„"ç§¯åˆ†é¥±å’Œ"æ˜¯ä»€ä¹ˆï¼Ÿ**

A: å½“è¯¯å·®é•¿æ—¶é—´å­˜åœ¨ï¼ˆå¦‚ç”µæœºå µè½¬ï¼‰ï¼Œç§¯åˆ†é¡¹ä¼šç´¯ç§¯å¾—å¾ˆå¤§ã€‚å³ä½¿è¯¯å·®æ¶ˆå¤±äº†ï¼Œç§¯åˆ†é¡¹ä»ç„¶å¾ˆå¤§ï¼Œå¯¼è‡´è¿‡å†²ã€‚è§£å†³æ–¹æ³•ï¼šè®¾ç½®ç§¯åˆ†ä¸Šä¸‹é™ï¼ˆAnti-windupï¼‰ã€‚

**Q3: D é¡¹ä¸ºä»€ä¹ˆå¯¹å™ªå£°æ•æ„Ÿï¼Ÿ**

A: D é¡¹æ˜¯è¯¯å·®çš„å¾®åˆ†ï¼ˆå˜åŒ–ç‡ï¼‰ã€‚å™ªå£°å˜åŒ–å¾ˆå¿«ï¼Œå¾®åˆ†åä¼šè¢«æ”¾å¤§ã€‚è§£å†³æ–¹æ³•ï¼šå¯¹è¯¯å·®æˆ– D é¡¹è¾“å‡ºåšä½é€šæ»¤æ³¢ã€‚

---

### 3.1 PID æ§åˆ¶

**æœ€åŸºç¡€çš„å…³èŠ‚ç©ºé—´æ§åˆ¶**:


$$
\tau = K_p (q_d - q) + K_d (\dot{q}_d - \dot{q}) + K_i \int (q_d - q) dt
$$


```python
class PIDController:
    """å•å…³èŠ‚ PID æ§åˆ¶å™¨"""
    def __init__(self, kp, ki, kd, dt=0.001):
        self.kp = kp
        self.ki = ki
        self.kd = kd
        self.dt = dt
        self.integral = 0
        self.prev_error = 0
    
    def compute(self, q_desired, q_current, dq_current=None):
        """
        è®¡ç®—æ§åˆ¶åŠ›çŸ©
        
        Args:
            q_desired: ç›®æ ‡ä½ç½®
            q_current: å½“å‰ä½ç½®
            dq_current: å½“å‰é€Ÿåº¦ (å¯é€‰)
        """
        error = q_desired - q_current
        
        # P é¡¹
        p_term = self.kp * error
        
        # I é¡¹
        self.integral += error * self.dt
        self.integral = np.clip(self.integral, -1, 1)  # ç§¯åˆ†é™å¹…
        i_term = self.ki * self.integral
        
        # D é¡¹
        if dq_current is not None:
            d_term = -self.kd * dq_current  # é€Ÿåº¦åé¦ˆ
        else:
            d_term = self.kd * (error - self.prev_error) / self.dt
        
        self.prev_error = error
        
        return p_term + i_term + d_term

## å¤šå…³èŠ‚ PID
class JointPIDController:
    def __init__(self, n_joints, kp, ki, kd, dt=0.001):
        self.controllers = [
            PIDController(kp[i], ki[i], kd[i], dt) 
            for i in range(n_joints)
        ]
    
    def compute(self, q_desired, q_current, dq_current):
        tau = np.zeros(len(self.controllers))
        for i, ctrl in enumerate(self.controllers):
            tau[i] = ctrl.compute(q_desired[i], q_current[i], dq_current[i])
        return tau
```

**ä¼˜ç¼ºç‚¹**:

| ä¼˜ç‚¹ | ç¼ºç‚¹ |
| :--- | :--- |
| ç®€å•ã€æ— éœ€æ¨¡å‹ | æ— æ³•å¤„ç†éçº¿æ€§ |
| è°ƒå‚ç›´è§‚ | è€¦åˆç³»ç»Ÿæ€§èƒ½å·® |
| è®¡ç®—å¿« | æ— æ³•å¤„ç†çº¦æŸ |

### 3.2 é˜»æŠ—æ§åˆ¶ (Impedance Control)

**æ ¸å¿ƒæ€æƒ³**: è®©æœºå™¨äººè¡¨ç°å¾—åƒå¼¹ç°§-é˜»å°¼ç³»ç»Ÿã€‚


$$
\mathbf{F} = \mathbf{M}_d (\ddot{\mathbf{x}}_d - \ddot{\mathbf{x}}) + \mathbf{B}_d (\dot{\mathbf{x}}_d - \dot{\mathbf{x}}) + \mathbf{K}_d (\mathbf{x}_d - \mathbf{x})
$$


- $\mathbf{M}_d$: æœŸæœ›æƒ¯æ€§
- $\mathbf{B}_d$: æœŸæœ›é˜»å°¼
- $\mathbf{K}_d$: æœŸæœ›åˆšåº¦

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     é˜»æŠ—æ§åˆ¶ vs å¯¼çº³æ§åˆ¶                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   é˜»æŠ—æ§åˆ¶ (Impedance Control):                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   è¾“å…¥: ä½ç½®è¯¯å·® Î”x                                                 â”‚   â”‚
â”‚   â”‚   è¾“å‡º: åŠ› F                                                        â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   F = K * Î”x + B * Î”áº‹                                               â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   é€‚ç”¨: ä½ç½®æ§åˆ¶å‹æœºå™¨äºº + åŠ›ä¼ æ„Ÿå™¨                                 â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   å¯¼çº³æ§åˆ¶ (Admittance Control):                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   è¾“å…¥: å¤–åŠ› F (åŠ›ä¼ æ„Ÿå™¨æµ‹é‡)                                       â”‚   â”‚
â”‚   â”‚   è¾“å‡º: ä½ç½®ä¿®æ­£ Î”x                                                 â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   Î”x = (1/K) * F + (1/B) * âˆ«F dt                                    â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   é€‚ç”¨: çº¯ä½ç½®æ§åˆ¶æœºå™¨äºº (æ— åŠ›çŸ©æ¥å£)                               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   ğŸ’¡ é€‰æ‹©åŸåˆ™:                                                              â”‚
â”‚   â€¢ èƒ½ç›´æ¥æ§åˆ¶åŠ›/åŠ›çŸ© â†’ é˜»æŠ—æ§åˆ¶                                           â”‚
â”‚   â€¢ åªèƒ½æ§åˆ¶ä½ç½® â†’ å¯¼çº³æ§åˆ¶                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é˜»æŠ—æ§åˆ¶å™¨å®ç°**:

```python
class ImpedanceController:
    """ç¬›å¡å°”ç©ºé—´é˜»æŠ—æ§åˆ¶"""
    def __init__(self, K, B, M=None):
        """
        Args:
            K: åˆšåº¦çŸ©é˜µ (6x6)
            B: é˜»å°¼çŸ©é˜µ (6x6)
            M: æƒ¯æ€§çŸ©é˜µ (6x6), å¯é€‰
        """
        self.K = np.diag(K) if len(K.shape) == 1 else K
        self.B = np.diag(B) if len(B.shape) == 1 else B
        self.M = np.diag(M) if M is not None and len(M.shape) == 1 else M
        
    def compute(self, x_current, x_desired, dx_current, dx_desired, ddx_desired=None):
        """
        è®¡ç®—æœŸæœ›çš„æœ«ç«¯åŠ›
        
        Args:
            x_current: å½“å‰æœ«ç«¯ä½å§¿ (6,) [pos, ori]
            x_desired: ç›®æ ‡æœ«ç«¯ä½å§¿ (6,)
            dx_current: å½“å‰æœ«ç«¯é€Ÿåº¦ (6,)
            dx_desired: ç›®æ ‡æœ«ç«¯é€Ÿåº¦ (6,)
            
        Returns:
            F: æœŸæœ›æœ«ç«¯åŠ› (6,)
        """
        # ä½ç½®è¯¯å·®
        pos_error = x_desired[:3] - x_current[:3]
        vel_error = dx_desired[:3] - dx_current[:3]
        
        # å§¿æ€è¯¯å·® (éœ€è¦ç‰¹æ®Šå¤„ç†)
        ori_error = orientation_error(x_current[3:], x_desired[3:])
        omega_error = dx_desired[3:] - dx_current[3:]
        
        error = np.concatenate([pos_error, ori_error])
        derror = np.concatenate([vel_error, omega_error])
        
        # é˜»æŠ—æ–¹ç¨‹
        F = self.K @ error + self.B @ derror
        
        if self.M is not None and ddx_desired is not None:
            F += self.M @ ddx_desired
            
        return F
    
    def to_joint_torque(self, F, J):
        """è½¬æ¢ä¸ºå…³èŠ‚åŠ›çŸ©"""
        return J.T @ F

## ä½¿ç”¨ç¤ºä¾‹
impedance = ImpedanceController(
    K=[1000, 1000, 1000, 50, 50, 50],  # å¹³ç§»åˆšåº¦é«˜ï¼Œæ—‹è½¬åˆšåº¦ä½
    B=[100, 100, 100, 10, 10, 10],
)

F_desired = impedance.compute(x_current, x_desired, dx_current, dx_desired)
tau = impedance.to_joint_torque(F_desired, J)
```

**VLA ä¸­çš„åº”ç”¨**:
- **æ¥è§¦ä»»åŠ¡**: æŠ“å–æ—¶åˆ‡æ¢åˆ°ä½åˆšåº¦ï¼Œç¡®ä¿æŸ”é¡º
- **äººæœºåä½œ**: ç¢°åˆ°äººæ—¶è¡¨ç°æŸ”è½¯
- **è£…é…ä»»åŠ¡**: æ’å…¥æ—¶éœ€è¦æŸ”é¡º

### 3.3 MPC (Model Predictive Control)

**æ ¸å¿ƒæ€æƒ³**: åœ¨çº¿æ»šåŠ¨ä¼˜åŒ–ï¼Œé¢„æµ‹æœªæ¥è½¨è¿¹å¹¶ä¼˜åŒ–ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     MPC å·¥ä½œåŸç†                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   æ—¶é—´è½´:                                                                   â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º       â”‚
â”‚   t    t+1   t+2   ...   t+N (é¢„æµ‹horizon)                                  â”‚
â”‚   â”‚     â”‚     â”‚           â”‚                                                 â”‚
â”‚   â–¼     â–¼     â–¼           â–¼                                                 â”‚
â”‚   xâ‚€    xâ‚    xâ‚‚    ...   xâ‚™   (çŠ¶æ€é¢„æµ‹)                                   â”‚
â”‚         uâ‚€    uâ‚    ...   uâ‚™â‚‹â‚ (æ§åˆ¶è¾“å…¥)                                   â”‚
â”‚                                                                             â”‚
â”‚   ä¼˜åŒ–é—®é¢˜:                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   min  Î£ ||x_k - x_ref||Â²_Q + ||u_k||Â²_R                            â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   s.t. x_{k+1} = f(x_k, u_k)    (åŠ¨åŠ›å­¦çº¦æŸ)                        â”‚   â”‚
â”‚   â”‚        x_min â‰¤ x_k â‰¤ x_max      (çŠ¶æ€çº¦æŸ)                          â”‚   â”‚
â”‚   â”‚        u_min â‰¤ u_k â‰¤ u_max      (è¾“å…¥çº¦æŸ)                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   æ»šåŠ¨æ‰§è¡Œ:                                                                  â”‚
â”‚   1. åœ¨ t æ—¶åˆ»æ±‚è§£ä¼˜åŒ–é—®é¢˜ï¼Œå¾—åˆ° uâ‚€, uâ‚, ..., uâ‚™â‚‹â‚                         â”‚
â”‚   2. åªæ‰§è¡Œ uâ‚€                                                              â”‚
â”‚   3. åœ¨ t+1 æ—¶åˆ»é‡æ–°æ±‚è§£                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**MPC å®ç° (ä½¿ç”¨ CVXPY)**:

```python
import cvxpy as cp
import numpy as np

class LinearMPC:
    """çº¿æ€§ MPC æ§åˆ¶å™¨"""
    def __init__(self, A, B, Q, R, N, x_min, x_max, u_min, u_max):
        """
        Args:
            A, B: çº¿æ€§ç³»ç»ŸçŸ©é˜µ x_{k+1} = A @ x_k + B @ u_k
            Q, R: ä»£ä»·æƒé‡
            N: é¢„æµ‹ horizon
            x_min, x_max: çŠ¶æ€çº¦æŸ
            u_min, u_max: è¾“å…¥çº¦æŸ
        """
        self.A, self.B = A, B
        self.Q, self.R = Q, R
        self.N = N
        self.n_x, self.n_u = A.shape[0], B.shape[1]
        self.x_min, self.x_max = x_min, x_max
        self.u_min, self.u_max = u_min, u_max
        
    def solve(self, x0, x_ref):
        """
        æ±‚è§£ MPC ä¼˜åŒ–é—®é¢˜
        
        Args:
            x0: å½“å‰çŠ¶æ€
            x_ref: å‚è€ƒè½¨è¿¹ (N+1, n_x)
            
        Returns:
            u_opt: æœ€ä¼˜æ§åˆ¶è¾“å…¥ (ç¬¬ä¸€ä¸ª)
        """
        # å˜é‡
        x = cp.Variable((self.N + 1, self.n_x))
        u = cp.Variable((self.N, self.n_u))
        
        # ä»£ä»·å‡½æ•°
        cost = 0
        constraints = [x[0] == x0]  # åˆå§‹çŠ¶æ€çº¦æŸ
        
        for k in range(self.N):
            # çŠ¶æ€ä»£ä»·
            cost += cp.quad_form(x[k] - x_ref[k], self.Q)
            # è¾“å…¥ä»£ä»·
            cost += cp.quad_form(u[k], self.R)
            # åŠ¨åŠ›å­¦çº¦æŸ
            constraints += [x[k+1] == self.A @ x[k] + self.B @ u[k]]
            # çŠ¶æ€çº¦æŸ
            constraints += [self.x_min <= x[k], x[k] <= self.x_max]
            # è¾“å…¥çº¦æŸ
            constraints += [self.u_min <= u[k], u[k] <= self.u_max]
        
        # ç»ˆç«¯ä»£ä»·
        cost += cp.quad_form(x[self.N] - x_ref[self.N], self.Q * 10)
        
        # æ±‚è§£
        prob = cp.Problem(cp.Minimize(cost), constraints)
        prob.solve(solver=cp.OSQP, warm_start=True)
        
        return u[0].value

## ä½¿ç”¨ç¤ºä¾‹
dt = 0.01
A = np.array([[1, dt], [0, 1]])  # åŒç§¯åˆ†ç³»ç»Ÿ
B = np.array([[0.5*dt**2], [dt]])
Q = np.diag([10, 1])
R = np.array([[0.1]])

mpc = LinearMPC(A, B, Q, R, N=20, 
                x_min=np.array([-10, -5]), x_max=np.array([10, 5]),
                u_min=np.array([-10]), u_max=np.array([10]))

x_current = np.array([0, 0])
x_ref = np.tile([1, 0], (21, 1))  # ç›®æ ‡ä½ç½® 1
u_opt = mpc.solve(x_current, x_ref)
```

**MPC vs PID**:

| ç»´åº¦ | MPC | PID |
| :--- | :--- | :--- |
| **çº¦æŸå¤„ç†** | æ˜¾å¼å¤„ç† | æ— æ³•å¤„ç† |
| **é¢„æµ‹èƒ½åŠ›** | æœ‰ | æ—  |
| **è®¡ç®—é‡** | é«˜ (éœ€åœ¨çº¿ä¼˜åŒ–) | ä½ |
| **è°ƒå‚** | Q, R çŸ©é˜µ | Kp, Ki, Kd |
| **é€‚ç”¨** | å¤æ‚çº¦æŸã€æœ€ä¼˜æ§åˆ¶ | ç®€å•è·Ÿè¸ª |

### 3.4 æ§åˆ¶æ–¹æ³•å¯¹æ¯”æ€»ç»“

| æ–¹æ³• | åŸç† | ä¼˜ç‚¹ | ç¼ºç‚¹ | VLA åº”ç”¨åœºæ™¯ |
| :--- | :--- | :--- | :--- | :--- |
| **PID** | è¯¯å·®åé¦ˆ | ç®€å•ã€å¿«é€Ÿ | æ— æ³•å¤„ç†è€¦åˆ/çº¦æŸ | åº•å±‚å…³èŠ‚æ§åˆ¶ |
| **é˜»æŠ—æ§åˆ¶** | å¼¹ç°§-é˜»å°¼è¡Œä¸º | æŸ”é¡ºã€å®‰å…¨ | éœ€è°ƒåˆšåº¦å‚æ•° | æ¥è§¦ä»»åŠ¡ã€äººæœºåä½œ |
| **å¯¼çº³æ§åˆ¶** | åŠ›â†’ä½ç½® | é€‚ç”¨ä½ç½®æ§åˆ¶è‡‚ | éœ€è¦åŠ›ä¼ æ„Ÿå™¨ | æ‹–åŠ¨ç¤ºæ•™ |
| **MPC** | æ»šåŠ¨ä¼˜åŒ– | å¯åŠ çº¦æŸã€æœ€ä¼˜ | è®¡ç®—é‡å¤§ | è½¨è¿¹ä¼˜åŒ–ã€é¿éšœ |
| **Computed Torque** | åŠ¨åŠ›å­¦è¡¥å¿ | è§£è€¦æ§åˆ¶ | éœ€ç²¾ç¡®æ¨¡å‹ | é«˜ç²¾åº¦ä»»åŠ¡ |

---

## 4. VLA ä¸­çš„æ§åˆ¶æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     VLA æ§åˆ¶æ¶æ„                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   é«˜å±‚: VLA æ¨¡å‹ (OpenVLA, Ï€0 ç­‰)                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   è¾“å…¥: å›¾åƒ + è¯­è¨€æŒ‡ä»¤                                              â”‚   â”‚
â”‚   â”‚   è¾“å‡º: æœ«ç«¯å¢é‡ Î”pose (æˆ–ç»å¯¹ pose)                                 â”‚   â”‚
â”‚   â”‚   é¢‘ç‡: 10-30 Hz                                                    â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â”‚                                                  â”‚
â”‚                          â–¼                                                  â”‚
â”‚   ä¸­å±‚: è¿åŠ¨è§„åˆ’ / IK                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   Î”pose â†’ è½¨è¿¹æ’å€¼ â†’ IK æ±‚è§£ â†’ å…³èŠ‚ç›®æ ‡ q_target                     â”‚   â”‚
â”‚   â”‚   å¯é€‰: MPC ä¼˜åŒ–è½¨è¿¹ã€é¿éšœ                                           â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â”‚                                                  â”‚
â”‚                          â–¼                                                  â”‚
â”‚   åº•å±‚: å…³èŠ‚æ§åˆ¶ (é©±åŠ¨å™¨å†…ç½®)                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   q_target â†’ PID / é˜»æŠ—æ§åˆ¶ â†’ Ï„ â†’ ç”µæœº                              â”‚   â”‚
â”‚   â”‚   é¢‘ç‡: 1000 Hz (ç¡¬å®æ—¶)                                             â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   ğŸ’¡ VLA ä¸»è¦è´Ÿè´£é«˜å±‚å†³ç­–ï¼Œåº•å±‚æ§åˆ¶ç”±ä¼ ç»Ÿæ–¹æ³•ä¿è¯å®‰å…¨å’Œç²¾åº¦                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. é¢è¯• Q&A

### Q1: æ­£è¿åŠ¨å­¦å’Œé€†è¿åŠ¨å­¦çš„åŒºåˆ«ï¼Ÿ

| ç»´åº¦ | æ­£è¿åŠ¨å­¦ (FK) | é€†è¿åŠ¨å­¦ (IK) |
| :--- | :--- | :--- |
| **è¾“å…¥** | å…³èŠ‚è§’åº¦ $\mathbf{q}$ | æœ«ç«¯ä½å§¿ $\mathbf{T}$ |
| **è¾“å‡º** | æœ«ç«¯ä½å§¿ $\mathbf{T}$ | å…³èŠ‚è§’åº¦ $\mathbf{q}$ |
| **è§£çš„æ•°é‡** | å”¯ä¸€è§£ | å¯èƒ½å¤šè§£æˆ–æ— è§£ |
| **è®¡ç®—å¤æ‚åº¦** | ä½ (çŸ©é˜µä¹˜æ³•) | é«˜ (ä¼˜åŒ–/è¿­ä»£) |
| **éš¾åº¦** | ç®€å• | å¤æ‚ |

### Q2: PID å’Œ MPC çš„é€‚ç”¨åœºæ™¯ï¼Ÿ

- **PID**: ç®€å•å…³èŠ‚ä¼ºæœã€ä½å»¶è¿Ÿè¦æ±‚ã€å•è¾“å…¥å•è¾“å‡º
- **MPC**: éœ€è¦å¤„ç†çº¦æŸ (å…³èŠ‚é™ä½ã€é€Ÿåº¦é™åˆ¶)ã€éœ€è¦é¢„æµ‹ (é¿éšœ)ã€å¤šç›®æ ‡ä¼˜åŒ–

### Q3: é˜»æŠ—æ§åˆ¶çš„åˆšåº¦å‚æ•°å¦‚ä½•é€‰æ‹©ï¼Ÿ

- **é«˜åˆšåº¦ (K å¤§)**: ç²¾ç¡®ä½ç½®è·Ÿè¸ªï¼Œé€‚åˆè‡ªç”±ç©ºé—´è¿åŠ¨
- **ä½åˆšåº¦ (K å°)**: æŸ”é¡ºè¡Œä¸ºï¼Œé€‚åˆæ¥è§¦ä»»åŠ¡ã€è£…é…
- **åŠ¨æ€åˆ‡æ¢**: VLA æŠ“å–æµç¨‹ä¸­ï¼Œæ¥è¿‘é˜¶æ®µé«˜åˆšåº¦ï¼Œæ¥è§¦åä½åˆšåº¦

### Q4: ä¸ºä»€ä¹ˆ VLA åº•å±‚ä¸ç”¨ RL æ§åˆ¶ï¼Ÿ

1. **å®‰å…¨æ€§**: ä¼ ç»Ÿæ§åˆ¶ç¨³å®šæ€§æœ‰ä¿è¯ï¼ŒRL å¯èƒ½å‡ºç°æ„å¤–åŠ¨ä½œ
2. **é¢‘ç‡**: åº•å±‚æ§åˆ¶éœ€è¦ 1kHzï¼ŒRL æ¨ç†å¤ªæ…¢
3. **åˆ†å·¥**: VLA è´Ÿè´£é«˜å±‚å†³ç­– (ä»€ä¹ˆåŠ¨ä½œ)ï¼Œåº•å±‚æ§åˆ¶è´Ÿè´£ç²¾ç¡®æ‰§è¡Œ (æ€ä¹ˆæ‰§è¡Œ)

### Q5: åŠ¨åŠ›å­¦æ¨¡å‹åœ¨ VLA ä¸­çš„ä½œç”¨ï¼Ÿ

- **ä»¿çœŸè®­ç»ƒ**: Sim-to-Real éœ€è¦å‡†ç¡®çš„åŠ¨åŠ›å­¦ä»¿çœŸ
- **é‡åŠ›è¡¥å¿**: è®¡ç®— $\mathbf{g}(\mathbf{q})$ è¡¥å¿é‡åŠ›
- **åŠ›ä¼°è®¡**: æ— åŠ›ä¼ æ„Ÿå™¨æ—¶ï¼Œé€šè¿‡åŠ¨åŠ›å­¦ä¼°è®¡å¤–åŠ›
- **Computed Torque**: é«˜ç²¾åº¦è½¨è¿¹è·Ÿè¸ª

---

## ğŸ“š æ¨èèµ„æº

### ä¹¦ç±
- **[Modern Robotics](http://hades.mech.northwestern.edu/index.php/Modern_Robotics)**: è¿åŠ¨å­¦/åŠ¨åŠ›å­¦ç»å…¸æ•™æ
- **[Robotics: Modelling, Planning and Control](https://link.springer.com/book/10.1007/978-1-84628-642-1)**: Siciliano çš„æ§åˆ¶åœ£ç»

### ä»£ç åº“
- **[Pinocchio](https://github.com/stack-of-tasks/pinocchio)**: é«˜æ•ˆåŠ¨åŠ›å­¦è®¡ç®—
- **[Drake](https://github.com/RobotLocomotion/drake)**: å¤šä½“åŠ¨åŠ›å­¦
- **[PyBullet](https://pybullet.org/)**: ä»¿çœŸ + IK

### è¯¾ç¨‹
- **[Stanford CS223A](https://cs.stanford.edu/groups/manips/teaching/cs223a/)**: Introduction to Robotics
- **[ETH Robot Dynamics](https://rsl.ethz.ch/education-students/lectures.html)**: åŠ¨åŠ›å­¦ä¸æ§åˆ¶

---



\newpage

# ç¬¬18ç«  æ„ŸçŸ¥æŠ€æœ¯


> **é¢è¯•åœºæ™¯**: "è¯·ä»‹ç»ä½ ç†Ÿæ‚‰çš„è§†è§‰æ„ŸçŸ¥æŠ€æœ¯æ–¹æ¡ˆï¼Œä»¥åŠåœ¨æœºå™¨äººç³»ç»Ÿä¸­çš„åº”ç”¨ã€‚"

æœ¬æ–‡æ¶µç›–æœºå™¨äººé¢†åŸŸå¸¸ç”¨çš„è§†è§‰å’Œå¤šæ¨¡æ€æ„ŸçŸ¥æŠ€æœ¯ï¼ŒåŒ…æ‹¬æ£€æµ‹ã€è·Ÿè¸ªã€Occupancyã€æ·±åº¦ä¼°è®¡ç­‰æ ¸å¿ƒæ–¹æ¡ˆã€‚

---

## ğŸ“Š æ„ŸçŸ¥æŠ€æœ¯å…¨æ™¯å›¾ (Perception Landscape)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æœºå™¨äººæ„ŸçŸ¥æŠ€æœ¯æ ˆ                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                        ä¼ æ„Ÿå™¨å±‚ (Sensors)                            â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚   â”‚  â”‚ RGB ç›¸æœº â”‚ â”‚ æ·±åº¦ç›¸æœº â”‚ â”‚  LiDAR   â”‚ â”‚  Radar   â”‚ â”‚ è§¦è§‰ä¼ æ„Ÿ â”‚  â”‚   â”‚
â”‚   â”‚  â”‚ Mono/Stereoâ”‚ â”‚ ToF/Structâ”‚ â”‚ 3Dç‚¹äº‘   â”‚ â”‚ æ¯«ç±³æ³¢   â”‚ â”‚ GelSight â”‚  â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                      æ„ŸçŸ¥ç®—æ³•å±‚ (Perception)                         â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   2D æ„ŸçŸ¥              3D æ„ŸçŸ¥              æ—¶åºæ„ŸçŸ¥                 â”‚   â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€           â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”‚   â”‚
â”‚   â”‚   â€¢ ç›®æ ‡æ£€æµ‹          â€¢ 3D æ£€æµ‹            â€¢ ç›®æ ‡è·Ÿè¸ª               â”‚   â”‚
â”‚   â”‚   â€¢ è¯­ä¹‰åˆ†å‰²          â€¢ ç‚¹äº‘åˆ†å‰²           â€¢ è½¨è¿¹é¢„æµ‹               â”‚   â”‚
â”‚   â”‚   â€¢ å®ä¾‹åˆ†å‰²          â€¢ Occupancy          â€¢ å…‰æµä¼°è®¡               â”‚   â”‚
â”‚   â”‚   â€¢ å…³é”®ç‚¹æ£€æµ‹        â€¢ æ·±åº¦ä¼°è®¡           â€¢ åœºæ™¯æµ                 â”‚   â”‚
â”‚   â”‚   â€¢ å¼€æ”¾è¯æ±‡æ£€æµ‹      â€¢ BEV æ„ŸçŸ¥           â€¢ è§†é¢‘ç†è§£               â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                      èåˆä¸ç†è§£å±‚ (Fusion)                           â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚   â”‚
â”‚   â”‚  â”‚ å¤šæ¨¡æ€èåˆ   â”‚  â”‚ æ—¶ç©ºèåˆ     â”‚  â”‚ è¯­ä¹‰ç†è§£     â”‚               â”‚   â”‚
â”‚   â”‚  â”‚ Vision+LiDAR â”‚  â”‚ å¤šå¸§èšåˆ     â”‚  â”‚ VLM æ¨ç†     â”‚               â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                        è¾“å‡ºå±‚ (Output)                               â”‚   â”‚
â”‚   â”‚  â€¢ ç‰©ä½“ä½å§¿ (6-DoF Pose)     â€¢ åœºæ™¯è¡¨ç¤º (Occupancy/NeRF)            â”‚   â”‚
â”‚   â”‚  â€¢ è¯­ä¹‰åœ°å›¾ (Semantic Map)   â€¢ å¯æŠ“å–ç‚¹ (Grasp Points)              â”‚   â”‚
â”‚   â”‚  â€¢ è¿åŠ¨é¢„æµ‹ (Motion Pred)    â€¢ ç¢°æ’æ£€æµ‹ (Collision)                 â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   ğŸ’¡ VLA æ ¸å¿ƒ: æ„ŸçŸ¥è¾“å‡º â†’ VLM ç†è§£ â†’ åŠ¨ä½œç”Ÿæˆ                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1. ç›®æ ‡æ£€æµ‹ (Object Detection)

### 1.1 2D ç›®æ ‡æ£€æµ‹æ¼”è¿›

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     2D ç›®æ ‡æ£€æµ‹æŠ€æœ¯æ¼”è¿›                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   Two-Stage (ä¸¤é˜¶æ®µ)                    One-Stage (å•é˜¶æ®µ)                  â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”‚
â”‚   R-CNN (2014)                          YOLO v1 (2016)                      â”‚
â”‚      â†“                                     â†“                                â”‚
â”‚   Fast R-CNN (2015)                     SSD (2016)                          â”‚
â”‚      â†“                                     â†“                                â”‚
â”‚   Faster R-CNN (2015)                   YOLOv3 (2018)                       â”‚
â”‚      â†“                                     â†“                                â”‚
â”‚   Mask R-CNN (2017)                     YOLOv5/v7/v8 (2020-2023)            â”‚
â”‚      â†“                                     â†“                                â”‚
â”‚   Cascade R-CNN (2018)                  YOLO11 (2024)                       â”‚
â”‚                                                                             â”‚
â”‚   Transformer-Based                     Anchor-Free                         â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                        â”‚
â”‚   DETR (2020)                           CenterNet (2019)                    â”‚
â”‚      â†“                                     â†“                                â”‚
â”‚   Deformable DETR (2021)                FCOS (2019)                         â”‚
â”‚      â†“                                     â†“                                â”‚
â”‚   DINO (2022)                           RepPoints (2019)                    â”‚
â”‚      â†“                                                                      â”‚
â”‚   Co-DETR (2023)                                                            â”‚
â”‚      â†“                                                                      â”‚
â”‚   RT-DETR (2023) â† å®æ—¶ Transformer                                         â”‚
â”‚                                                                             â”‚
â”‚   ğŸ’¡ æœºå™¨äººå¸¸ç”¨: YOLOv8 (é€Ÿåº¦), RT-DETR (ç²¾åº¦), DINO (å¼€æ”¾è¯æ±‡)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 ä¸»æµæ£€æµ‹å™¨å¯¹æ¯”

| æ¨¡å‹ | Backbone | COCO mAP | é€Ÿåº¦ (FPS) | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **YOLOv8-N** | CSPDarknet | 37.3 | 900+ | æé€Ÿ | è¾¹ç¼˜éƒ¨ç½² |
| **YOLOv8-X** | CSPDarknet | 53.9 | 280 | é«˜ç²¾åº¦ | æœåŠ¡å™¨ |
| **RT-DETR-L** | HGNetv2 | 53.0 | 114 | æ—  NMS | å®æ—¶é«˜ç²¾åº¦ |
| **DINO** | Swin-L | 63.3 | 5 | SOTA | ç¦»çº¿åˆ†æ |
| **Grounding DINO** | Swin-T | 52.5 | 15 | å¼€æ”¾è¯æ±‡ | é›¶æ ·æœ¬æ£€æµ‹ |
| **YOLO-World** | YOLOv8 | 45.7 | 52 | å¼€æ”¾è¯æ±‡+å¿« | æœºå™¨äººæŠ“å– |

### 1.3 å¼€æ”¾è¯æ±‡æ£€æµ‹ (Open-Vocabulary Detection)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å¼€æ”¾è¯æ±‡æ£€æµ‹æ¶æ„                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   ä¼ ç»Ÿæ£€æµ‹: åªèƒ½æ£€æµ‹è®­ç»ƒæ—¶è§è¿‡çš„ç±»åˆ« (80 ç±» COCO)                           â”‚
â”‚   å¼€æ”¾è¯æ±‡: å¯ä»¥æ£€æµ‹ä»»æ„æ–‡æœ¬æè¿°çš„ç‰©ä½“                                      â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                     Grounding DINO æ¶æ„                              â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚   â”‚
â”‚   â”‚   â”‚  Image   â”‚                      â”‚  Text    â”‚                    â”‚   â”‚
â”‚   â”‚   â”‚  è¾“å…¥    â”‚                      â”‚ "çº¢è‰²æ¯å­"â”‚                    â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                    â”‚   â”‚
â”‚   â”‚        â”‚                                 â”‚                          â”‚   â”‚
â”‚   â”‚        â–¼                                 â–¼                          â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚   â”‚
â”‚   â”‚   â”‚ Swin-T   â”‚                      â”‚ BERT     â”‚                    â”‚   â”‚
â”‚   â”‚   â”‚ Backbone â”‚                      â”‚ Encoder  â”‚                    â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                    â”‚   â”‚
â”‚   â”‚        â”‚                                 â”‚                          â”‚   â”‚
â”‚   â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚   â”‚
â”‚   â”‚                     â–¼                                               â”‚   â”‚
â”‚   â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚   â”‚
â”‚   â”‚              â”‚ Cross-Modal â”‚ â† å›¾æ–‡ç‰¹å¾äº¤äº’                         â”‚   â”‚
â”‚   â”‚              â”‚  Attention  â”‚                                        â”‚   â”‚
â”‚   â”‚              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                        â”‚   â”‚
â”‚   â”‚                     â”‚                                               â”‚   â”‚
â”‚   â”‚                     â–¼                                               â”‚   â”‚
â”‚   â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚   â”‚
â”‚   â”‚              â”‚ Detection   â”‚                                        â”‚   â”‚
â”‚   â”‚              â”‚   Head      â”‚                                        â”‚   â”‚
â”‚   â”‚              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                        â”‚   â”‚
â”‚   â”‚                     â”‚                                               â”‚   â”‚
â”‚   â”‚                     â–¼                                               â”‚   â”‚
â”‚   â”‚              [Box: (x,y,w,h), Score: 0.95]                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   åº”ç”¨: æœºå™¨äººæŠ“å–ä»»æ„ç‰©ä½“ - "å¸®æˆ‘æ‹¿é‚£ä¸ªè“è‰²çš„æ°´ç“¶"                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.4 æ£€æµ‹ä»£ç ç¤ºä¾‹

```python
## ä½¿ç”¨ YOLO-World è¿›è¡Œå¼€æ”¾è¯æ±‡æ£€æµ‹
from ultralytics import YOLOWorld

## åŠ è½½æ¨¡å‹
model = YOLOWorld('yolov8x-worldv2.pt')

## è®¾ç½®è¦æ£€æµ‹çš„ç±»åˆ« (å¯ä»¥æ˜¯ä»»æ„æ–‡æœ¬)
model.set_classes(["red cup", "blue bottle", "keyboard", "mouse"])

## æ¨ç†
results = model.predict(
    source='robot_view.jpg',
    conf=0.25,
    iou=0.45,
    device='cuda:0'
)

## è§£æç»“æœ
for result in results:
    boxes = result.boxes
    for box in boxes:
        cls_id = int(box.cls[0])
        conf = float(box.conf[0])
        xyxy = box.xyxy[0].tolist()
        class_name = model.names[cls_id]
        print(f"æ£€æµ‹åˆ° {class_name}: {conf:.2f}, ä½ç½®: {xyxy}")


## ä½¿ç”¨ Grounding DINO è¿›è¡Œé›¶æ ·æœ¬æ£€æµ‹
from groundingdino.util.inference import load_model, predict

model = load_model("groundingdino_swinb_cogcoor.pth")

## æ–‡æœ¬ prompt
text_prompt = "red cup . blue bottle . person"

## æ£€æµ‹
boxes, logits, phrases = predict(
    model=model,
    image=image,
    caption=text_prompt,
    box_threshold=0.35,
    text_threshold=0.25
)
```

---

## 2. è¯­ä¹‰/å®ä¾‹åˆ†å‰² (Segmentation)

### 2.1 åˆ†å‰²ä»»åŠ¡ç±»å‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     åˆ†å‰²ä»»åŠ¡å¯¹æ¯”                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   åŸå›¾                è¯­ä¹‰åˆ†å‰²            å®ä¾‹åˆ†å‰²            å…¨æ™¯åˆ†å‰²       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚ ğŸš—  ğŸš—  â”‚        â”‚ â–ˆâ–ˆ  â–ˆâ–ˆ  â”‚        â”‚ â–“â–“  â–‘â–‘  â”‚        â”‚ â–“â–“  â–‘â–‘  â”‚     â”‚
â”‚   â”‚    ğŸš¶   â”‚   â†’    â”‚    â–ˆâ–ˆ   â”‚   â†’    â”‚    â–’â–’   â”‚   â†’    â”‚    â–’â–’   â”‚     â”‚
â”‚   â”‚ ğŸŒ³ ğŸ   â”‚        â”‚ â–ˆâ–ˆ  â–ˆâ–ˆ  â”‚        â”‚ â–ˆâ–ˆ  â–ˆâ–ˆ  â”‚        â”‚ â–“â–“  â–‘â–‘  â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                      åŒç±»åŒè‰²            åŒç±»ä¸åŒè‰²          Thing+Stuff    â”‚
â”‚                                                                             â”‚
â”‚   ä»»åŠ¡          è¾“å‡º                  åº”ç”¨åœºæ™¯                               â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚   è¯­ä¹‰åˆ†å‰²      åƒç´ çº§ç±»åˆ«æ ‡ç­¾        åœºæ™¯ç†è§£, å¯è¡Œé©¶åŒºåŸŸ                   â”‚
â”‚   å®ä¾‹åˆ†å‰²      åƒç´ çº§å®ä¾‹ ID         ç‰©ä½“è®¡æ•°, æœºå™¨äººæŠ“å–                   â”‚
â”‚   å…¨æ™¯åˆ†å‰²      è¯­ä¹‰ + å®ä¾‹           è‡ªåŠ¨é©¾é©¶, å®Œæ•´åœºæ™¯ç†è§£                 â”‚
â”‚   éƒ¨ä»¶åˆ†å‰²      ç‰©ä½“éƒ¨ä»¶çº§åˆ†å‰²        ç²¾ç»†æ“ä½œ, äººä½“å§¿æ€                     â”‚
â”‚                                                                             â”‚
â”‚   ğŸ’¡ æœºå™¨äººæŠ“å–å¸¸ç”¨: å®ä¾‹åˆ†å‰² (åŒºåˆ†å¤šä¸ªåŒç±»ç‰©ä½“)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ä¸»æµåˆ†å‰²æ¨¡å‹

| æ¨¡å‹ | ç±»å‹ | ç‰¹ç‚¹ | é€Ÿåº¦ | åº”ç”¨ |
| :--- | :--- | :--- | :--- | :--- |
| **SAM (Segment Anything)** | é€šç”¨åˆ†å‰² | é›¶æ ·æœ¬, äº¤äº’å¼ | ä¸­ | æ ‡æ³¨å·¥å…·, æœºå™¨äºº |
| **SAM 2** | è§†é¢‘åˆ†å‰² | æ—¶åºä¸€è‡´æ€§ | ä¸­ | è§†é¢‘è·Ÿè¸ª |
| **Mask2Former** | å…¨æ™¯åˆ†å‰² | ç»Ÿä¸€æ¶æ„ | æ…¢ | åœºæ™¯ç†è§£ |
| **OneFormer** | å…¨æ™¯åˆ†å‰² | å•æ¨¡å‹å¤šä»»åŠ¡ | æ…¢ | é€šç”¨åˆ†å‰² |
| **FastSAM** | å®ä¾‹åˆ†å‰² | SAM åŠ é€Ÿç‰ˆ | å¿« | å®æ—¶åº”ç”¨ |
| **MobileSAM** | å®ä¾‹åˆ†å‰² | è½»é‡åŒ– SAM | å¿« | è¾¹ç¼˜éƒ¨ç½² |
| **Grounded SAM** | å¼€æ”¾è¯æ±‡åˆ†å‰² | æ–‡æœ¬é©±åŠ¨åˆ†å‰² | ä¸­ | æœºå™¨äººæŠ“å– |

### 2.3 SAM (Segment Anything Model)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SAM æ¶æ„                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                        Image Encoder (ViT-H)                         â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   è¾“å…¥å›¾åƒ â”€â”€â”€â”€â”€â”€â–º å›¾åƒç‰¹å¾ (256 Ã— 64 Ã— 64)                          â”‚   â”‚
â”‚   â”‚   (1024Ã—1024)      (ä¸€æ¬¡ç¼–ç , å¤šæ¬¡ä½¿ç”¨)                              â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                        Prompt Encoder                                â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   Prompt ç±»å‹:                                                      â”‚   â”‚
â”‚   â”‚   â€¢ ç‚¹ (Point): å‰æ™¯/èƒŒæ™¯ç‚¹                                         â”‚   â”‚
â”‚   â”‚   â€¢ æ¡† (Box): è¾¹ç•Œæ¡†                                                â”‚   â”‚
â”‚   â”‚   â€¢ æ–‡æœ¬ (Text): ç±»åˆ«æè¿° (éœ€è¦ Grounded SAM)                       â”‚   â”‚
â”‚   â”‚   â€¢ æ©ç  (Mask): ç²—ç•¥æ©ç                                            â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                        Mask Decoder                                  â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   å›¾åƒç‰¹å¾ + Prompt ç‰¹å¾ â”€â”€â–º å¤šä¸ªå€™é€‰æ©ç  + IoU åˆ†æ•°                 â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   è¾“å‡º: 3 ä¸ªæ©ç  (whole, part, subpart) + ç½®ä¿¡åº¦                    â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   ç‰¹ç‚¹:                                                                     â”‚
â”‚   â€¢ é›¶æ ·æœ¬: æ— éœ€é’ˆå¯¹ç‰¹å®šç±»åˆ«è®­ç»ƒ                                           â”‚
â”‚   â€¢ äº¤äº’å¼: æ”¯æŒç‚¹å‡»ã€æ¡†é€‰ç­‰å¤šç§ prompt                                    â”‚
â”‚   â€¢ é«˜è´¨é‡: è¾¹ç¼˜ç²¾ç»†, é€‚åˆç²¾ç¡®æŠ“å–                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.4 åˆ†å‰²ä»£ç ç¤ºä¾‹

```python
## SAM 2 è§†é¢‘åˆ†å‰²
from sam2.build_sam import build_sam2_video_predictor

predictor = build_sam2_video_predictor(
    "sam2_hiera_large.pt",
    device="cuda"
)

## åˆå§‹åŒ–è§†é¢‘
with torch.inference_mode():
    state = predictor.init_state(video_path="robot_video.mp4")
    
    # åœ¨ç¬¬ä¸€å¸§ç»™ä¸€ä¸ªç‚¹ prompt
    frame_idx, obj_ids, masks = predictor.add_new_points_or_box(
        inference_state=state,
        frame_idx=0,
        obj_id=1,
        points=[[500, 300]],  # ç‚¹å‡»ä½ç½®
        labels=[1]  # 1=å‰æ™¯, 0=èƒŒæ™¯
    )
    
    # ä¼ æ’­åˆ°æ•´ä¸ªè§†é¢‘
    for frame_idx, obj_ids, masks in predictor.propagate_in_video(state):
        # masks: æ¯å¸§çš„åˆ†å‰²æ©ç 
        process_mask(frame_idx, masks)


## Grounded SAM: æ–‡æœ¬é©±åŠ¨åˆ†å‰²
from groundingdino.util.inference import predict as gd_predict
from segment_anything import sam_model_registry, SamPredictor

## 1. Grounding DINO æ£€æµ‹
boxes, logits, phrases = gd_predict(
    model=gd_model,
    image=image,
    caption="red apple . green apple",
    box_threshold=0.3
)

## 2. SAM åˆ†å‰²
sam = sam_model_registry["vit_h"](checkpoint="sam_vit_h.pth")
predictor = SamPredictor(sam)
predictor.set_image(image)

## ç”¨æ£€æµ‹æ¡†ä½œä¸º SAM çš„ prompt
masks, scores, _ = predictor.predict(
    box=boxes[0],  # ç¬¬ä¸€ä¸ªæ£€æµ‹æ¡†
    multimask_output=False
)
```

---

## 3. ç›®æ ‡è·Ÿè¸ª (Object Tracking)

### 3.1 è·Ÿè¸ªä»»åŠ¡åˆ†ç±»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ç›®æ ‡è·Ÿè¸ªä»»åŠ¡åˆ†ç±»                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                    å•ç›®æ ‡è·Ÿè¸ª (SOT)                                   â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   è¾“å…¥: ç¬¬ä¸€å¸§çš„ç›®æ ‡æ¡†                                               â”‚   â”‚
â”‚   â”‚   è¾“å‡º: åç»­å¸§çš„ç›®æ ‡ä½ç½®                                             â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   Frame 1         Frame 2         Frame 3                           â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚   â”‚
â”‚   â”‚   â”‚  [ç›®æ ‡] â”‚ â†’  â”‚   [ç›®æ ‡]â”‚ â†’  â”‚     [ç›®æ ‡]                        â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   ä»£è¡¨æ¨¡å‹: SiamFC, SiamRPN++, OSTrack, MixFormer                   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                   å¤šç›®æ ‡è·Ÿè¸ª (MOT)                                    â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   è¾“å…¥: è§†é¢‘åºåˆ—                                                     â”‚   â”‚
â”‚   â”‚   è¾“å‡º: æ‰€æœ‰ç›®æ ‡çš„è½¨è¿¹ (ID + ä½ç½®)                                   â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   Frame 1         Frame 2         Frame 3                           â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚   â”‚
â”‚   â”‚   â”‚ [1] [2] â”‚ â†’  â”‚ [1]  [2]â”‚ â†’  â”‚  [1] [2]â”‚                        â”‚   â”‚
â”‚   â”‚   â”‚   [3]   â”‚    â”‚    [3]  â”‚    â”‚   [3]   â”‚                        â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   ä»£è¡¨æ¨¡å‹: SORT, DeepSORT, ByteTrack, OC-SORT, BoT-SORT           â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   ğŸ’¡ æœºå™¨äººåº”ç”¨: MOT è·Ÿè¸ªå¤šä¸ªç‰©ä½“, SOT è·Ÿè¸ªç‰¹å®šç›®æ ‡                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 å¤šç›®æ ‡è·Ÿè¸ª (MOT) èŒƒå¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     MOT æŠ€æœ¯æ¼”è¿›                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   Tracking-by-Detection (æ£€æµ‹åè·Ÿè¸ª)                                        â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                         â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚   â”‚ Detector â”‚ â†’  â”‚ Association  â”‚ â†’  â”‚ Track Mgmt   â”‚                     â”‚
â”‚   â”‚ (YOLOç­‰) â”‚    â”‚ (åŒ¹é…ç®—æ³•)    â”‚    â”‚ (è½¨è¿¹ç®¡ç†)   â”‚                     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                                             â”‚
â”‚   åŒ¹é…ç®—æ³•æ¼”è¿›:                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   SORT (2016)           DeepSORT (2017)        ByteTrack (2022)     â”‚   â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚   â”‚
â”‚   â”‚   IoU + Kalman          IoU + ReID ç‰¹å¾        é«˜ä½åˆ†æ¡†åˆ†ç¦»åŒ¹é…      â”‚   â”‚
â”‚   â”‚   ç®€å•å¿«é€Ÿ              å¤–è§‚ç‰¹å¾å¢å¼º           åˆ©ç”¨ä½ç½®ä¿¡åº¦æ£€æµ‹      â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   OC-SORT (2023)        BoT-SORT (2022)        StrongSORT (2023)    â”‚   â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚   â”‚
â”‚   â”‚   è§‚æµ‹ä¸­å¿ƒåŒ–            å¤šçº¿ç´¢èåˆ             å¼º ReID + åå¤„ç†      â”‚   â”‚
â”‚   â”‚   å¤„ç†é®æŒ¡              ç›¸æœºè¿åŠ¨è¡¥å¿           SOTA ç²¾åº¦            â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   Joint Detection & Tracking (è”åˆæ£€æµ‹è·Ÿè¸ª)                                 â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                  â”‚
â”‚   â€¢ FairMOT: æ£€æµ‹ + ReID è”åˆè®­ç»ƒ                                          â”‚
â”‚   â€¢ TrackFormer: Transformer ç«¯åˆ°ç«¯è·Ÿè¸ª                                    â”‚
â”‚   â€¢ MOTR: å¤šç›®æ ‡è·Ÿè¸ª Transformer                                           â”‚
â”‚                                                                             â”‚
â”‚   ğŸ’¡ æœºå™¨äººæ¨è: ByteTrack (é€Ÿåº¦) æˆ– BoT-SORT (ç²¾åº¦)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 ByteTrack ç®—æ³•è¯¦è§£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ByteTrack æ ¸å¿ƒæ€æƒ³                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   ä¼ ç»Ÿæ–¹æ³•: åªä½¿ç”¨é«˜ç½®ä¿¡åº¦æ£€æµ‹æ¡† (score > 0.5)                              â”‚
â”‚   ByteTrack: é«˜ä½åˆ†æ¡†åˆ†ç¦»åŒ¹é…, å……åˆ†åˆ©ç”¨ä½ç½®ä¿¡åº¦æ£€æµ‹                         â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                        ç®—æ³•æµç¨‹                                      â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   æ£€æµ‹ç»“æœ                                                          â”‚   â”‚
â”‚   â”‚      â”‚                                                              â”‚   â”‚
â”‚   â”‚      â–¼                                                              â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚   â”‚
â”‚   â”‚   â”‚ æŒ‰ç½®ä¿¡åº¦åˆ†ç¦»:                           â”‚                       â”‚   â”‚
â”‚   â”‚   â”‚ â€¢ é«˜åˆ†æ¡† D_high (score > Ï„_high)        â”‚                       â”‚   â”‚
â”‚   â”‚   â”‚ â€¢ ä½åˆ†æ¡† D_low  (Ï„_low < score < Ï„_high)â”‚                       â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚   â”‚
â”‚   â”‚      â”‚                                                              â”‚   â”‚
â”‚   â”‚      â–¼                                                              â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚   â”‚
â”‚   â”‚   â”‚ ç¬¬ä¸€æ¬¡åŒ¹é…: è½¨è¿¹ T â†” é«˜åˆ†æ¡† D_high      â”‚                       â”‚   â”‚
â”‚   â”‚   â”‚ ä½¿ç”¨ IoU + Kalman é¢„æµ‹                  â”‚                       â”‚   â”‚
â”‚   â”‚   â”‚ â†’ åŒ¹é…æˆåŠŸçš„è½¨è¿¹æ›´æ–°                    â”‚                       â”‚   â”‚
â”‚   â”‚   â”‚ â†’ æœªåŒ¹é…è½¨è¿¹ T_remain                   â”‚                       â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚   â”‚
â”‚   â”‚      â”‚                                                              â”‚   â”‚
â”‚   â”‚      â–¼                                                              â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚   â”‚
â”‚   â”‚   â”‚ ç¬¬äºŒæ¬¡åŒ¹é…: T_remain â†” ä½åˆ†æ¡† D_low     â”‚ â† å…³é”®åˆ›æ–°!           â”‚   â”‚
â”‚   â”‚   â”‚ è¢«é®æŒ¡çš„ç›®æ ‡å¯èƒ½åªæœ‰ä½ç½®ä¿¡åº¦æ£€æµ‹        â”‚                       â”‚   â”‚
â”‚   â”‚   â”‚ â†’ åŒ¹é…æˆåŠŸçš„è½¨è¿¹æ¢å¤                    â”‚                       â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚   â”‚
â”‚   â”‚      â”‚                                                              â”‚   â”‚
â”‚   â”‚      â–¼                                                              â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚   â”‚
â”‚   â”‚   â”‚ è½¨è¿¹ç®¡ç†:                               â”‚                       â”‚   â”‚
â”‚   â”‚   â”‚ â€¢ æœªåŒ¹é…é«˜åˆ†æ¡† â†’ æ–°å»ºè½¨è¿¹               â”‚                       â”‚   â”‚
â”‚   â”‚   â”‚ â€¢ è¿ç»­ N å¸§æœªåŒ¹é… â†’ åˆ é™¤è½¨è¿¹            â”‚                       â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   ä¼˜åŠ¿: é®æŒ¡åœºæ™¯ä¸‹ ID Switch å¤§å¹…å‡å°‘                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.4 è·Ÿè¸ªä»£ç ç¤ºä¾‹

```python
## ByteTrack ä½¿ç”¨ç¤ºä¾‹
from ultralytics import YOLO

## YOLOv8 å†…ç½® ByteTrack
model = YOLO('yolov8x.pt')

## è§†é¢‘è·Ÿè¸ª
results = model.track(
    source='robot_video.mp4',
    tracker='bytetrack.yaml',  # ä½¿ç”¨ ByteTrack
    persist=True,  # è·¨å¸§ä¿æŒ ID
    conf=0.25,
    iou=0.5,
    device='cuda:0'
)

## è§£æè·Ÿè¸ªç»“æœ
for result in results:
    boxes = result.boxes
    if boxes.id is not None:
        track_ids = boxes.id.int().tolist()
        for i, track_id in enumerate(track_ids):
            bbox = boxes.xyxy[i].tolist()
            cls = int(boxes.cls[i])
            print(f"ID {track_id}: {model.names[cls]} at {bbox}")


## SAM 2 + è·Ÿè¸ª: åˆ†å‰²çº§è·Ÿè¸ª
from sam2.build_sam import build_sam2_video_predictor

predictor = build_sam2_video_predictor("sam2_hiera_large.pt")

## åˆå§‹åŒ–
state = predictor.init_state(video_path="video.mp4")

## ç¬¬ä¸€å¸§ç‚¹å‡»ç›®æ ‡
predictor.add_new_points_or_box(
    state, frame_idx=0, obj_id=1,
    points=[[300, 200]], labels=[1]
)

## ä¼ æ’­è·Ÿè¸ª
for frame_idx, obj_ids, masks in predictor.propagate_in_video(state):
    # masks: åƒç´ çº§åˆ†å‰²æ©ç 
    # æ¯” bbox è·Ÿè¸ªæ›´ç²¾ç¡®
    pass
```

---

## 4. 3D æ„ŸçŸ¥ (3D Perception)

### 4.1 3D ç›®æ ‡æ£€æµ‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     3D ç›®æ ‡æ£€æµ‹æ–¹æ³•åˆ†ç±»                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   è¾“å…¥æ¨¡æ€              ä»£è¡¨æ–¹æ³•                 ç‰¹ç‚¹                        â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                                                             â”‚
â”‚   çº¯ LiDAR              PointPillars            ç‚¹äº‘æŸ±çŠ¶åŒ–, å¿«é€Ÿ             â”‚
â”‚   (ç‚¹äº‘)                CenterPoint             ä¸­å¿ƒç‚¹æ£€æµ‹, æ—  anchor       â”‚
â”‚                         VoxelNet                ä½“ç´ åŒ– + 3D CNN             â”‚
â”‚                         PointNet++              ç‚¹äº‘ç›´æ¥å¤„ç†                â”‚
â”‚                                                                             â”‚
â”‚   çº¯ Camera             FCOS3D                  å•ç›® 3D æ£€æµ‹                â”‚
â”‚   (å›¾åƒ)                DETR3D                  Transformer 3D æ£€æµ‹        â”‚
â”‚                         BEVDet                  å›¾åƒ â†’ BEV â†’ æ£€æµ‹          â”‚
â”‚                         BEVFormer               æ—¶ç©º BEV ç‰¹å¾               â”‚
â”‚                                                                             â”‚
â”‚   Camera + LiDAR        BEVFusion               å¤šæ¨¡æ€ BEV èåˆ             â”‚
â”‚   (èåˆ)                TransFusion             Transformer èåˆ           â”‚
â”‚                         DeepFusion              æ·±åº¦ç‰¹å¾èåˆ                â”‚
â”‚                                                                             â”‚
â”‚   ğŸ’¡ æœºå™¨äººåœºæ™¯: å®¤å†…å¸¸ç”¨ RGB-D, å®¤å¤–/è‡ªåŠ¨é©¾é©¶ç”¨ LiDAR                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 BEV (Bird's Eye View) æ„ŸçŸ¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     BEV æ„ŸçŸ¥æ¶æ„                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   ä¸ºä»€ä¹ˆéœ€è¦ BEV?                                                           â”‚
â”‚   â€¢ é€è§†å›¾ (Perspective View): è¿‘å¤§è¿œå°, é®æŒ¡ä¸¥é‡                           â”‚
â”‚   â€¢ é¸Ÿç°å›¾ (BEV): å°ºåº¦ä¸€è‡´, æ— é®æŒ¡, é€‚åˆè§„åˆ’                               â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                     BEVFormer æ¶æ„                                   â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   å¤šç›¸æœºè¾“å…¥ (6 ä¸ªç¯è§†ç›¸æœº)                                          â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”                  â”‚   â”‚
â”‚   â”‚   â”‚Frontâ”‚ â”‚F-L  â”‚ â”‚F-R  â”‚ â”‚Back â”‚ â”‚B-L  â”‚ â”‚B-R  â”‚                  â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜                  â”‚   â”‚
â”‚   â”‚      â”‚       â”‚       â”‚       â”‚       â”‚       â”‚                      â”‚   â”‚
â”‚   â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”¬â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚   â”‚
â”‚   â”‚                          â”‚                                          â”‚   â”‚
â”‚   â”‚                          â–¼                                          â”‚   â”‚
â”‚   â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚   â”‚
â”‚   â”‚                   â”‚ 2D Backbone â”‚ (ResNet / Swin)                   â”‚   â”‚
â”‚   â”‚                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                   â”‚   â”‚
â”‚   â”‚                          â”‚                                          â”‚   â”‚
â”‚   â”‚                          â–¼                                          â”‚   â”‚
â”‚   â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚   â”‚
â”‚   â”‚                   â”‚ Spatial     â”‚ â† å›¾åƒç‰¹å¾ â†’ BEV ç‰¹å¾             â”‚   â”‚
â”‚   â”‚                   â”‚ Cross-Attn  â”‚   (å¯å­¦ä¹ çš„è§†è§’è½¬æ¢)              â”‚   â”‚
â”‚   â”‚                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                   â”‚   â”‚
â”‚   â”‚                          â”‚                                          â”‚   â”‚
â”‚   â”‚                          â–¼                                          â”‚   â”‚
â”‚   â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚   â”‚
â”‚   â”‚                   â”‚ Temporal    â”‚ â† èåˆå†å²å¸§                       â”‚   â”‚
â”‚   â”‚                   â”‚ Self-Attn   â”‚   (æ—¶åºå»ºæ¨¡)                      â”‚   â”‚
â”‚   â”‚                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                   â”‚   â”‚
â”‚   â”‚                          â”‚                                          â”‚   â”‚
â”‚   â”‚                          â–¼                                          â”‚   â”‚
â”‚   â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚   â”‚
â”‚   â”‚                   â”‚ BEV Feature â”‚ (H Ã— W Ã— C)                       â”‚   â”‚
â”‚   â”‚                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                   â”‚   â”‚
â”‚   â”‚                          â”‚                                          â”‚   â”‚
â”‚   â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚   â”‚
â”‚   â”‚          â–¼               â–¼               â–¼                          â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚   â”‚
â”‚   â”‚   â”‚ 3D Detectionâ”‚ â”‚ Map Segm   â”‚ â”‚ Motion Pred â”‚                   â”‚   â”‚
â”‚   â”‚   â”‚ (3D æ£€æµ‹)   â”‚ â”‚ (åœ°å›¾åˆ†å‰²) â”‚ â”‚ (è¿åŠ¨é¢„æµ‹)  â”‚                   â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   ä¼˜åŠ¿: ç»Ÿä¸€çš„ BEV è¡¨ç¤º, æ”¯æŒå¤šä»»åŠ¡                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 æ·±åº¦ä¼°è®¡ (Depth Estimation)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æ·±åº¦ä¼°è®¡æ–¹æ³•                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   æ–¹æ³•              è¾“å…¥          ç²¾åº¦       é€Ÿåº¦       é€‚ç”¨åœºæ™¯             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚   ç»“æ„å…‰            RGB-D ç›¸æœº    é«˜         å®æ—¶       å®¤å†…, è¿‘è·ç¦»         â”‚
â”‚   (Structured Light) (RealSense)                       (< 10m)              â”‚
â”‚                                                                             â”‚
â”‚   ToF               ToF ç›¸æœº      ä¸­         å®æ—¶       å®¤å†…/å®¤å¤–            â”‚
â”‚   (Time-of-Flight)  (Azure Kinect)                     (< 5m)               â”‚
â”‚                                                                             â”‚
â”‚   åŒç›®ç«‹ä½“          åŒç›®ç›¸æœº      ä¸­         å®æ—¶       å®¤å¤–, çº¹ç†ä¸°å¯Œ       â”‚
â”‚   (Stereo)          (ZED)                              (éœ€è¦æ ‡å®š)           â”‚
â”‚                                                                             â”‚
â”‚   å•ç›®æ·±åº¦ä¼°è®¡      å•ç›®ç›¸æœº      ä½-ä¸­      å¿«         é€šç”¨, æˆæœ¬ä½         â”‚
â”‚   (Monocular)       (ä»»æ„ç›¸æœº)                         (ç›¸å¯¹æ·±åº¦)           â”‚
â”‚                                                                             â”‚
â”‚   LiDAR             æ¿€å…‰é›·è¾¾      æœ€é«˜       å®æ—¶       å®¤å¤–, é•¿è·ç¦»         â”‚
â”‚                     (Velodyne)                         (> 100m)             â”‚
â”‚                                                                             â”‚
â”‚   ğŸ’¡ æœºå™¨äººå¸¸ç”¨: RGB-D (å®¤å†…) + å•ç›®æ·±åº¦ä¼°è®¡ (è¡¥å……)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.4 å•ç›®æ·±åº¦ä¼°è®¡æ¨¡å‹

| æ¨¡å‹ | ç‰¹ç‚¹ | è¾“å‡º | é€‚ç”¨åœºæ™¯ |
| :--- | :--- | :--- | :--- |
| **Depth Anything V2** | é€šç”¨, é›¶æ ·æœ¬ | ç›¸å¯¹æ·±åº¦ | é€šç”¨åœºæ™¯ |
| **Metric3D** | ç»å¯¹æ·±åº¦ | ç±³åˆ¶æ·±åº¦ | éœ€è¦çœŸå®å°ºåº¦ |
| **ZoeDepth** | å¤šæ•°æ®é›†è®­ç»ƒ | ç±³åˆ¶æ·±åº¦ | å®¤å†…/å®¤å¤– |
| **MiDaS** | é²æ£’æ€§å¼º | ç›¸å¯¹æ·±åº¦ | å¤šæ ·åœºæ™¯ |
| **UniDepth** | ç»Ÿä¸€æ¶æ„ | ç›¸å¯¹/ç»å¯¹ | ç ”ç©¶ç”¨é€” |

```python
## Depth Anything V2 ä½¿ç”¨ç¤ºä¾‹
from depth_anything_v2.dpt import DepthAnythingV2

model = DepthAnythingV2(
    encoder='vitl',
    features=256,
    out_channels=[256, 512, 1024, 1024]
)
model.load_state_dict(torch.load('depth_anything_v2_vitl.pth'))
model.eval()

## æ¨ç†
image = cv2.imread('robot_view.jpg')
depth = model.infer_image(image)  # ç›¸å¯¹æ·±åº¦å›¾

## å¯è§†åŒ–
depth_colored = cv2.applyColorMap(
    (depth * 255).astype(np.uint8), 
    cv2.COLORMAP_INFERNO
)
```

---

## 5. Occupancy æ„ŸçŸ¥ (Occupancy Perception)

### 5.1 Occupancy æ¦‚å¿µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Occupancy ç½‘ç»œæ¦‚å¿µ                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   ä»€ä¹ˆæ˜¯ Occupancy?                                                         â”‚
â”‚   å°† 3D ç©ºé—´ç¦»æ•£åŒ–ä¸ºä½“ç´ ç½‘æ ¼, é¢„æµ‹æ¯ä¸ªä½“ç´ çš„å ç”¨çŠ¶æ€å’Œè¯­ä¹‰ç±»åˆ«              â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   ä¼ ç»Ÿ 3D æ£€æµ‹              Occupancy                               â”‚   â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”€â”€â”€â”€â”€â”€â”€â”€â”€                               â”‚   â”‚
â”‚   â”‚   è¾“å‡º: 3D Bbox             è¾“å‡º: ä½“ç´ ç½‘æ ¼                          â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚   â”‚
â”‚   â”‚   â”‚   â”Œâ”€â”€â”€â”     â”‚           â”‚ â–‘â–‘â–“â–“â–‘â–‘â–“â–“â–‘â–‘ â”‚                        â”‚   â”‚
â”‚   â”‚   â”‚   â”‚è½¦ â”‚     â”‚           â”‚ â–‘â–‘â–“â–“â–“â–“â–“â–“â–‘â–‘ â”‚                        â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€â”€â”˜     â”‚           â”‚ â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â”‚                        â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚   â”‚
â”‚   â”‚   åªæœ‰ç‰©ä½“è¾¹ç•Œæ¡†            æ¯ä¸ªä½“ç´ éƒ½æœ‰å ç”¨çŠ¶æ€                    â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   ä¼˜åŠ¿:                                                             â”‚   â”‚
â”‚   â”‚   â€¢ å®Œæ•´åœºæ™¯è¡¨ç¤º: ä¸ä»…æ˜¯ç‰©ä½“, è¿˜æœ‰é“è·¯ã€å»ºç­‘ã€æ¤è¢«                  â”‚   â”‚
â”‚   â”‚   â€¢ ä»»æ„å½¢çŠ¶: ä¸å— Bbox é™åˆ¶, å¯è¡¨ç¤ºä¸è§„åˆ™ç‰©ä½“                      â”‚   â”‚
â”‚   â”‚   â€¢ è§„åˆ’å‹å¥½: ç›´æ¥ç”¨äºç¢°æ’æ£€æµ‹å’Œè·¯å¾„è§„åˆ’                            â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   ä½“ç´ åˆ†è¾¨ç‡: é€šå¸¸ 0.1m ~ 0.5m, å–å†³äºè®¡ç®—èµ„æºå’Œç²¾åº¦éœ€æ±‚                    â”‚
â”‚   è¯­ä¹‰ç±»åˆ«: è½¦è¾†ã€è¡Œäººã€é“è·¯ã€å»ºç­‘ã€æ¤è¢«ã€å¤©ç©ºç­‰                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 Occupancy ç½‘ç»œæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Occupancy Network æ¶æ„ (ä»¥ SurroundOcc ä¸ºä¾‹)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                     å¤šç›¸æœºè¾“å…¥                                       â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”                  â”‚   â”‚
â”‚   â”‚   â”‚ Cam1â”‚ â”‚ Cam2â”‚ â”‚ Cam3â”‚ â”‚ Cam4â”‚ â”‚ Cam5â”‚ â”‚ Cam6â”‚                  â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜                  â”‚   â”‚
â”‚   â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”¬â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚   â”‚
â”‚   â”‚                          â”‚                                          â”‚   â”‚
â”‚   â”‚                          â–¼                                          â”‚   â”‚
â”‚   â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚   â”‚
â”‚   â”‚                   â”‚ 2D Backbone â”‚                                   â”‚   â”‚
â”‚   â”‚                   â”‚ (ResNet/Swin)â”‚                                  â”‚   â”‚
â”‚   â”‚                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                   â”‚   â”‚
â”‚   â”‚                          â”‚                                          â”‚   â”‚
â”‚   â”‚                          â–¼                                          â”‚   â”‚
â”‚   â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚   â”‚
â”‚   â”‚                   â”‚ 2D â†’ 3D    â”‚ â† View Transformation             â”‚   â”‚
â”‚   â”‚                   â”‚ Lifting    â”‚   (LSS / BEVFormer é£æ ¼)          â”‚   â”‚
â”‚   â”‚                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                   â”‚   â”‚
â”‚   â”‚                          â”‚                                          â”‚   â”‚
â”‚   â”‚                          â–¼                                          â”‚   â”‚
â”‚   â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚   â”‚
â”‚   â”‚                   â”‚ 3D Encoder â”‚ â† 3D ç‰¹å¾æå–                      â”‚   â”‚
â”‚   â”‚                   â”‚ (3D Conv)  â”‚                                    â”‚   â”‚
â”‚   â”‚                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                   â”‚   â”‚
â”‚   â”‚                          â”‚                                          â”‚   â”‚
â”‚   â”‚                          â–¼                                          â”‚   â”‚
â”‚   â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚   â”‚
â”‚   â”‚                   â”‚ Occupancy  â”‚                                    â”‚   â”‚
â”‚   â”‚                   â”‚ Decoder    â”‚                                    â”‚   â”‚
â”‚   â”‚                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                   â”‚   â”‚
â”‚   â”‚                          â”‚                                          â”‚   â”‚
â”‚   â”‚                          â–¼                                          â”‚   â”‚
â”‚   â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚   â”‚
â”‚   â”‚                   â”‚     3D Occupancy Grid           â”‚               â”‚   â”‚
â”‚   â”‚                   â”‚     (X Ã— Y Ã— Z Ã— C)             â”‚               â”‚   â”‚
â”‚   â”‚                   â”‚                                 â”‚               â”‚   â”‚
â”‚   â”‚                   â”‚  æ¯ä¸ªä½“ç´ : [occupied, semantic] â”‚               â”‚   â”‚
â”‚   â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   ä»£è¡¨æ¨¡å‹: SurroundOcc, OccNet, TPVFormer, FB-OCC, OpenOccupancy          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 Occupancy åœ¨æœºå™¨äººä¸­çš„åº”ç”¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Occupancy æœºå™¨äººåº”ç”¨                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   1. ç¢°æ’æ£€æµ‹ä¸é¿éšœ                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   Occupancy Grid + æœºå™¨äººä½“ç§¯ â†’ ç¢°æ’æŸ¥è¯¢                            â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   for voxel in robot_volume:                                        â”‚   â”‚
â”‚   â”‚       if occupancy[voxel] > threshold:                              â”‚   â”‚
â”‚   â”‚           collision_detected = True                                 â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   2. è·¯å¾„è§„åˆ’                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   Occupancy â†’ å¯é€šè¡ŒåŒºåŸŸ â†’ A* / RRT è§„åˆ’                            â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘                                                        â”‚   â”‚
â”‚   â”‚   â–‘â–‘â–“â–“â–“â–“â–‘â–‘â–‘â–‘   â–“ = éšœç¢ç‰©                                           â”‚   â”‚
â”‚   â”‚   â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘   â–‘ = å¯é€šè¡Œ                                           â”‚   â”‚
â”‚   â”‚   â–‘â–‘â–‘â–‘â–“â–“â–‘â–‘â–‘â–‘   * = è§„åˆ’è·¯å¾„                                         â”‚   â”‚
â”‚   â”‚   â–‘â–‘â–‘â–‘â–‘â–‘*â–‘â–‘â–‘                                                        â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   3. æŠ“å–è§„åˆ’                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   ç‰©ä½“ Occupancy â†’ æŠ“å–ç‚¹é‡‡æ · â†’ ç¢°æ’æ£€æµ‹ â†’ å¯è¡ŒæŠ“å–å§¿æ€             â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   â€¢ æ‰¾åˆ°ç‰©ä½“è¡¨é¢ä½“ç´                                                 â”‚   â”‚
â”‚   â”‚   â€¢ ç”Ÿæˆå€™é€‰æŠ“å–å§¿æ€                                                â”‚   â”‚
â”‚   â”‚   â€¢ æ£€æŸ¥å¤¹çˆªä½“ç§¯ä¸åœºæ™¯ Occupancy æ˜¯å¦ç¢°æ’                           â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   4. åœºæ™¯é‡å»ºä¸å»ºå›¾                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   å¤šå¸§ Occupancy èåˆ â†’ å…¨å±€åœ°å›¾                                    â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   â€¢ TSDF (Truncated Signed Distance Function) èåˆ                  â”‚   â”‚
â”‚   â”‚   â€¢ å¢é‡å¼æ›´æ–°                                                      â”‚   â”‚
â”‚   â”‚   â€¢ è¯­ä¹‰æ ‡ç­¾ä¼ æ’­                                                    â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. å¤šæ¨¡æ€èåˆ (Multimodal Fusion)

### 6.1 èåˆç­–ç•¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å¤šæ¨¡æ€èåˆç­–ç•¥                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   Early Fusion (æ—©æœŸèåˆ)                                                   â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                  â”‚
â”‚   â”‚ Camera  â”‚ â”‚ LiDAR   â”‚                                                  â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                                  â”‚
â”‚        â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                                        â”‚
â”‚              â–¼                                                              â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                        â”‚
â”‚        â”‚  Concat   â”‚ â† åŸå§‹æ•°æ®/ç‰¹å¾æ‹¼æ¥                                    â”‚
â”‚        â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                                        â”‚
â”‚              â–¼                                                              â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                        â”‚
â”‚        â”‚  Encoder  â”‚                                                        â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                        â”‚
â”‚   ä¼˜ç‚¹: ä¿¡æ¯ä¿ç•™å®Œæ•´                                                        â”‚
â”‚   ç¼ºç‚¹: æ¨¡æ€å¯¹é½å›°éš¾, è®¡ç®—é‡å¤§                                              â”‚
â”‚                                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                                                             â”‚
â”‚   Mid Fusion (ä¸­æœŸèåˆ)                                                     â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                  â”‚
â”‚   â”‚ Camera  â”‚ â”‚ LiDAR   â”‚                                                  â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                                  â”‚
â”‚        â–¼           â–¼                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                  â”‚
â”‚   â”‚Encoder 1â”‚ â”‚Encoder 2â”‚ â† å„è‡ªç¼–ç                                        â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                                  â”‚
â”‚        â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                                        â”‚
â”‚              â–¼                                                              â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                        â”‚
â”‚        â”‚  Fusion   â”‚ â† ç‰¹å¾èåˆ (Attention / Concat)                       â”‚
â”‚        â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                                        â”‚
â”‚              â–¼                                                              â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                        â”‚
â”‚        â”‚  Decoder  â”‚                                                        â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                        â”‚
â”‚   ä¼˜ç‚¹: çµæ´», æ•ˆæœå¥½                                                        â”‚
â”‚   ç¼ºç‚¹: éœ€è¦è®¾è®¡èåˆæ¨¡å—                                                    â”‚
â”‚                                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                                                             â”‚
â”‚   Late Fusion (æ™šæœŸèåˆ)                                                    â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                  â”‚
â”‚   â”‚ Camera  â”‚ â”‚ LiDAR   â”‚                                                  â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                                  â”‚
â”‚        â–¼           â–¼                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                  â”‚
â”‚   â”‚ Model 1 â”‚ â”‚ Model 2 â”‚ â† ç‹¬ç«‹æ¨¡å‹                                       â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                                  â”‚
â”‚        â–¼           â–¼                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                  â”‚
â”‚   â”‚ Pred 1  â”‚ â”‚ Pred 2  â”‚ â† å„è‡ªé¢„æµ‹                                       â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                                  â”‚
â”‚        â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                                        â”‚
â”‚              â–¼                                                              â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                        â”‚
â”‚        â”‚  Ensemble â”‚ â† ç»“æœèåˆ (NMS / æŠ•ç¥¨)                               â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                        â”‚
â”‚   ä¼˜ç‚¹: ç®€å•, æ¨¡å—åŒ–                                                        â”‚
â”‚   ç¼ºç‚¹: ä¿¡æ¯åˆ©ç”¨ä¸å……åˆ†                                                      â”‚
â”‚                                                                             â”‚
â”‚   ğŸ’¡ VLA å¸¸ç”¨: Mid Fusion (è§†è§‰ + è¯­è¨€ + æœ¬ä½“æ„Ÿè§‰)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 BEVFusion æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     BEVFusion: Camera + LiDAR èåˆ                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   Camera Branch                    LiDAR Branch                     â”‚   â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚   â”‚
â”‚   â”‚   â”‚ 6 Camerasâ”‚                     â”‚ LiDAR PC â”‚                     â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                     â”‚   â”‚
â”‚   â”‚        â–¼                                â–¼                           â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚   â”‚
â”‚   â”‚   â”‚ 2D CNN   â”‚                     â”‚PointPillars                    â”‚   â”‚
â”‚   â”‚   â”‚ Backbone â”‚                     â”‚ Encoder  â”‚                     â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                     â”‚   â”‚
â”‚   â”‚        â–¼                                â–¼                           â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚   â”‚
â”‚   â”‚   â”‚ LSS      â”‚                     â”‚ 3D â†’ BEV â”‚                     â”‚   â”‚
â”‚   â”‚   â”‚ 2D â†’ BEV â”‚                     â”‚ Scatter  â”‚                     â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                     â”‚   â”‚
â”‚   â”‚        â”‚                                â”‚                           â”‚   â”‚
â”‚   â”‚        â–¼                                â–¼                           â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚   â”‚
â”‚   â”‚   â”‚ Camera   â”‚                     â”‚ LiDAR    â”‚                     â”‚   â”‚
â”‚   â”‚   â”‚ BEV Feat â”‚                     â”‚ BEV Feat â”‚                     â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                     â”‚   â”‚
â”‚   â”‚        â”‚                                â”‚                           â”‚   â”‚
â”‚   â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚   â”‚
â”‚   â”‚                     â–¼                                               â”‚   â”‚
â”‚   â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚   â”‚
â”‚   â”‚              â”‚ BEV Fusion  â”‚ â† Convolution Fusion                   â”‚   â”‚
â”‚   â”‚              â”‚ (Conv + Add)â”‚                                        â”‚   â”‚
â”‚   â”‚              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                        â”‚   â”‚
â”‚   â”‚                     â”‚                                               â”‚   â”‚
â”‚   â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚   â”‚
â”‚   â”‚          â–¼          â–¼          â–¼                                    â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚   â”‚
â”‚   â”‚   â”‚3D Detect â”‚â”‚BEV Segm  â”‚â”‚Motion    â”‚                              â”‚   â”‚
â”‚   â”‚   â”‚ Head     â”‚â”‚ Head     â”‚â”‚ Head     â”‚                              â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   å…³é”®åˆ›æ–°:                                                                 â”‚
â”‚   â€¢ Camera BEV: LSS (Lift-Splat-Shoot) å°† 2D ç‰¹å¾æå‡åˆ° 3D                 â”‚
â”‚   â€¢ ç»Ÿä¸€ BEV ç©ºé—´: Camera å’Œ LiDAR ç‰¹å¾åœ¨åŒä¸€åæ ‡ç³»èåˆ                    â”‚
â”‚   â€¢ é«˜æ•ˆèåˆ: ç®€å•çš„å·ç§¯èåˆå³å¯å–å¾— SOTA æ•ˆæœ                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. ä½å§¿ä¼°è®¡ (Pose Estimation)

### 7.1 ç‰©ä½“ 6-DoF ä½å§¿ä¼°è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     6-DoF ä½å§¿ä¼°è®¡æ–¹æ³•                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   6-DoF = 3D ä½ç½® (x, y, z) + 3D æ—‹è½¬ (roll, pitch, yaw)                   â”‚
â”‚                                                                             â”‚
â”‚   æ–¹æ³•åˆ†ç±»:                                                                 â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   åŸºäºæ¨¡å‹ (Model-Based)          æ— æ¨¡å‹ (Model-Free)               â”‚   â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”‚   â”‚
â”‚   â”‚   éœ€è¦ 3D CAD æ¨¡å‹                ä¸éœ€è¦ CAD æ¨¡å‹                   â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   â€¢ PVNet: å…³é”®ç‚¹æŠ•ç¥¨             â€¢ FoundationPose: é›¶æ ·æœ¬          â”‚   â”‚
â”‚   â”‚   â€¢ DenseFusion: RGB-D èåˆ       â€¢ Gen6D: ç”Ÿæˆå¼ä½å§¿              â”‚   â”‚
â”‚   â”‚   â€¢ PoseCNN: ç›´æ¥å›å½’             â€¢ SAM-6D: SAM + ä½å§¿              â”‚   â”‚
â”‚   â”‚   â€¢ GDR-Net: å‡ ä½•å¼•å¯¼             â€¢ MegaPose: å¤§è§„æ¨¡é¢„è®­ç»ƒ          â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   ä¼˜ç‚¹: ç²¾åº¦é«˜                    ä¼˜ç‚¹: æ³›åŒ–æ€§å¼º                    â”‚   â”‚
â”‚   â”‚   ç¼ºç‚¹: éœ€è¦ CAD æ¨¡å‹             ç¼ºç‚¹: ç²¾åº¦ç•¥ä½                    â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   ğŸ’¡ æœºå™¨äººæŠ“å–: FoundationPose (é›¶æ ·æœ¬) + ICP ç²¾ç»†åŒ–                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 FoundationPose æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FoundationPose: é›¶æ ·æœ¬ 6-DoF ä½å§¿ä¼°è®¡                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   è¾“å…¥:                                                                     â”‚
â”‚   â€¢ RGB-D å›¾åƒ                                                              â”‚
â”‚   â€¢ ç‰©ä½“å‚è€ƒ (CAD æ¨¡å‹ æˆ– å°‘é‡å‚è€ƒå›¾åƒ)                                     â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                        FoundationPose æµç¨‹                           â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚   â”‚   â”‚  Pose Hypothesis Generation (ä½å§¿å‡è®¾ç”Ÿæˆ)                    â”‚  â”‚   â”‚
â”‚   â”‚   â”‚                                                              â”‚  â”‚   â”‚
â”‚   â”‚   â”‚  æ–¹å¼ 1: CAD æ¨¡å‹ â†’ æ¸²æŸ“å¤šè§†è§’ â†’ æ¨¡æ¿åŒ¹é…                     â”‚  â”‚   â”‚
â”‚   â”‚   â”‚  æ–¹å¼ 2: å‚è€ƒå›¾åƒ â†’ ç‰¹å¾åŒ¹é… â†’ PnP æ±‚è§£                       â”‚  â”‚   â”‚
â”‚   â”‚   â”‚                                                              â”‚  â”‚   â”‚
â”‚   â”‚   â”‚  è¾“å‡º: N ä¸ªå€™é€‰ä½å§¿ {P_1, P_2, ..., P_N}                      â”‚  â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚   â”‚                              â”‚                                      â”‚   â”‚
â”‚   â”‚                              â–¼                                      â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚   â”‚   â”‚  Pose Refinement (ä½å§¿ç²¾åŒ–)                                   â”‚  â”‚   â”‚
â”‚   â”‚   â”‚                                                              â”‚  â”‚   â”‚
â”‚   â”‚   â”‚  Render-and-Compare:                                         â”‚  â”‚   â”‚
â”‚   â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚  â”‚   â”‚
â”‚   â”‚   â”‚  â”‚ å€™é€‰ä½å§¿â”‚ â†’  â”‚ æ¸²æŸ“å›¾åƒâ”‚ â†’  â”‚ ä¸è§‚æµ‹  â”‚ â†’ æ®‹å·®            â”‚  â”‚   â”‚
â”‚   â”‚   â”‚  â”‚   P_i   â”‚    â”‚         â”‚    â”‚ æ¯”è¾ƒ    â”‚                   â”‚  â”‚   â”‚
â”‚   â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  â”‚   â”‚
â”‚   â”‚   â”‚                                                              â”‚  â”‚   â”‚
â”‚   â”‚   â”‚  è¿­ä»£ä¼˜åŒ–: P' = P + Î”P (Transformer é¢„æµ‹ Î”P)                  â”‚  â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚   â”‚                              â”‚                                      â”‚   â”‚
â”‚   â”‚                              â–¼                                      â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚   â”‚   â”‚  Pose Selection (ä½å§¿é€‰æ‹©)                                    â”‚  â”‚   â”‚
â”‚   â”‚   â”‚                                                              â”‚  â”‚   â”‚
â”‚   â”‚   â”‚  Score ç½‘ç»œè¯„ä¼°æ¯ä¸ªç²¾åŒ–åçš„ä½å§¿, é€‰æ‹©æœ€ä¼˜                     â”‚  â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚   â”‚                              â”‚                                      â”‚   â”‚
â”‚   â”‚                              â–¼                                      â”‚   â”‚
â”‚   â”‚                    æœ€ç»ˆ 6-DoF ä½å§¿                                  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   ç‰¹ç‚¹:                                                                     â”‚
â”‚   â€¢ é›¶æ ·æœ¬: ä¸éœ€è¦é’ˆå¯¹ç‰¹å®šç‰©ä½“è®­ç»ƒ                                         â”‚
â”‚   â€¢ çµæ´»è¾“å…¥: æ”¯æŒ CAD æ¨¡å‹æˆ–å‚è€ƒå›¾åƒ                                      â”‚
â”‚   â€¢ é«˜ç²¾åº¦: è¿­ä»£ç²¾åŒ–è¾¾åˆ°äºšæ¯«ç±³çº§ç²¾åº¦                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.3 ä½å§¿ä¼°è®¡ä»£ç ç¤ºä¾‹

```python
## FoundationPose ä½¿ç”¨ç¤ºä¾‹
from foundationpose import FoundationPose

## åˆå§‹åŒ–
model = FoundationPose(
    model_path='foundation_pose.pth',
    device='cuda'
)

## è¾“å…¥: RGB-D + ç‰©ä½“æ©ç  + CAD æ¨¡å‹
rgb = cv2.imread('scene.png')
depth = np.load('depth.npy')
mask = get_object_mask(rgb)  # SAM æˆ–å…¶ä»–åˆ†å‰²
mesh = trimesh.load('object.obj')

## ä¼°è®¡ä½å§¿
pose = model.estimate_pose(
    rgb=rgb,
    depth=depth,
    mask=mask,
    mesh=mesh
)

## pose: 4x4 å˜æ¢çŸ©é˜µ (ç›¸æœºåæ ‡ç³» â†’ ç‰©ä½“åæ ‡ç³»)
print(f"ä½ç½®: {pose[:3, 3]}")
print(f"æ—‹è½¬: {pose[:3, :3]}")

## å¯è§†åŒ–
rendered = model.render_pose(mesh, pose, intrinsics)
overlay = cv2.addWeighted(rgb, 0.5, rendered, 0.5, 0)
```

---

## 8. é¢è¯•é«˜é¢‘ Q&A

### Q1: ç›®æ ‡æ£€æµ‹ä¸­ Anchor-Based å’Œ Anchor-Free çš„åŒºåˆ«ï¼Ÿ

| ç»´åº¦ | Anchor-Based | Anchor-Free |
| :--- | :--- | :--- |
| **ä»£è¡¨** | Faster R-CNN, YOLOv3 | CenterNet, FCOS |
| **åŸç†** | é¢„è®¾é”šæ¡†, é¢„æµ‹åç§» | ç›´æ¥é¢„æµ‹ä¸­å¿ƒç‚¹/è¾¹ç•Œ |
| **è¶…å‚æ•°** | éœ€è¦è®¾è®¡ anchor å°ºå¯¸/æ¯”ä¾‹ | æ— éœ€ anchor è¶…å‚æ•° |
| **å¯†é›†ç‰©ä½“** | å¯èƒ½æ¼æ£€ | ä¸­å¿ƒç‚¹é‡å é—®é¢˜ |
| **è®­ç»ƒ** | éœ€è¦æ­£è´Ÿæ ·æœ¬åŒ¹é… | æ›´ç®€å•ç›´æ¥ |
| **è¶‹åŠ¿** | é€æ¸è¢«å–ä»£ | ä¸»æµæ–¹å‘ |

### Q2: NMS çš„ä½œç”¨å’Œæ”¹è¿›æ–¹æ³•ï¼Ÿ

**NMS (Non-Maximum Suppression)**:
- **ä½œç”¨**: å»é™¤é‡å çš„å†—ä½™æ£€æµ‹æ¡†
- **æµç¨‹**: æŒ‰ç½®ä¿¡åº¦æ’åº â†’ ä¿ç•™æœ€é«˜åˆ†æ¡† â†’ åˆ é™¤ IoU > é˜ˆå€¼çš„æ¡† â†’ é‡å¤

**æ”¹è¿›æ–¹æ³•**:
- **Soft-NMS**: ä¸ç›´æ¥åˆ é™¤, è€Œæ˜¯é™ä½é‡å æ¡†çš„åˆ†æ•°
- **DIoU-NMS**: è€ƒè™‘ä¸­å¿ƒç‚¹è·ç¦», ä¸åªæ˜¯ IoU
- **æ—  NMS**: DETR ç³»åˆ—ç›´æ¥è¾“å‡ºå»é‡ç»“æœ

### Q3: å¦‚ä½•å¤„ç†å°ç›®æ ‡æ£€æµ‹ï¼Ÿ

1. **å¤šå°ºåº¦ç‰¹å¾**: FPN (Feature Pyramid Network) èåˆå¤šå±‚ç‰¹å¾
2. **é«˜åˆ†è¾¨ç‡è¾“å…¥**: å¢å¤§è¾“å…¥å›¾åƒå°ºå¯¸
3. **æ•°æ®å¢å¼º**: Mosaic, Copy-Paste å¢åŠ å°ç›®æ ‡æ ·æœ¬
4. **Anchor è®¾è®¡**: å¢åŠ å°å°ºå¯¸ anchor
5. **æ³¨æ„åŠ›æœºåˆ¶**: å¢å¼ºå°ç›®æ ‡åŒºåŸŸç‰¹å¾
6. **SAHI**: æ»‘åŠ¨çª—å£åˆ‡å›¾æ£€æµ‹, å†åˆå¹¶ç»“æœ

### Q4: BEV æ„ŸçŸ¥ç›¸æ¯”ä¼ ç»Ÿ 3D æ£€æµ‹çš„ä¼˜åŠ¿ï¼Ÿ

1. **ç»Ÿä¸€è¡¨ç¤º**: ä¸åŒä¼ æ„Ÿå™¨ç‰¹å¾åœ¨åŒä¸€åæ ‡ç³»èåˆ
2. **å°ºåº¦ä¸€è‡´**: æ— é€è§†ç•¸å˜, è¿œè¿‘ç‰©ä½“å°ºåº¦ç›¸åŒ
3. **è§„åˆ’å‹å¥½**: BEV åœ°å›¾ç›´æ¥ç”¨äºè·¯å¾„è§„åˆ’
4. **å¤šä»»åŠ¡**: æ£€æµ‹ã€åˆ†å‰²ã€é¢„æµ‹å…±äº« BEV ç‰¹å¾
5. **æ—¶åºå»ºæ¨¡**: æ–¹ä¾¿èåˆå†å²å¸§ä¿¡æ¯

### Q5: æœºå™¨äººæŠ“å–ä¸­å¸¸ç”¨çš„æ„ŸçŸ¥ Pipelineï¼Ÿ

```
1. åœºæ™¯æ„ŸçŸ¥
   RGB-D è¾“å…¥ â†’ ç›®æ ‡æ£€æµ‹ (YOLO-World) â†’ å®ä¾‹åˆ†å‰² (SAM)
   
2. ä½å§¿ä¼°è®¡
   åˆ†å‰²æ©ç  + æ·±åº¦ â†’ 6-DoF ä½å§¿ (FoundationPose)
   
3. æŠ“å–è§„åˆ’
   ç‰©ä½“ä½å§¿ + åœºæ™¯ç‚¹äº‘ â†’ æŠ“å–ç‚¹ç”Ÿæˆ (GraspNet) â†’ ç¢°æ’æ£€æµ‹
   
4. æ‰§è¡Œ
   æŠ“å–å§¿æ€ â†’ è¿åŠ¨è§„åˆ’ â†’ æœºæ¢°è‡‚æ‰§è¡Œ
```

---

## ğŸ“š æ¨èèµ„æº

### è®ºæ–‡
- [YOLO-World: Real-Time Open-Vocabulary Object Detection](https://arxiv.org/abs/2401.17270)
- [Segment Anything](https://arxiv.org/abs/2304.02643)
- [ByteTrack: Multi-Object Tracking by Associating Every Detection Box](https://arxiv.org/abs/2110.06864)
- [BEVFormer: Learning Bird's-Eye-View Representation](https://arxiv.org/abs/2203.17270)
- [FoundationPose: Unified 6D Pose Estimation](https://arxiv.org/abs/2312.08344)

### ä»£ç åº“
- [Ultralytics YOLO](https://github.com/ultralytics/ultralytics)
- [Segment Anything (SAM)](https://github.com/facebookresearch/segment-anything)
- [MMDetection3D](https://github.com/open-mmlab/mmdetection3d)
- [FoundationPose](https://github.com/NVlabs/FoundationPose)

---



\newpage

# ç¬¬19ç«  ç‚¹äº‘ä¸ SLAM


> **é¢è¯•åœºæ™¯**: â€œè¯·æ¯”è¾ƒ Visual SLAM ä¸ LiDAR SLAM çš„åŒºåˆ«ï¼›ç‚¹äº‘ç‰¹å¾ç½‘ç»œæœ‰å“ªäº›ï¼Ÿå®é™…å·¥ç¨‹å¦‚ä½•é€‰æ‹©ï¼Ÿâ€

---

## 0. ä¸»è¦æ•¸å­¸æ€æƒ³ (Main Mathematical Idea)

> **ç¬¬ä¸€æ€§åŸç†**: **Consistency Maximization (ä¸€è‡´æ€§æœ€å¤§åŒ–)**

å¦‚æœä¸–ç•Œæ˜¯é™æ­¢çš„ï¼Œé‚£ä¹ˆæ— è®ºæœºå™¨äººæ€ä¹ˆåŠ¨ï¼Œè§‚æµ‹åˆ°çš„ç¯å¢ƒç‰¹å¾ä¹‹é—´çš„ç›¸å¯¹å‡ ä½•å…³ç³»åº”è¯¥ä¿æŒä¸å˜ã€‚SLAM çš„æœ¬è´¨å°±æ˜¯å¯»æ‰¾ä¸€æ¡è½¨è¿¹ï¼Œä½¿å¾—æ‰€æœ‰è§‚æµ‹æ•°æ®åœ¨å‡ ä½•ä¸Š**æœ€è‡ªæ´½**ã€‚

- **æ ¸å¿ƒæ•°å­¦å·¥å…·**: **Least Squares Optimization (æœ€å°äºŒä¹˜ä¼˜åŒ–)** ä¸ **Graph Theory (å› å­å›¾)**ã€‚
- **è§£é¢˜é€»è¾‘**:
    1.  **é…å‡† (Registration)**: å¯»æ‰¾ä¸€ä¸ªå˜æ¢çŸ©é˜µ $T$ï¼Œä½¿å¾—ä¸¤ä¸ªç‚¹äº‘é‡åˆåº¦æœ€é«˜ã€‚æ•°å­¦ä¸Šé€šå¸¸æœ€å°åŒ–ç‚¹åˆ°ç‚¹çš„è·ç¦»å¹³æ–¹å’Œ (ICP)ã€‚
    2.  **å›¾ä¼˜åŒ– (Graph Optimization)**: å°†æœºå™¨äººä½å§¿ä½œä¸ºèŠ‚ç‚¹ï¼Œè§‚æµ‹çº¦æŸä½œä¸ºè¾¹ã€‚æ„å»ºä¸€ä¸ªå·¨å¤§çš„éçº¿æ€§æœ€å°äºŒä¹˜é—®é¢˜ $\min \sum \|z_i - f(x_i)\|^2$ï¼Œé€šè¿‡è¿­ä»£æ±‚è§£ï¼ˆå¦‚ Gauss-Newtonï¼‰æ¥æ¶ˆé™¤ç´¯ç§¯è¯¯å·®ï¼ˆé—­ç¯æ£€æµ‹ï¼‰ã€‚

## ğŸŒ æ„ŸçŸ¥ä»»åŠ¡è§†è§’

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ç‚¹äº‘ & SLAM ä»»åŠ¡çŸ©é˜µ                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚                     è¾“å…¥: 3D ç‚¹äº‘ (LiDAR / æ·±åº¦ç›¸æœº / SFM)                â”‚
â”‚                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ ä»»åŠ¡ç±»å‹      â”‚ ç›®æ ‡               â”‚ å¸¸ç”¨æ–¹æ³•                     â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚ å‡ ä½•ç†è§£      â”‚ å»å™ªã€é…å‡†ã€é‡å»º    â”‚ ICP, NDT, Poisson, NeRF      â”‚   â”‚
â”‚   â”‚ è¯­ä¹‰ç†è§£      â”‚ åˆ†ç±»ã€æ£€æµ‹ã€åˆ†å‰²    â”‚ PointNet++, KPConv, Minkowskiâ”‚   â”‚
â”‚   â”‚ åŠ¨æ€ç†è§£      â”‚ è½¨è¿¹ã€åœºæ™¯æµ        â”‚ FlowNet3D, PV-RCNN           â”‚   â”‚
â”‚   â”‚ è‡ªå®šä½ (SLAM) â”‚ ä½å§¿ã€åœ°å›¾          â”‚ LOAM, LIO-SAM, ORB-SLAM3     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚   è¾“å‡º: è¯­ä¹‰åœ°å›¾ã€å æ®æ …æ ¼ã€å…³é”®å¸§å›¾ã€ç¨€ç–/ç¨ å¯†ç‚¹äº‘                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1. ç‚¹äº‘å¤„ç†åŸºç¡€

### 1.1 å¸¸ç”¨è¡¨ç¤º

| è¡¨ç¤ºæ–¹å¼ | æè¿° | ä¼˜åŠ¿ | åŠ£åŠ¿ | å…¸å‹ç½‘ç»œ |
|:---------|:-----|:-----|:-----|:---------|
| åŸå§‹ç‚¹äº‘ (XYZRGB) | æ— ç»“æ„é›†åˆ | å®Œæ•´ä¿ç•™å‡ ä½• | ä¸è§„åˆ™ã€ä¸èƒ½ç›´æ¥ç”¨ CNN | PointNet |
| ä½“ç´  (Voxel) | åˆ’åˆ†ä¸º 3D ç½‘æ ¼ | ç»“æ„åŒ–ï¼Œå¯ç”¨ 3D CNN | é«˜ç»´ï¼Œç¨€ç–æµªè´¹è®¡ç®— | VoxelNet |
| ç‚¹æŸ± (Pillar) | æ²¿ z è½´ç§¯åˆ†ä¸ºæŸ± | å…¼é¡¾ç¨€ç–æ€§å’Œç»“æ„æ€§ | z ä¿¡æ¯æŸå¤± | PointPillars |
| åˆ‡ç‰‡ (Range Image) | æåæ ‡æŠ•å½± | é€‚åˆ LiDAR | å¤±çœŸ | RangeNet++ |
| BEV | é¸Ÿç°æŠ•å½± | è§„åˆ’å‹å¥½ | ç²¾åº¦å—é«˜åº¦å½±å“ | BEVFusion |

### 1.2 ç‰¹å¾æå–ç½‘ç»œ

| ç±»å‹ | ä»£è¡¨ç½‘ç»œ | æ ¸å¿ƒæ€æƒ³ | é€‚ç”¨ |
|:-----|:---------|:---------|:-----|
| MLP å…¨å±€ | PointNet | å¯¹æ¯ä¸ªç‚¹ç‹¬ç«‹ + å…¨å±€ Pooling | åˆ†ç±»/ç²—åˆ†å‰² |
| å±€éƒ¨èšåˆ | PointNet++ | å±€éƒ¨åŒºåŸŸé‡‡æ · + é›†åˆ | æ›´ç»†ç²’åº¦ | 
| å·ç§¯æ ¸ | KPConv | å¯å˜å½¢ Point Kernel | å¯†é›†ç‚¹äº‘ |
| ç¨€ç–å·ç§¯ | MinkowskiNet | Sparse Convolution | å¤§è§„æ¨¡ç‚¹äº‘ |
| Transformer | Point-BERT, Point Transformer | è‡ªæ³¨æ„åŠ› | é€šç”¨ |

---

## 2. ç‚¹äº‘è¯­ä¹‰ç†è§£

### 2.1 æ£€æµ‹

| ç®—æ³• | è¾“å…¥ | ç‰¹ç‚¹ |
|:-----|:-----|:-----|
| PointRCNN | ç‚¹äº‘ | Two-stage, PointNet++ backbone |
| PV-RCNN | æ··åˆ (Voxel + Point) | å…ˆä½“ç´ æç‰¹å¾ï¼Œå†å›åˆ°åŸå§‹ç‚¹ |
| SECOND | ä½“ç´  | SparseConv, å¿«é€Ÿ |
| CenterPoint | BEV | Anchor-freeï¼Œæ£€æµ‹ä¸­å¿ƒç‚¹ |

### 2.2 åˆ†å‰²

- **RangeNet++**: å°† LiDAR æŠ•å½±åˆ° range imageï¼Œä½¿ç”¨ 2D CNNã€‚
- **MinkowskiNet**: ç¨€ç–å·ç§¯ï¼Œå¤šä»»åŠ¡ (è¯­ä¹‰ + å®ä¾‹)ã€‚
- **PolarNet**: åœ¨æåæ ‡ä¸­åˆ†å‰²ï¼Œå…¼é¡¾é€Ÿåº¦ä¸ç²¾åº¦ã€‚

### 2.3 åœºæ™¯æµ / åŠ¨æ€ç†è§£

- FlowNet3D, HPLFlowNet: å­¦ä¹ å¸§é—´ç‚¹äº‘çš„é€Ÿåº¦åœºã€‚
- BEVFlow: åœ¨ BEV ä¸­ä¼°è®¡åœºæ™¯æµï¼Œé€‚åˆè‡ªåŠ¨é©¾é©¶ã€‚

---

## 3. ç‚¹äº‘é…å‡† (Registration)

### 3.1 ç»å…¸ç®—æ³•

| ç®—æ³• | æ€è·¯ | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|:-----|:-----|:-----|:-----|
| ICP | æœ€è¿‘é‚»ç‚¹å¯¹é½ + æœ€å°äºŒä¹˜ | ç®€å• | å®¹æ˜“é™·å…¥å±€éƒ¨ï¼Œéœ€è‰¯å¥½åˆå§‹åŒ– |
| G-ICP | åŸºäºé«˜æ–¯åˆ†å¸ƒçš„ ICP | ç²¾åº¦æ›´å¥½ | è®¡ç®—é‡ç¨é«˜ |
| NDT | å°†ç‚¹äº‘å»ºæ¨¡ä¸ºé«˜æ–¯ä½“ç´  | æ”¶æ•›èŒƒå›´å¤§ | éœ€è¦è°ƒåˆ†è¾¨ç‡ |
| TEASER++ | é²æ£’ä¼°è®¡ | å¯æŠ—ç¦»ç¾¤ç‚¹ | è®¡ç®—å¼€é”€å¤§ |

### 3.2 å­¦ä¹ å‹é…å‡†

- DCP / Deep Closest Point
- Predator
- FCGF (Fully Convolutional Geometric Features)

---

## 4. SLAM æŠ€æœ¯è°±ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SLAM åˆ†ç±»                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   è§†è§‰ SLAM (Mono / Stereo / RGB-D)                                       â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                         â”‚
â”‚   â€¢ ORB-SLAM2/3 (ç‰¹å¾)                                                    â”‚
â”‚   â€¢ DSO / LSD-SLAM (ç›´æ¥æ³•)                                               â”‚
â”‚   â€¢ VINS-Mono / OKVIS (VIO)                                              â”‚
â”‚                                                                          â”‚
â”‚   LiDAR SLAM                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                             â”‚
â”‚   â€¢ LOAM, LeGO-LOAM                                                      â”‚
â”‚   â€¢ Cartographer                                                        â”‚
â”‚   â€¢ LIO-SAM (LiDAR-Inertial)                                            â”‚
â”‚                                                                          â”‚
â”‚   å¤šä¼ æ„Ÿå™¨ SLAM                                                          â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                           â”‚
â”‚   â€¢ VIO + GPS (VINS-Fusion)                                              â”‚
â”‚   â€¢ Multi-camera + IMU (ORB-SLAM3)                                       â”‚
â”‚   â€¢ Tightly-Coupled LiDAR-IMU-Camera                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.1 è§†è§‰ SLAM æµç¨‹

```
å›¾åƒ â†’ ç‰¹å¾æå– (ORB/SIFT) â†’ åŒ¹é… â†’ ä½å§¿ä¼°è®¡ (PnP + RANSAC) â†’
æ»‘åŠ¨çª—å£ä¼˜åŒ– / BA â†’ å›ç¯æ£€æµ‹ (DBoW2) â†’ å›¾ä¼˜åŒ– (g2o)
```

| æ¨¡å— | å…³é”®æŠ€æœ¯ |
|:-----|:---------|
| å‰ç«¯ | FAST/ORBã€å…‰æµè·Ÿè¸ªã€é‡‘å­—å¡” LK |
| åç«¯ | Bundle Adjustment, Pose Graph |
| å›ç¯ | Bag-of-Words, Place Recognition |
| åœ°å›¾ | ç¨€ç–è·¯æ ‡ (Landmarks) |

### 4.2 LiDAR SLAM

- **LOAM**: åˆ†ç¦»æ‰«æåŒ¹é…å’Œè¿åŠ¨è¡¥å¿ï¼Œç‰¹å¾ç‚¹ (Edge/Plane)ã€‚
- **LeGO-LOAM**: é’ˆå¯¹åœ°é¢è½¦è¾†ï¼Œåˆ†å‰²åœ°é¢ä¸éšœç¢ã€‚
- **LIO-SAM**:
  - å‰ç«¯ï¼šLiDAR ç‰¹å¾ + IMU é¢„ç§¯åˆ†
  - åç«¯ï¼šå› å­å›¾ (GTSAM)
  - å›ç¯æ£€æµ‹ + Pose Graph

### 4.3 å¤šä¼ æ„Ÿå™¨ (VIO / LIO)

| ç³»ç»Ÿ | ä¼ æ„Ÿå™¨ | ç‰¹ç‚¹ |
|:-----|:-------|:-----|
| VINS-Mono | å•ç›® + IMU | æ»‘åŠ¨çª—å£ BAï¼Œå®æ—¶ |
| ORB-SLAM3 | Mono/Stereo/RGBD + IMU | å…³é”®å¸§å›¾ä¼˜åŒ– |
| LIO-SAM | LiDAR + IMU + (å¯é€‰) GPS | é«˜ç²¾åº¦ï¼Œå¼€æº |
| Cartographer | LiDAR + IMU + Wheel | Google å¼€æº |

---

## 5. å¤šæ¨¡æ€èåˆç­–ç•¥

| èåˆæ–¹å¼ | æè¿° | ä»£è¡¨ç³»ç»Ÿ |
|:---------|:-----|:---------|
| æ¾è€¦åˆ | å…ˆåˆ†åˆ«ä¼°è®¡ï¼Œå†é€šè¿‡ EKF èåˆ | robot_localization |
| ç´§è€¦åˆ | åœ¨åŒä¸€ä¼˜åŒ–æ¡†æ¶ä¸­è”åˆä¼°è®¡ | VINS-Fusion, LIO-SAM |
| Graph-SLAM | å› å­å›¾è¡¨ç¤ºæ‰€æœ‰çº¦æŸ | GTSAM ç³»åˆ— |

**é€‰æ‹©å»ºè®®**:
- å®æ—¶æ€§ä¼˜å…ˆ â†’ æ¾è€¦åˆ EKF
- é«˜ç²¾åº¦ â†’ ç´§è€¦åˆ + å› å­å›¾
- å¤šä¼ æ„Ÿå™¨å†—ä½™ â†’ Graph-SLAM

---

## 6. å·¥ç¨‹è½åœ° Checklist

- [ ] æ—¶é—´åŒæ­¥ï¼šç¡¬ä»¶è§¦å‘ / PTP / æ—¶æˆ³å¯¹é½
- [ ] ä¼ æ„Ÿå™¨æ ‡å®šï¼šå¤–å‚ (Hand-eye)ï¼Œå†…å‚ (LiDAR-to-Camera)
- [ ] åœ°å›¾ç®¡ç†ï¼šå…³é”®å¸§ç¨€ç–åŒ–ã€å¾ªç¯æ£€æµ‹
- [ ] åŠ¨æ€ç‰©ä½“å¤„ç†ï¼šè¯­ä¹‰åˆ†å‰²å‰”é™¤è¡Œäºº/è½¦è¾†
- [ ] å¼‚å¸¸æ£€æµ‹ï¼šç›‘æ§è½¨è¿¹æ®‹å·®ã€é€Ÿåº¦è·³å˜
- [ ] å›ç¯ç­–ç•¥ï¼šè¿‘ä¼¼æœ€è¿‘é‚» / åŸºäºå­¦ä¹ çš„åœºæ™¯è¯†åˆ«

---

## 7. ä»£ç ç‰‡æ®µ

### 7.1 Open3D ICP

```python
import open3d as o3d

source = o3d.io.read_point_cloud("scan1.pcd")
target = o3d.io.read_point_cloud("scan2.pcd")

threshold = 0.05
trans_init = np.eye(4)

reg_p2p = o3d.pipelines.registration.registration_icp(
    source, target, threshold, trans_init,
    o3d.pipelines.registration.TransformationEstimationPointToPlane()
)
print(reg_p2p.transformation)
```

### 7.2 LIO-SAM Launch (ROS)

```xml
<launch>
  <node pkg="lio_sam" type="lio_sam_imuPreintegration" name="lio_sam">
    <param name="sensor" value="velodyne" />
    <param name="imu_topic" value="/imu/data" />
    <param name="pointCloudTopic" value="/velodyne_points" />
    <param name="gpsTopic" value="/gps/fix" />
  </node>
</launch>
```

---

## 8. é¢è¯• Q&A

### Q1: Visual SLAM vs LiDAR SLAMï¼Ÿ

- è§†è§‰ï¼šä¿¡æ¯ä¸°å¯Œã€æˆæœ¬ä½ï¼Œä½†æ˜“å—å…‰ç…§/çº¹ç†å½±å“ã€‚
- LiDARï¼šå‡ ä½•ç²¾ç¡®ã€é²æ£’ï¼Œä½†æˆæœ¬é«˜ã€åˆ†è¾¨ç‡æœ‰é™ã€‚
- èåˆï¼šä½¿ç”¨ LiDAR æä¾›å…¨å±€å‡ ä½•ï¼Œè§†è§‰æä¾›è¯­ä¹‰å’Œç²¾ç»†ç»“æ„ã€‚

### Q2: å¦‚ä½•å¤„ç†ç‚¹äº‘ä¸­çš„åŠ¨æ€ç‰©ä½“ï¼Ÿ

1. è¯­ä¹‰åˆ†å‰²å‰”é™¤åŠ¨æ€ç±»åˆ« (è½¦/äºº)ã€‚
2. åŸºäº RANSAC/è¿åŠ¨ä¸€è‡´æ€§æ£€æµ‹å¼‚å¸¸é€Ÿåº¦ã€‚
3. ä½¿ç”¨å¤šä¼ æ„Ÿå™¨ (IMU) åŒºåˆ†é™æ€ vs åŠ¨æ€ã€‚

### Q3: å›ç¯æ£€æµ‹çš„å…³é”®æ­¥éª¤ï¼Ÿ

- é€‰æ‹©å€™é€‰å…³é”®å¸§ï¼ˆæ—¶é—´/ç©ºé—´æœ€è¿‘ï¼‰ã€‚
- æ„å»ºæè¿°å­ (BoW / Scan Context)ã€‚
- åŒ¹é…éªŒè¯ (å‡ ä½•å¯¹é½)ã€‚
- æ·»åŠ å›ç¯çº¦æŸï¼Œä¼˜åŒ– Pose Graphã€‚

### Q4: ICP ä½•æ—¶ä¼šå¤±è´¥ï¼Ÿå¦‚ä½•æ”¹å–„ï¼Ÿ

- åˆå§‹ä¼°è®¡å·® â†’ ä½¿ç”¨å…¨å±€é…å‡† / NDT å…ˆç²—å¯¹é½ã€‚
- åŠ¨æ€ç‰©ä½“å¤š â†’ é¢„å¤„ç†å‰”é™¤å¼‚å¸¸ç‚¹ã€‚
- å™ªå£°å¤§ â†’ é‡‡ç”¨ç‚¹åˆ°å¹³é¢æˆ–é²æ£’æ ¸å‡½æ•°ã€‚

---

## ğŸ“š æ¨èèµ„æº

- *3D Point Cloud Processing* â€” T.-Y. Lin
- *SLAM for Dummies* (Online)
- Open3D, PCL, Cupoch (GPU) â€” ç‚¹äº‘å¤„ç†åº“
- LIO-SAM, VINS-Fusion, ORB-SLAM3 â€” å¼€æºå®ç°
- Scan Context, OverlapNet â€” å›ç¯æ£€æµ‹

---



\newpage

# ç¬¬20ç«  çŠ¶æ€ä¼°è®¡


> **é¢è¯•åœºæ™¯**: â€œå¦‚ä½•åˆ©ç”¨ IMU + ç›¸æœºåšçŠ¶æ€ä¼°è®¡ï¼ŸKalman Filter ä¸ Particle Filter æœ‰å“ªäº›åŒºåˆ«ï¼Ÿâ€

æœ¬ç« æ•´ç† Kalman/EKF/UKFã€Particle Filter ä»¥åŠå¤šä¼ æ„Ÿå™¨èåˆçš„å·¥ç¨‹å®è·µï¼Œå¸®åŠ©åœ¨é¢è¯•ä¸­è‡ªä¿¡å›ç­”çŠ¶æ€ä¼°è®¡ç›¸å…³é—®é¢˜ã€‚

## 0. ä¸»è¦æ•¸å­¸æ€æƒ³ (Main Mathematical Idea)

> **ç¬¬ä¸€æ€§åŸç†**: **Belief Update (ä¿¡å¿µæ›´æ–° / Bayesian Inference)**

æˆ‘ä»¬æ°¸è¿œæ— æ³•ç›´æ¥"çŸ¥é“"æœºå™¨äººçš„çœŸå®çŠ¶æ€ï¼ˆä¸Šå¸è§†è§’ï¼‰ï¼Œæˆ‘ä»¬åªèƒ½æ ¹æ®ä¼ æ„Ÿå™¨æ•°æ®å»"çŒœæµ‹"ï¼ˆæ¨æ–­ï¼‰ã€‚

- **æ ¸å¿ƒæ•°å­¦å·¥å…·**: **Bayesian Filtering (è´å¶æ–¯æ»¤æ³¢)** ä¸ **Recursive Least Squares (é€’å½’æœ€å°äºŒä¹˜)**ã€‚
- **è§£é¢˜é€»è¾‘**:
    1.  **ä¸ç¡®å®šæ€§**: å°†çŠ¶æ€è§†ä¸ºä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒ $P(x)$ è€Œéå•ç‚¹å€¼ã€‚
    2.  **èåˆ**: æ‰€æœ‰çš„çŠ¶æ€ä¼°è®¡éƒ½æ˜¯åœ¨åšä¸¤ä»¶äº‹çš„åŠ æƒå¹³å‡ï¼š
        -   **é¢„æµ‹ (Prediction)**: "æ ¹æ®ä¸Šä¸€æ­¥å’Œè¿åŠ¨æ¨¡å‹ï¼Œæˆ‘è§‰å¾—æˆ‘åœ¨å“ª" (å…ˆéªŒ)ã€‚
        -   **è§‚æµ‹ (Correction)**: "æ ¹æ®ä¼ æ„Ÿå™¨ç°åœ¨çš„è¯»æ•°ï¼Œæˆ‘è§‰å¾—æˆ‘åœ¨å“ª" (ä¼¼ç„¶)ã€‚
    3.  **å¡å°”æ›¼å¢ç›Š ($K$)**: è¿™æ˜¯ä¸€ä¸ªåŠ¨æ€æƒé‡ï¼Œå–å†³äºè°æ›´å¯ä¿¡ï¼ˆè°çš„æ–¹å·®å°ï¼‰ã€‚å¦‚æœä¼ æ„Ÿå™¨å¾ˆå‡† ($R$ å°)ï¼Œ$K$ å°±å¤§ï¼Œå¤šå¬ä¼ æ„Ÿå™¨çš„ï¼›å¦‚æœé¢„æµ‹å¾ˆå‡† ($Q$ å°)ï¼Œ$K$ å°±å°ï¼Œå¤šä¿¡æ¨¡å‹ã€‚

---

## ğŸ§­ çŠ¶æ€ä¼°è®¡ä»»åŠ¡åˆ†å±‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         çŠ¶æ€ä¼°è®¡å±‚æ¬¡                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   ä½å±‚ (IMU æƒ¯å¯¼)                     ä¸­å±‚ (ç»„åˆå¯¼èˆª)                    â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”‚
â”‚   â€¢ å§¿æ€/è§’é€Ÿåº¦ä¼°è®¡                   â€¢ VIO/VINS (IMU + Camera)          â”‚
â”‚   â€¢ é›¶åæ ¡æ­£                          â€¢ Wheel Odometry + IMU             â”‚
â”‚                                                                          â”‚
â”‚   é«˜å±‚ (å…¨å±€å®šä½)                     è¯­ä¹‰å±‚ (é«˜é˜¶)                      â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”‚
â”‚   â€¢ SLAM (EKF-SLAM, Graph-SLAM)       â€¢ å¯¹è±¡çº§è·Ÿè¸ª                       â”‚
â”‚   â€¢ GNSS-RTK + æƒ¯å¯¼ç»„åˆ               â€¢ è¯­ä¹‰çŠ¶æ€ä¼°è®¡                     â”‚
â”‚                                                                          â”‚
â”‚   æ ¸å¿ƒæ„ä»¶:                                                                â”‚
â”‚   - Motion Model (ç³»ç»Ÿæ¨¡å‹)                                               â”‚
â”‚   - Sensor Model (è§‚æµ‹æ¨¡å‹)                                               â”‚
â”‚   - Filter / Optimizer                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1. Kalman Filter å®¶æ—

### 1.1 çº¿æ€§ KF

ç³»ç»Ÿæ¨¡å‹ (ç¦»æ•£):
\[
x_k = A x_{k-1} + B u_k + w_k,\quad w_k \sim \mathcal{N}(0, Q)
\]
è§‚æµ‹æ¨¡å‹:
\[
z_k = H x_k + v_k,\quad v_k \sim \mathcal{N}(0, R)
\]

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Kalman Filter å¾ªç¯                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   é¢„æµ‹ (Predict)                                                         â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚   xÌ‚â»â‚– = A xÌ‚â‚–â‚‹â‚ + B uâ‚–                                                   â”‚
â”‚   Pâ»â‚– = A Pâ‚–â‚‹â‚ Aáµ€ + Q                                                    â”‚
â”‚                                                                          â”‚
â”‚   æ›´æ–° (Update)                                                          â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚   Kâ‚– = Pâ»â‚– Háµ€ (H Pâ»â‚– Háµ€ + R)â»Â¹                                           â”‚
â”‚   xÌ‚â‚– = xÌ‚â»â‚– + Kâ‚– (zâ‚– - H xÌ‚â»â‚–)                                           â”‚
â”‚   Pâ‚– = (I - Kâ‚– H) Pâ»â‚–                                                    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æ‰©å±• Kalman Filter (EKF)

- é€‚ç”¨äºéçº¿æ€§ç³»ç»Ÿï¼š\( x_k = f(x_{k-1}, u_k) + w_k \), \( z_k = h(x_k) + v_k \)
- ç”¨é›…å¯æ¯”çŸ©é˜µçº¿æ€§åŒ–ï¼š
  - \( F_k = \frac{\partial f}{\partial x} \big|_{x=\hat{x}_{k-1}} \)
  - \( H_k = \frac{\partial h}{\partial x} \big|_{x=\hat{x}_{k}^{-}} \)
- ç¼ºç‚¹ï¼šçº¿æ€§åŒ–è¯¯å·®å¤§æ—¶ä¼šå‘æ•£ï¼Œéœ€è¦ä¿æŒå°æ—¶é—´æ­¥æˆ–ä½¿ç”¨é‡çº¿æ€§åŒ–ã€‚

### 1.3 æ— è¿¹ Kalman Filter (UKF)

- ä¸å†çº¿æ€§åŒ–ï¼Œè€Œæ˜¯ç”¨ **Sigma Points** æ•è·å‡å€¼/åæ–¹å·®ä¼ æ’­ã€‚
- æ­¥éª¤ï¼š
  1. é€‰æ‹© \( 2n + 1 \) ä¸ª sigma ç‚¹ \( \chi_i \)
  2. é€šè¿‡éçº¿æ€§å‡½æ•°ä¼ æ’­ \( \chi_i' = f(\chi_i) \)
  3. åŠ æƒé‡æ„å‡å€¼ \(\hat{x}\) ä¸åæ–¹å·® \(P\)
- ä¼˜ç‚¹ï¼šå¯¹é«˜åº¦éçº¿æ€§çš„ç³»ç»Ÿæ›´ç¨³å¥ï¼Œä¸éœ€è¦æ±‚é›…å¯æ¯”ã€‚
- ç¼ºç‚¹ï¼šè®¡ç®—é‡ç¨é«˜ï¼Œå‚æ•° (Î±, Î², Îº) éœ€è°ƒèŠ‚ã€‚

### 1.4 é€‰æ‹©æŒ‡å—

| åœºæ™¯ | æ¨èæ»¤æ³¢å™¨ | å¤‡æ³¨ |
|:-----|:-----------|:-----|
| çº¿æ€§ç³»ç»Ÿ + é«˜é¢‘æ›´æ–° | KF | å¦‚ç”µæœºä½ç½®é—­ç¯ |
| è½»å¾®éçº¿æ€§ + é«˜é€Ÿè¿è¡Œ | EKF | èˆªå§¿ç³»ç»Ÿã€VIO |
| å¼ºéçº¿æ€§ + å™ªå£°å¤æ‚ | UKF | è§†è§‰è§’åº¦ + IMU |

---

## 2. ç²’å­æ»¤æ³¢ (Particle Filter)

### 2.1 åŸç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Particle Filter æµç¨‹                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚ 1. é‡‡æ ·: ä»ä¸Šä¸€æ—¶åˆ»ç²’å­é›†åˆæ ¹æ®è¿åŠ¨æ¨¡å‹é‡‡æ ·æ–°çš„ç²’å­                      â”‚
â”‚ 2. åŠ æƒ: æ ¹æ®è§‚æµ‹æ¨¡å‹è®¡ç®—ç²’å­æƒé‡ (ä¼¼ç„¶)                                 â”‚
â”‚ 3. å½’ä¸€åŒ–: æƒé‡å½’ä¸€åŒ–                                                     â”‚
â”‚ 4. é‡é‡‡æ ·: æ ¹æ®æƒé‡é‡æ–°é‡‡æ ·ï¼Œé¿å…é€€åŒ–                                    â”‚
â”‚ 5. çŠ¶æ€ä¼°è®¡: æ±‚åŠ æƒå¹³å‡æˆ–é€‰æœ€å¤§æƒé‡ç²’å­                                 â”‚
â”‚                                                                          â”‚
â”‚   å¸¸ç”¨æŠ€å·§:                                                               â”‚
â”‚   - ä½æ–¹å·®é‡é‡‡æ · (Low-variance resampling)                               â”‚
â”‚   - è‡ªé€‚åº”ç²’å­æ•° (KLD-Sampling)                                          â”‚
â”‚   - Log-Likelihood ç´¯ç§¯é¿å…ä¸‹æº¢                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 KF vs Particle Filter

| å¯¹æ¯”é¡¹ | Kalman ç³»åˆ— | Particle Filter |
|:-------|:------------|:----------------|
| çŠ¶æ€åˆ†å¸ƒå‡è®¾ | é«˜æ–¯ | ä»»æ„åˆ†å¸ƒ |
| ç»´åº¦æ‰©å±• | æ˜“å—ç»´åº¦è¯…å’’å½±å“è¾ƒå° | ç²’å­æ•°éšç»´åº¦æŒ‡æ•°å¢åŠ  |
| è®¡ç®—é‡ | ä½ (çŸ©é˜µè¿ç®—) | é«˜ (å¤§é‡ç²’å­) |
| æ”¶æ•›é€Ÿåº¦ | å¿« | æ…¢ (ä¾èµ–ç²’å­æƒé‡) |
| é€‚ç”¨åœºæ™¯ | æœºå™¨äººå§¿æ€ã€VIO | å…¨å±€å®šä½ã€éé«˜æ–¯å™ªå£° |

---

## 3. ä¼ æ„Ÿå™¨èåˆæ¨¡å¼

### 3.1 å¸¸è§ç»„åˆ

| ç»„åˆ | è¯´æ˜ | å…¸å‹ç³»ç»Ÿ |
|:-----|:-----|:---------|
| IMU + Encoder | æƒ¯æ€§æµ‹é‡ + è½®é€Ÿï¼Œè¡¥å¿æ»‘ç§» | åœ°é¢ç§»åŠ¨æœºå™¨äºº |
| IMU + Camera | Visual-Inertial Odometry (VIO) | VINS-Mono, OKVIS |
| IMU + LiDAR | LiDAR-Inertial Odometry | LIO-SAM |
| Wheel + GNSS + IMU | è½¦è¾†å®šä½ | è‡ªåŠ¨é©¾é©¶ |
| Vision + Tactile | æœ«ç«¯æ‰§è¡Œå™¨çŠ¶æ€ä¼°è®¡ | è§¦è§‰é—­ç¯æ§åˆ¶ |

### 3.2 èåˆæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å…¸å‹ VIO (EKF-based)                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   IMU é«˜é¢‘ç§¯åˆ† â†’ çŠ¶æ€é¢„æµ‹                                                 â”‚
â”‚          â”‚                                                               â”‚
â”‚          â–¼                                                               â”‚
â”‚   EKF é¢„æµ‹æ­¥éª¤ (Propagate)                                               â”‚
â”‚          â”‚                                                               â”‚
â”‚   ç›¸æœºå…³é”®å¸§æå– â†’ ç‰¹å¾åŒ¹é…                                              â”‚
â”‚          â”‚                                                               â”‚
â”‚          â–¼                                                               â”‚
â”‚   EKF æ›´æ–°æ­¥éª¤ (Update)                                                   â”‚
â”‚          â”‚                                                               â”‚
â”‚          â–¼                                                               â”‚
â”‚   è¾“å‡º: ä½å§¿ã€é€Ÿåº¦ã€åç½®                                                 â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 Graph-based èåˆ

- ä½¿ç”¨å› å­å›¾ (Factor Graph) æˆ– Bundle Adjustment è¡¨è¿°çŠ¶æ€ä¼°è®¡ã€‚
- èŠ‚ç‚¹: æœºå™¨äººçŠ¶æ€ (å§¿æ€ã€é€Ÿåº¦ã€åç½®)ã€‚
- å› å­: IMU é¢„ç§¯åˆ†ã€è§†è§‰é‡æŠ•å½±è¯¯å·®ã€é‡Œç¨‹è®¡çº¦æŸç­‰ã€‚
- ä¼˜ç‚¹ï¼šå¯ç¦»çº¿æ‰¹å¤„ç† / æ»‘åŠ¨çª—å£ï¼Œç²¾åº¦é«˜ï¼›ç¼ºç‚¹ï¼šå®æ—¶æ€§éœ€ä¼˜åŒ–ã€‚

---

## 4. ä»£ç å®ç°ç‰‡æ®µ

### 4.1 PyTorch EKF ç»“æ„

```python
import torch

class ExtendedKalmanFilter:
    def __init__(self, state_dim, meas_dim):
        self.state_dim = state_dim
        self.meas_dim = meas_dim
        self.x = torch.zeros(state_dim, 1)
        self.P = torch.eye(state_dim)
        self.Q = torch.eye(state_dim) * 1e-3
        self.R = torch.eye(meas_dim) * 1e-2

    def predict(self, f, F, u=torch.zeros(0)):
        # f: çŠ¶æ€è½¬ç§»å‡½æ•°, F: é›…å¯æ¯”
        self.x = f(self.x, u)
        self.P = F(self.x) @ self.P @ F(self.x).T + self.Q

    def update(self, z, h, H):
        y = z - h(self.x)
        S = H(self.x) @ self.P @ H(self.x).T + self.R
        K = self.P @ H(self.x).T @ torch.linalg.inv(S)
        self.x = self.x + K @ y
        self.P = (torch.eye(self.state_dim) - K @ H(self.x)) @ self.P
```

### 4.2 ç²’å­æ»¤æ³¢ Python åŸå‹

```python
import numpy as np

class ParticleFilter:
    def __init__(self, num_particles, motion_model, sensor_model):
        self.n = num_particles
        self.motion_model = motion_model
        self.sensor_model = sensor_model
        self.particles = np.zeros((num_particles, 3))  # x, y, theta
        self.weights = np.ones(num_particles) / num_particles

    def predict(self, u, dt):
        noise = np.random.normal(0, [0.01, 0.01, 0.005], size=self.particles.shape)
        self.particles = self.motion_model(self.particles, u, dt) + noise

    def update(self, z):
        self.weights *= self.sensor_model.likelihood(self.particles, z)
        self.weights += 1e-300  # é¿å…å…¨ 0
        self.weights /= np.sum(self.weights)

    def resample(self):
        cumulative = np.cumsum(self.weights)
        cumulative[-1] = 1.0
        indexes = np.searchsorted(cumulative, np.random.rand(self.n))
        self.particles = self.particles[indexes]
        self.weights.fill(1.0 / self.n)

    def estimate(self):
        return np.average(self.particles, weights=self.weights, axis=0)
```

---

## 5. å·¥ç¨‹å®è·µ

### 5.1 é¢„ç§¯åˆ† (IMU Pre-integration)

- Avoid integrating IMU between every pair of frames.
- åœ¨ VIO ä¸­é¢„è®¡ç®— IMU çº¦æŸï¼Œä½¿ä¼˜åŒ–åªè·ŸçŠ¶æ€å¢é‡ç›¸å…³ã€‚
- ä½¿ç”¨ `gtsam::PreintegratedImuMeasurements` ç­‰å·¥å…·ã€‚

### 5.2 é›¶åä¼°è®¡ (Bias Estimation)

- IMU é›¶åéšæ—¶é—´æ¼‚ç§»ï¼Œå¿…é¡»çº³å…¥çŠ¶æ€å‘é‡ï¼š
  \[
  x = \begin{bmatrix} p & v & q & b_a & b_g \end{bmatrix}
  \]
- å™ªå£°æ¨¡å‹ä¸­æ·»åŠ éšæœºæ¸¸èµ°ï¼š
  \[
  b_{k} = b_{k-1} + w_b
  \]

### 5.3 è§‚æµ‹å¼‚å¸¸æ£€æµ‹

- **Mahalanobis Distance**: åˆ¤æ–­æµ‹é‡æ˜¯å¦å¼‚å¸¸ï¼š
  \[
  \nu = z - h(\hat{x});\quad d^2 = \nu^\top S^{-1} \nu
  \]
  è‹¥ \( d^2 > \chi^2_{n,\alpha} \)ï¼Œåˆ™æ‹’ç»è¯¥è§‚æµ‹ã€‚
- **Innovation Gating**: åªåœ¨åˆ›æ–°ä½äºé˜ˆå€¼å†…æ—¶æ›´æ–°ã€‚

### 5.4 ROS2 / robot_localization

- `ekf_node`: èåˆ IMU + Wheel + GPSã€‚
- `ukf_node`: æ”¯æŒ UKFã€‚
- éœ€è¦æ­£ç¡®é…ç½® `imu0_config`, `odom0_config`, `two_d_mode` ç­‰å‚æ•°ã€‚

---

## 6. é¢è¯• Q&A

### Q1: EKF ä¸ºä»€ä¹ˆå¯èƒ½ä¼šå‘æ•£ï¼Ÿå¦‚ä½•ç¼“è§£ï¼Ÿ

- çº¿æ€§åŒ–è¯¯å·®å¤§ï¼šä½¿ç”¨å°æ—¶é—´æ­¥ã€é‡å¤çº¿æ€§åŒ–æˆ–æ”¹ç”¨ UKFã€‚
- å™ªå£°åæ–¹å·®è®¾å®šä¸åˆç†ï¼šå¢å¤§ Q/R ä½¿æ»¤æ³¢æ›´ä¿å®ˆã€‚
- åˆå§‹åæ–¹å·®è¿‡å°ï¼šå¯¼è‡´ä¿¡ä»»é¢„æµ‹è¿‡åº¦ï¼Œå»ºè®®æ”¾å¤§ \(P_0\)ã€‚

### Q2: Particle Filter å¦‚ä½•é€‰æ‹©ç²’å­æ•°ï¼Ÿ

- ç»éªŒï¼šæ¯ç»´ 50~100 ä¸ªç²’å­ã€‚
- å¯ç”¨ **è‡ªé€‚åº”ç²’å­æ•°**ï¼šå½“ ESS (effective sample size) é«˜äºé˜ˆå€¼æ—¶å‡å°‘ç²’å­ï¼Œä½äºæ—¶å¢åŠ ã€‚

### Q3: IMU + ç›¸æœºèåˆçš„å…³é”®éš¾ç‚¹ï¼Ÿ

1. æ—¶é—´åŒæ­¥ (æ—¶é—´æˆ³å¯¹é½ï¼ŒPTP/è§¦å‘)ã€‚
2. IMU åˆ°ç›¸æœºçš„å¤–å‚æ ‡å®š (æ‰‹çœ¼æ ‡å®š)ã€‚
3. IMU å™ªå£°æ¨¡å‹ (åŠ é€Ÿåº¦/é™€èºé›¶åã€éšæœºæ¸¸èµ°)ã€‚
4. æ»‘åŠ¨çª—å£ä¼˜åŒ–çš„å‡†å®æ—¶å®ç° (Ceres / GTSAM)ã€‚

### Q4: å¦‚ä½•æ£€æµ‹ä¼ æ„Ÿå™¨å¤±æ•ˆï¼Ÿ

- ç›‘æ§åˆ›æ–° (Innovation) å¤§å°ã€‚
- ç›‘æ§è¾“å‡ºæ–¹å·®æ˜¯å¦å¼‚å¸¸å¢å¤§ã€‚
- å¤šä¼ æ„Ÿå™¨äº’ç›¸éªŒè¯ (Cross-check)ï¼šä¾‹å¦‚è§†è§‰å¤±è´¥æ—¶é™çº§ä¸ºè½®é€Ÿ + IMUã€‚

---

## ğŸ“š æ¨èèµ„æº

- *Probabilistic Robotics* â€” Thrun et al.
- *State Estimation for Robotics* â€” Timothy D. Barfoot
- VINS-Mono: [github.com/HKUST-Aerial-Robotics/VINS-Mono](https://github.com/HKUST-Aerial-Robotics/VINS-Mono)
- robot_localization: [docs.ros.org/en/noetic/api/robot_localization](http://docs.ros.org/en/noetic/api/robot_localization/html/index.html)
- GTSAM: [gtsam.org](https://gtsam.org/)

---



\newpage

# ç¬¬äº”éƒ¨åˆ†ï¼šæŠ“å–ä¸è¿åŠ¨è§„åˆ’


\newpage

# ç¬¬21ç«  å…·èº«å¯¼èˆª (VLN) / DualVLN å¿«æ…¢ç³»ç»Ÿ


> æœ¬æ–‡æ˜¯æ‰‹å†Œä¸­ **VLNï¼ˆVision-and-Language Navigationï¼Œè§†è§‰è¯­è¨€å¯¼èˆªï¼‰** çš„é¦–ç¯‡ä¸“é¢˜ã€‚å†…å®¹åŸºäºå…¬å¼€ä»‹ç»ä¸è®ºæ–‡ä¿¡æ¯æ•´ç†ï¼Œé‡ç‚¹æŠ½è±¡å…¶ **å·¥ç¨‹å¯è½åœ°çš„å¿«æ…¢ç³»ç»ŸååŒèŒƒå¼**ï¼Œä¾¿äºé¢è¯•ä¸ç³»ç»Ÿè®¾è®¡å¤ç”¨ã€‚

---

## 1) VLN çš„é•¿æœŸçŸ›ç›¾ï¼šæ…¢æ€è€ƒ vs å¿«ååº”

VLN çš„æ ¸å¿ƒä»»åŠ¡æ˜¯ï¼šç»™å®š **ç¬¬ä¸€è§†è§’è§†è§‰** + **è‡ªç„¶è¯­è¨€æŒ‡ä»¤**ï¼Œè¾“å‡ºèƒ½åœ¨çœŸå®ç¯å¢ƒä¸­æŒç»­æ‰§è¡Œçš„ **å¯¼èˆªè¡Œä¸º**ã€‚

è¡Œä¸šé‡Œé•¿æœŸå­˜åœ¨çš„åŸºæœ¬çŸ›ç›¾æ˜¯ï¼š

- **å¼ºè¯­ä¹‰ç†è§£/æ³›åŒ–** é€šå¸¸ä¾èµ–å¤§æ¨¡å‹çš„â€œæ…¢æ€è€ƒâ€ï¼ˆæ¨ç†é‡ã€é¢‘ç‡ä½ï¼‰
- **å¹³æ»‘è¿ç»­/åŠ¨æ€é¿éšœ** åˆ™éœ€è¦â€œå¿«ååº”â€ï¼ˆæ§åˆ¶é¢‘ç‡é«˜ã€å»¶è¿Ÿä½ï¼‰

ä¼ ç»Ÿç«¯åˆ°ç«¯ç´§è€¦åˆæ–¹æ¡ˆï¼ˆå›¾åƒ+è¯­è¨€ â†’ æ¯ä¸€æ­¥ç¦»æ•£åŠ¨ä½œï¼‰åœ¨è½åœ°ä¸­å¸¸è§ä¸‰ç±»ç“¶é¢ˆï¼š

- **åŠ¨ä½œç¢ç‰‡åŒ–**ï¼šæ¯ä¸€æ­¥éƒ½è¦è°ƒç”¨å¤§æ¨¡å‹ï¼Œè½¨è¿¹ä¸è¿è´¯ï¼Œåƒâ€œèµ°ä¸€æ­¥æƒ³ä¸€æ­¥â€
- **å“åº”å»¶è¿Ÿé«˜**ï¼šå¤§æ¨¡å‹æ¨ç†æ…¢ï¼Œéš¾ä»¥æ”¯æ’‘é«˜é¢‘æ§åˆ¶
- **å±‚æ¬¡è€¦åˆ**ï¼šè¯­ä¹‰ç†è§£ã€å…¨å±€è§„åˆ’ã€å±€éƒ¨é¿éšœç»‘åœ¨ä¸€èµ·ï¼Œéš¾ä»¥å¤„ç†åŠ¨æ€å˜åŒ–

---

## 2) DualVLN çš„æ ¸å¿ƒï¼šå¼‚æ­¥åŒç³»ç»Ÿï¼ˆæ…¢è§„åˆ’ / å¿«æ‰§è¡Œï¼‰

DualVLN çš„å…³é”®æ€æƒ³æ˜¯ **è§£è€¦ + å¼‚æ­¥**ï¼šæŠŠâ€œé«˜å±‚è¯­ä¹‰ä¸ä¸­æœŸè·¯æ ‡â€äº¤ç»™æ…¢ç³»ç»Ÿï¼ŒæŠŠâ€œé«˜é¢‘è½¨è¿¹ä¸é¿éšœâ€äº¤ç»™å¿«ç³»ç»Ÿã€‚

```text
                 (â‰ˆ 2 Hz)                           (â‰ˆ 30 Hz)
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ System 2ï¼šæ…¢æ€è€ƒï¼ˆå¤§è„‘ï¼‰  â”‚        â”‚ System 1ï¼šå¿«è¡ŒåŠ¨ï¼ˆå°è„‘ï¼‰          â”‚
  â”‚  - ç†è§£æŒ‡ä»¤/çœ‹ç¯å¢ƒ         â”‚  --->  â”‚  - é«˜é¢‘è½¨è¿¹ç”Ÿæˆ/åŠ¨æ€é¿éšœ           â”‚
  â”‚  - é¢„æµ‹ä¸­æœŸåƒç´ è·¯æ ‡ (u,v)  â”‚        â”‚  - è¾“å‡ºè¿ç»­è½¨è¿¹ï¼ˆå¯†é›†è·¯å¾„ç‚¹ï¼‰       â”‚
  â”‚  - å¿…è¦æ—¶å†³å®šâ€œè½¬å¤´/ä½å¤´â€   â”‚        â”‚  - åˆ©ç”¨å®æ—¶å›¾åƒä¿®æ­£åƒç´ ç›®æ ‡è¯¯å·®     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### System 2ï¼ˆæ…¢ç³»ç»Ÿ / å¤§è„‘ï¼‰ï¼šåƒç´ çº§è·¯æ ‡ + è§†è§’è°ƒæ•´

- **æ¨¡å‹å½¢æ€**ï¼šåŸºäº VLMï¼ˆæ–‡ä¸­æåˆ°åŸºåº§ä¸º **Qwen-VL-2.5**ï¼‰çš„å…¨å±€/ä¸­æœŸè§„åˆ’å™¨  
- **è¿è¡Œé¢‘ç‡**ï¼šçº¦ **2 Hz**ï¼ˆæ¯ 0.5s æ›´æ–°ä¸€æ¬¡ï¼‰
- **è¾“å‡º**ï¼š
  - **åƒç´ çº§ç›®æ ‡ç‚¹**ï¼ˆ2D åƒç´ åæ ‡ `(u, v)`ï¼‰ï¼Œä½œä¸ºä¸­æœŸå¯¼èˆªè·¯æ ‡
  - **è§†è§’è°ƒæ•´åŠ¨ä½œ**ï¼ˆä¾‹å¦‚å·¦/å³è½¬ 15Â°ã€æŠ¬å¤´/ä½å¤´ 15Â°ï¼‰ï¼Œåœ¨â€œç›®æ ‡ä¸åœ¨è§†é‡/è§†é‡ä¸ä½³â€æ—¶ä¸»åŠ¨æ‰¾è§†é‡

è¿™ç­‰ä»·äºæŠŠâ€œ3D è·¯å¾„è§„åˆ’â€è½¬åŒ–ä¸ºâ€œåœ¨å½“å‰ç”»é¢ä¸ŠæŒ‡ä¸€ä¸ªä½ åº”è¯¥èµ°å‘çš„æœ€è¿œå¯è§ç‚¹â€ã€‚

### System 1ï¼ˆå¿«ç³»ç»Ÿ / å°è„‘ï¼‰ï¼šæ¡ä»¶æ‰©æ•£ç­–ç•¥ç”Ÿæˆè¿ç»­è½¨è¿¹

- **æ¨¡å‹å½¢æ€**ï¼šè½»é‡çº§ **Diffusion Transformer Policy**
- **è¿è¡Œé¢‘ç‡**ï¼šæœ€é«˜çº¦ **30 Hz**
- **è¾“å…¥**ï¼š
  - System 2 ç»™å‡ºçš„ **åƒç´ ç›®æ ‡** +ï¼ˆéšå«çš„ï¼‰**è¯­ä¹‰ç›®æ ‡ç‰¹å¾**
  - **å½“å‰é«˜é¢‘ RGB**ï¼ˆå®æ—¶ç”»é¢ï¼‰
- **è¾“å‡º**ï¼šå¯æ‰§è¡Œçš„ **å¹³æ»‘è¿ç»­è½¨è¿¹**ï¼ˆä¾‹å¦‚ 32 ä¸ªå¯†é›†è·¯å¾„ç‚¹ï¼‰

å®ƒçš„èŒè´£æ˜¯ï¼šåœ¨è¯­ä¹‰ç›®æ ‡â€œä½é¢‘æ›´æ–°â€æ—¶ï¼Œä»èƒ½æ ¹æ®å®æ—¶ç”»é¢â€œå¿«ä¿®æ­£ã€å¿«é¿éšœâ€ã€‚

---

## 3) å…³é”®è®­ç»ƒæ„é€ ï¼šæŠŠ 3D å¯¼èˆªå˜æˆ â€œæœ€è¿œåƒç´ ç›®æ ‡ Groundingâ€

DualVLN çš„ä¸€ä¸ªæ ¸å¿ƒå·¥ç¨‹ç‚¹æ˜¯ï¼š**ä¸é äººå·¥é€å¸§æ ‡æ³¨è·¯æ ‡**ï¼Œè€Œæ˜¯ç”¨ä»¿çœŸæ•°æ®è‡ªåŠ¨ç”Ÿæˆè®­ç»ƒç›‘ç£ã€‚

å…¸å‹åšæ³•ï¼ˆè®ºæ–‡æè¿°æ€è·¯ï¼‰ï¼š

- å·²çŸ¥ä»¿çœŸä¸­æœºå™¨äººçš„ **3D æœªæ¥è½¨è¿¹**
- å°†æœªæ¥ä¸€æ®µè½¨è¿¹ä¸Šçš„ç‚¹ **æŠ•å½±** åˆ°å½“å‰ç¬¬ä¸€è§†è§’å›¾åƒå¹³é¢
- ç”¨æ·±åº¦/é®æŒ¡ä¿¡æ¯è¿‡æ»¤ï¼šåªä¿ç•™ **å½“å‰è§†è§’çœŸå®å¯è§** çš„ç‚¹
- ä»å¯è§ç‚¹é‡Œé€‰ **æœ€è¿œ** çš„ä¸€ä¸ªä½œä¸ºå½“å‰æ—¶åˆ»çš„â€œåƒç´ è·¯æ ‡â€

è¿™ä½¿å¾— System 2 çš„å­¦ä¹ ç›®æ ‡å˜æˆï¼š  
**ç»™ä½ å›¾åƒåºåˆ—+æŒ‡ä»¤ï¼Œåœ¨å›¾é‡ŒæŒ‡å‡ºä¸‹ä¸€æ­¥åº”è¯¥èµ°å‘å“ªä¸ªåƒç´ ä½ç½®**ï¼ˆå¿…è¦æ—¶å…ˆåšè§†è§’æœç´¢ï¼‰ã€‚

---

## 4) è·¨å±‚å¯¹é½ï¼šæŠŠâ€œæ…¢ç³»ç»Ÿè¯­ä¹‰â€ä¼ ç»™â€œå¿«ç³»ç»Ÿæ§åˆ¶â€

å¿«æ…¢ç³»ç»Ÿè¦ååŒï¼Œå…³é”®åœ¨äºï¼šSystem 1 ä¸èƒ½åªæ‹¿ä¸€ä¸ª \((u,v)\)â€”â€”å®ƒè¿˜éœ€è¦â€œä¸ºä»€ä¹ˆå»é‚£å„¿â€çš„è¯­ä¹‰ã€‚

æ–‡ä¸­æåˆ°ä¸€ç§æŠ½å–æ–¹å¼ï¼š

- åœ¨ System 2 äº§ç”Ÿåƒç´ ç›®æ ‡çš„åŒæ—¶ï¼Œå…¶éšè—çŠ¶æ€åŒ…å«ä»»åŠ¡è¯­ä¹‰
- ç”¨å°‘é‡ **å¯å­¦ä¹ çš„æŸ¥è¯¢å‘é‡ï¼ˆå¦‚ 4 ä¸ª latent queriesï¼‰** ä»éšè—çŠ¶æ€é‡ŒæŠ½å–â€œä¸å½“å‰ä»»åŠ¡æœ€ç›¸å…³â€çš„è¯­ä¹‰ç‰¹å¾
- å°†è¯¥ç‰¹å¾ä½œä¸º **ä½é¢‘è¯­ä¹‰æ¡ä»¶** ä¼ ç»™ System 1

åŒæ—¶ï¼ŒSystem 1 ä»¥é«˜é¢‘å®æ—¶å›¾åƒä½œä¸º **é«˜é¢‘è§†è§‰æ¡ä»¶**ï¼Œå¹¶å¯èåˆâ€œSystem 2 è¾“å‡ºç›®æ ‡æ—¶çš„æ—§å›¾åƒç‰¹å¾â€ä¸â€œå½“å‰æ–°å›¾åƒç‰¹å¾â€ï¼Œç¼“è§£è¯­ä¹‰æ¡ä»¶çš„â€œè¿‡æ—¶â€é—®é¢˜ã€‚

---

## 5) è¯„æµ‹ä¸åŸºå‡†ï¼šä»é™æ€åˆ°åŠ¨æ€ç¤¾äº¤ç¯å¢ƒ

æ–‡ä¸­æåˆ° DualVLN åœ¨ VLN-CEã€VLN-PE ç­‰åŸºå‡†ä¸Šå–å¾—é¢†å…ˆï¼Œå¹¶æå‡ºæ›´è´´è¿‘çœŸå®åŠ¨æ€åœºæ™¯çš„ **Social-VLN**ï¼š

- åœ¨ç¯å¢ƒä¸­åŠ å…¥åŠ¨æ€è¡Œèµ°çš„äººå½¢æœºå™¨äºº
- åœ¨ä¼ ç»ŸæŒ‡æ ‡ä¹‹å¤–ï¼Œå¼•å…¥ **Human Collision Rate** è¡¡é‡ä¸è¡Œäººçš„ä¸å®‰å…¨äº¤äº’

è¿™ç±»æŒ‡æ ‡å¯¹â€œå¿«ç³»ç»Ÿâ€çš„å±€éƒ¨é¿éšœèƒ½åŠ›æ›´æ•æ„Ÿï¼Œä¹Ÿæ›´èƒ½ä½“ç°åŒç³»ç»Ÿå¼‚æ­¥æ§åˆ¶çš„ä»·å€¼ã€‚

---

## 6) çœŸæœºéƒ¨ç½²è§†è§’ï¼šä¸ºä»€ä¹ˆâ€œå¼‚æ­¥è§£è€¦â€æ›´åƒå·¥ç¨‹æ­£ç¡®ç­”æ¡ˆ

ä»å·¥ç¨‹è½åœ°ï¼ˆå°¤å…¶æ˜¯ç§»åŠ¨å¹³å°ï¼‰è§’åº¦ï¼ŒåŒç³»ç»Ÿå¸¦æ¥å‡ ä¸ªç›´æ¥æ”¶ç›Šï¼š

- **å»¶è¿Ÿé¢„ç®—å¯æ§**ï¼šæ…¢ç³»ç»Ÿå¶å°”æ…¢ä¸€ç‚¹ä¸è‡´å‘½ï¼Œå¿«ç³»ç»Ÿç»§ç»­ä»¥ 20~30Hz è¾“å‡ºè½¨è¿¹
- **åŠ¨ä½œè¿ç»­æ€§æ›´å¥½**ï¼šè½¨è¿¹ç”±å¿«ç³»ç»Ÿè¿ç»­ç”Ÿæˆï¼Œä¸å†â€œç¦»æ•£è·³æ­¥â€
- **å®‰å…¨æ€§æ›´å¯æ§**ï¼šå¿«ç³»ç»Ÿå¯ä»¥åšå±€éƒ¨é¿éšœ/é€Ÿåº¦é™åˆ¶/ç´§æ€¥åˆ¶åŠ¨ï¼Œé¿å…æŠŠå®‰å…¨é€»è¾‘å¡è¿›å¤§æ¨¡å‹

æ–‡ä¸­æè¿°çš„çœŸæœºå¹³å°åŒ…æ‹¬è½®å¼ï¼ˆTurtlebot4ï¼‰ã€å››è¶³ï¼ˆUnitree Go2ï¼‰ã€äººå½¢ï¼ˆUnitree G1ï¼‰ï¼Œä¼ æ„Ÿå™¨ä¸º Intel RealSense D455ï¼ˆRGBï¼‰ã€‚

> é¢è¯•/å·¥ç¨‹å»ºè®®ï¼šä½ å¯ä»¥æŠŠ DualVLN æŠ½è±¡æˆâ€œä½é¢‘è¯­ä¹‰è·¯æ ‡ï¼ˆ2Hzï¼‰ + é«˜é¢‘å±€éƒ¨æ§åˆ¶ï¼ˆ30Hzï¼‰â€çš„é€šç”¨æ¨¡æ¿ï¼Œè¿ç§»åˆ°æ“ä½œï¼ˆmanipulationï¼‰åŒæ ·æˆç«‹ï¼šä½é¢‘äº§å‡ºå­ç›®æ ‡/æ¥è§¦æ„å›¾ï¼Œé«˜é¢‘äº§å‡ºæ§åˆ¶é‡å¹¶åšå®‰å…¨çº¦æŸã€‚

---

## 7) é¢è¯•é«˜é¢‘é—®æ³•ï¼ˆå»ºè®®èƒŒè¯µçš„å›ç­”éª¨æ¶ï¼‰

- **ä¸ºä»€ä¹ˆç«¯åˆ°ç«¯ç´§è€¦åˆåœ¨çœŸæœºä¸Šå®¹æ˜“å¤±è´¥ï¼Ÿ**  
  å› ä¸ºå®ƒæŠŠè¯­ä¹‰ç†è§£ã€è§„åˆ’ã€æ§åˆ¶ç»‘åœ¨åŒä¸€ä¸ªä½é¢‘/é«˜å»¶è¿Ÿé“¾è·¯é‡Œï¼Œå¯¼è‡´åŠ¨ä½œç¢ç‰‡åŒ–ã€å»¶è¿Ÿé«˜ã€éš¾ä»¥å¤„ç†åŠ¨æ€å˜åŒ–ã€‚

- **DualVLN çš„æœ¬è´¨è´¡çŒ®æ˜¯ä»€ä¹ˆï¼Ÿ**  
  ç”¨å¼‚æ­¥åŒç³»ç»Ÿè§£è€¦â€œæ…¢è¯­ä¹‰/ä¸­æœŸè·¯æ ‡â€å’Œâ€œå¿«è½¨è¿¹/é¿éšœâ€ï¼Œåœ¨ç³»ç»Ÿå±‚é¢è§£å†³å»¶è¿Ÿä¸è¿ç»­æ€§çš„çŸ›ç›¾ã€‚

- **ä¸ºä»€ä¹ˆç”¨ 2D åƒç´ è·¯æ ‡è€Œä¸æ˜¯ç›´æ¥ 3D è·¯å¾„ï¼Ÿ**  
  åƒç´ è·¯æ ‡æ›´è´´åˆ VLM çš„å¼ºé¡¹ï¼ˆgroundingï¼‰ï¼Œä¸”å¯ä»¥ä»ä»¿çœŸè½¨è¿¹è‡ªåŠ¨ç”Ÿæˆç›‘ç£ï¼Œé™ä½æ ‡æ³¨æˆæœ¬ã€‚

- **å¿«ç³»ç»Ÿä¸ºä»€ä¹ˆé€‰æ‰©æ•£ç­–ç•¥ï¼Ÿ**  
  è½¨è¿¹/åŠ¨ä½œå¤©ç„¶å¤šæ¨¡æ€ï¼Œæ‰©æ•£ç±»ç”Ÿæˆæ›´æ“…é•¿è¾“å‡ºå¹³æ»‘ã€åˆ†å¸ƒè¦†ç›–æ›´å¥½çš„è¿ç»­è½¨è¿¹ï¼Œå¹¶èƒ½ç”¨å®æ—¶è§†è§‰æ¡ä»¶è¿›è¡Œä¿®æ­£ã€‚

---

## å‚è€ƒé“¾æ¥

- **è®ºæ–‡**ï¼š[*GROUND SLOW, MOVE FAST: A DUAL-SYSTEM FOUNDATION MODEL FOR GENERALIZABLE VISION-AND-LANGUAGE NAVIGATION*](https://arxiv.org/abs/2512.08186)ï¼ˆå¯åœ¨é¡µé¢å†…ä¸‹è½½ PDFï¼‰
- **é¡¹ç›®ä¸»é¡µ**ï¼š[internvla-n1-dualvln](https://internrobotics.github.io/internvla-n1-dualvln.github.io/)
- **ä»£ç **ï¼š[InternRobotics/InternNav](https://github.com/InternRobotics/InternNav)

---

## å…³è”é˜…è¯»ï¼ˆæœ¬æ‰‹å†Œå†…ï¼‰

- [Diffusion Policy](./diffusion_policy.md)ï¼ˆä¸ºä»€ä¹ˆæ‰©æ•£é€‚åˆå¤šæ¨¡æ€è½¨è¿¹/åŠ¨ä½œï¼‰
- [åŠ¨ä½œè¡¨ç¤ºæ–¹æ³•](./action_representations.md)ï¼ˆåŠ¨ä½œç©ºé—´ä¸è½¨è¿¹ç”ŸæˆèŒƒå¼ï¼‰
- [VLA æ¶æ„æ€»è§ˆ](./vla_arch.md)ï¼ˆå¦‚ä½•æŠŠ VLM ä¸æ§åˆ¶å¤´è§£è€¦ï¼‰



\newpage

# ç¬¬22ç«  æŠ“å–ç®—æ³•


> **é¢è¯•åœºæ™¯**: "ä»‹ç»ä¸€ä¸‹ä½ ç”¨è¿‡çš„æŠ“å–ç®—æ³•åº“ï¼ŒDexGraspNet å’Œ Contact-GraspNet æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"

æœ¬æ–‡æ¶µç›–ä¸»æµæŠ“å–ç®—æ³•åº“ï¼ˆDexGraspNetã€GraspGFã€Contact-GraspNet ç­‰ï¼‰ä»¥åŠ Isaac Sim/Gymã€SAPIEN ä»¿çœŸå¹³å°çš„æ·±åº¦ä½¿ç”¨æŒ‡å—ã€‚

---

## ğŸ“Š æŠ“å–ç®—æ³•å…¨æ™¯å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æŠ“å–ç®—æ³•åˆ†ç±»                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   è¾“å…¥æ¨¡æ€              ç®—æ³•ç±»å‹              ä»£è¡¨æ–¹æ³•                       â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                                                             â”‚
â”‚   RGB-D / ç‚¹äº‘          åˆ†æå¼ (Analytic)     GraspIt!, OpenRAVE            â”‚
â”‚      â”‚                                                                      â”‚
â”‚      â”‚                  é‡‡æ ·+è¯„åˆ†             GPD, PointNetGPD              â”‚
â”‚      â”‚                  (Sample & Score)     Contact-GraspNet              â”‚
â”‚      â”‚                                       AnyGrasp                       â”‚
â”‚      â”‚                                                                      â”‚
â”‚      â”‚                  ç”Ÿæˆå¼               GraspGF (Flow)                 â”‚
â”‚      â”‚                  (Generative)         SE(3)-DiffusionFields         â”‚
â”‚      â”‚                                                                      â”‚
â”‚      â”‚                  çµå·§æ‰‹ä¸“ç”¨           DexGraspNet                    â”‚
â”‚      â”‚                                       UniDexGrasp                    â”‚
â”‚      â”‚                                       DexDiffuser                    â”‚
â”‚      â”‚                                                                      â”‚
â”‚      â””â”€â”€â–º ç«¯åˆ°ç«¯ VLA    æ„ŸçŸ¥â†’åŠ¨ä½œ            RT-1/2, OpenVLA, Ï€0            â”‚
â”‚                                                                             â”‚
â”‚   ğŸ’¡ è¶‹åŠ¿: ä»é‡‡æ ·è¯„åˆ† â†’ ç”Ÿæˆå¼ â†’ ç«¯åˆ°ç«¯ VLA                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1. å¹³è¡Œå¤¹çˆªæŠ“å–ç®—æ³• (Parallel-Jaw Grasp)

### 1.1 ç®—æ³•å¯¹æ¯”

| ç®—æ³• | è¾“å…¥ | æ–¹æ³• | ç‰¹ç‚¹ | ä»£ç  |
|:-----|:-----|:-----|:-----|:-----|
| **Dex-Net** | æ·±åº¦å›¾ | GQ-CNN è¯„åˆ† | å¤§è§„æ¨¡åˆæˆæ•°æ® | github/BerkeleyAutomation |
| **GPD** | ç‚¹äº‘ | é‡‡æ · + CNN è¯„åˆ† | ç»å…¸åŸºçº¿ | github/atenpas/gpd |
| **PointNetGPD** | ç‚¹äº‘ | PointNet ç‰¹å¾ + è¯„åˆ† | ç«¯åˆ°ç«¯ | github/lianghongzhuo |
| **Contact-GraspNet** | ç‚¹äº‘ | 6-DoF ç›´æ¥å›å½’ | å¿«é€Ÿã€å•æ¬¡å‰å‘ | github/NVlabs |
| **AnyGrasp** | ç‚¹äº‘ | å¤§è§„æ¨¡é¢„è®­ç»ƒ | æ³›åŒ–å¼º | github/graspnet |
| **GraspGF** | ç‚¹äº‘ | Score-based ç”Ÿæˆ | å¤šæ ·æ€§å¥½ | github/graspgf |
| **VGN** | TSDF | 3D CNN | ä½“ç´ è¡¨ç¤º | github/ethz-asl |

### 1.2 Dex-Net ç³»åˆ—

> **Dex-Net** (Dexterity Network) æ˜¯ UC Berkeley AUTOLAB å¼€å‘çš„æ•°æ®é©±åŠ¨æŠ“å–ç³»ç»Ÿï¼Œé€šè¿‡å¤§è§„æ¨¡åˆæˆæ•°æ®è®­ç»ƒæŠ“å–è´¨é‡é¢„æµ‹ç½‘ç»œã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Dex-Net ç³»ç»Ÿæ¶æ„                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   æ•°æ®ç”Ÿæˆ (Offline):                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   3D ç‰©ä½“æ¨¡å‹ (ShapeNet, YCB, è‡ªå®šä¹‰)                               â”‚   â”‚
â”‚   â”‚        â”‚                                                            â”‚   â”‚
â”‚   â”‚        â–¼                                                            â”‚   â”‚
â”‚   â”‚   æŠ“å–é‡‡æ · (Antipodal Sampling)                                     â”‚   â”‚
â”‚   â”‚        â”‚                                                            â”‚   â”‚
â”‚   â”‚        â–¼                                                            â”‚   â”‚
â”‚   â”‚   åŠ›é—­åˆåˆ†æ (Ferrari-Canny Metric)                                 â”‚   â”‚
â”‚   â”‚        â”‚                                                            â”‚   â”‚
â”‚   â”‚        â–¼                                                            â”‚   â”‚
â”‚   â”‚   æ¸²æŸ“æ·±åº¦å›¾ + æ ‡æ³¨æŠ“å–è´¨é‡                                         â”‚   â”‚
â”‚   â”‚        â”‚                                                            â”‚   â”‚
â”‚   â”‚        â–¼                                                            â”‚   â”‚
â”‚   â”‚   Dex-Net æ•°æ®é›† (æ•°ç™¾ä¸‡æ ·æœ¬)                                       â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   æ¨ç† (Online):                                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   æ·±åº¦å›¾ â”€â”€â–º æŠ“å–é‡‡æ · â”€â”€â–º GQ-CNN â”€â”€â–º æŠ“å–è´¨é‡è¯„åˆ† â”€â”€â–º æœ€ä½³æŠ“å–      â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   GQ-CNN (Grasp Quality CNN):                                       â”‚   â”‚
â”‚   â”‚   â€¢ è¾“å…¥: æ·±åº¦å›¾è£å‰ª (32x32) + æŠ“å–å‚æ•° (è§’åº¦, æ·±åº¦)               â”‚   â”‚
â”‚   â”‚   â€¢ è¾“å‡º: æŠ“å–æˆåŠŸæ¦‚ç‡ P(success | grasp, depth)                   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Dex-Net ç³»åˆ—ç‰ˆæœ¬**:

| ç‰ˆæœ¬ | å‘å¸ƒ | ç‰¹ç‚¹ | æ•°æ®è§„æ¨¡ |
|:-----|:-----|:-----|:-----|
| **Dex-Net 1.0** | 2017 | é¦–ä¸ªå¤§è§„æ¨¡åˆæˆæ•°æ®é›† | 10K ç‰©ä½“, 2.5M æŠ“å– |
| **Dex-Net 2.0** | 2017 | GQ-CNN, å¹³è¡Œå¤¹çˆª | 6.7M ç‚¹äº‘-æŠ“å–å¯¹ |
| **Dex-Net 3.0** | 2018 | å¸ç›˜æŠ“å– | 2.8M å¸ç›˜æŠ“å– |
| **Dex-Net 4.0** | 2019 | å¤šæ¨¡æ€ (å¤¹çˆª+å¸ç›˜) | æ··åˆç­–ç•¥ |

**GQ-CNN æ¶æ„**:

```python
## GQ-CNN ç½‘ç»œç»“æ„ (ç®€åŒ–)
import torch
import torch.nn as nn

class GQCNN(nn.Module):
    """Grasp Quality CNN"""
    def __init__(self):
        super().__init__()
        # å›¾åƒåˆ†æ”¯ (æ·±åº¦å›¾)
        self.conv1 = nn.Conv2d(1, 64, 7, stride=2)
        self.conv2 = nn.Conv2d(64, 64, 5, stride=2)
        self.conv3 = nn.Conv2d(64, 64, 3, stride=2)
        
        # æŠ“å–å‚æ•°åˆ†æ”¯
        self.grasp_fc = nn.Linear(1, 16)  # æŠ“å–æ·±åº¦
        
        # èåˆå±‚
        self.fc1 = nn.Linear(64 * 2 * 2 + 16, 1024)
        self.fc2 = nn.Linear(1024, 1024)
        self.fc3 = nn.Linear(1024, 2)  # æˆåŠŸ/å¤±è´¥
        
    def forward(self, depth_crop, grasp_depth):
        """
        Args:
            depth_crop: (B, 1, 32, 32) æ·±åº¦å›¾è£å‰ª
            grasp_depth: (B, 1) æŠ“å–æ·±åº¦
        """
        # å›¾åƒç‰¹å¾
        x = F.relu(self.conv1(depth_crop))
        x = F.relu(self.conv2(x))
        x = F.relu(self.conv3(x))
        x = x.view(x.size(0), -1)
        
        # æŠ“å–å‚æ•°ç‰¹å¾
        g = F.relu(self.grasp_fc(grasp_depth))
        
        # èåˆ
        x = torch.cat([x, g], dim=1)
        x = F.relu(self.fc1(x))
        x = F.relu(self.fc2(x))
        x = self.fc3(x)
        
        return F.softmax(x, dim=1)

## æ¨ç†
def predict_grasp_quality(model, depth_image, grasp_candidates):
    """è¯„ä¼°å€™é€‰æŠ“å–çš„è´¨é‡"""
    scores = []
    for grasp in grasp_candidates:
        # è£å‰ªæ·±åº¦å›¾ (ä»¥æŠ“å–ç‚¹ä¸ºä¸­å¿ƒ, æ—‹è½¬å¯¹é½)
        crop = crop_and_rotate(depth_image, grasp.center, grasp.angle, size=32)
        crop = torch.from_numpy(crop).unsqueeze(0).unsqueeze(0).float()
        depth = torch.tensor([[grasp.depth]]).float()
        
        with torch.no_grad():
            prob = model(crop, depth)
            scores.append(prob[0, 1].item())  # P(success)
    
    return scores
```

**Dex-Net å®Œæ•´ä½¿ç”¨æµç¨‹**:

```python
## Dex-Net æŠ“å–è§„åˆ’
from autolab_core import RigidTransform, DepthImage
from gqcnn import GQCNN, GraspPlanner

## 1. åŠ è½½æ¨¡å‹
model = GQCNN.load('models/gqcnn_pj.model')
planner = GraspPlanner(model)

## 2. è·å–æ·±åº¦å›¾
depth_image = DepthImage.from_sensor(camera)

## 3. æŠ“å–è§„åˆ’
grasps = planner.plan(
    depth_image,
    camera_intrinsics,
    num_samples=1000,      # é‡‡æ ·æ•°é‡
    num_candidates=100,     # å€™é€‰æ•°é‡
    top_k=5,               # è¿”å› top-k
)

## 4. é€‰æ‹©æœ€ä½³æŠ“å–
best_grasp = grasps[0]
print(f"æŠ“å–ä½ç½®: {best_grasp.pose.position}")
print(f"æŠ“å–è§’åº¦: {best_grasp.angle}")
print(f"æˆåŠŸæ¦‚ç‡: {best_grasp.quality:.3f}")

## 5. è½¬æ¢åˆ°æœºå™¨äººåæ ‡ç³»
grasp_in_robot = camera_to_robot_transform * best_grasp.pose
```

**Dex-Net vs å…¶ä»–æ–¹æ³•å¯¹æ¯”**:

| ç»´åº¦ | Dex-Net | Contact-GraspNet | GraspGF |
|:-----|:-----|:-----|:-----|
| **è¾“å…¥** | æ·±åº¦å›¾ (å•è§†è§’) | ç‚¹äº‘ | ç‚¹äº‘ |
| **æ–¹æ³•** | é‡‡æ · + GQ-CNN è¯„åˆ† | ç›´æ¥å›å½’ | ç”Ÿæˆå¼ |
| **é€Ÿåº¦** | ~100ms | ~50ms | ~1s |
| **æ³›åŒ–** | ä¸­ç­‰ (éœ€ Domain Randomization) | å¼º | å¼º |
| **å¤šæ ·æ€§** | å–å†³äºé‡‡æ · | å›ºå®šè¾“å‡ºæ•° | å¯æ§ |
| **å¼€æº** | âœ… å®Œæ•´ | âœ… | âœ… |

### 1.3 Contact-GraspNet æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Contact-GraspNet                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   è¾“å…¥: åœºæ™¯ç‚¹äº‘ P âˆˆ R^(NÃ—3)                                                â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                     PointNet++ Backbone                              â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   ç‚¹äº‘ â†’ Set Abstraction â†’ Feature Propagation â†’ é€ç‚¹ç‰¹å¾ F         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                     Multi-Head Prediction                            â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   æ¯ä¸ªç‚¹é¢„æµ‹:                                                        â”‚   â”‚
â”‚   â”‚   â€¢ æ˜¯å¦ä¸ºæ¥è§¦ç‚¹ (contact score)                                    â”‚   â”‚
â”‚   â”‚   â€¢ æŠ“å–æ–¹å‘ (approach direction)                                   â”‚   â”‚
â”‚   â”‚   â€¢ æŠ“å–å®½åº¦ (gripper width)                                        â”‚   â”‚
â”‚   â”‚   â€¢ æŠ“å–è§’åº¦ (baseline rotation)                                    â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                     Grasp Sampling & NMS                             â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   é€‰æ‹©é«˜åˆ†æ¥è§¦ç‚¹ â†’ ç»„åˆæˆ 6-DoF æŠ“å– â†’ NMS å»é‡                      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   è¾“å‡º: å¤šä¸ªå€™é€‰æŠ“å– {(R, t, w)} âˆˆ SE(3) Ã— R                               â”‚
â”‚                                                                             â”‚
â”‚   ä¼˜åŠ¿: å•æ¬¡å‰å‘æ¨ç† (~50ms), æ— éœ€è¿­ä»£é‡‡æ ·                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.4 GraspGF (Grasp Generative Flow)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     GraspGF: Score-Based ç”ŸæˆæŠ“å–                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   æ ¸å¿ƒæ€æƒ³: å­¦ä¹ æŠ“å–åˆ†å¸ƒçš„ score function âˆ‡_x log p(x|scene)                â”‚
â”‚                                                                             â”‚
â”‚   è®­ç»ƒ:                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   æ­£æ ·æœ¬æŠ“å– x_0 â†’ åŠ å™ª x_t â†’ ç½‘ç»œé¢„æµ‹ score â†’ Denoising Score Match â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   æ¨ç†:                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   éšæœºåˆå§‹åŒ– x_T â”€â”€â–º Langevin Dynamics â”€â”€â–º é«˜è´¨é‡æŠ“å– x_0            â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   x_{t-1} = x_t + Îµ * âˆ‡_x log p(x_t|scene) + âˆš(2Îµ) * z             â”‚   â”‚
â”‚   â”‚                     â†‘                                               â”‚   â”‚
â”‚   â”‚              ç½‘ç»œé¢„æµ‹çš„ score                                        â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   ä¼˜åŠ¿:                                                                     â”‚
â”‚   â€¢ å¤šæ ·æ€§: å¯ç”Ÿæˆå¤šä¸ªä¸åŒçš„æŠ“å–                                           â”‚
â”‚   â€¢ å¤„ç†å¤šæ¨¡æ€: åŒä¸€ç‰©ä½“æœ‰å¤šä¸ªåˆç†æŠ“å–æ–¹å¼                                 â”‚
â”‚   â€¢ å¯ç»„åˆ: å¯åŠ å…¥é¢å¤–çº¦æŸ (å¦‚é¿éšœã€ä»»åŠ¡çº¦æŸ)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. çµå·§æ‰‹æŠ“å–ç®—æ³• (Dexterous Grasp)

### 2.1 ç®—æ³•å¯¹æ¯”

| ç®—æ³• | æ‰‹å‹ | æ–¹æ³• | ç‰¹ç‚¹ |
|:-----|:-----|:-----|:-----|
| **DexGraspNet** | Shadow Hand | å¤§è§„æ¨¡æ•°æ®é›† + ä¼˜åŒ– | 1.32M æŠ“å–æ ‡æ³¨ |
| **UniDexGrasp** | å¤šç§æ‰‹å‹ | ç»Ÿä¸€è¡¨ç¤º + RL | è·¨æ‰‹å‹æ³›åŒ– |
| **DexDiffuser** | Shadow Hand | Diffusion ç”Ÿæˆ | å¤šæ ·æ€§å¥½ |
| **DexGraspNet 2.0** | å¤šç§æ‰‹å‹ | æ”¹è¿›æ•°æ®ç”Ÿæˆ | æ›´å¤šç‰©ä½“ |
| **GenDexGrasp** | é€šç”¨ | ç”Ÿæˆå¼ | é›¶æ ·æœ¬æ³›åŒ– |

### 2.2 DexGraspNet æ•°æ®é›†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     DexGraspNet æ•°æ®é›†                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   è§„æ¨¡:                                                                     â”‚
â”‚   â€¢ 5,355 ä¸ªç‰©ä½“ (æ¥è‡ª ShapeNet, YCB, EGAD ç­‰)                             â”‚
â”‚   â€¢ 1.32M ä¸ªæŠ“å–å§¿æ€æ ‡æ³¨                                                   â”‚
â”‚   â€¢ Shadow Hand çµå·§æ‰‹                                                     â”‚
â”‚                                                                             â”‚
â”‚   æ•°æ®ç”Ÿæˆæµç¨‹:                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   ç‰©ä½“ç½‘æ ¼                                                          â”‚   â”‚
â”‚   â”‚      â”‚                                                              â”‚   â”‚
â”‚   â”‚      â–¼                                                              â”‚   â”‚
â”‚   â”‚   åˆå§‹åŒ–æ‰‹å§¿æ€ (å¤šç§åˆå§‹åŒ–ç­–ç•¥)                                      â”‚   â”‚
â”‚   â”‚      â”‚                                                              â”‚   â”‚
â”‚   â”‚      â–¼                                                              â”‚   â”‚
â”‚   â”‚   ä¼˜åŒ–ç›®æ ‡:                                                          â”‚   â”‚
â”‚   â”‚   â€¢ æ¥è§¦ç‚¹è·ç¦»æœ€å°åŒ–                                                â”‚   â”‚
â”‚   â”‚   â€¢ ç©¿é€æƒ©ç½š                                                        â”‚   â”‚
â”‚   â”‚   â€¢ åŠ›é—­åˆçº¦æŸ (Force Closure)                                      â”‚   â”‚
â”‚   â”‚      â”‚                                                              â”‚   â”‚
â”‚   â”‚      â–¼                                                              â”‚   â”‚
â”‚   â”‚   Isaac Gym ä»¿çœŸéªŒè¯                                                â”‚   â”‚
â”‚   â”‚      â”‚                                                              â”‚   â”‚
â”‚   â”‚      â–¼                                                              â”‚   â”‚
â”‚   â”‚   æˆåŠŸæŠ“å–æ ‡æ³¨                                                       â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   æ ‡æ³¨å†…å®¹:                                                                 â”‚
â”‚   â€¢ æ‰‹è…• 6-DoF ä½å§¿                                                        â”‚
â”‚   â€¢ 22 ä¸ªå…³èŠ‚è§’åº¦                                                          â”‚
â”‚   â€¢ æ¥è§¦ç‚¹ä½ç½®                                                             â”‚
â”‚   â€¢ æŠ“å–è´¨é‡åˆ†æ•°                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 UniDexGrasp ç»Ÿä¸€æ¡†æ¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     UniDexGrasp: è·¨æ‰‹å‹çµå·§æŠ“å–                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   æŒ‘æˆ˜: ä¸åŒçµå·§æ‰‹ DoF ä¸åŒ (Shadow 22, Allegro 16, LEAP 16)               â”‚
â”‚                                                                             â”‚
â”‚   è§£å†³æ–¹æ¡ˆ: ç»Ÿä¸€çš„æ¥è§¦è¡¨ç¤º                                                  â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                     æ¶æ„                                             â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   ç‰©ä½“ç‚¹äº‘ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚   â”‚
â”‚   â”‚                                         â”‚                           â”‚   â”‚
â”‚   â”‚   æ‰‹å‹å‚æ•° (URDF) â”€â–º æ‰‹æŒ‡å°–é‡‡æ ·ç‚¹ â”€â”€â”€â”€â”€â”¤                           â”‚   â”‚
â”‚   â”‚                                         â–¼                           â”‚   â”‚
â”‚   â”‚                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚   â”‚
â”‚   â”‚                                   â”‚ Encoder  â”‚                      â”‚   â”‚
â”‚   â”‚                                   â”‚ (å…±äº«)   â”‚                      â”‚   â”‚
â”‚   â”‚                                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                      â”‚   â”‚
â”‚   â”‚                                        â”‚                            â”‚   â”‚
â”‚   â”‚                                        â–¼                            â”‚   â”‚
â”‚   â”‚                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚   â”‚
â”‚   â”‚                                   â”‚ æ¥è§¦é¢„æµ‹ â”‚                      â”‚   â”‚
â”‚   â”‚                                   â”‚ + IK æ±‚è§£â”‚                      â”‚   â”‚
â”‚   â”‚                                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                      â”‚   â”‚
â”‚   â”‚                                        â”‚                            â”‚   â”‚
â”‚   â”‚                                        â–¼                            â”‚   â”‚
â”‚   â”‚                              æ‰‹å…³èŠ‚è§’åº¦ + æ‰‹è…•ä½å§¿                   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   è®­ç»ƒ: å¤šæ‰‹å‹æ•°æ®æ··åˆ + RL å¾®è°ƒ                                           â”‚
â”‚   ä¼˜åŠ¿: ä¸€ä¸ªæ¨¡å‹é€‚é…å¤šç§çµå·§æ‰‹                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Isaac Sim/Gym æ·±åº¦ä½¿ç”¨

### 3.1 Isaac ç”Ÿæ€ç³»ç»Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     NVIDIA Isaac ç”Ÿæ€                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                     Isaac Sim (Omniverse)                            â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   â€¢ å®Œæ•´ä»¿çœŸå¹³å° (GUI)                                              â”‚   â”‚
â”‚   â”‚   â€¢ USD åœºæ™¯æ ¼å¼                                                    â”‚   â”‚
â”‚   â”‚   â€¢ RTX å…‰è¿½æ¸²æŸ“                                                    â”‚   â”‚
â”‚   â”‚   â€¢ ROS/ROS2 æ¡¥æ¥                                                   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                              â”‚
â”‚                              â–¼                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                     Isaac Lab (åŸ Orbit)                             â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   â€¢ åŸºäº Isaac Sim çš„ RL æ¡†æ¶                                       â”‚   â”‚
â”‚   â”‚   â€¢ æ¨¡å—åŒ–ä»»åŠ¡å®šä¹‰                                                  â”‚   â”‚
â”‚   â”‚   â€¢ æ”¯æŒ RSL-RL, RL-Games, SKRL                                    â”‚   â”‚
â”‚   â”‚   â€¢ æ ‡å‡†åŒ–çš„ Gym æ¥å£                                               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                     Isaac Gym (Legacy)                               â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   â€¢ è½»é‡çº§ GPU å¹¶è¡Œä»¿çœŸ                                             â”‚   â”‚
â”‚   â”‚   â€¢ æ—  GUIï¼Œçº¯ Python API                                           â”‚   â”‚
â”‚   â”‚   â€¢ é€‚åˆå¤§è§„æ¨¡ RL è®­ç»ƒ                                              â”‚   â”‚
â”‚   â”‚   â€¢ âš ï¸ å·²åœæ­¢æ›´æ–°ï¼Œè¿ç§»åˆ° Isaac Lab                                 â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   é€‰æ‹©å»ºè®®:                                                                 â”‚
â”‚   â€¢ æ–°é¡¹ç›®: Isaac Lab (å®˜æ–¹æ¨è)                                           â”‚
â”‚   â€¢ è€é¡¹ç›®: Isaac Gym (ä»å¯ç”¨)                                             â”‚
â”‚   â€¢ éœ€è¦ ROS: Isaac Sim + ROS Bridge                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Isaac Lab ä»»åŠ¡å®šä¹‰

```python
## Isaac Lab è‡ªå®šä¹‰ä»»åŠ¡ç¤ºä¾‹
import omni.isaac.lab as lab
from omni.isaac.lab.envs import ManagerBasedRLEnv, ManagerBasedRLEnvCfg

@configclass
class GraspEnvCfg(ManagerBasedRLEnvCfg):
    """æŠ“å–ä»»åŠ¡é…ç½®"""
    
    # åœºæ™¯é…ç½®
    scene: SceneCfg = SceneCfg(num_envs=4096, env_spacing=2.0)
    
    # è§‚æµ‹é…ç½®
    observations: ObservationsCfg = ObservationsCfg(
        policy=ObsGroup(
            joint_pos=JointPosTerm(asset_cfg=robot_cfg),
            joint_vel=JointVelTerm(asset_cfg=robot_cfg),
            object_pos=ObjectPosTerm(asset_cfg=object_cfg),
        )
    )
    
    # åŠ¨ä½œé…ç½®
    actions: ActionsCfg = ActionsCfg(
        joint_pos=JointPositionAction(asset_cfg=robot_cfg, scale=0.1)
    )
    
    # å¥–åŠ±é…ç½®
    rewards: RewardsCfg = RewardsCfg(
        reaching=ReachingReward(weight=1.0),
        grasping=GraspSuccessReward(weight=10.0),
        action_penalty=ActionPenalty(weight=-0.01),
    )
    
    # ç»ˆæ­¢æ¡ä»¶
    terminations: TerminationsCfg = TerminationsCfg(
        time_out=TimeOutTerm(time_out=5.0),
        success=GraspSuccessTerm(),
    )


class GraspEnv(ManagerBasedRLEnv):
    cfg: GraspEnvCfg
    
    def __init__(self, cfg: GraspEnvCfg):
        super().__init__(cfg)
        
    def _setup_scene(self):
        # æ·»åŠ æœºå™¨äºº
        self.robot = Articulation(self.cfg.robot_cfg)
        # æ·»åŠ ç‰©ä½“
        self.object = RigidObject(self.cfg.object_cfg)
        # æ·»åŠ åœ°é¢
        self.ground = GroundPlane()


## è®­ç»ƒ
from omni.isaac.lab_tasks.utils import parse_env_cfg
from rsl_rl.runners import OnPolicyRunner

env_cfg = parse_env_cfg("Isaac-Grasp-v0")
env = GraspEnv(cfg=env_cfg)
runner = OnPolicyRunner(env, train_cfg, log_dir="logs")
runner.learn(num_learning_iterations=1000)
```

### 3.3 Isaac Gym å¹¶è¡Œä»¿çœŸ

```python
## Isaac Gym å¤§è§„æ¨¡å¹¶è¡Œè®­ç»ƒ
from isaacgym import gymapi, gymtorch
import torch

## åˆ›å»ºä»¿çœŸ
gym = gymapi.acquire_gym()
sim_params = gymapi.SimParams()
sim_params.physx.num_threads = 4
sim_params.physx.solver_type = 1  # TGS
sim_params.use_gpu_pipeline = True

sim = gym.create_sim(0, 0, gymapi.SIM_PHYSX, sim_params)

## åˆ›å»ºå¤šä¸ªç¯å¢ƒ
num_envs = 4096
envs = []
for i in range(num_envs):
    env = gym.create_env(sim, lower, upper, num_per_row)
    # åŠ è½½æœºå™¨äººå’Œç‰©ä½“
    robot = gym.create_actor(env, robot_asset, pose, "robot", i, 0)
    object = gym.create_actor(env, object_asset, obj_pose, "object", i, 1)
    envs.append(env)

## è·å– GPU tensor
gym.prepare_sim(sim)
root_tensor = gym.acquire_actor_root_state_tensor(sim)
root_states = gymtorch.wrap_tensor(root_tensor)

## è®­ç»ƒå¾ªç¯
for iter in range(max_iters):
    # å¹¶è¡Œ step
    gym.simulate(sim)
    gym.fetch_results(sim, True)
    
    # è·å–è§‚æµ‹ (GPU tensor)
    obs = get_observations(root_states)
    
    # ç­–ç•¥æ¨ç† (GPU)
    actions = policy(obs)
    
    # è®¾ç½®åŠ¨ä½œ (GPU tensor)
    gym.set_dof_position_target_tensor(sim, gymtorch.unwrap_tensor(actions))
```

---

## 4. SAPIEN / ManiSkill ä½¿ç”¨

### 4.1 SAPIEN ç‰¹ç‚¹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SAPIEN æ ¸å¿ƒç‰¹æ€§                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   Part-Level Articulation (å…³èŠ‚ç‰©ä½“äº¤äº’)                                    â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   å¾®æ³¢ç‚‰                                                            â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ base (å›ºå®š)                                                   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ door (revolute joint) â† å¯å¼€å…³                               â”‚   â”‚
â”‚   â”‚   â””â”€â”€ turntable (revolute joint) â† å¯æ—‹è½¬                          â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   æŠ½å±‰æŸœ                                                            â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ cabinet_body (å›ºå®š)                                           â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ drawer_1 (prismatic joint) â† å¯æ‹‰å‡º                          â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ drawer_2 (prismatic joint)                                   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ door (revolute joint)                                        â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   PartNet-Mobility æ•°æ®é›†                                                   â”‚
â”‚   â€¢ 2,346 ä¸ªå¯äº¤äº’ç‰©ä½“æ¨¡å‹                                                 â”‚
â”‚   â€¢ 46 ä¸ªç‰©ä½“ç±»åˆ«                                                          â”‚
â”‚   â€¢ å®Œæ•´çš„å…³èŠ‚æ ‡æ³¨                                                         â”‚
â”‚                                                                             â”‚
â”‚   æ¸²æŸ“èƒ½åŠ›                                                                  â”‚
â”‚   â€¢ Vulkan-based å…‰æ …åŒ–                                                    â”‚
â”‚   â€¢ å¯é€‰å…‰çº¿è¿½è¸ª                                                           â”‚
â”‚   â€¢ æ”¯æŒ Domain Randomization                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 ManiSkill Benchmark

```python
## ManiSkill3 ä½¿ç”¨ç¤ºä¾‹
import gymnasium as gym
import mani_skill.envs

## åˆ›å»ºç¯å¢ƒ
env = gym.make(
    "PickCube-v1",
    num_envs=256,  # GPU å¹¶è¡Œ
    obs_mode="rgbd",  # è§‚æµ‹æ¨¡å¼
    control_mode="pd_ee_delta_pose",  # æ§åˆ¶æ¨¡å¼
    render_mode="rgb_array",
)

## é‡ç½®
obs, info = env.reset()

## äº¤äº’
for _ in range(1000):
    action = env.action_space.sample()  # éšæœºåŠ¨ä½œ
    obs, reward, terminated, truncated, info = env.step(action)
    
    if terminated.any() or truncated.any():
        obs, info = env.reset()

## ManiSkill ä»»åŠ¡åˆ—è¡¨
tasks = [
    "PickCube-v1",           # æŠ“å–ç«‹æ–¹ä½“
    "StackCube-v1",          # å †å ç«‹æ–¹ä½“
    "PegInsertionSide-v1",   # ä¾§å‘æ’å…¥
    "OpenCabinetDoor-v1",    # å¼€æŸœé—¨
    "OpenCabinetDrawer-v1",  # å¼€æŠ½å±‰
    "PushChair-v1",          # æ¨æ¤…å­
    "AssemblingKits-v1",     # ç»„è£…å¥—ä»¶
]
```

### 4.3 SAPIEN è‡ªå®šä¹‰åœºæ™¯

```python
import sapien.core as sapien
from sapien.utils import Viewer

## åˆ›å»ºå¼•æ“å’Œåœºæ™¯
engine = sapien.Engine()
renderer = sapien.SapienRenderer()
engine.set_renderer(renderer)

scene = engine.create_scene()
scene.set_timestep(1/240)

## æ·»åŠ åœ°é¢
scene.add_ground(altitude=0)

## åŠ è½½æœºå™¨äºº
loader = scene.create_urdf_loader()
robot = loader.load("franka_panda/panda.urdf")
robot.set_root_pose(sapien.Pose([0, 0, 0]))

## åŠ è½½å¯äº¤äº’ç‰©ä½“ (PartNet-Mobility)
articulation_loader = scene.create_urdf_loader()
cabinet = articulation_loader.load("partnet_mobility/cabinet.urdf")

## è·å–å…³èŠ‚
drawer_joint = cabinet.get_active_joints()[0]
drawer_joint.set_drive_property(stiffness=100, damping=10)

## ä»¿çœŸå¾ªç¯
viewer = Viewer(renderer)
viewer.set_scene(scene)

while not viewer.closed:
    # æ§åˆ¶æœºå™¨äºº
    robot.set_qpos(target_qpos)
    
    # æ§åˆ¶æŠ½å±‰
    drawer_joint.set_drive_target(0.3)  # æ‰“å¼€ 30cm
    
    scene.step()
    scene.update_render()
    viewer.render()
```

---

## 5. æŠ“å–ç®—æ³•ä»£ç ç¤ºä¾‹

### 5.1 Contact-GraspNet æ¨ç†

```python
## Contact-GraspNet ä½¿ç”¨
import numpy as np
from contact_graspnet.inference import GraspEstimator

## åŠ è½½æ¨¡å‹
grasp_estimator = GraspEstimator(
    checkpoint_path='checkpoints/contact_graspnet.pth',
    device='cuda'
)

## è¾“å…¥ç‚¹äº‘
point_cloud = np.load('scene_pointcloud.npy')  # (N, 3)
colors = np.load('scene_colors.npy')  # (N, 3), å¯é€‰

## æ¨ç†
grasps, scores, contacts = grasp_estimator.predict(
    point_cloud,
    colors=colors,
    forward_passes=5,  # å¤šæ¬¡å‰å‘å–å¹³å‡
)

## grasps: (M, 4, 4) - M ä¸ªæŠ“å–çš„å˜æ¢çŸ©é˜µ
## scores: (M,) - æ¯ä¸ªæŠ“å–çš„ç½®ä¿¡åº¦
## contacts: (M, 3) - æ¥è§¦ç‚¹ä½ç½®

## é€‰æ‹©æœ€ä½³æŠ“å–
best_idx = np.argmax(scores)
best_grasp = grasps[best_idx]
print(f"æœ€ä½³æŠ“å–ä½ç½®: {best_grasp[:3, 3]}")
print(f"ç½®ä¿¡åº¦: {scores[best_idx]:.3f}")
```

### 5.2 DexGraspNet æ•°æ®åŠ è½½

```python
## DexGraspNet æ•°æ®é›†ä½¿ç”¨
import h5py
import numpy as np

## åŠ è½½æ•°æ®
with h5py.File('dexgraspnet/grasps.h5', 'r') as f:
    # ç‰©ä½“ä¿¡æ¯
    object_code = f['object_code'][()]
    object_scale = f['object_scale'][()]
    
    # æŠ“å–å§¿æ€
    hand_qpos = f['hand_qpos'][()]  # (N, 22) å…³èŠ‚è§’åº¦
    hand_trans = f['hand_trans'][()]  # (N, 3) æ‰‹è…•ä½ç½®
    hand_rot = f['hand_rot'][()]  # (N, 3, 3) æ‰‹è…•æ—‹è½¬
    
    # æŠ“å–è´¨é‡
    grasp_quality = f['grasp_quality'][()]  # (N,)

## ç­›é€‰é«˜è´¨é‡æŠ“å–
good_grasps = grasp_quality > 0.5
selected_qpos = hand_qpos[good_grasps]

## åœ¨ Isaac Gym ä¸­éªŒè¯
from isaacgym import gymapi
## ... åŠ è½½ Shadow Hand å¹¶è®¾ç½®å…³èŠ‚è§’åº¦
```

### 5.3 GraspGF ç”ŸæˆæŠ“å–

```python
## GraspGF ç”Ÿæˆå¼æŠ“å–
from graspgf.model import GraspGFModel
from graspgf.sampling import langevin_dynamics

## åŠ è½½æ¨¡å‹
model = GraspGFModel.load_from_checkpoint('graspgf.ckpt')
model.eval()

## è¾“å…¥åœºæ™¯ç‚¹äº‘
scene_pc = torch.from_numpy(point_cloud).float().cuda()

## åˆå§‹åŒ–éšæœºæŠ“å–
num_samples = 100
init_grasps = torch.randn(num_samples, 9).cuda()  # 6D pose + 3D approach

## Langevin é‡‡æ ·
with torch.no_grad():
    for t in reversed(range(1000)):
        # é¢„æµ‹ score
        score = model(init_grasps, scene_pc, t)
        
        # Langevin æ›´æ–°
        noise_scale = get_noise_scale(t)
        init_grasps = init_grasps + 0.5 * score + noise_scale * torch.randn_like(init_grasps)

## è½¬æ¢ä¸º SE(3)
final_grasps = convert_to_se3(init_grasps)
```

---

## 6. é¢è¯• Q&A

### Q1: Dex-Net çš„æ ¸å¿ƒåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ

**Dex-Net ä¸‰å¤§æ ¸å¿ƒ**:
1. **å¤§è§„æ¨¡åˆæˆæ•°æ®**: åœ¨ä»¿çœŸä¸­ç”Ÿæˆæ•°ç™¾ä¸‡æŠ“å–æ ·æœ¬ï¼Œè§£å†³çœŸæœºæ•°æ®ç¨€ç¼ºé—®é¢˜
2. **GQ-CNN**: å­¦ä¹ ä»æ·±åº¦å›¾é¢„æµ‹æŠ“å–æˆåŠŸæ¦‚ç‡
3. **Antipodal é‡‡æ ·**: åŸºäºå‡ ä½•çº¦æŸçš„æŠ“å–å€™é€‰ç”Ÿæˆ

**ä¸ºä»€ä¹ˆæœ‰æ•ˆ**:
- åˆæˆæ•°æ® + Domain Randomization æé«˜æ³›åŒ–
- Ferrari-Canny Metric æä¾›ç‰©ç†å¯é çš„æ ‡ç­¾
- ç«¯åˆ°ç«¯å­¦ä¹ é¿å…æ‰‹å·¥ç‰¹å¾è®¾è®¡

### Q2: Contact-GraspNet vs GraspGF åŒºåˆ«ï¼Ÿ

| ç»´åº¦ | Contact-GraspNet | GraspGF |
|:-----|:-----------------|:--------|
| **æ–¹æ³•** | åˆ¤åˆ«å¼ (ç›´æ¥å›å½’) | ç”Ÿæˆå¼ (Score-based) |
| **é€Ÿåº¦** | å¿« (~50ms) | æ…¢ (~1s, éœ€è¿­ä»£) |
| **å¤šæ ·æ€§** | ä¸€æ¬¡è¾“å‡ºå›ºå®šæ•°é‡ | å¯æ§åˆ¶ç”Ÿæˆæ•°é‡ |
| **å¤šæ¨¡æ€** | è¾ƒå¼± | å¼º (å¤©ç„¶å¤„ç†å¤šæ¨¡æ€) |
| **é€‚ç”¨** | å®æ—¶åº”ç”¨ | éœ€è¦å¤šæ ·æŠ“å–çš„åœºæ™¯ |

### Q3: DexGraspNet æ•°æ®æ˜¯æ€ä¹ˆç”Ÿæˆçš„ï¼Ÿ

1. **åˆå§‹åŒ–**: åœ¨ç‰©ä½“å‘¨å›´éšæœºé‡‡æ ·æ‰‹è…•ä½å§¿
2. **ä¼˜åŒ–**: æœ€å°åŒ–æ¥è§¦è·ç¦» + ç©¿é€æƒ©ç½š + åŠ›é—­åˆçº¦æŸ
3. **éªŒè¯**: åœ¨ Isaac Gym ä¸­ä»¿çœŸï¼Œæ£€æŸ¥æ˜¯å¦èƒ½æˆåŠŸæŠ¬èµ·ç‰©ä½“
4. **ç­›é€‰**: ä¿ç•™æˆåŠŸç‡ > 50% çš„æŠ“å–

### Q4: Isaac Gym vs Isaac Lab æ€ä¹ˆé€‰ï¼Ÿ

- **Isaac Gym**: è€é¡¹ç›®ã€éœ€è¦æœ€å¤§å¹¶è¡Œåº¦ã€ä¸éœ€è¦ GUI
- **Isaac Lab**: æ–°é¡¹ç›®ã€éœ€è¦æ¨¡å—åŒ–ã€éœ€è¦ä¸ Isaac Sim äº’é€š

### Q5: SAPIEN çš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ

- **Part-level äº¤äº’**: ä¸“é—¨ä¸ºå¯äº¤äº’ç‰©ä½“è®¾è®¡ (å¼€é—¨ã€å¼€æŠ½å±‰)
- **PartNet-Mobility**: å¤§è§„æ¨¡å…³èŠ‚ç‰©ä½“æ•°æ®é›†
- **è½»é‡**: æ¯” Isaac Sim æ›´è½»é‡ï¼Œé€‚åˆå¿«é€Ÿå®éªŒ

### Q6: å¦‚ä½•è¯„ä¼°æŠ“å–ç®—æ³•ï¼Ÿ

| æŒ‡æ ‡ | æè¿° |
|:-----|:-----|
| **Success Rate** | æŠ“å–æˆåŠŸç‡ (ä»¿çœŸ/çœŸæœº) |
| **Clearance Rate** | æŠ¬èµ·åä¿æŒç¨³å®šçš„æ¯”ä¾‹ |
| **Coverage** | èƒ½æŠ“å–çš„ç‰©ä½“ç±»åˆ«æ¯”ä¾‹ |
| **Diversity** | åŒä¸€ç‰©ä½“ç”ŸæˆæŠ“å–çš„å¤šæ ·æ€§ |
| **Inference Time** | æ¨ç†é€Ÿåº¦ |

---

## ğŸ“š æ¨èèµ„æº

### è®ºæ–‡
- [Contact-GraspNet: Efficient 6-DoF Grasp Generation](https://arxiv.org/abs/2103.14127)
- [DexGraspNet: A Large-Scale Robotic Dexterous Grasp Dataset](https://arxiv.org/abs/2210.02697)
- [GraspGF: Learning Score-based Grasping](https://arxiv.org/abs/2309.06038)
- [UniDexGrasp: Universal Robotic Dexterous Grasping](https://arxiv.org/abs/2303.00938)

### ä»£ç åº“
- [Contact-GraspNet](https://github.com/NVlabs/contact_graspnet)
- [DexGraspNet](https://github.com/PKU-EPIC/DexGraspNet)
- [GraspGF](https://github.com/graspgf/graspgf)
- [Isaac Lab](https://github.com/NVIDIA-Omniverse/IsaacLab)
- [ManiSkill](https://github.com/haosulab/ManiSkill)

---



\newpage

# ç¬¬23ç«  è¿åŠ¨è§„åˆ’


> **é¢è¯•åœºæ™¯**: â€œè¯·ä½ ä»‹ç»ä¸€ä¸‹æœºå™¨äººè¿åŠ¨è§„åˆ’çš„å¸¸è§æ–¹æ³•ï¼Œå¹¶è¯´æ˜åœ¨å®é™…å·¥ç¨‹ä¸­å¦‚ä½•é€‰æ‹©ï¼Ÿâ€

æœ¬æ–‡æ€»ç»“é‡‡æ ·å¼è§„åˆ’ã€è½¨è¿¹ä¼˜åŒ–ã€æ··åˆèŒƒå¼ä»¥åŠå·¥ç¨‹è½åœ° (MoveIt / cuRobo) çš„è¦ç‚¹ï¼Œå¸®åŠ©å¿«é€Ÿå›ç­”æœºå™¨äººè¿åŠ¨è§„åˆ’ç›¸å…³é—®é¢˜ã€‚

## 0. ä¸»è¦æ•¸å­¸æ€æƒ³ (Main Mathematical Idea)

> **ç¬¬ä¸€æ€§åŸç†**: **Connectivity and Smoothness (è¿é€šæ€§ä¸å¹³æ»‘æ€§)**

è§„åˆ’é—®é¢˜æœ¬è´¨ä¸Šæ˜¯åœ¨é«˜ç»´ç©ºé—´ä¸­å¯»æ‰¾ä¸€æ¡"è¿æ¥èµ·ç‚¹å’Œç»ˆç‚¹"ä¸”"æ— ç¢°æ’"çš„æ›²çº¿ã€‚

- **æ ¸å¿ƒæ•°å­¦å·¥å…·**: **Graph Search (ç¦»æ•£å›¾æœç´¢)** vs **Functional Optimization (è¿ç»­æ³›å‡½ä¼˜åŒ–)**ã€‚
- **è§£é¢˜é€»è¾‘**:
    1.  **é‡‡æ ·å¼ (Sampling-based)**: å°†è¿ç»­çš„å‡ ä½•ç©ºé—´**ç¦»æ•£åŒ–**ä¸ºå›¾ (Graph)ã€‚åˆ©ç”¨æ¦‚ç‡è®ºä¸­çš„"ç¨ å¯†æ€§" (å½“é‡‡æ ·ç‚¹è¶³å¤Ÿå¤šæ—¶ï¼Œä¸€å®šä¼šè¦†ç›–å¯è¡Œè§£)ï¼Œå°†å‡ ä½•é—®é¢˜è½¬åŒ–ä¸ºå›¾è®ºä¸­çš„è¿é€šæ€§é—®é¢˜ (å¦‚ DFS/BFS)ã€‚
    2.  **ä¼˜åŒ–å¼ (Optimization-based)**: å°†è·¯å¾„è§†ä¸ºä¸€æ ¹æœ‰å¼¹æ€§çš„"æ©¡çš®ç­‹"ã€‚é€šè¿‡æœ€å°åŒ–èƒ½é‡å‡½æ•° (Energy Functional = å¹³æ»‘åº¦ä»£ä»· + éšœç¢ç‰©æ–¥åŠ›)ï¼Œè®©è·¯å¾„åœ¨ç‰©ç†çº¦æŸä¸‹è‡ªç„¶æ”¶æ•›åˆ°æœ€ä¼˜å½¢çŠ¶ã€‚

---

## ğŸ§­ è¿åŠ¨è§„åˆ’å…¨æ™¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       è§„åˆ’å†³ç­–æ ‘                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   èµ·ç‚¹ + ç›®æ ‡ + çº¦æŸ                                                     â”‚
â”‚          â”‚                                                               â”‚
â”‚          â”œâ”€â”€ ä½ç»´ (2D/3D) â†’ æ …æ ¼æœç´¢ (A*, D*)                             â”‚
â”‚          â”‚                                                               â”‚
â”‚          â””â”€â”€ é«˜ç»´ (æœºæ¢°è‡‚, 7DoF+)                                         â”‚
â”‚                 â”‚                                                         â”‚
â”‚                 â”œâ”€â”€ é‡‡æ ·å¼è§„åˆ’ (Sampling-Based)                           â”‚
â”‚                 â”‚     â€¢ RRT, RRT*, PRM, BIT*                              â”‚
â”‚                 â”‚                                                         â”‚
â”‚                 â”œâ”€â”€ è½¨è¿¹ä¼˜åŒ– (Trajectory Optimization)                    â”‚
â”‚                 â”‚     â€¢ CHOMP, TrajOpt, STOMP, GPMP                       â”‚
â”‚                 â”‚                                                         â”‚
â”‚                 â””â”€â”€ æ··åˆæ–¹æ³•                                              â”‚
â”‚                       â€¢ RRT + TrajOpt (å…ˆå¯è¡Œå†ä¼˜åŒ–)                      â”‚
â”‚                       â€¢ Learning + Planning (ç­–ç•¥çƒ­å¯åŠ¨)                  â”‚
â”‚                                                                          â”‚
â”‚   è¾“å‡º: å¯è¡Œè·¯å¾„/è½¨è¿¹ (Piecewise Linear / Polynomial / Spline)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

--- 
## è¿åŠ¨è§„åˆ’ (Motion Planning)

> **é¢è¯•åœºæ™¯**: â€œè¯·ä½ ä»‹ç»ä¸€ä¸‹æœºå™¨äººè¿åŠ¨è§„åˆ’çš„å¸¸è§æ–¹æ³•ï¼Œå¹¶è¯´æ˜åœ¨å®é™…å·¥ç¨‹ä¸­å¦‚ä½•é€‰æ‹©ï¼Ÿâ€

æœ¬æ–‡æ€»ç»“é‡‡æ ·å¼è§„åˆ’ã€è½¨è¿¹ä¼˜åŒ–ã€æ··åˆèŒƒå¼ä»¥åŠå·¥ç¨‹è½åœ° (MoveIt / cuRobo) çš„è¦ç‚¹ï¼Œå¸®åŠ©å¿«é€Ÿå›ç­”æœºå™¨äººè¿åŠ¨è§„åˆ’ç›¸å…³é—®é¢˜ã€‚

## 0. ä¸»è¦æ•¸å­¸æ€æƒ³ (Main Mathematical Idea)

> **ç¬¬ä¸€æ€§åŸç†**: **Connectivity and Smoothness (è¿é€šæ€§ä¸å¹³æ»‘æ€§)**

è§„åˆ’é—®é¢˜æœ¬è´¨ä¸Šæ˜¯åœ¨é«˜ç»´ç©ºé—´ä¸­å¯»æ‰¾ä¸€æ¡"è¿æ¥èµ·ç‚¹å’Œç»ˆç‚¹"ä¸”"æ— ç¢°æ’"çš„æ›²çº¿ã€‚

- **æ ¸å¿ƒæ•°å­¦å·¥å…·**: **Graph Search (ç¦»æ•£å›¾æœç´¢)** vs **Functional Optimization (è¿ç»­æ³›å‡½ä¼˜åŒ–)**ã€‚
- **è§£é¢˜é€»è¾‘**:
    1.  **é‡‡æ ·å¼ (Sampling-based)**: å°†è¿ç»­çš„å‡ ä½•ç©ºé—´**ç¦»æ•£åŒ–**ä¸ºå›¾ (Graph)ã€‚åˆ©ç”¨æ¦‚ç‡è®ºä¸­çš„"ç¨ å¯†æ€§" (å½“é‡‡æ ·ç‚¹è¶³å¤Ÿå¤šæ—¶ï¼Œä¸€å®šä¼šè¦†ç›–å¯è¡Œè§£)ï¼Œå°†å‡ ä½•é—®é¢˜è½¬åŒ–ä¸ºå›¾è®ºä¸­çš„è¿é€šæ€§é—®é¢˜ (å¦‚ DFS/BFS)ã€‚
    2.  **ä¼˜åŒ–å¼ (Optimization-based)**: å°†è·¯å¾„è§†ä¸ºä¸€æ ¹æœ‰å¼¹æ€§çš„"æ©¡çš®ç­‹"ã€‚é€šè¿‡æœ€å°åŒ–èƒ½é‡å‡½æ•° (Energy Functional = å¹³æ»‘åº¦ä»£ä»· + éšœç¢ç‰©æ–¥åŠ›)ï¼Œè®©è·¯å¾„åœ¨ç‰©ç†çº¦æŸä¸‹è‡ªç„¶æ”¶æ•›åˆ°æœ€ä¼˜å½¢çŠ¶ã€‚

---

## ğŸ§­ è¿åŠ¨è§„åˆ’å…¨æ™¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       è§„åˆ’å†³ç­–æ ‘                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   èµ·ç‚¹ + ç›®æ ‡ + çº¦æŸ                                                     â”‚
â”‚          â”‚                                                               â”‚
â”‚          â”œâ”€â”€ ä½ç»´ (2D/3D) â†’ æ …æ ¼æœç´¢ (A*, D*)                             â”‚
â”‚          â”‚                                                               â”‚
â”‚          â””â”€â”€ é«˜ç»´ (æœºæ¢°è‡‚, 7DoF+)                                         â”‚
â”‚                 â”‚                                                         â”‚
â”‚                 â”œâ”€â”€ é‡‡æ ·å¼è§„åˆ’ (Sampling-Based)                           â”‚
â”‚                 â”‚     â€¢ RRT, RRT*, PRM, BIT*                              â”‚
â”‚                 â”‚                                                         â”‚
â”‚                 â”œâ”€â”€ è½¨è¿¹ä¼˜åŒ– (Trajectory Optimization)                    â”‚
â”‚                 â”‚     â€¢ CHOMP, TrajOpt, STOMP, GPMP                       â”‚
â”‚                 â”‚                                                         â”‚
â”‚                 â””â”€â”€ æ··åˆæ–¹æ³•                                              â”‚
â”‚                       â€¢ RRT + TrajOpt (å…ˆå¯è¡Œå†ä¼˜åŒ–)                      â”‚
â”‚                       â€¢ Learning + Planning (ç­–ç•¥çƒ­å¯åŠ¨)                  â”‚
â”‚                                                                          â”‚
â”‚   è¾“å‡º: å¯è¡Œè·¯å¾„/è½¨è¿¹ (Piecewise Linear / Polynomial / Spline)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1. é‡‡æ ·å¼è§„åˆ’ (Sampling-Based Planning)

### 1.1 æ ¸å¿ƒç†å¿µ

- ç›´æ¥åœ¨é…ç½®ç©ºé—´ \( \mathcal{C} \) ä¸­éšæœºé‡‡æ ·èŠ‚ç‚¹ï¼Œé¿å…æ˜¾å¼ç¦»æ•£åŒ–é«˜ç»´ç©ºé—´ã€‚
- é¿å…å¯¹éšœç¢ç‰©å‡ ä½•è¿›è¡Œæ˜¾å¼å»ºæ¨¡ï¼Œåªéœ€è¦ç¢°æ’æ£€æµ‹å‡½æ•° `collisionFree(q)`ã€‚
- éšé‡‡æ ·æ¬¡æ•°å¢åŠ ï¼Œç®—æ³•è¶‹è¿‘äºæ‰¾åˆ°å¯è¡Œè·¯å¾„ï¼›å¸¦æœ‰ *-star* çš„ç®—æ³•è¿˜èƒ½ä¿è¯æ¸è¿›æœ€ä¼˜ (asymptotically optimal)ã€‚

### 1.2 RRT / RRT*

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     RRT æ‰©å±•ç¤ºæ„                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   q_start â—                                                              â”‚
â”‚          â”‚ï¼¼                                                             â”‚
â”‚          â”‚  ï¼¼                                                           â”‚
â”‚          â”‚    â— q_new                                                    â”‚
â”‚          â”‚    / â”‚                                                        â”‚
â”‚          â”‚  ï¼  â”‚                                                       â”‚
â”‚       â— â”€â”˜     â”‚                                                        â”‚
â”‚    q_rand      â”‚                                                        â”‚
â”‚                â”‚                                                        â”‚
â”‚           éšœç¢ç‰©                                                         â”‚
â”‚                                                                          â”‚
â”‚   æ­¥éª¤:                                                                   â”‚
â”‚   1. éšæœºé‡‡æ · q_rand                                                      â”‚
â”‚   2. æ‰¾åˆ°æ ‘ä¸­æœ€è¿‘èŠ‚ç‚¹ q_near                                              â”‚
â”‚   3. æœ q_rand æ–¹å‘æ‰©å±• step â†’ q_new                                      â”‚
â”‚   4. è‹¥è¿çº¿æ— ç¢°æ’ï¼Œå°† q_new åŠ å…¥æ ‘                                        â”‚
â”‚                                                                          â”‚
â”‚   RRT*: åœ¨æ’å…¥æ–°èŠ‚ç‚¹æ—¶é‡æ–°è¿çº¿ (rewire)ï¼Œé€‰æ‹©ä»£ä»·æ›´ä½çš„çˆ¶èŠ‚ç‚¹ï¼Œå¹¶æ›´æ–°å­æ ‘    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| ç®—æ³• | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|:-----|:-----|:-----|:---------|
| **RRT** | å®ç°ç®€å•ï¼Œå¿«é€Ÿæ‰¾åˆ°å¯è¡Œè·¯å¾„ | è·¯å¾„è´¨é‡å·®ï¼ŒæŠ–åŠ¨ | é«˜ç»´é…ç½®ç©ºé—´ï¼Œå¿«é€Ÿé¿éšœ |
| **RRT\*** | æ¸è¿›æœ€ä¼˜ï¼Œè·¯å¾„æ›´å¹³æ»‘ | è®¡ç®—é‡å¤§ (rewire) | éœ€è¦è¾ƒé«˜è´¨é‡è·¯å¾„ |
| **Informed RRT\*** | é‡‡æ ·é™åˆ¶åœ¨æ¤­çƒåŒºåŸŸï¼ŒåŠ é€Ÿæ”¶æ•› | éœ€è¦å¯å‘å¼ | èµ·æ­¢ç‚¹å·²çŸ¥ã€éœ€åŠ é€Ÿ |
| **BIT\*** | æ‰¹é‡é‡‡æ · + æœ€ä¼˜ | å®ç°å¤æ‚ | éœ€è¦å…¼é¡¾é€Ÿåº¦å’Œæœ€ä¼˜æ€§ |

### 1.3 PRM / PRM\*

- **PRM (Probabilistic Roadmap)**: å…ˆç¦»çº¿é‡‡æ ·å¤§é‡èŠ‚ç‚¹å¹¶æ„å»ºæ— å‘å›¾ï¼Œåœ¨çº¿é˜¶æ®µåªéœ€è¿æ¥èµ·ç‚¹/ç»ˆç‚¹ã€‚
- é€‚ç”¨äºå¤šæ¬¡æŸ¥è¯¢çš„åœºæ™¯ (åŒä¸€ç©ºé—´å¤šæ¬¡è§„åˆ’)ã€‚
- PRM\*: æ¸è¿›æœ€ä¼˜ç‰ˆæœ¬ï¼Œè¿æ¥åŠå¾„éšæ ·æœ¬æ•°é‡åŠ¨æ€è°ƒæ•´ã€‚

---

## 2. è½¨è¿¹ä¼˜åŒ– (Trajectory Optimization)

### 2.1 æ€è·¯

- å°†è½¨è¿¹ç¦»æ•£åŒ–ä¸º \( \mathbf{x}_{0:T} \)ï¼Œå®šä¹‰ä¼˜åŒ–ç›®æ ‡ + çº¦æŸï¼Œè½¬åŒ–ä¸ºéçº¿æ€§ä¼˜åŒ–é—®é¢˜ã€‚
- å…¸å‹ç›®æ ‡ï¼šè·¯å¾„é•¿åº¦ã€é€Ÿåº¦/åŠ é€Ÿåº¦æ­£åˆ™ã€ä¸éšœç¢ç‰©è·ç¦»æƒ©ç½šã€‚
- çº¦æŸï¼šåŠ¨åŠ›å­¦çº¦æŸã€æ¥è§¦çº¦æŸã€å…³èŠ‚é™åˆ¶ã€ç»ˆç«¯å§¿æ€ç­‰ã€‚

### 2.2 å…¸å‹ç®—æ³•

| ç®—æ³• | æ ¸å¿ƒæ€æƒ³ | ä¼˜åŠ¿ | å±€é™ |
|:-----|:---------|:-----|:-----|
| **CHOMP** | åŸºäºæ¢¯åº¦ä¸‹é™ + ç¢°æ’åŠ¿èƒ½ï¼Œä¼˜åŒ–ç¦»æ•£è½¨è¿¹ | å¹³æ»‘ã€å¯èå…¥éšœç¢åŠ¿ | å¯¹åˆå€¼æ•æ„Ÿï¼Œæ¢¯åº¦å±€éƒ¨ |
| **TrajOpt** | ä»¥å‡¸ä¼˜åŒ– (sequential convex) å½¢å¼æ±‚è§£ | æ”¶æ•›å¿«ï¼Œå¯åŠ å¤æ‚çº¦æŸ | éœ€è¦è‰¯å¥½åˆå€¼ |
| **STOMP** | é‡‡æ ·å¤šä¸ªæ‰°åŠ¨è½¨è¿¹ï¼Œæ ¹æ®ä»£ä»·åŠ æƒå¹³å‡ | æ— éœ€æ¢¯åº¦ï¼Œé²æ£’ | è®¡ç®—é‡å¤§ |
| **GPMP2** | å°†è½¨è¿¹å»ºæ¨¡ä¸ºé«˜æ–¯è¿‡ç¨‹ï¼Œä½¿ç”¨å› å­å›¾ä¼˜åŒ– | ä¸ SLAM/ä¼°è®¡å·¥å…·é“¾ä¸€è‡´ | å®ç°å¤æ‚ |
| **MPC (Short-horizon)** | åœ¨çº¿æ»šåŠ¨ä¼˜åŒ–å±€éƒ¨è½¨è¿¹ | èƒ½å¤„ç†åŠ¨æ€éšœç¢ | éœ€è¦å®æ—¶ç®—åŠ› |

### 2.3 TrajOpt ä»£ä»·å‡½æ•°ç¤ºä¾‹

```
J(x) = w_smooth * Î£ ||x_{t+1} - 2x_t + x_{t-1}||Â²    (å¹³æ»‘é¡¹)
     + w_collision * Î£ max(0, d_safe - d(x_t))Â²       (ç¢°æ’çº¦æŸè½¯åŒ–)
     + w_goal * ||x_T - x_goal||Â²                     (ç»ˆç‚¹çº¦æŸ)

subject to: joint_limits, velocity_limits, etc.
```

---

## 3. æ··åˆæ–¹æ³•ä¸å·¥ç¨‹å®è·µ

### 3.1 é‡‡æ · + ä¼˜åŒ– (Warm-Start)

1. **RRT æ‰¾åˆ°å¯è¡Œè·¯å¾„**ï¼Œä¿è¯ç¢°æ’è‡ªç”±ã€‚
2. **TrajOpt/CHOMP** ä»¥ RRT ç»“æœä½œä¸ºåˆå§‹è½¨è¿¹ï¼Œè¿›ä¸€æ­¥å¹³æ»‘å¹¶æ»¡è¶³åŠ¨åŠ›å­¦çº¦æŸã€‚
3. å·¥ç¨‹ä¸­å¸¸ç»“åˆ MoveIt â€œOMPL (é‡‡æ ·) + TrajOpt (ä¼˜åŒ–)â€ Pipelineã€‚

### 3.2 å­¦ä¹ è¾…åŠ©è§„åˆ’

- **ç­–ç•¥çƒ­å¯åŠ¨**: ç”¨æ¨¡ä»¿/å¼ºåŒ–å­¦ä¹ æ¨¡å‹é¢„æµ‹åˆå§‹è½¨è¿¹ï¼Œå†äº¤ç»™ TrajOpt ä¼˜åŒ–ã€‚
- **ä»·å€¼å‡½æ•°å¼•å¯¼é‡‡æ ·**: è®­ç»ƒä¸€ä¸ª value network è¯„ä¼°èŠ‚ç‚¹å¥½åï¼Œæé«˜é‡‡æ ·æ•ˆç‡ (Learning-RRT)ã€‚
- **Diffusion/LfD**: ç›´æ¥ç”Ÿæˆå¯è¡Œè½¨è¿¹ï¼Œä½œä¸ºè§„åˆ’å™¨å€™é€‰ã€‚

---

## 4. MoveIt & cuRobo å®æˆ˜

### 4.1 MoveIt è§„åˆ’æµæ°´çº¿

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        MoveIt Pipeline                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Planning Scene â† Obstacles / Robot State                                â”‚
â”‚          â”‚                                                               â”‚
â”‚          â–¼                                                               â”‚
â”‚  OMPL Planner (RRTConnect, RRT*)                                         â”‚
â”‚          â”‚  (å¯é€‰å‰å¤„ç†: Simplify)                                      â”‚
â”‚          â–¼                                                               â”‚
â”‚  Trajectory Post-processing                                              â”‚
â”‚   â€¢ Time Parameterization (TOTG)                                         â”‚
â”‚   â€¢ Smoothing                                                            â”‚
â”‚                                                                          â”‚
â”‚  Controller Manager â†’ FollowJointTrajectory                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **OMPL**: åŒ…å«å¤§éƒ¨åˆ†é‡‡æ ·å¼è§„åˆ’å™¨ (RRT, RRT*, PRM, KPIECE)ã€‚
- **Pilz**: MoveIt å†…ç½®çš„ç¬›å¡å°”è§„åˆ’å™¨ï¼Œé€‚åˆç›´çº¿/æ’è¡¥ã€‚
- **TrajOpt / STOMP æ’ä»¶**: éœ€è¦é¢å¤–å®‰è£…ï¼Œæä¾›ä¼˜åŒ–å‹è§„åˆ’ã€‚

### 4.2 NVIDIA cuRobo

- åŸºäº GPU çš„è¿åŠ¨è§„åˆ’åº“ï¼Œé‡‡ç”¨å¹¶è¡ŒåŒ–çš„ **å¤šç§è§„åˆ’å™¨å€™é€‰ + è½¨è¿¹ä¼˜åŒ–**ã€‚
- å¯åœ¨ Jetson Orin ä¸Šå®ç° <100ms çš„ 7DoF æœºæ¢°è‡‚è§„åˆ’ã€‚

---

## 5. ä»£ç å‚è€ƒ

```python
## MoveIt Python RRTConnect ç¤ºä¾‹
import moveit_commander
import geometry_msgs.msg as geometry_msgs

moveit_commander.roscpp_initialize([])
robot = moveit_commander.RobotCommander()
group = moveit_commander.MoveGroupCommander("manipulator")

## è®¾ç½®è§„åˆ’å™¨
group.set_planner_id("RRTConnectkConfigDefault")
group.set_num_planning_attempts(10)
group.set_planning_time(2.0)

## ç›®æ ‡
pose_goal = geometry_msgs.Pose()
pose_goal.position.x = 0.4
pose_goal.position.y = 0.2
pose_goal.position.z = 0.3
pose_goal.orientation.w = 1.0

group.set_pose_target(pose_goal)
plan = group.go(wait=True)
group.stop()
group.clear_pose_targets()
```

```python
## ä½¿ç”¨ ompl Python API è‡ªå®šä¹‰ RRT*
import ompl.base as ob
import ompl.geometric as og

def is_state_valid(space_information, state):
    # TODO: è°ƒç”¨ç¢°æ’æ£€æµ‹
    return True

space = ob.RealVectorStateSpace(7)  # 7 DoF
bounds = ob.RealVectorBounds(7)
bounds.setLow(-3.14)
bounds.setHigh(3.14)
space.setBounds(bounds)

si = ob.SpaceInformation(space)
si.setStateValidityChecker(ob.StateValidityCheckerFn(
    lambda state: is_state_valid(si, state)))
si.setup()

problem = ob.ProblemDefinition(si)
start = ob.State(space)
goal = ob.State(space)
## ... è®¾ç½® start/goal ...
problem.setStartAndGoalStates(start, goal)

planner = og.RRTstar(si)
planner.setRange(0.1)  # æ‰©å±•æ­¥é•¿
planner.setProblemDefinition(problem)
planner.setup()

if planner.solve(5.0):
    path = problem.getSolutionPath()
    path.interpolate(100)
```

---

## 6. é¢è¯• Q&A

### Q1: é‡‡æ ·å¼è§„åˆ’ vs è½¨è¿¹ä¼˜åŒ–ï¼Ÿ

- é‡‡æ ·å¼ï¼šæ˜“æ‰¾åˆ°å¯è¡Œè§£ï¼Œé€‚åˆå¤æ‚éšœç¢ç©ºé—´ï¼›ä½†è·¯å¾„æŠ–åŠ¨ï¼Œéœ€è¦åå¤„ç†ã€‚
- è½¨è¿¹ä¼˜åŒ–ï¼šå¯ç›´æ¥è€ƒè™‘åŠ¨åŠ›å­¦å’Œæˆæœ¬ï¼Œä½†å¯¹åˆå€¼æ•æ„Ÿï¼Œå¯èƒ½é™·å…¥å±€éƒ¨æœ€ä¼˜ã€‚
- å·¥ç¨‹å®è·µï¼šå…ˆé‡‡æ ·æ‰¾å¯è¡Œè·¯å¾„ï¼Œå†ç”¨ TrajOpt å¹³æ»‘ã€‚

### Q2: å¦‚ä½•å¤„ç†åŠ¨æ€éšœç¢ï¼Ÿ

1. ä½¿ç”¨ **åœ¨çº¿ Re-planning** (RRT Replan) æˆ– **MPC**ã€‚
2. ç»´æŠ¤ **å æ®æ …æ ¼** / **ESDF** å®æ—¶æ›´æ–°ç¢°æ’ä¿¡æ¯ã€‚
3. çŸ­æ—¶ MPC + é•¿æœŸè§„åˆ’ç»“åˆï¼šå…¨å±€è·¯å¾„ + å±€éƒ¨é¿éšœã€‚

### Q3: é«˜ç»´æœºæ¢°è‡‚å¦‚ä½•åŠ é€Ÿè§„åˆ’ï¼Ÿ

- åˆç†çš„ **joint limits** ä¸ **sampling bounds**ã€‚
- ä½¿ç”¨ **IK è§£** ä½œä¸ºèµ·ç‚¹ï¼Œå‡å°‘æœç´¢ç©ºé—´ã€‚
- **Task Space RRT**: åœ¨ç¬›å¡å°”ç©ºé—´é‡‡æ ·ï¼Œå†æŠ•å½±å› joint spaceã€‚
- åˆ©ç”¨ GPU (cuRobo) å¹¶è¡Œæ±‚è§£ã€‚

### Q4: CHOMP ä¸ºä»€ä¹ˆéœ€è¦â€œéšœç¢åŠ¿èƒ½â€ï¼Ÿ

- é€šè¿‡è·ç¦»åœºå®šä¹‰åŠ¿èƒ½ \( U(q) = \phi(d(q)) \)ï¼Œåœ¨è½¨è¿¹ä¼˜åŒ–æ—¶é€šè¿‡æ¢¯åº¦è¿œç¦»éšœç¢ã€‚
- å¸¸ç”¨ SDF (Signed Distance Field) æˆ– ESDF ä½œä¸ºè·ç¦»è®¡ç®—ã€‚

### Q5: å¦‚ä½•ä¿è¯è§„åˆ’ç»“æœå¯æ‰§è¡Œï¼Ÿ

- **æ—¶é—´å‚æ•°åŒ–**: TOTG / Iterative Parabolic Time Parameterizationã€‚
- **é€Ÿåº¦/åŠ é€Ÿåº¦é™åˆ¶**: ç¡®ä¿å…³èŠ‚å‘½ä»¤ä¸è¶…é™ã€‚
- **è½¨è¿¹è·Ÿè¸ªæ§åˆ¶**: Feedforward + PD/MPCã€‚

---

## ğŸ“š æ¨èé˜…è¯»

- *Principles of Robot Motion* (MIT Press)
- OMPL: [ompl.kavrakilab.org](https://ompl.kavrakilab.org/)
- MoveIt Tutorials: [moveit.picknik.ai](https://moveit.picknik.ai/)
- NVIDIA cuRobo: [github.com/NVlabs/curobo](https://github.com/NVlabs/curobo)

---



\newpage

# ç¬¬å…­éƒ¨åˆ†ï¼šå‰æ²¿æ¨¡å‹è§£æ


\newpage

# ç¬¬24ç«  è§¦è§‰ VLA


åœ¨æœºå™¨äººæ“ä½œä¸­ï¼Œè§†è§‰ (Vision) å¾€å¾€ä¸è¶³ä»¥å®Œæˆæ‰€æœ‰ä»»åŠ¡ã€‚å¯¹äºæ¥è§¦å¯†é›†å‹ (Contact-rich) ä»»åŠ¡ï¼ˆå¦‚åœ¨é»‘æš—ä¸­æ‘¸ç´¢ç‰©ä½“ã€ç²¾å¯†è£…é…ã€åˆ¤æ–­ç‰©ä½“æè´¨ï¼‰ï¼Œ**è§¦è§‰ (Tactile)** æ˜¯ä¸å¯æˆ–ç¼ºçš„æ¨¡æ€ã€‚

2024-2025 å¹´ï¼ŒVLA é¢†åŸŸå¼€å§‹çˆ†å‘ "Vision-Tactile-Language-Action" çš„ç ”ç©¶ï¼Œæ—¨åœ¨èµ‹äºˆæœºå™¨äºº"è§¦è§‰è¯­ä¹‰"ç†è§£èƒ½åŠ›ã€‚

## 1. ä¸ºä»€ä¹ˆéœ€è¦è§¦è§‰? (Why Tactile?)
- **è§†è§‰é®æŒ¡ (Occlusion)**: å½“æœºæ¢°æ‰‹æŠ“å–ç‰©ä½“æ—¶ï¼Œæ‰‹æŒä¼šæŒ¡ä½æ‘„åƒå¤´è§†çº¿ã€‚æ­¤æ—¶åªæœ‰è§¦è§‰èƒ½æä¾›åé¦ˆã€‚
- **ç‰©ç†å±æ€§æ„ŸçŸ¥**: è§†è§‰æ— æ³•ç›´æ¥åˆ¤æ–­ç‰©ä½“çš„è½¯ç¡¬ã€æ‘©æ“¦åŠ›ã€é‡é‡ã€‚
- **å¾®ç±³çº§æ§åˆ¶**: è§†è§‰é€šå¸¸æœ‰æ¯«ç±³çº§è¯¯å·®ï¼Œè€Œè§¦è§‰ä¼ æ„Ÿå™¨ (å¦‚ GelSight) å¯ä»¥æä¾›å¾®ç±³çº§çš„çº¹ç†ä¿¡æ¯ã€‚

## 2. æ ¸å¿ƒä¼ æ„Ÿå™¨æŠ€æœ¯

### 2.1 GelSight
MIT å¼€å‘çš„é«˜åˆ†è¾¨ç‡å…‰å­¦è§¦è§‰ä¼ æ„Ÿå™¨ï¼Œæ˜¯è§¦è§‰ VLA ç ”ç©¶çš„åŸºçŸ³ã€‚

| å‚æ•° | è§„æ ¼ |
| :--- | :--- |
| åˆ†è¾¨ç‡ | ~40 å¾®ç±³ |
| å°ºå¯¸ | çº¦ 30Ã—30mm æ„ŸçŸ¥é¢ |
| è¾“å‡º | RGB å›¾åƒ + æ·±åº¦å›¾ |
| å¸§ç‡ | 30-60 FPS |
| ä»·æ ¼ | ~$500-1000 |

**åŸç†**: å†…éƒ¨æœ‰å¼¹æ€§ä½“ (Elastomer) + LED å…‰æº + æ‘„åƒå¤´ã€‚å½“ç‰©ä½“æ¥è§¦å¼¹æ€§ä½“æ—¶ï¼Œè¡¨é¢å˜å½¢æ”¹å˜å…‰ç…§åˆ†å¸ƒï¼Œæ‘„åƒå¤´æ•æ‰è¿™äº›å˜åŒ–é‡å»ºæ¥è§¦å‡ ä½•ã€‚

### 2.2 DIGIT (Meta AI)
> **è®ºæ–‡**: [DIGIT: A Novel Design for a Low-Cost Compact High-Resolution Tactile Sensor](https://arxiv.org/abs/2005.14679) (RSS 2020)
> **å®˜ç½‘**: [digit.ml](https://digit.ml)

Meta AI (FAIR) å¼€å‘çš„**å¼€æº**ç´§å‡‘å‹è§¦è§‰ä¼ æ„Ÿå™¨ï¼Œä¸“ä¸ºæœºå™¨äººæ‰‹æŒ‡è®¾è®¡ã€‚

**ä»£ç åº“**:

| ä»“åº“ | è¯´æ˜ | é“¾æ¥ |
| :--- | :--- | :--- |
| **digit-interface** | Python é©±åŠ¨æ¥å£ | [GitHub](https://github.com/facebookresearch/digit-interface) |
| **TACTO** | DIGIT ä»¿çœŸå™¨ (PyBullet) | [GitHub](https://github.com/facebookresearch/tacto) |
| **PyTouch** | è§¦è§‰ ML åº“ | [GitHub](https://github.com/facebookresearch/PyTouch) |
| **Sparsh** | é¢„è®­ç»ƒè§¦è§‰æ¨¡å‹ | [GitHub](https://github.com/facebookresearch/sparsh) |
| **3DCal** | è§¦è§‰ä¼ æ„Ÿå™¨æ ‡å®šå·¥å…· | [GitHub](https://github.com/3DCal/3DCal) |

| å‚æ•° | è§„æ ¼ |
| :--- | :--- |
| åˆ†è¾¨ç‡ | 640Ã—480 RGB |
| å°ºå¯¸ | **20Ã—27Ã—18mm** (æç´§å‡‘) |
| é‡é‡ | ~20g |
| å¸§ç‡ | 60 FPS |
| æ¥å£ | USB-C |
| æˆæœ¬ | **~$15** (å¼€æº BOM) |

**ä¼˜åŠ¿**:
- **å¼€æºç¡¬ä»¶**: å®Œæ•´ CAD è®¾è®¡ã€åˆ¶é€ æŒ‡å—å…¬å¼€ï¼Œå¯è‡ªè¡Œåˆ¶ä½œ
- **ç´§å‡‘è®¾è®¡**: ä¸“ä¸ºæœºå™¨äººæ‰‹æŒ‡ä¼˜åŒ–ï¼Œå¯å®‰è£…åœ¨ Allegro Hand ç­‰çµå·§æ‰‹ä¸Š
- **ä½æˆæœ¬**: ææ–™æˆæœ¬ä»… $15ï¼Œé€‚åˆå¤§è§„æ¨¡éƒ¨ç½²
- **é«˜å¸§ç‡**: 60 FPS æ”¯æŒå®æ—¶æ§åˆ¶
- **é¢„è®­ç»ƒæ¨¡å‹**: Meta æä¾›è®­ç»ƒå¥½çš„è§¦è§‰è¡¨å¾æ¨¡å‹ (å¦‚ T3, Sparsh)
- **é€‚é…æ¥å£**: å®˜æ–¹æä¾› PyTorch æ¥å£ã€ROS é©±åŠ¨ï¼Œç”Ÿæ€å®Œå–„

**å±€é™æ€§**:
- **ä¸€è‡´æ€§å·®**: æ¯ä¸ªä¼ æ„Ÿå™¨çš„å…‰å­¦ç‰¹æ€§ç•¥æœ‰ä¸åŒï¼Œéœ€è¦å•ç‹¬æ ‡å®š
- **æ— åŠ›è¾“å‡º**: åªæä¾›å½¢å˜å›¾åƒï¼Œ**ä¸ç›´æ¥è¾“å‡ºæ¥è§¦åŠ›** (éœ€ç®—æ³•ä¼°è®¡)
- **å¼¹æ€§ä½“ç£¨æŸ**: é•¿æ—¶é—´ä½¿ç”¨åå¼¹æ€§ä½“ä¼šè€åŒ–

**ä¸ GelSight å¯¹æ¯”**:

| ç‰¹æ€§ | GelSight | DIGIT |
| :--- | :--- | :--- |
| åˆ†è¾¨ç‡ | æ›´é«˜ (~40Î¼m) | è¾ƒä½ (åƒç´ çº§) |
| å°ºå¯¸ | è¾ƒå¤§ | **æç´§å‡‘** |
| æˆæœ¬ | é«˜ ($500+) | **æä½ ($15)** |
| å¼€æº | éƒ¨åˆ† | **å®Œå…¨å¼€æº** |
| åŠ›è¾“å‡º | å¯ä¼°è®¡ | **æ— ç›´æ¥è¾“å‡º** |
| ä¸€è‡´æ€§ | è¾ƒå¥½ | **ä¼ æ„Ÿå™¨é—´å·®å¼‚å¤§** |
| ç”Ÿæ€ | å­¦æœ¯ä¸ºä¸» | **Meta é¢„è®­ç»ƒæ¨¡å‹** |
| é€‚ç”¨åœºæ™¯ | ç²¾å¯†æ£€æµ‹ã€ç ”ç©¶ | çµå·§æ‰‹ã€å¤§è§„æ¨¡éƒ¨ç½² |

### 2.3 åƒè§‰ GelStereo (Xense Robotics)
> **å…¬å¸**: åƒè§‰æœºå™¨äººç§‘æŠ€ï¼ˆä¸Šæµ·ï¼‰æœ‰é™å…¬å¸ï¼Œæˆç«‹äº 2024 å¹´ 5 æœˆ
> **å®˜ç½‘**: [xense-robotics.com](https://www.xense-robotics.com)

åŸºäº**åŒç›®ç«‹ä½“è§†è§‰ (Binocular Stereo)** çš„é«˜åˆ†è¾¨ç‡å¤šæ¨¡æ€è§¦è§‰ä¼ æ„Ÿå™¨ã€‚

| å‚æ•° | è§„æ ¼ |
| :--- | :--- |
| æ„ŸçŸ¥å¯†åº¦ | **äººç±»æ‰‹æŒ‡ 800 å€** |
| æ¨¡æ€ | ä¸‰ç»´åŠ›è§‰ + åŠ¨è§‰ + æ»‘è§‰ + å½¢è²Œ |
| åŸç† | åŒç›®ç›¸æœº + å¼¹æ€§ä½“ |
| è¾“å‡º | 3D ç‚¹äº‘ + åŠ›åˆ†å¸ƒå›¾ |

**æ ¸å¿ƒæŠ€æœ¯ - GelStereo åŸç†**:

```
        å·¦ç›¸æœº                å³ç›¸æœº
           \                  /
            \   å¼¹æ€§ä½“å˜å½¢   /
             \     â†“       /
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ æ¥è§¦åŒºåŸŸ â”‚  â† ç‰©ä½“æ¥è§¦
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
           åŒç›®è§†å·® â†’ 3D é‡å»º
```

1. **åŒç›®ç«‹ä½“åŒ¹é…**: ä¸¤ä¸ªç›¸æœºä»ä¸åŒè§’åº¦æ‹æ‘„å¼¹æ€§ä½“è¡¨é¢ï¼Œé€šè¿‡è§†å·®è®¡ç®—æ·±åº¦
2. **äºšåƒç´ ç²¾åº¦**: ç›¸æ¯”å•ç›® GelSightï¼ŒåŒç›®å¯å®ç°æ›´ç²¾ç¡®çš„ 3D å½¢è²Œé‡å»º
3. **å®æ—¶æ€§**: æ— éœ€å¤æ‚çš„å…‰åº¦ç«‹ä½“ (Photometric Stereo) ç®—æ³•ï¼Œé€Ÿåº¦æ›´å¿«

**ä¸ GelSight å¯¹æ¯”**:

| ç‰¹æ€§ | GelSight (å•ç›®) | GelStereo (åŒç›®) |
| :--- | :--- | :--- |
| 3D é‡å»ºæ–¹æ³• | å…‰åº¦ç«‹ä½“ (éœ€å¤šè‰²å…‰) | **ç«‹ä½“åŒ¹é…** (å•è‰²å³å¯) |
| è®¡ç®—å¤æ‚åº¦ | é«˜ | **ä½** |
| å…‰ç…§è¦æ±‚ | RGB ä¸‰è‰²å…‰ | å•è‰²å…‰ |
| æ·±åº¦ç²¾åº¦ | ä¾èµ–æ ‡å®š | **å‡ ä½•çº¦æŸæ›´å¼º** |

---

### 2.4 æˆ´ç›Ÿ DM-Tac (DMRobot)
> **å…¬å¸**: æˆ´ç›Ÿæœºå™¨äººï¼Œä¸“æ³¨è§†è§¦è§‰æŠ€æœ¯
> **å®˜ç½‘**: [dmrobot.com](https://www.dmrobot.com)

å…¨çƒé¦–æ¬¾**å¤šç»´é«˜åˆ†è¾¨ç‡é«˜é¢‘ç‡**è§†è§¦è§‰ä¼ æ„Ÿå™¨ç³»åˆ—ã€‚

#### DM-Tac W ä¼ æ„Ÿå™¨

| å‚æ•° | è§„æ ¼ |
| :--- | :--- |
| æ„ŸçŸ¥å¯†åº¦ | **4 ä¸‡å•å…ƒ/cmÂ²** (äººç±» 240/cmÂ²) |
| æ¨¡æ€ | å½¢è²Œ + çº¹ç† + è½¯ç¡¬ + æ»‘ç§» + ä¸‰ç»´åŠ› |
| è€ä¹…æ€§ | **500 ä¸‡æ¬¡æŒ‰å‹æµ‹è¯•** |
| åšåº¦ | æ¯«ç±³çº§ |

**æ ¸å¿ƒæŠ€æœ¯ - å•è‰²å…‰è§†è§¦è§‰**:

ä¼ ç»Ÿ GelSight ä½¿ç”¨ **RGB ä¸‰è‰²å…‰** + å…‰åº¦ç«‹ä½“ (Photometric Stereo) é‡å»º 3D å½¢è²Œã€‚æˆ´ç›Ÿé‡‡ç”¨**å•è‰²å…‰**æ–¹æ¡ˆï¼Œç®€åŒ–ç¡¬ä»¶è®¾è®¡ï¼š

| æ–¹æ¡ˆ | ä¸‰è‰²å…‰ (RGB) | å•è‰²å…‰ (æˆ´ç›Ÿ) |
| :--- | :--- | :--- |
| å…‰æº | çº¢/ç»¿/è“ LED (å¤šè§’åº¦) | å•è‰² LED |
| 3D é‡å»º | å…‰åº¦ç«‹ä½“ (è§£æè§£) | æ•°æ®é©±åŠ¨ / å­¦ä¹ æ–¹æ³• |
| ç¡¬ä»¶å¤æ‚åº¦ | éœ€ç²¾ç¡® LED å¸ƒå±€ | **æ›´ç®€å•** |
| æ ‡å®š | éœ€æ ‡å®š RGB é€šé“ | **æ›´ç®€å•** |

**ä¼˜åŠ¿**:
- **ç¡¬ä»¶ç®€åŒ–**: å‡å°‘ LED æ•°é‡å’Œå¸ƒå±€è¦æ±‚
- **å·¥ä¸šçº§è€ç”¨**: 500 ä¸‡æ¬¡æŒ‰å‹ï¼Œè¿œè¶…å­¦æœ¯çº§ä¼ æ„Ÿå™¨
- **é«˜å¯†åº¦**: 4 ä¸‡å•å…ƒ/cmÂ² çš„é«˜å¯†åº¦è§¦ç‚¹

> æ³¨ï¼šå•è‰²å…‰æŸå¤±äº†å…‰åº¦ç«‹ä½“çš„å¤šæ–¹å‘å…‰ç…§ä¿¡æ¯ï¼Œéœ€ä¾èµ–å­¦ä¹ ç®—æ³•è¡¥å¿ã€‚

#### DM-Hand1 çµå·§æ‰‹
é›†æˆ DM-Tac ä¼ æ„Ÿå™¨çš„äº”æŒ‡çµå·§æ‰‹ï¼Œæ¯ä¸ªæŒ‡å°–éƒ½æœ‰è§¦è§‰æ„ŸçŸ¥ã€‚

#### DM-EXton é¥æ“ä½œç³»ç»Ÿ
ç©¿æˆ´å¼æ•°æ®é‡‡é›†è®¾å¤‡ï¼Œç”¨äºæ”¶é›†é«˜è´¨é‡äººç±»ç¤ºæ•™æ•°æ®ï¼Œä¸ºæ¨¡ä»¿å­¦ä¹ æä¾›è§¦è§‰æ ‡æ³¨ã€‚

---

### 2.5 å…¶ä»–è§¦è§‰ä¼ æ„Ÿå™¨
- **TacTip**: Bristol å¤§å­¦ï¼ŒåŸºäºç”Ÿç‰©å¯å‘çš„è½¯æ€§è§¦è§‰ä¼ æ„Ÿå™¨
- **BioTac**: SynTouch å…¬å¸ï¼Œå¤šæ¨¡æ€ä¼ æ„Ÿå™¨ (å‹åŠ› + æ¸©åº¦ + æŒ¯åŠ¨)
- **ReSkin**: Meta AIï¼Œç£æ€§è–„è†œè§¦è§‰ä¼ æ„Ÿå™¨ï¼Œå¯è´´é™„äºä»»æ„è¡¨é¢
- **Taxim**: CMUï¼ŒåŸºäºæœ‰é™å…ƒä»¿çœŸçš„è§¦è§‰ä¼ æ„Ÿå™¨

## 3. æœ€æ–°æ¨¡å‹è¿›å±• (2024-2025)

### 3.1 Tactile-VLA / TVL (ICML 2024)
> **è®ºæ–‡**: [A Touch, Vision, and Language Dataset for Multimodal Alignment](https://arxiv.org/abs/2402.13232)
> **ä½œè€…**: Max Fu, Gaurav Datta, et al. (UC Berkeley)
> **ä»£ç **: [GitHub - Max-Fu/tvl](https://github.com/Max-Fu/tvl)

**æ ¸å¿ƒè´¡çŒ®**: é¦–ä¸ªå¤§è§„æ¨¡è§¦è§‰-è§†è§‰-è¯­è¨€å¯¹é½æ•°æ®é›†å’ŒåŸºå‡†æ¨¡å‹ã€‚

#### æ•°æ®é›† (TVL Dataset)

| ç»Ÿè®¡é‡ | æ•°å€¼ |
| :--- | :--- |
| æ ·æœ¬æ•° | **44,000** ä¸‰å…ƒç»„ |
| æè´¨ç§ç±» | 100+ ç§ |
| ä¼ æ„Ÿå™¨ | GelSight Mini |
| æ ‡æ³¨ç±»å‹ | è‡ªç„¶è¯­è¨€æè¿° |

**æ•°æ®ç¤ºä¾‹**:
```
è§¦è§‰å›¾åƒ: [GelSight å‹ç—•å›¾]
è§†è§‰å›¾åƒ: [ç‰©ä½“ RGB å›¾]
è¯­è¨€æè¿°: "The surface feels rough and rigid, like sandpaper"
```

**æ•°æ®é‡‡é›†æµç¨‹**:
1. æœºå™¨äººç”¨ GelSight ä¼ æ„Ÿå™¨æ¥è§¦ç‰©ä½“è¡¨é¢
2. åŒæ—¶æ‹æ‘„ç‰©ä½“çš„ RGB å›¾åƒ
3. äººç±»æ ‡æ³¨å‘˜ç”¨è‡ªç„¶è¯­è¨€æè¿°è§¦è§‰æ„Ÿå—

#### æ¨¡å‹æ¶æ„è¯¦è§£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TVL æ¨¡å‹æ¶æ„                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚   Vision Image â”€â”€â†’ CLIP ViT-L/14 â”€â”€â†’ [CLS] Token       â”‚
â”‚                         â†“                               â”‚
â”‚                   Vision Embedding (768d)               â”‚
â”‚                         â†“                               â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                   â”‚  Projection â”‚ (MLP)                 â”‚
â”‚                   â”‚    Layer    â”‚                       â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                         â†“                               â”‚
â”‚                  Joint Embedding Space                  â”‚
â”‚                         â†‘                               â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                   â”‚  Projection â”‚ (MLP)                 â”‚
â”‚                   â”‚    Layer    â”‚                       â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                         â†‘                               â”‚
â”‚                  Tactile Embedding (768d)               â”‚
â”‚                         â†‘                               â”‚
â”‚  Tactile Image â”€â”€â†’ ViT-B/16 (MAE pretrained) â”€â”€â†’ [CLS] â”‚
â”‚                                                         â”‚
â”‚                  Joint Embedding Space                  â”‚
â”‚                         â†“                               â”‚
â”‚                   Cross-Attention                       â”‚
â”‚                         â†“                               â”‚
â”‚                  Language Decoder (GPT-2)               â”‚
â”‚                         â†“                               â”‚
â”‚                 "rough and cold..."                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### è®­ç»ƒç­–ç•¥

**Stage 1: Tactile Encoder é¢„è®­ç»ƒ (MAE)**
```python
## éšæœº Mask 75% çš„ Tactile Patches
masked_patches = random_mask(tactile_image, ratio=0.75)
## é‡å»ºè¢« Mask çš„ Patches
reconstruction_loss = MSE(decoder(encoder(masked_patches)), original)
```

**Stage 2: å¯¹æ¯”å­¦ä¹ å¯¹é½ (Contrastive Alignment)**


$$
L_{align} = -log \frac{exp(sim(t_i, v_i) / Ï„)}{\sum_{j} exp(sim(t_i, v_j) / Ï„)}
$$


- `t_i`: è§¦è§‰ Embedding
- `v_i`: å¯¹åº”çš„è§†è§‰ Embedding
- `Ï„`: æ¸©åº¦å‚æ•° (0.07)

**Stage 3: è¯­è¨€ç”Ÿæˆå¾®è°ƒ**
```python
## è§¦è§‰ + è§†è§‰ â†’ è¯­è¨€æè¿°
loss = CrossEntropy(decoder(tactile_emb, vision_emb), text_tokens)
```

#### ä¸‹æ¸¸ä»»åŠ¡ä¸æ€§èƒ½

| ä»»åŠ¡ | æŒ‡æ ‡ | TVL æ€§èƒ½ |
| :--- | :--- | :--- |
| æè´¨åˆ†ç±» | Accuracy | 78.3% |
| è§¦è§‰-è¯­è¨€æ£€ç´¢ | R@1 | 45.2% |
| è§¦è§‰é—®ç­” | BLEU-4 | 32.1 |
| Zero-shot æè´¨è¯†åˆ« | Accuracy | 61.7% |

#### æ ¸å¿ƒæ´å¯Ÿ

1. **è§¦è§‰-è§†è§‰äº’è¡¥**: è§†è§‰æ“…é•¿è¯†åˆ«ç‰©ä½“ç±»åˆ«ï¼Œè§¦è§‰æ“…é•¿åˆ¤æ–­ç‰©ç†å±æ€§
2. **è¯­è¨€ä½œä¸ºæ¡¥æ¢**: è‡ªç„¶è¯­è¨€æè¿°ä½¿è§¦è§‰è¯­ä¹‰å¯è§£é‡Šã€å¯è¿ç§»
3. **MAE é¢„è®­ç»ƒæœ‰æ•ˆ**: è§¦è§‰å›¾åƒçš„çº¹ç†ç‰¹å¾é€‚åˆ Masked Autoencoder

**æ„ä¹‰**: ä¸º VLA æä¾›äº†è§¦è§‰è¯­ä¹‰ç†è§£çš„åŸºç¡€ï¼Œä½¿æœºå™¨äººèƒ½å¤Ÿ"ç”¨è¯­è¨€æè¿°è§¦è§‰"ã€‚

---

### 3.2 VLA-Touch (2025)
> **è®ºæ–‡**: [VLA-Touch: Enhancing Generalist Robot Policies with Dual-Level Tactile Feedback](https://arxiv.org/abs/2502.xxxxx)
> **æ ¸å¿ƒæ€æƒ³**: åŒå±‚åé¦ˆæœºåˆ¶ (Dual-level Feedback)ã€‚

- **èƒŒæ™¯**: ç°æœ‰çš„ VLA (å¦‚ RT-2) ç¼ºä¹è§¦è§‰é€šé“ã€‚ç›´æ¥å¾®è°ƒå¤§æ¨¡å‹æˆæœ¬å¤ªé«˜ã€‚
- **æ¶æ„ç»†èŠ‚**:
    1.  **High-level Planning (VLM)**:
        - **Tactile Encoder**: ä½¿ç”¨ **ResNet-50** æˆ– **ViT-B** ç¼–ç  GelSight å›¾åƒã€‚
        - **Tactile-Language Model (TLM)**: é¢„è®­ç»ƒä¸€ä¸ª Decoder-only Transformerï¼Œå°†è§¦è§‰ Embedding ç¿»è¯‘æˆè‡ªç„¶è¯­è¨€æè¿° (e.g., "I feel a smooth, hard surface")ã€‚
        - **Prompting**: å°†ç”Ÿæˆçš„è§¦è§‰æè¿°ä½œä¸º Prompt å–‚ç»™ VLM (å¦‚ GPT-4o æˆ– Gemini)ï¼Œè¾…åŠ©å…¶è¿›è¡Œæ¨ç†ã€‚
    2.  **Low-level Control (Diffusion)**:
        - **Fusion**: ä½¿ç”¨ **FiLM (Feature-wise Linear Modulation)** å°†è§¦è§‰ç‰¹å¾æ³¨å…¥åˆ° Diffusion Policy çš„ U-Net ä¸­ã€‚
        - **Action Refinement**: è§¦è§‰ä¿¡å·ä¸»è¦ç”¨äºä¿®æ­£åŠ¨ä½œçš„æœ€åå‡ æ¯«ç±³ (Contact Phase)ï¼Œç¡®ä¿æ¥è§¦åŠ›é€‚ä¸­ã€‚
- **ä¼˜åŠ¿**: æ— éœ€é‡æ–°è®­ç»ƒæ•´ä¸ª VLAï¼Œå³æ’å³ç”¨ã€‚

### 3.3 OmniVTLA (2025)
> **è®ºæ–‡**: [OmniVTLA: A Unified Vision-Tactile-Language-Action Model](https://arxiv.org/abs/2503.xxxxx)
> **æ ¸å¿ƒæ€æƒ³**: ç»Ÿä¸€çš„è§†è§¦è§‰è¯­è¨€åŠ¨ä½œæ¨¡å‹ (Unified Vision-Tactile-Language-Action Model)ã€‚

- **æ¶æ„ç»†èŠ‚**:
    - **Unified Tokenization**:
        - **Vision**: ViT Patch Embeddings.
        - **Tactile**: åŒæ ·ä½¿ç”¨ ViT å¤„ç†è§¦è§‰å›¾åƒï¼Œå°†å…¶ Patch åŒ–ä¸º Tactile Tokensã€‚
        - **Language**: æ–‡æœ¬ Tokenã€‚
    - **Semantic Alignment (Contrastive Learning)**:
        - å…³é”®åˆ›æ–°åœ¨äº**è¯­ä¹‰å¯¹é½**ã€‚å®ƒä¸ä»…å­¦ä¹ è§¦è§‰çš„ç‰©ç†ç‰¹å¾ï¼Œè¿˜å­¦ä¹ è§¦è§‰çš„è¯­ä¹‰æè¿° (e.g., "slippery", "rough")ã€‚
        - **Loss Function**: $\mathcal{L} = \mathcal{L}_{action} + \lambda \mathcal{L}_{align}$ã€‚å…¶ä¸­ $\mathcal{L}_{align}$ æ˜¯ InfoNCE Lossï¼Œæ‹‰è¿‘è§¦è§‰ Embedding ä¸å¯¹åº”çš„æè´¨æè¿°æ–‡æœ¬ Embedding çš„è·ç¦»ã€‚
- **è®­ç»ƒ**: ä½¿ç”¨å¤§è§„æ¨¡çš„å¤šæ¨¡æ€æ•°æ®é›† (åŒ…å«å›¾åƒã€è§¦è§‰å›¾ã€è¯­è¨€æŒ‡ä»¤ã€åŠ¨ä½œ)ã€‚
- **èƒ½åŠ›**: èƒ½å¤Ÿæ‰§è¡Œ "Pick up the softest object" (æŠ“èµ·æœ€è½¯çš„ç‰©ä½“) è¿™ç§éœ€è¦è·¨æ¨¡æ€æ¨ç†çš„ä»»åŠ¡ã€‚

---

### 3.4 ğŸ”¥ SaTA: ç©ºé—´é”šå®šè§¦è§‰æ„ŸçŸ¥ (Sharpa + æ¸…å + æ­¦å¤§, 2025)

> **è®ºæ–‡**: [SaTA: Spatially-anchored Tactile Awareness for Dexterous Manipulation](https://arxiv.org/abs/2510.14647)
> **æœºæ„**: Sharpa (æ–°åŠ å¡ AI æœºå™¨äººå…¬å¸) + æ¸…åå¤§å­¦ + æ­¦æ±‰å¤§å­¦
> **æ ¸å¿ƒçªç ´**: **é¦–æ¬¡å°†è§¦è§‰ä¿¡å·é”šå®šåˆ°æœºæ¢°æ‰‹è‡ªèº«åæ ‡ç³»**ï¼Œå®ç°è§†è§‰é®æŒ¡ä¸‹çš„äºšæ¯«ç±³çº§ç²¾åº¦"ç›²æ“ä½œ"

#### 3.4.1 æ ¸å¿ƒé—®é¢˜

ä¼ ç»Ÿè§¦è§‰æ–¹æ³•å°†è§¦è§‰å¤„ç†ä¸ºç®€å•çš„å›¾åƒæˆ–å±€éƒ¨çº¹ç†ï¼Œ**ç¼ºä¹ç©ºé—´è¯­ä¹‰**ï¼š
- æ¨¡å‹ä¸çŸ¥é“"æ¥è§¦å‘ç”Ÿåœ¨å“ªé‡Œ"
- æ— æ³•åˆ¤æ–­"è§’åº¦åäº†å¤šå°‘"
- ä¸æ¸…æ¥š"ä¸‹ä¸€æ­¥åŠ¨ä½œåº”è¯¥å¾€å“ªä¸ªæ–¹å‘åš"

**ç±»æ¯”**: äººç±»é—­çœ¼æ’å……ç”µçº¿æ—¶ï¼Œèƒ½å‡­"æ‰‹æ„Ÿ"åˆ¤æ–­æ’å¤´å’Œæ’å­”çš„ä½ç½®å…³ç³»ï¼Œè¿™ä¾èµ–äºè§¦è§‰ä¸ç©ºé—´æ–¹ä½æ„Ÿçš„ç»“åˆã€‚SaTA é¦–æ¬¡è®©æœºå™¨äººæ‹¥æœ‰è¿™ç§èƒ½åŠ›ã€‚

#### 3.4.2 æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SaTA æ¶æ„: ç©ºé—´é”šå®šè§¦è§‰æ„ŸçŸ¥                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚   è§¦è§‰å›¾åƒ (320Ã—240)      æŒ‡å°– 6D ä½å§¿          æ—¶é—´æ­¥              â”‚
â”‚   [B, 5, H, W, 3]        [B, 5, 6]             t                   â”‚
â”‚   (5ä¸ªæŒ‡å°–ä¼ æ„Ÿå™¨)         (æ‰‹åæ ‡ç³»)                                 â”‚
â”‚        â”‚                     â”‚                  â”‚                   â”‚
â”‚        â–¼                     â–¼                  â–¼                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚   â”‚ViT/CNN  â”‚          â”‚  å‚…é‡Œå¶ç¼–ç    â”‚   â”‚Sinusoidalâ”‚             â”‚
â”‚   â”‚Encoder  â”‚          â”‚ (å¤šå°ºåº¦6D)   â”‚   â”‚Embedding â”‚             â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜             â”‚
â”‚        â”‚                      â”‚                 â”‚                   â”‚
â”‚        â–¼                      â–¼                 â”‚                   â”‚
â”‚   Tactile                Position              â”‚                   â”‚
â”‚   Features               Encoding              â”‚                   â”‚
â”‚   [B, 5, D]              [B, 5, D]             â”‚                   â”‚
â”‚        â”‚                      â”‚                 â”‚                   â”‚
â”‚        â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚                   â”‚
â”‚        â”‚         â”‚                              â”‚                   â”‚
â”‚        â–¼         â–¼                              â”‚                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚                   â”‚
â”‚   â”‚         FiLM è°ƒåˆ¶å±‚                       â”‚   â”‚                   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚                   â”‚
â”‚   â”‚  â”‚ Î³ = MLP(pos_enc)                â”‚    â”‚â—€â”€â”€â”˜                   â”‚
â”‚   â”‚  â”‚ Î² = MLP(pos_enc)                â”‚    â”‚                       â”‚
â”‚   â”‚  â”‚                                 â”‚    â”‚                       â”‚
â”‚   â”‚  â”‚ out = Î³ * tactile_feat + Î²     â”‚    â”‚                       â”‚
â”‚   â”‚  â”‚       â†‘                         â”‚    â”‚                       â”‚
â”‚   â”‚  â”‚  ç©ºé—´ä¿¡æ¯è°ƒåˆ¶è§¦è§‰ç‰¹å¾            â”‚    â”‚                       â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                    â”‚                                                â”‚
â”‚                    â–¼                                                â”‚
â”‚            ç©ºé—´é”šå®šè§¦è§‰ Token                                        â”‚
â”‚            (å…·æœ‰ç©ºé—´è¯­ä¹‰çš„è§¦è§‰è¡¨ç¤º)                                   â”‚
â”‚                    â”‚                                                â”‚
â”‚                    â–¼                                                â”‚
â”‚            Policy Network (åŠ¨ä½œé¢„æµ‹)                                 â”‚
â”‚                    â”‚                                                â”‚
â”‚                    â–¼                                                â”‚
â”‚              ğŸ¦¾ ç²¾ç»†åŠ¨ä½œ                                             â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.4.3 ä¸‰å¤§æ ¸å¿ƒè®¾è®¡

| è®¾è®¡ | æŠ€æœ¯ç»†èŠ‚ | ä½œç”¨ |
| :--- | :--- | :--- |
| **1. æ‰‹åæ ‡ç³»é”šå®š** | è§¦è§‰é”šå®šåˆ°æ‰‹çš„ **URDF åæ ‡ç³»** (è…•éƒ¨å‚è€ƒç³»)ï¼Œè€Œéä¸–ç•Œåæ ‡ç³» | çµå·§æ“ä½œçš„æˆåŠŸå–å†³äºæ‰‹å†…çš„ç›¸å¯¹å‡ ä½•å…³ç³»ï¼Œæ— è®ºæ‰‹è…•å¦‚ä½•ç§»åŠ¨ï¼Œå‡ ä½•çº¦æŸä¿æŒä¸å˜ |
| **2. å‚…é‡Œå¶ä½ç½®ç¼–ç ** | å¯¹å®Œæ•´ **6D ä½å§¿** (3D ä½ç½® + 3D æ—‹è½¬) è¿›è¡Œ**å¤šå°ºåº¦ç¼–ç ** | æ¨¡å‹æ—¢èƒ½è¿›è¡Œç²—ç²’åº¦çš„å¯¹é½åˆ¤æ–­ï¼Œåˆèƒ½å®ç°æ¯«ç±³çº§çš„å¾®è°ƒæ“ä½œ |
| **3. FiLM è°ƒåˆ¶** | ä½¿ç”¨ **Feature-wise Linear Modulation** è®©ç©ºé—´ä¿¡æ¯è°ƒåˆ¶è§¦è§‰ç‰¹å¾å¤„ç† | æ¯ä¸ªè§¦è§‰æµ‹é‡éƒ½æˆä¸ºæ—¢åŒ…å«æ„ŸçŸ¥ä¿¡æ¯åˆå…·æœ‰ç©ºé—´è¯­ä¹‰çš„ Token |

**å‚…é‡Œå¶ä½ç½®ç¼–ç å…¬å¼**:


$$
\gamma(p) = [\sin(2^0 \pi p), \cos(2^0 \pi p), ..., \sin(2^{L-1} \pi p), \cos(2^{L-1} \pi p)]
$$


å…¶ä¸­ $p$ æ˜¯ 6D ä½å§¿å‘é‡ï¼Œ$L$ æ˜¯é¢‘ç‡çº§æ•°ã€‚å¤šå°ºåº¦ç¼–ç ä½¿å¾—æ¨¡å‹å¯¹ä¸åŒç²¾åº¦çš„ç©ºé—´ä¿¡æ¯éƒ½æ•æ„Ÿã€‚

**FiLM è°ƒåˆ¶å…¬å¼**:


$$
\text{FiLM}(x, \gamma, \beta) = \gamma \cdot x + \beta
$$


å…¶ä¸­ $\gamma, \beta$ ç”±ä½ç½®ç¼–ç é€šè¿‡ MLP ç”Ÿæˆï¼Œ$x$ æ˜¯è§¦è§‰ç‰¹å¾ã€‚

#### 3.4.4 ç¡¬ä»¶é…ç½®

| ç»„ä»¶ | è§„æ ¼ |
| :--- | :--- |
| **çµå·§æ‰‹** | SharpaWaveï¼Œ**22 è‡ªç”±åº¦** |
| **è§¦è§‰ä¼ æ„Ÿå™¨** | æ¯æŒ‡å°– 1 ä¸ªè§†è§‰è§¦è§‰ä¼ æ„Ÿå™¨ |
| **è§¦è§‰åˆ†è¾¨ç‡** | **320Ã—240** @ 30Hz |
| **æ§åˆ¶é¢‘ç‡** | 30 Hz |

#### 3.4.5 å®éªŒä»»åŠ¡ä¸ç»“æœ

| ä»»åŠ¡ | éš¾ç‚¹ | SaTA æˆåŠŸç‡ | æœ€å¼ºåŸºçº¿ | æå‡ |
| :--- | :--- | :--- | :--- | :--- |
| **è‡ªç”±ç©ºé—´ USB-C æ’å…¥** | åŒæ‰‹åè°ƒã€ç©ºä¸­å¯¹å‡†ã€è§†è§‰å®Œå…¨é®æŒ¡ | **35%** | ~0% | N/A |
| **æ‰‘å…‹ç‰Œå±•å¼€** | ç²¾ç¡®ä¾§å‘åŠ›æ§åˆ¶ï¼Œé˜²æ­¢å¼¯æŠ˜ | **95%** | 65% | +30% |
| **ç¯æ³¡å®‰è£…** | å‚ç›´å¯¹å‡†ã€æ—‹å…¥åŠ›æ§åˆ¶ | **100%** | 70% | +30% |
| **å¹³å‡** | - | **76.7%** | 46.7% | **+30%** |

**å…³é”®æŒ‡æ ‡**:
- **é¦–æ¬¡æ¥è§¦æˆåŠŸç‡ (FC)**: SaTA 48.3% vs åŸºçº¿ 25%
- **å¹³å‡å®Œæˆæ—¶é—´**: ç¼©çŸ­ **28%** (æ›´å°‘çš„åå¤è¯•æ¢)

#### 3.4.6 åŸºçº¿å¯¹æ¯”

| æ–¹æ³• | æè¿° | é—®é¢˜ |
| :--- | :--- | :--- |
| **Vision Only** | çº¯è§†è§‰æ–¹æ³• | è§†è§‰é®æŒ¡æ—¶å®Œå…¨å¤±æ•ˆ |
| **Tactile-Flat** | è§¦è§‰ä½œä¸ºå¹³é¢å›¾åƒ | æ— ç©ºé—´è¯­ä¹‰ï¼Œæ— æ³•æ¨ç†ä½ç½®å…³ç³» |
| **Tactile-Global** | è§¦è§‰é”šå®šåˆ°ä¸–ç•Œåæ ‡ç³» | æ‰‹è…•ç§»åŠ¨æ—¶å‡ ä½•çº¦æŸæ”¹å˜ |
| **SaTA** | è§¦è§‰é”šå®šåˆ°æ‰‹åæ ‡ç³» + FiLM è°ƒåˆ¶ | âœ… ç©ºé—´è¯­ä¹‰å®Œæ•´ |

#### 3.4.7 è§¦è§‰æ„ŸçŸ¥çš„ä¸‰ä¸ªå±‚æ¬¡

è®ºæ–‡æå‡ºäº†çµå·§æ“ä½œä¸­è§¦è§‰æ„ŸçŸ¥çš„æ¸è¿›å±‚æ¬¡ï¼š

```
Level 1: é—¨æ§ä¿¡å· (Gating Signal) - æœ€åŸºç¡€
â”œâ”€â”€ æ£€æµ‹åŠ›çªå˜ä»¥è§¦å‘ç­–ç•¥é˜¶æ®µè½¬æ¢
â”œâ”€â”€ ä¾‹: USB æ’å…¥æ—¶åŠ›å³°å€¼æ ‡å¿—"å¯¹é½â†’æ’å…¥"é˜¶æ®µè½¬æ¢
â””â”€â”€ å®ç°: ç®€å•é˜ˆå€¼æ£€æµ‹

Level 2: å‡ ä½•æ¨ç† (Geometric Reasoning) - SaTA é‡ç‚¹
â”œâ”€â”€ æä¾›é«˜ç²¾åº¦çš„å±€éƒ¨å‡ ä½•ä¿¡æ¯
â”œâ”€â”€ é€šè¿‡ç©ºé—´é”šå®šç»„ç»‡æˆé€‚åˆæ¨ç†çš„ç©ºé—´è¡¨ç¤º
â”œâ”€â”€ è¾¾åˆ°æ¯«ç±³çº§ç²¾åº¦æ§åˆ¶
â””â”€â”€ å®ç°: FiLM + å‚…é‡Œå¶ç¼–ç 

Level 3: åŠ›ä¸»å¯¼æ§åˆ¶ (Force-Dominant Control) - æœ€é«˜çº§
â”œâ”€â”€ ç­–ç•¥å®Œå…¨åŸºäºåŠ›/è§¦è§‰åé¦ˆï¼Œè§†è§‰ä»…æä¾›ç²—ç•¥å¼•å¯¼
â”œâ”€â”€ ä¾‹: ç¬”æ—‹è½¬éœ€è¦æŒç»­çš„åŠ›è°ƒåˆ¶
â””â”€â”€ å®ç°: éœ€è¦çœŸå®åŠ›åé¦ˆçš„è§¦è§‰æ‰‹å¥— æˆ– çœŸå®ä¸–ç•Œ RL
```

#### 3.4.8 æ ¸å¿ƒæ´å¯Ÿä¸æ„ä¹‰

1. **èŒƒå¼è½¬å˜**: ä»"è¢«åŠ¨è§¦è§‰"åˆ°"ç©ºé—´é”šå®šè§¦è§‰"
   - ä¼ ç»Ÿ: è§¦è§‰ = ç¥ç»æœ«æ¢¢ (åªçŸ¥é“"æœ‰æ¥è§¦")
   - SaTA: è§¦è§‰ = è§¦è§‰å¤§è„‘ (çŸ¥é“"åœ¨å“ªé‡Œæ¥è§¦ã€åäº†å¤šå°‘ã€è¯¥æ€ä¹ˆè°ƒ")

2. **åæ ‡ç³»é€‰æ‹©è‡³å…³é‡è¦**:
   - ä¸–ç•Œåæ ‡ç³»: æ‰‹è…•ç§»åŠ¨æ—¶å‡ ä½•çº¦æŸæ”¹å˜ï¼Œæ¨¡å‹éœ€è¦é‡æ–°å­¦ä¹ 
   - **æ‰‹åæ ‡ç³»**: å‡ ä½•çº¦æŸä¸å˜ï¼Œç­–ç•¥å¯è¿ç§»

3. **è®¾è®¡åŸåˆ™é€šç”¨æ€§**: SaTA çš„ç©ºé—´é”šå®šåŸåˆ™å¯è¿ç§»è‡³å…¶ä»–æä¾›å±€éƒ¨æµ‹é‡çš„ä¼ æ„Ÿæ¨¡æ€ (å¦‚æ¥è¿‘è§‰ã€åŠ›è§‰)

#### 3.4.9 ä»£ç å®ç°è¦ç‚¹

```python
import torch
import torch.nn as nn

class FourierPositionEncoding(nn.Module):
    """6D ä½å§¿çš„å‚…é‡Œå¶ä½ç½®ç¼–ç """
    def __init__(self, d_model=256, num_frequencies=10):
        super().__init__()
        self.num_frequencies = num_frequencies
        # é¢‘ç‡: 2^0, 2^1, ..., 2^(L-1)
        self.frequencies = 2.0 ** torch.arange(num_frequencies)
        self.proj = nn.Linear(6 * 2 * num_frequencies, d_model)
    
    def forward(self, pose_6d):
        """
        pose_6d: [B, 5, 6] - 5ä¸ªæŒ‡å°–çš„ 6D ä½å§¿ (3D pos + 3D rot)
        """
        B, N, D = pose_6d.shape
        # å¤šå°ºåº¦ç¼–ç 
        freqs = self.frequencies.to(pose_6d.device)  # [L]
        pose_scaled = pose_6d.unsqueeze(-1) * freqs * torch.pi  # [B, N, 6, L]
        encoding = torch.cat([
            torch.sin(pose_scaled),
            torch.cos(pose_scaled)
        ], dim=-1)  # [B, N, 6, 2L]
        encoding = encoding.flatten(-2)  # [B, N, 6*2L]
        return self.proj(encoding)  # [B, N, d_model]


class FiLMLayer(nn.Module):
    """Feature-wise Linear Modulation"""
    def __init__(self, feature_dim, condition_dim):
        super().__init__()
        self.gamma_net = nn.Linear(condition_dim, feature_dim)
        self.beta_net = nn.Linear(condition_dim, feature_dim)
    
    def forward(self, x, condition):
        """
        x: [B, N, D] - è§¦è§‰ç‰¹å¾
        condition: [B, N, D] - ç©ºé—´ç¼–ç 
        """
        gamma = self.gamma_net(condition)  # ç¼©æ”¾å› å­
        beta = self.beta_net(condition)    # åç§»é‡
        return gamma * x + beta


class SaTAModule(nn.Module):
    """ç©ºé—´é”šå®šè§¦è§‰æ„ŸçŸ¥æ¨¡å—"""
    def __init__(self, tactile_dim=256, d_model=256):
        super().__init__()
        self.tactile_encoder = nn.Sequential(
            nn.Conv2d(3, 64, 7, stride=2, padding=3),
            nn.ReLU(),
            nn.Conv2d(64, 128, 3, stride=2, padding=1),
            nn.ReLU(),
            nn.AdaptiveAvgPool2d(1),
            nn.Flatten(),
            nn.Linear(128, tactile_dim)
        )
        self.pos_encoder = FourierPositionEncoding(d_model)
        self.film = FiLMLayer(tactile_dim, d_model)
    
    def forward(self, tactile_images, fingertip_poses):
        """
        tactile_images: [B, 5, 3, H, W] - 5ä¸ªæŒ‡å°–è§¦è§‰å›¾åƒ
        fingertip_poses: [B, 5, 6] - æ‰‹åæ ‡ç³»ä¸‹çš„ 6D ä½å§¿
        """
        B, N = tactile_images.shape[:2]
        
        # 1. è§¦è§‰ç¼–ç 
        tactile_flat = tactile_images.flatten(0, 1)  # [B*5, 3, H, W]
        tactile_feat = self.tactile_encoder(tactile_flat)  # [B*5, D]
        tactile_feat = tactile_feat.view(B, N, -1)  # [B, 5, D]
        
        # 2. ç©ºé—´ç¼–ç  (é”šå®šåˆ°æ‰‹åæ ‡ç³»)
        pos_enc = self.pos_encoder(fingertip_poses)  # [B, 5, D]
        
        # 3. FiLM è°ƒåˆ¶: ç©ºé—´ä¿¡æ¯è°ƒåˆ¶è§¦è§‰ç‰¹å¾
        spatially_anchored_tactile = self.film(tactile_feat, pos_enc)
        
        return spatially_anchored_tactile  # [B, 5, D]
```

#### 3.4.10 é¢è¯•è€ƒç‚¹

**Q: SaTA ä¸ºä»€ä¹ˆé€‰æ‹©æ‰‹åæ ‡ç³»è€Œä¸æ˜¯ä¸–ç•Œåæ ‡ç³»?**

A: çµå·§æ“ä½œçš„æˆåŠŸå–å†³äº**æ‰‹å†…çš„ç›¸å¯¹å‡ ä½•å…³ç³»** (å¦‚æŒ‡å°–ä¸ç‰©ä½“çš„ç›¸å¯¹ä½ç½®)ï¼Œè€Œéæ‰‹åœ¨ä¸–ç•Œä¸­çš„ç»å¯¹ä½ç½®ã€‚é”šå®šåˆ°æ‰‹åæ ‡ç³»åï¼š
- æ— è®ºæ‰‹è…•å¦‚ä½•ç§»åŠ¨æˆ–æœºæ¢°è‡‚å¦‚ä½•æ‘†æ”¾ï¼Œå®Œæˆä»»åŠ¡çš„å‡ ä½•çº¦æŸå§‹ç»ˆä¸å˜
- ç­–ç•¥å¯åœ¨ä¸åŒä½å§¿ä¸‹å¤ç”¨ï¼Œæ— éœ€é’ˆå¯¹æ¯ä¸ªä½ç½®é‡æ–°å­¦ä¹ 

**Q: FiLM è°ƒåˆ¶çš„ä½œç”¨æ˜¯ä»€ä¹ˆ?**

A: FiLM è®©ç©ºé—´ä¿¡æ¯**ç›´æ¥è°ƒåˆ¶**è§¦è§‰ç‰¹å¾çš„å¤„ç†è¿‡ç¨‹ï¼Œè€Œéç®€å•æ‹¼æ¥ã€‚è¿™ä½¿å¾—ï¼š
- è§¦è§‰çº¹ç†ã€è¾¹ç¼˜æ–¹å‘ã€å‹åŠ›åˆ†å¸ƒç­‰æ¯ä¸ªæµ‹é‡éƒ½**åŒæ—¶å…·æœ‰æ„ŸçŸ¥ä¿¡æ¯å’Œç©ºé—´è¯­ä¹‰**
- ç›¸æ¯” Concatï¼ŒFiLM çš„æ¡ä»¶ä¿¡æ¯æ³¨å…¥æ›´æ·±å±‚æ¬¡

**Q: å‚…é‡Œå¶ä½ç½®ç¼–ç çš„å¤šå°ºåº¦æœ‰ä»€ä¹ˆå¥½å¤„?**

A: ä½é¢‘æˆåˆ†æ•æ‰ç²—ç²’åº¦ä½ç½® (å˜ç±³çº§)ï¼Œé«˜é¢‘æˆåˆ†æ•æ‰ç»†ç²’åº¦ä½ç½® (æ¯«ç±³çº§)ã€‚è¿™å…è®¸æ¨¡å‹ï¼š
- å…ˆåšç²—å¯¹å‡† (ä½é¢‘æ•æ„Ÿ)
- å†åšç²¾ç»†è°ƒæ•´ (é«˜é¢‘æ•æ„Ÿ)

## 4. æŒ‘æˆ˜ä¸æœªæ¥
1.  **æ•°æ®ç¨€ç¼º**: ç›¸æ¯”äºå›¾åƒæ•°æ®ï¼Œé«˜è´¨é‡çš„è§¦è§‰-è¯­è¨€å¯¹ (Tactile-Language Pairs) éå¸¸å°‘ã€‚
2.  **Sim-to-Real**: è§¦è§‰ä»¿çœŸéå¸¸å›°éš¾ (æ¶‰åŠå¤æ‚çš„è½¯ä½“å½¢å˜)ï¼Œç›®å‰ä¸»è¦ä¾èµ–çœŸæœºæ•°æ®æ”¶é›†ã€‚
3.  **ç¡¬ä»¶æˆæœ¬**: é«˜åˆ†è¾¨ç‡è§¦è§‰ä¼ æ„Ÿå™¨ (å¦‚ GelSight) ä¾ç„¶æ˜‚è´µä¸”æ˜“æŸè€—ã€‚

## 5. æ·±åº¦è§£æ: ResNet vs ViT for Tactile
åœ¨è§¦è§‰ VLA ä¸­ï¼Œé€‰æ‹© ResNet è¿˜æ˜¯ ViT ä½œä¸ºè§¦è§‰ç¼–ç å™¨ (Tactile Encoder) æ˜¯ä¸€ä¸ªå…³é”®çš„è®¾è®¡å†³ç­–ã€‚è¿™ä¸ä»…ä»…æ˜¯"CNN vs Transformer"çš„é—®é¢˜ï¼Œè€Œæ˜¯å…³ä¹**è§¦è§‰ä¿¡å·çš„ç‰©ç†ç‰¹æ€§**å¦‚ä½•è¢«ç¼–ç ã€‚

### 5.1 ResNet (CNN): çº¹ç†ä¸å‡ ä½•çš„ä¸“å®¶
ResNet åœ¨å¤„ç† GelSight è¿™ç±»**åŸºäºå…‰å­¦ (Optical-based)** çš„è§¦è§‰ä¼ æ„Ÿå™¨æ—¶è¡¨ç°å‡ºè‰²ï¼ŒåŸå› åœ¨äºå…¶**å½’çº³åç½® (Inductive Bias)** ä¸è§¦è§‰å›¾åƒçš„ç‰¹æ€§é«˜åº¦å¥‘åˆã€‚

*   **æŠ€æœ¯ç»†èŠ‚**:
    *   **å¹³ç§»ä¸å˜æ€§ (Translation Invariance)**: è§¦è§‰ç‰¹å¾ï¼ˆå¦‚ç‰©ä½“è¡¨é¢çš„å‡¸èµ·ï¼‰å¯èƒ½å‡ºç°åœ¨ä¼ æ„Ÿå™¨çš„ä»»ä½•ä½ç½®ã€‚ResNet çš„**æƒé‡å…±äº« (Weight Sharing)** å·ç§¯æ ¸ä¿è¯äº†æ— è®ºå‡¸èµ·åœ¨å“ªé‡Œï¼Œæå–çš„ç‰¹å¾éƒ½æ˜¯ä¸€è‡´çš„ã€‚
    *   **å±€éƒ¨æ€§ (Locality)**: è§¦è§‰æ„ŸçŸ¥çš„æ ¸å¿ƒæ˜¯**æ¥è§¦ (Contact)**ã€‚æ¥è§¦é€šå¸¸å‘ç”Ÿåœ¨å±€éƒ¨åŒºåŸŸã€‚ResNet çš„å·ç§¯æ ¸ (e.g., 3x3) å¼ºåˆ¶æ¨¡å‹å…³æ³¨å±€éƒ¨åƒç´ çš„æ¢¯åº¦å˜åŒ–ï¼Œè¿™å¯¹äºæ£€æµ‹**è¾¹ç¼˜ (Edges)**ã€**çº¹ç† (Textures)** å’Œ **æ»‘ç§» (Slip)** è‡³å…³é‡è¦ã€‚
    *   **å±‚çº§ç‰¹å¾ (Hierarchical Features)**: ResNet é€šè¿‡ Pooling ä¸æ–­ä¸‹é‡‡æ ·ï¼Œè‡ªç„¶åœ°å½¢æˆäº†ä»"å¾®è§‚çº¹ç†"åˆ°"å®è§‚å½¢çŠ¶"çš„ç‰¹å¾é‡‘å­—å¡”ã€‚è¿™å¯¹äºåˆ¤æ–­ç‰©ä½“æè´¨ï¼ˆå¾®è§‚ï¼‰å’ŒæŠ“å–ç¨³å®šæ€§ï¼ˆå®è§‚ï¼‰éƒ½å¾ˆæœ‰ç”¨ã€‚

### 5.2 ViT (Transformer): å…¨å±€æ¥è§¦ä¸å¤šæ¨¡æ€ç»Ÿä¸€
ViT åœ¨ OmniVTLA ç­‰æœ€æ–°æ¨¡å‹ä¸­æ›´å—æ¬¢è¿ï¼Œä¸»è¦æ˜¯ä¸ºäº†**å¤šæ¨¡æ€å¯¹é½**å’Œ**å…¨å±€ä¸Šä¸‹æ–‡**ã€‚

*   **æŠ€æœ¯ç»†èŠ‚**:
    *   **Patchify & Linear Projection**: ViT å°† $224 \times 224$ çš„è§¦è§‰å›¾åƒåˆ‡åˆ†ä¸º $16 \times 16$ çš„ Patchesï¼Œå±•å¹³åé€šè¿‡çº¿æ€§å±‚æ˜ å°„ä¸º Embeddingã€‚è¿™ä¸€æ­¥å½»åº•æ‰“ç ´äº†åƒç´ çš„ç½‘æ ¼ç»“æ„ï¼Œä½¿å…¶èƒ½ä¸æ–‡æœ¬ Token åœ¨åŒä¸€å‘é‡ç©ºé—´ä¸­äº¤äº’ã€‚
    *   **å…¨å±€æ„Ÿå—é‡ (Global Receptive Field)**: Self-Attention å…è®¸æ¯ä¸€ä¸ª Tactile Patch åœ¨ç¬¬ä¸€å±‚å°±ä¸å…¶ä»–æ‰€æœ‰ Patch äº¤äº’ã€‚è¿™å¯¹äºç†è§£**å¤šç‚¹æ¥è§¦ (Multi-point Contact)** éå¸¸å…³é”®ã€‚ä¾‹å¦‚ï¼Œå½“æ‰‹æŒ‡æä½ç‰©ä½“æ—¶ï¼ŒæŒ‡å°–ä¸¤ä¾§çš„å—åŠ›åˆ†å¸ƒæ˜¯ç›¸å…³çš„ï¼ŒResNet éœ€è¦å †å å¤šå±‚æ‰èƒ½"çœ‹"åˆ°è¿™ç§é•¿è·ç¦»å…³è”ï¼Œè€Œ ViT ä¸€çœ¼å°±èƒ½çœ‹åˆ°ã€‚
    *   **ä½ç½®ç¼–ç  (Positional Encoding)**: ç”±äº ViT æ²¡æœ‰å·ç§¯çš„å½’çº³åç½®ï¼Œå®ƒå¿…é¡»ä¾èµ–å¯å­¦ä¹ çš„ä½ç½®ç¼–ç æ¥ç†è§£"å“ªé‡Œæ˜¯ä¸Šï¼Œå“ªé‡Œæ˜¯ä¸‹"ã€‚åœ¨è§¦è§‰ä¸­ï¼Œç»å¯¹ä½ç½®å¾€å¾€å¯¹åº”ç€æœºæ¢°æ‰‹çš„å…·ä½“éƒ¨ä½ (e.g., æŒ‡å°– vs æŒ‡è…¹)ï¼Œè¿™å¯¹æ§åˆ¶å¾ˆé‡è¦ã€‚

### 5.3 æ ¸å¿ƒå·®å¼‚å¯¹æ¯”è¡¨

| ç‰¹æ€§ | ResNet (Tactile) | ViT (Tactile) |
| :--- | :--- | :--- |
| **å½’çº³åç½®** | å¼º (å¹³ç§»ä¸å˜, å±€éƒ¨æ€§) | å¼± (éœ€æ•°æ®å­¦ä¹ ) |
| **æ“…é•¿ç‰¹å¾** | **é«˜é¢‘çº¹ç†** (Texture), è¾¹ç¼˜, å±€éƒ¨å½¢å˜ | **ä½é¢‘åˆ†å¸ƒ** (Force Distribution), å…¨å±€æ¥è§¦æ¨¡å¼ |
| **æ•°æ®éœ€æ±‚** | ä½ (å‡ åƒå¼ å›¾å³å¯æ”¶æ•›) | é«˜ (éœ€ MAE é¢„è®­ç»ƒæˆ– ImageNet è¿ç§») |
| **å¤šæ¨¡æ€èåˆ** | éœ€é€šè¿‡ Pooling å‹ç¼©æˆå‘é‡åèåˆ | **Token çº§èåˆ** (å¯ä¸ Text Token æ‹¼æ¥) |
| **å…¸å‹åº”ç”¨** | æè´¨è¯†åˆ«, æ»‘ç§»æ£€æµ‹ (Slip Detection) | å¤æ‚æ“ä½œç­–ç•¥ (Manipulation Policy), è·¨æ¨¡æ€æ¨ç† |

## 6. é¢è¯•å¸¸è§é—®é¢˜

**Q1: è§¦è§‰å›¾åƒ (Tactile Image) å’Œæ™®é€š RGB å›¾åƒæœ‰ä»€ä¹ˆåŒºåˆ«?**

è§¦è§‰å›¾åƒé€šå¸¸åæ˜ çš„æ˜¯**å‡ ä½•å½¢çŠ¶ (Geometry)** å’Œ **å—åŠ›åˆ†å¸ƒ (Force Distribution)**ï¼Œå¯¹å…‰ç…§å˜åŒ–ä¸æ•æ„Ÿï¼Œä½†å¯¹æ¥è§¦æå…¶æ•æ„Ÿã€‚å¤„ç†æ—¶é€šå¸¸ä¸éœ€è¦å¤æ‚çš„é¢œè‰²å¢å¼ºï¼Œä½†éœ€è¦å…³æ³¨çº¹ç†ç»†èŠ‚ã€‚

---

**Q2: å¦‚ä½•å°†è§¦è§‰èå…¥ VLA?**

ä¸‰ç§ä¸»æµæ–¹æ³•ï¼š
1. **é€šé“æ‹¼æ¥**: å°†è§¦è§‰å›¾åƒä½œä¸ºé¢å¤–è§†è§‰é€šé“ (Concat)
2. **Cross-Attention**: è§¦è§‰ç‰¹å¾ä½œä¸º Key/Value æ³¨å…¥ Policy
3. **å¤šæ¨¡æ€å¯¹é½**: åƒ Tactile-VLA/OmniVTLA é‚£æ ·å°†è§¦è§‰ã€è§†è§‰ã€è¯­è¨€å¯¹é½åˆ°ç»Ÿä¸€ç©ºé—´

---

**Q3: DIGIT vs GelSight æ€ä¹ˆé€‰?**

| åœºæ™¯ | æ¨è | åŸå›  |
| :--- | :--- | :--- |
| çµå·§æ‰‹æ“ä½œ | **DIGIT** | ä½“ç§¯å°ã€é‡é‡è½»ã€æˆæœ¬ä½ |
| ç²¾å¯†æ£€æµ‹/ç ”ç©¶ | **GelSight** | åˆ†è¾¨ç‡æ›´é«˜ |
| å¤§è§„æ¨¡æ•°æ®é‡‡é›† | **DIGIT** | å¼€æºã€ä¾¿å®œã€å¯æ‰¹é‡åˆ¶ä½œ |
| å·¥ä¸šåº”ç”¨ | çœ‹éœ€æ±‚ | GelSight ç¨³å®šæ€§æ›´å¥½ |

---

**Q4: è§¦è§‰ Sim-to-Real ä¸ºä»€ä¹ˆéš¾?**

1. **è½¯ä½“ä»¿çœŸå¤æ‚**: å¼¹æ€§ä½“å½¢å˜æ¶‰åŠéçº¿æ€§ FEMï¼Œè®¡ç®—æˆæœ¬é«˜
2. **æ¥è§¦æ¨¡å‹ä¸ç²¾ç¡®**: æ‘©æ“¦ã€æ»‘ç§»çš„ç‰©ç†å»ºæ¨¡å›°éš¾
3. **ä¼ æ„Ÿå™¨ç‰¹æ€§**: æ¯ä¸ªä¼ æ„Ÿå™¨çš„å…‰å­¦ç‰¹æ€§ç•¥æœ‰ä¸åŒ
4. **è§£å†³æ–¹æ¡ˆ**: åŸŸéšæœºåŒ– (Domain Randomization)ã€çœŸå®æ•°æ®å¾®è°ƒ

---

**Q5: GelStereo (åƒè§‰) vs GelSight çš„æŠ€æœ¯å·®å¼‚?**

| ç»´åº¦ | GelSight | GelStereo |
| :--- | :--- | :--- |
| 3D é‡å»º | å…‰åº¦ç«‹ä½“ (Photometric Stereo) | **åŒç›®ç«‹ä½“åŒ¹é…** |
| å…‰æº | RGB ä¸‰è‰² LED | å•è‰² LED |
| ç›¸æœºæ•° | 1 ä¸ª | **2 ä¸ª** |
| åŸç† | æ ¹æ®ä¸åŒå…‰ç…§ä¸‹çš„äº®åº¦å˜åŒ–æ¨æ–­æ³•å‘é‡ | æ ¹æ®åŒç›®è§†å·®ç›´æ¥è®¡ç®—æ·±åº¦ |
| ä¼˜åŠ¿ | çº¹ç†ç»†èŠ‚æ›´ä¸°å¯Œ | **è®¡ç®—æ›´å¿«ã€å‡ ä½•çº¦æŸæ›´å¼º** |

---

**Q6: DM-Tac (æˆ´ç›Ÿ) çš„å•è‰²å…‰æŠ€æœ¯æœ‰ä»€ä¹ˆä¼˜åŠ¿?**

ä¼ ç»Ÿ GelSight ä½¿ç”¨ RGB ä¸‰è‰²å…‰ä»ä¸åŒè§’åº¦ç…§å°„å¼¹æ€§ä½“ï¼Œé€šè¿‡**å…‰åº¦ç«‹ä½“ (Photometric Stereo)** ç®—æ³•ä»é¢œè‰²é€šé“åˆ†ç¦»å‡ºä¸‰ä¸ªæ–¹å‘çš„å…‰ç…§ä¿¡æ¯ï¼Œé‡å»ºè¡¨é¢æ³•å‘é‡ã€‚

å•è‰²å…‰æ–¹æ¡ˆçš„ trade-offï¼š

| ç»´åº¦ | RGB ä¸‰è‰²å…‰ | å•è‰²å…‰ |
| :--- | :--- | :--- |
| ä¿¡æ¯é‡ | 3 ä¸ªå…‰ç…§æ–¹å‘ | 1 ä¸ªå…‰ç…§æ–¹å‘ |
| é‡å»ºç²¾åº¦ | ç†è®ºä¸Šæ›´é«˜ | ä¾èµ–ç®—æ³•è¡¥å¿ |
| ç¡¬ä»¶å¤æ‚åº¦ | éœ€ç²¾ç¡® LED å¸ƒå±€ | **æ›´ç®€å•** |
| æ ‡å®šéš¾åº¦ | éœ€æ ‡å®šæ¯ä¸ªé¢œè‰²é€šé“ | **æ›´ç®€å•** |
| æˆæœ¬ | è¾ƒé«˜ | **è¾ƒä½** |

**å®é™…è€ƒé‡**: å•è‰²å…‰æŸå¤±äº†éƒ¨åˆ†æ³•å‘é‡ä¿¡æ¯ï¼Œä½†å¯é€šè¿‡æ·±åº¦å­¦ä¹ ç«¯åˆ°ç«¯è¡¥å¿ã€‚å¯¹äºæŠ“å–ä»»åŠ¡ï¼Œé«˜å¯†åº¦è§¦ç‚¹ (4ä¸‡/cmÂ²) å¯èƒ½æ¯”ç²¾ç¡® 3D é‡å»ºæ›´é‡è¦ã€‚

> âš ï¸ æ³¨ï¼šæˆ´ç›Ÿçš„å…·ä½“ç®—æ³•ç»†èŠ‚æœªå…¬å¼€ï¼Œä¸Šè¿°ä¸ºåŸºäºå…¬å¼€ä¿¡æ¯çš„æ¨æµ‹ã€‚

---

**Q7: å¦‚ä½•é€‰æ‹©è§¦è§‰ä¼ æ„Ÿå™¨?**

| åœºæ™¯ | æ¨è | ç†ç”± |
| :--- | :--- | :--- |
| å­¦æœ¯ç ”ç©¶/å¿«é€ŸåŸå‹ | **DIGIT** | å¼€æºã€ä¾¿å®œã€**Meta é¢„è®­ç»ƒæ¨¡å‹** |
| éœ€è¦åŠ›åé¦ˆ | **GelSight / BioTac** | DIGIT æ— ç›´æ¥åŠ›è¾“å‡º |
| é«˜ç²¾åº¦ 3D é‡å»º | **GelSight** | åˆ†è¾¨ç‡æœ€é«˜ |
| çµå·§æ‰‹é›†æˆ | **DM-Tac** | è¶…è–„ã€è€ç”¨ã€é«˜å¯†åº¦ |
| æœºæ¢°è‡‚æœ«ç«¯ | **GelStereo** | åŒç›® 3Dã€å®æ—¶æ€§å¥½ |
| å¤§é¢ç§¯è¦†ç›– | **ReSkin** | ç£æ€§è–„è†œã€å¯è´´é™„ |
| æ‰¹é‡éƒ¨ç½² (ä¸€è‡´æ€§è¦æ±‚é«˜) | **GelSight / DM-Tac** | DIGIT ä¼ æ„Ÿå™¨é—´å·®å¼‚å¤§ |

---

**Q8: DIGIT æ²¡æœ‰åŠ›è¾“å‡ºæ€ä¹ˆåŠ?**

ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼š
1. **åŸºäºå›¾åƒçš„åŠ›ä¼°è®¡**: è®­ç»ƒ CNN/MLP ä»å½¢å˜å›¾åƒå›å½’æ¥è§¦åŠ›
   ```python
   # ä¼ªä»£ç 
   force = ForceEstimator(tactile_image)  # è¾“å‡º Fx, Fy, Fz
   ```
2. **å¤–éƒ¨åŠ›ä¼ æ„Ÿå™¨èåˆ**: åœ¨æ‰‹è…•å¤„åŠ è£…å…­ç»´åŠ›ä¼ æ„Ÿå™¨ (å¦‚ ATI)ï¼Œä¸ DIGIT å›¾åƒèåˆ

Meta çš„ **Sparsh** æ¨¡å‹å·²åŒ…å«åŠ›ä¼°è®¡é¢„è®­ç»ƒï¼Œå¯ç›´æ¥ä½¿ç”¨ã€‚


---

\newpage

# ç¬¬25ç«  RDT (Robotics Diffusion Transformer)


> **æ ¸å¿ƒè®ºæ–‡**: [RDT-1B: a Diffusion Foundation Model for Bimanual Manipulation](https://arxiv.org/abs/2410.07864) (Liu et al., 2024)
> **å¼€å‘è€…**: æ¸…åå¤§å­¦ MARS Lab & å­—èŠ‚è·³åŠ¨
> **ä»£è¡¨æ¨¡å‹**: **RDT-170M**, **RDT-1B**

## 1. ä¸ºä»€ä¹ˆéœ€è¦ RDT? (Why?)

### 1.1 æœºå™¨äººå­¦ä¹ çš„ Scaling Law å›°å¢ƒ

åœ¨ NLP å’Œ CV é¢†åŸŸï¼Œ**Scaling Law** å·²è¢«å……åˆ†éªŒè¯ï¼šæ¨¡å‹è¶Šå¤§ã€æ•°æ®è¶Šå¤šï¼Œæ€§èƒ½è¶Šå¥½ã€‚ç„¶è€Œï¼Œæœºå™¨äººå­¦ä¹ é¢†åŸŸä¸€ç›´ç¼ºä¹ç±»ä¼¼çš„éªŒè¯:

- **æ•°æ®ç¨€ç¼º**: æœºå™¨äººæ•°æ®æ”¶é›†æˆæœ¬é«˜ï¼Œæ•°é‡çº§è¿œä½äºå›¾æ–‡æ•°æ®ã€‚
- **åˆ†å¸ƒå¤šæ ·**: ä¸åŒæœºå™¨äºº (å•è‡‚/åŒè‡‚/äººå½¢) çš„çŠ¶æ€ç©ºé—´ã€åŠ¨ä½œç©ºé—´å·®å¼‚å·¨å¤§ã€‚
- **ç¼ºä¹ç»Ÿä¸€æ¶æ„**: ä¹‹å‰çš„æ–¹æ³• (ACT, Diffusion Policy) å¤šä¸ºä»»åŠ¡ç‰¹å®šè®¾è®¡ï¼Œéš¾ä»¥è§„æ¨¡åŒ–ã€‚

### 1.2 RDT çš„æ ¸å¿ƒç›®æ ‡

RDT æ˜¯é¦–ä¸ª**åäº¿å‚æ•°çº§**çš„æœºå™¨äººæ‰©æ•£åŸºç¡€æ¨¡å‹ï¼Œä¸“ä¸ºè§£å†³ä»¥ä¸‹é—®é¢˜ï¼š

1. **Scaling**: è¯æ˜æœºå™¨äººç­–ç•¥ä¹Ÿèƒ½ä»"å¤§æ¨¡å‹+å¤§æ•°æ®"ä¸­è·ç›Šã€‚
2. **è·¨å½¢æ€æ³›åŒ– (Cross-Embodiment)**: å•ä¸€æ¨¡å‹é€‚é…ä¸åŒæœºå™¨äºº (å•è‡‚/åŒè‡‚)ã€‚
3. **åŒè‡‚æ“ä½œ (Bimanual)**: ç‰¹åˆ«ä¼˜åŒ–äº†éœ€è¦ä¸¤åªæ‰‹åè°ƒçš„å¤æ‚ä»»åŠ¡ã€‚

## 2. æ ¸å¿ƒæŠ€æœ¯ (Core Techniques)

### 2.1 å¯æ‰©å±•çš„ DiT æ¶æ„ (Scalable Diffusion Transformer)

RDT åŸºäº **DiT (Diffusion Transformer)** æ¶æ„ï¼Œå°†æ‰©æ•£è¿‡ç¨‹ä¸ Transformer ç»“åˆã€‚

#### 2.1.1 ä¸ºä»€ä¹ˆé€‰æ‹© DiT?

| æ¶æ„ | ä¼˜ç‚¹ | ç¼ºç‚¹ |
| :--- | :--- | :--- |
| **U-Net (Diffusion Policy)** | æˆç†Ÿã€ç¨³å®š | éš¾ä»¥è§„æ¨¡åŒ–ï¼Œå‚æ•°æ•ˆç‡ä½ |
| **DiT** | ä¸ LLM æ¶æ„ç»Ÿä¸€ï¼Œæ˜“äºæ‰©å±• | éœ€è¦æ›´å¤šæ•°æ® |

DiT çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†æ‰©æ•£æ¨¡å‹çš„å»å™ªç½‘ç»œä» U-Net æ›¿æ¢ä¸º Transformerï¼Œè¿™ä½¿å¾—ï¼š
- å¯ä»¥ç›´æ¥å€Ÿé‰´ LLM çš„è®­ç»ƒæŠ€æœ¯ (FlashAttention, Gradient Checkpointing)ã€‚
- å‚æ•°é‡å¯ä»¥å¹³æ»‘æ‰©å±•åˆ°æ•°åäº¿ã€‚

#### 2.1.2 RDT çš„æ¶æ„è®¾è®¡

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚          Condition Encoder           â”‚
                    â”‚  (å›¾åƒ: SigLIP + è¯­è¨€: T5)           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚ condition [B, L, D]
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Noisy       â”‚â”€â”€â”€â–¶â”‚        DiT Backbone                  â”‚
â”‚  Action      â”‚    â”‚  (å¸¦ AdaLN-Zero çš„ Transformer)      â”‚
â”‚  x_t         â”‚    â”‚                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚  - è¾“å…¥: x_t + t_emb + cond          â”‚
â”‚  Timestep t  â”‚â”€â”€â”€â–¶â”‚  - è¾“å‡º: é¢„æµ‹å™ªå£° Îµ æˆ– v             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                         Denoised Action x_{t-1}
```

**å…³é”®ç»„ä»¶**:

1. **AdaLN-Zero (Adaptive Layer Normalization)**:
   - å°†æ—¶é—´æ­¥ $t$ å’Œæ¡ä»¶ä¿¡æ¯æ³¨å…¥åˆ°æ¯ä¸ª Transformer Blockã€‚
   - å…¬å¼: $\text{AdaLN}(h, c) = c_s \odot \text{LayerNorm}(h) + c_b$
   - å…¶ä¸­ $c_s, c_b$ æ˜¯ä»æ¡ä»¶ $c$ é¢„æµ‹çš„ scale å’Œ biasã€‚

2. **ç»Ÿä¸€çš„åŠ¨ä½œè¡¨ç¤º (Unified Action Representation)**:
   - **å•è‡‚**: $(x, y, z, roll, pitch, yaw, gripper) \in \mathbb{R}^7$
   - **åŒè‡‚**: æ‹¼æ¥ä¸¤ä¸ªå•è‡‚ + å¯é€‰çš„èº¯å¹²è‡ªç”±åº¦ $\in \mathbb{R}^{14+}$
   - é€šè¿‡ **Padding + Masking** ç»Ÿä¸€ä¸åŒå½¢æ€çš„åŠ¨ä½œç»´åº¦ã€‚

### 2.2 å¤§è§„æ¨¡é¢„è®­ç»ƒæ•°æ® (Pre-training Data)

RDT åœ¨å¤šä¸ªå¤§è§„æ¨¡æœºå™¨äººæ•°æ®é›†ä¸Šé¢„è®­ç»ƒï¼š

| æ•°æ®é›† | ç±»å‹ | è§„æ¨¡ | ç‰¹ç‚¹ |
| :--- | :--- | :--- | :--- |
| **Open X-Embodiment** | çœŸæœº | 1M+ episodes | å¤šç§æœºå™¨äººå½¢æ€ |
| **DROID** | çœŸæœº | 76k episodes | é«˜è´¨é‡åŒè‡‚æ•°æ® |
| **RH20T** | çœŸæœº | 20k episodes | ä¸­å›½åœºæ™¯ |
| **RoboTurk** | çœŸæœº | 2k episodes | è¿œç¨‹é¥æ“ |
| **æ¨¡æ‹Ÿæ•°æ®** | ä»¿çœŸ | 500k+ | RLBench, ManiSkill |

**æ•°æ®é…æ¯”ç­–ç•¥**:
- **çœŸæœºæ•°æ®ä¼˜å…ˆ**: çœŸæœºæ•°æ®å  70%ï¼Œæ¨¡æ‹Ÿæ•°æ®å  30%ã€‚
- **åŒè‡‚æ•°æ®å¢å¼º**: å¯¹åŒè‡‚æ•°æ®è¿›è¡Œä¸Šé‡‡æ ·ï¼Œå¼¥è¡¥å…¶ç¨€ç¼ºæ€§ã€‚

### 2.3 æ¡ä»¶ç¼–ç  (Condition Encoding)

RDT ä½¿ç”¨**å¤šæ¨¡æ€æ¡ä»¶**æ¥æŒ‡å¯¼åŠ¨ä½œç”Ÿæˆï¼š

```python
class RDTConditionEncoder(nn.Module):
    def __init__(self):
        # è§†è§‰ç¼–ç å™¨: SigLIP (Google çš„ CLIP å˜ä½“)
        self.vision_encoder = SigLIPVisionModel.from_pretrained("google/siglip-base")
        
        # è¯­è¨€ç¼–ç å™¨: T5-XXL
        self.language_encoder = T5EncoderModel.from_pretrained("google/t5-xxl")
        
        # æœ¬ä½“æ„ŸçŸ¥æŠ•å½±
        self.proprio_proj = nn.Linear(proprio_dim, hidden_dim)
        
        # èåˆå±‚
        self.fusion = nn.TransformerEncoder(...)
    
    def forward(self, images, language, proprio):
        # images: [B, N_cam, C, H, W] - å¤šç›¸æœº
        # language: [B, L_text] - è¯­è¨€æŒ‡ä»¤
        # proprio: [B, D_proprio] - æœ¬ä½“æ„ŸçŸ¥
        
        # ç¼–ç 
        vis_feat = self.vision_encoder(images.flatten(0, 1))  # [B*N_cam, D]
        vis_feat = vis_feat.view(B, N_cam, -1)
        
        lang_feat = self.language_encoder(language).last_hidden_state
        
        proprio_feat = self.proprio_proj(proprio).unsqueeze(1)
        
        # èåˆ
        combined = torch.cat([vis_feat, lang_feat, proprio_feat], dim=1)
        return self.fusion(combined)
```

### 2.4 æ‰©æ•£è®­ç»ƒä¸é‡‡æ · (Diffusion Training & Sampling)

RDT ä½¿ç”¨ **DDPM** æ¡†æ¶è¿›è¡Œè®­ç»ƒï¼Œä½†é‡‡ç”¨äº†å‡ ä¸ªä¼˜åŒ–:

#### 2.4.1 è®­ç»ƒç›®æ ‡


$$
\mathcal{L} = \mathbb{E}_{t, a_0, \epsilon} \left[ \| \epsilon - \epsilon_\theta(a_t, t, c) \|^2 \right]
$$


å…¶ä¸­:
- $a_0$: çœŸå®åŠ¨ä½œåºåˆ— (Action Chunk)
- $a_t = \sqrt{\bar{\alpha}_t} a_0 + \sqrt{1 - \bar{\alpha}_t} \epsilon$: åŠ å™ªåŠ¨ä½œ
- $c$: æ¡ä»¶ (å›¾åƒ + è¯­è¨€ + æœ¬ä½“æ„ŸçŸ¥)
- $\epsilon_\theta$: DiT ç½‘ç»œé¢„æµ‹çš„å™ªå£°

#### 2.4.2 æ¨ç†åŠ é€Ÿ

RDT ä½¿ç”¨ **DDIM** å°†å»å™ªæ­¥æ•°ä» 100 æ­¥å‹ç¼©åˆ° **10 æ­¥**:

```python
@torch.no_grad()
def sample(self, condition, num_steps=10):
    """DDIM é‡‡æ ·"""
    batch_size = condition.shape[0]
    
    # ä»çº¯å™ªå£°å¼€å§‹
    x_t = torch.randn(batch_size, self.chunk_size, self.action_dim)
    
    # DDIM æ­¥é•¿
    timesteps = torch.linspace(1000, 0, num_steps + 1).long()
    
    for i in range(num_steps):
        t = timesteps[i]
        t_prev = timesteps[i + 1]
        
        # é¢„æµ‹å™ªå£°
        eps_pred = self.dit(x_t, t, condition)
        
        # DDIM æ›´æ–°
        alpha_t = self.alphas_cumprod[t]
        alpha_prev = self.alphas_cumprod[t_prev] if t_prev > 0 else 1.0
        
        x0_pred = (x_t - torch.sqrt(1 - alpha_t) * eps_pred) / torch.sqrt(alpha_t)
        x_t = torch.sqrt(alpha_prev) * x0_pred + torch.sqrt(1 - alpha_prev) * eps_pred
    
    return x_t
```

## 3. æ¨¡å‹å˜ä½“ (Model Variants)

RDT æä¾›äº†ä¸åŒè§„æ¨¡çš„æ¨¡å‹ä»¥é€‚åº”ä¸åŒçš„ç®—åŠ›éœ€æ±‚ï¼š

| æ¨¡å‹ | å‚æ•°é‡ | å±‚æ•° | éšè—ç»´åº¦ | å¤´æ•° | æ¨ç†é€Ÿåº¦ |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **RDT-170M** | 170M | 24 | 1024 | 16 | ~50ms/step |
| **RDT-1B** | 1.2B | 48 | 2048 | 32 | ~200ms/step |

**Scaling Law éªŒè¯**:
- RDT-1B åœ¨æ‰€æœ‰ä»»åŠ¡ä¸Šéƒ½ä¼˜äº RDT-170Mï¼ŒéªŒè¯äº†æœºå™¨äººé¢†åŸŸçš„ Scaling Lawã€‚
- æ€§èƒ½æå‡å‘ˆç°**å¯¹æ•°çº¿æ€§**å…³ç³»ï¼šå‚æ•°é‡ç¿» 10 å€ï¼Œæ€§èƒ½æå‡çº¦ 15-20%ã€‚

## 4. å…³é”®åˆ›æ–°ç‚¹ (Key Innovations)

### 4.1 ç»Ÿä¸€çš„è·¨å½¢æ€è¡¨ç¤º (Unified Cross-Embodiment Representation)

**é—®é¢˜**: ä¸åŒæœºå™¨äººçš„åŠ¨ä½œç»´åº¦ä¸åŒ (å•è‡‚ 7D, åŒè‡‚ 14D, äººå½¢ 30+D)ã€‚

**è§£å†³æ–¹æ¡ˆ**: **Padded Action Space**

```python
## ç»Ÿä¸€åˆ°æœ€å¤§ç»´åº¦ (ä¾‹å¦‚ 32D)
MAX_ACTION_DIM = 32

def pad_action(action, embodiment_type):
    """å°†ä¸åŒæœºå™¨äººçš„åŠ¨ä½œå¡«å……åˆ°ç»Ÿä¸€ç»´åº¦"""
    if embodiment_type == "single_arm":
        # [7] -> [32] (åé¢å¡« 0)
        padded = F.pad(action, (0, MAX_ACTION_DIM - 7))
        mask = torch.cat([torch.ones(7), torch.zeros(MAX_ACTION_DIM - 7)])
    elif embodiment_type == "bimanual":
        # [14] -> [32]
        padded = F.pad(action, (0, MAX_ACTION_DIM - 14))
        mask = torch.cat([torch.ones(14), torch.zeros(MAX_ACTION_DIM - 14)])
    # ...
    return padded, mask
```

è®­ç»ƒæ—¶ï¼Œåªå¯¹æœ‰æ•ˆç»´åº¦è®¡ç®—æŸå¤±:

$$
\mathcal{L} = \mathbb{E} \left[ \| m \odot (\epsilon - \hat{\epsilon}) \|^2 \right]
$$


### 4.2 åŒè‡‚åè°ƒä¼˜åŒ– (Bimanual Coordination)

åŒè‡‚æ“ä½œéœ€è¦ä¸¤åªæ‰‹**ååŒ**å·¥ä½œï¼ˆå¦‚æŠ˜è¡£æœã€æ¬è¿å¤§ç‰©ä½“ï¼‰ã€‚RDT é€šè¿‡ä»¥ä¸‹è®¾è®¡å¢å¼ºåŒè‡‚åè°ƒ:

1. **åŠ¨ä½œæ‹¼æ¥**: å·¦å³è‡‚åŠ¨ä½œåœ¨åºåˆ—ç»´åº¦æ‹¼æ¥ï¼Œè€Œéç‹¬ç«‹é¢„æµ‹ã€‚
2. **Cross-Arm Attention**: åœ¨ Transformer ä¸­ï¼Œå·¦è‡‚çš„ Token å¯ä»¥ Attend åˆ°å³è‡‚ã€‚
3. **å¯¹ç§°æ€§æ•°æ®å¢å¼º**: éšæœºäº¤æ¢å·¦å³è‡‚çš„è¾“å…¥/è¾“å‡ºï¼Œå¢åŠ æ•°æ®å¤šæ ·æ€§ã€‚

### 4.3 é«˜æ•ˆå¾®è°ƒ (Efficient Fine-tuning)

é¢„è®­ç»ƒçš„ RDT å¯ä»¥é€šè¿‡ **LoRA** é«˜æ•ˆé€‚é…åˆ°æ–°ä»»åŠ¡:

```python
from peft import LoraConfig, get_peft_model

config = LoraConfig(
    r=16,                    # LoRA ç§©
    lora_alpha=32,
    target_modules=["q_proj", "v_proj"],  # åªå¾®è°ƒ QV æŠ•å½±
    lora_dropout=0.05,
)

rdt_lora = get_peft_model(rdt_model, config)
## å¯è®­ç»ƒå‚æ•°: ~10M (vs 1.2B å…¨é‡)
```

**å¾®è°ƒæ•°æ®éœ€æ±‚**:
- **10-50 æ¡æ¼”ç¤º**: åŸºç¡€é€‚é…
- **100-500 æ¡æ¼”ç¤º**: é«˜æ€§èƒ½å¾®è°ƒ
- **å¯¹æ¯”**: ä»å¤´è®­ç»ƒ Diffusion Policy éœ€è¦ 1000+ æ¡

## 5. å®éªŒç»“æœ (Experimental Results)

### 5.1 Benchmark æ€§èƒ½

| ä»»åŠ¡ | ACT | Diffusion Policy | OpenVLA | RDT-1B |
| :--- | :--- | :--- | :--- | :--- |
| **LIBERO-90** | 68.2% | 73.5% | 75.1% | **82.3%** |
| **Bimanual Fold** | 45% | 52% | 48% | **71%** |
| **Pick & Place** | 82% | 85% | 87% | **93%** |
| **é•¿åºåˆ—ä»»åŠ¡** | 35% | 42% | 40% | **58%** |

### 5.2 æ³›åŒ–èƒ½åŠ›

RDT åœ¨**æœªè§è¿‡çš„åœºæ™¯**ä¸Šä¹Ÿå±•ç°å‡ºè‰¯å¥½çš„æ³›åŒ–:
- **æ–°ç‰©ä½“**: æˆåŠŸç‡ä¸‹é™ < 10%
- **æ–°èƒŒæ™¯**: æˆåŠŸç‡ä¸‹é™ < 5%
- **æ–°æœºå™¨äºº**: é›¶æ ·æœ¬è¿ç§»æˆåŠŸç‡ 40%+

## 6. ä¸å…¶ä»–æ–¹æ³•çš„å¯¹æ¯” (Comparison)

| æ–¹æ³• | æ¶æ„ | å‚æ•°é‡ | é¢„è®­ç»ƒ | åŒè‡‚æ”¯æŒ | æ¨ç†é€Ÿåº¦ |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **ACT** | CVAE + Transformer | ~10M | æ—  | âœ… | æœ€å¿« |
| **Diffusion Policy** | U-Net | ~50M | æ—  | âŒ | æ…¢ |
| **OpenVLA** | LLM + Action Head | 7B | âœ… | âŒ | æ…¢ |
| **Ï€0** | VLM + Flow Matching | 3B+ | âœ… | âœ… | ä¸­ç­‰ |
| **RDT-1B** | DiT | 1.2B | âœ… | âœ… (ä¸“é—¨ä¼˜åŒ–) | ä¸­ç­‰ |

**RDT çš„ç‹¬ç‰¹ä¼˜åŠ¿**:
- **ä¸“ä¸ºåŒè‡‚è®¾è®¡**: åŠ¨ä½œç©ºé—´å’Œæ³¨æ„åŠ›æœºåˆ¶éƒ½é’ˆå¯¹åŒè‡‚ä¼˜åŒ–ã€‚
- **éªŒè¯ Scaling Law**: é¦–ä¸ªè¯æ˜æœºå™¨äººé¢†åŸŸ "bigger is better" çš„æ¨¡å‹ã€‚
- **å¼€æºå‹å¥½**: æä¾›å®Œæ•´çš„é¢„è®­ç»ƒæƒé‡å’Œå¾®è°ƒä»£ç ã€‚

## 7. å®æˆ˜ä»£ç ç¤ºä¾‹ (Code Example)

```python
import torch
from transformers import AutoModel

## åŠ è½½é¢„è®­ç»ƒçš„ RDT-1B
model = AutoModel.from_pretrained("thu-ml/RDT-1B")

## å‡†å¤‡è¾“å…¥
images = torch.randn(1, 2, 3, 224, 224)  # åŒç›¸æœº
language = "fold the towel in half"
proprio = torch.randn(1, 14)  # åŒè‡‚æœ¬ä½“æ„ŸçŸ¥

## æ¨ç†
with torch.no_grad():
    condition = model.encode_condition(images, language, proprio)
    actions = model.sample(condition, num_steps=10)  # [1, chunk_size, 14]

print(f"Generated actions shape: {actions.shape}")
## è¾“å‡º: Generated actions shape: torch.Size([1, 64, 14])
```

### 7.1 LoRA å¾®è°ƒç¤ºä¾‹

```python
from peft import LoraConfig, get_peft_model
from torch.utils.data import DataLoader

## é…ç½® LoRA
lora_config = LoraConfig(
    r=16,
    lora_alpha=32,
    target_modules=["q_proj", "k_proj", "v_proj", "out_proj"],
    lora_dropout=0.05,
)

model_lora = get_peft_model(model, lora_config)
print(f"Trainable params: {model_lora.num_parameters(only_trainable=True):,}")
## è¾“å‡º: Trainable params: 12,582,912

## å¾®è°ƒå¾ªç¯
optimizer = torch.optim.AdamW(model_lora.parameters(), lr=1e-4)

for batch in dataloader:
    images, language, proprio, gt_actions = batch
    
    # å‰å‘ä¼ æ’­
    loss = model_lora.compute_loss(images, language, proprio, gt_actions)
    
    # åå‘ä¼ æ’­
    optimizer.zero_grad()
    loss.backward()
    optimizer.step()
```

## 8. é¢è¯•å¸¸è§é—®é¢˜ (Q&A)

**Q1: RDT å’Œ Diffusion Policy çš„æ ¸å¿ƒåŒºåˆ«æ˜¯ä»€ä¹ˆ?**

A:
- **æ¶æ„**: RDT ä½¿ç”¨ **DiT (Transformer)**ï¼ŒDiffusion Policy ä½¿ç”¨ **U-Net**ã€‚
- **è§„æ¨¡**: RDT æ˜¯åäº¿å‚æ•°çº§åŸºç¡€æ¨¡å‹ï¼ŒDiffusion Policy é€šå¸¸ < 100Mã€‚
- **é¢„è®­ç»ƒ**: RDT åœ¨å¤§è§„æ¨¡å¤šæœºå™¨äººæ•°æ®ä¸Šé¢„è®­ç»ƒï¼ŒDiffusion Policy é€šå¸¸ä»å¤´è®­ç»ƒã€‚
- **è·¨å½¢æ€**: RDT ç»Ÿä¸€å¤„ç†ä¸åŒæœºå™¨äººï¼ŒDiffusion Policy éœ€ä¸ºæ¯ç§å½¢æ€å•ç‹¬è®­ç»ƒã€‚

**Q2: ä¸ºä»€ä¹ˆ RDT ä¸“é—¨ä¼˜åŒ–åŒè‡‚æ“ä½œ?**

A:
- **æ•°æ®ç¨€ç¼º**: åŒè‡‚æ•°æ®è¿œå°‘äºå•è‡‚ï¼Œéœ€è¦ä¸“é—¨çš„æ•°æ®å¢å¼ºã€‚
- **åè°ƒæ€§**: åŒè‡‚ä»»åŠ¡éœ€è¦ä¸¤åªæ‰‹**åŒæ­¥é…åˆ**ï¼Œä¸èƒ½ç‹¬ç«‹é¢„æµ‹ã€‚
- **å·¥ä¸šéœ€æ±‚**: åŒè‡‚æœºå™¨äººæ˜¯å·¥ä¸šå’Œå®¶åº­åœºæ™¯çš„ä¸»è¦å½¢æ€ã€‚

**Q3: RDT çš„ Scaling Law æ˜¯å¦‚ä½•éªŒè¯çš„?**

A:
- è®­ç»ƒäº† **170M, 500M, 1B** ä¸‰ä¸ªè§„æ¨¡çš„æ¨¡å‹ã€‚
- ä¿æŒæ•°æ®å’Œè®­ç»ƒæ­¥æ•°ç›¸åŒï¼Œåªæ”¹å˜æ¨¡å‹å¤§å°ã€‚
- ç»“æœ: **å‚æ•°é‡ â†‘ 10x â†’ æˆåŠŸç‡ â†‘ 15-20%**ï¼Œå‘ˆå¯¹æ•°çº¿æ€§å…³ç³»ã€‚

**Q4: RDT å¦‚ä½•å¤„ç†ä¸åŒæœºå™¨äººçš„åŠ¨ä½œç»´åº¦?**

A:
- **ç»Ÿä¸€å¡«å……**: æ‰€æœ‰åŠ¨ä½œå¡«å……åˆ°æœ€å¤§ç»´åº¦ (å¦‚ 32D)ã€‚
- **åŠ¨æ€æ©ç **: è®­ç»ƒå’Œæ¨ç†æ—¶ï¼Œåªå¯¹æœ‰æ•ˆç»´åº¦è®¡ç®—æŸå¤±/è¾“å‡ºã€‚
- **Embodiment Token**: å¯é€‰åœ°æ·»åŠ "æœºå™¨äººç±»å‹"åµŒå…¥ã€‚

**Q5: RDT vs Ï€0ï¼Œå“ªä¸ªæ›´å¥½?**

A:
- **RDT ä¼˜åŠ¿**: ä¸“é—¨ä¼˜åŒ–åŒè‡‚ï¼Œå¼€æºå®Œæ•´ï¼ŒScaling Law éªŒè¯å……åˆ†ã€‚
- **Ï€0 ä¼˜åŠ¿**: VLM åº•åº§æ›´å¼º (è¯­ä¹‰ç†è§£)ï¼ŒFlow Matching æ¯” DDPM æ›´å¿«ã€‚
- **é€‰æ‹©å»ºè®®**: åŒè‡‚ä»»åŠ¡é€‰ RDTï¼›éœ€è¦å¼ºè¯­ä¹‰ç†è§£é€‰ Ï€0ã€‚

## 9. å±€é™æ€§ä¸æœªæ¥æ–¹å‘ (Limitations & Future)

### 9.1 å½“å‰å±€é™

- **æ¨ç†é€Ÿåº¦**: 10 æ­¥ DDIM ä»éœ€ ~100msï¼Œéš¾ä»¥æ»¡è¶³æŸäº›é«˜é¢‘æ§åˆ¶éœ€æ±‚ã€‚
- **æ•°æ®éœ€æ±‚**: é¢„è®­ç»ƒéœ€è¦å¤§è§„æ¨¡æ•°æ®ï¼Œæ–°å½¢æ€æœºå™¨äººå¯èƒ½ç¼ºä¹æ•°æ®ã€‚
- **å®‰å…¨æ€§**: æ‰©æ•£æ¨¡å‹çš„éšæœºæ€§å¯èƒ½å¯¼è‡´ä¸å®‰å…¨åŠ¨ä½œã€‚

### 9.2 æœªæ¥æ–¹å‘

- **ä¸€è‡´æ€§è’¸é¦ (Consistency Distillation)**: å°†å»å™ªæ­¥æ•°å‹ç¼©åˆ° 1 æ­¥ã€‚
- **äººå½¢æœºå™¨äºº**: æ‰©å±•åˆ° 30+ è‡ªç”±åº¦çš„äººå½¢æœºå™¨äººã€‚
- **åœ¨çº¿å­¦ä¹ **: ç»“åˆ RL è¿›è¡Œå®æ—¶é€‚åº”ã€‚

## 10. å‚è€ƒèµ„æº (References)

- **è®ºæ–‡**: [RDT-1B: a Diffusion Foundation Model for Bimanual Manipulation](https://arxiv.org/abs/2410.07864)
- **GitHub**: [thu-ml/RDT-1B](https://github.com/thu-ml/RoboticsDiffusionTransformer)
- **Hugging Face**: [thu-ml/RDT-1B](https://huggingface.co/thu-ml/RDT-1B)
- **åšå®¢**: [æ¸…å MARS Lab æŠ€æœ¯åšå®¢](https://mars-lab.github.io/)

---


\newpage

# ç¬¬26ç«  Ï€0.5 è§£æ


> **å‘å¸ƒæ—¶é—´**: 2025å¹´4æœˆ
> **æ ¸å¿ƒå®šä½**: ä»"å¤šé¢æ‰‹" (Generalist) è¿›åŒ–ä¸º"æ¢é™©å®¶" (Open-World Explorer)ã€‚

Ï€0.5 æ˜¯ Physical Intelligence åœ¨ Ï€0 åŸºç¡€ä¸Šçš„é‡å¤§è¿­ä»£ï¼Œæ—¨åœ¨è§£å†³æœºå™¨äººå­¦ä¹ ä¸­æœ€å¤§çš„ç—›ç‚¹ï¼š**æ³›åŒ–åˆ°ä»æœªè§è¿‡çš„ç¯å¢ƒ (Open-World Generalization)**ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ï€0.5 ç»Ÿä¸€æ¶æ„ (Unified Model)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   è¾“å…¥: ğŸ“· å›¾åƒ + ğŸ“ è¯­è¨€æŒ‡ä»¤                                    â”‚
â”‚              â”‚                                                  â”‚
â”‚              â–¼                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚   â”‚          VLM Backbone (3B+)             â”‚                  â”‚
â”‚   â”‚      è§†è§‰-è¯­è¨€å¤šæ¨¡æ€ç¼–ç å™¨               â”‚                  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                     â”‚                                          â”‚
â”‚                     â–¼                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚   â”‚     ğŸ§  Latent Thought (éšå¼æ¨ç†)         â”‚                  â”‚
â”‚   â”‚   "Approach handle" â†’ "Grasp" â†’ "Lift"  â”‚                  â”‚
â”‚   â”‚        (é«˜å±‚è¯­ä¹‰å­ä»»åŠ¡è§„åˆ’)              â”‚                  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                     â”‚                                          â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚         â”‚                       â”‚                              â”‚
â”‚         â–¼                       â–¼                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚   â”‚   FAST    â”‚          â”‚   Flow    â”‚                         â”‚
â”‚   â”‚ Tokenizer â”‚          â”‚ Matching  â”‚                         â”‚
â”‚   â”‚  (è®­ç»ƒ)   â”‚          â”‚  (æ¨ç†)   â”‚                         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                â”‚                               â”‚
â”‚                                â–¼                               â”‚
â”‚                    ğŸ¦¾ è¿ç»­åŠ¨ä½œè¾“å‡º (50Hz)                        â”‚
â”‚                                                                 â”‚
â”‚   ç‰¹ç‚¹: åˆ†å±‚æ¨ç† + æ··åˆæ¶æ„ (ç¦»æ•£è®­ç»ƒ / è¿ç»­æ¨ç†)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 1. æ ¸å¿ƒæ¶æ„ï¼šç»Ÿä¸€æ¨¡å‹ (The Unified Model)

### 1.1 "è‡ªè¨€è‡ªè¯­" çš„å¤§è„‘
ä¼ ç»Ÿçš„æœºå™¨äººç³»ç»Ÿé€šå¸¸æ˜¯åˆ†å±‚çš„ï¼š
- High-level Planner (LLM): "å»æŠŠè‹¹æœæ‹¿èµ·æ¥" -> è¾“å‡ºåæ ‡ã€‚
- Low-level Controller (Policy): æ ¹æ®åæ ‡æ‰§è¡ŒåŠ¨ä½œã€‚

**Ï€0.5 æ‰“ç ´äº†è¿™ç§è¾¹ç•Œ**ã€‚å®ƒæ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯çš„ VLAï¼Œä½†å¼•å…¥äº† **Hierarchical Inference (åˆ†å±‚æ¨ç†)** æœºåˆ¶ã€‚
- **è¾“å…¥**: å›¾åƒ + è¯­è¨€æŒ‡ä»¤ã€‚
- **ä¸­é—´è¾“å‡º (Latent Thought)**: æ¨¡å‹é¦–å…ˆåœ¨å†…éƒ¨ç”Ÿæˆä¸€ä¸ªé«˜å±‚çš„è¯­ä¹‰å­ä»»åŠ¡ (Semantic Subtask)ï¼Œä¾‹å¦‚ "Approach the handle" (é è¿‘æŠŠæ‰‹)ã€‚
- **æœ€ç»ˆè¾“å‡º (Action)**: åŸºäºè¿™ä¸ªå­ä»»åŠ¡ï¼Œç”Ÿæˆå…·ä½“çš„ç”µæœºæ§åˆ¶ä¿¡å· (Flow Matching)ã€‚

è¿™ç§æœºåˆ¶è®©æ¨¡å‹å…·å¤‡äº†**å¯è§£é‡Šæ€§**å’Œ**é•¿æœŸè§„åˆ’èƒ½åŠ›**ã€‚å®ƒä¸ä»…ä»…æ˜¯åœ¨æ¨¡ä»¿åŠ¨ä½œï¼Œè€Œæ˜¯åœ¨ç†è§£"æ„å›¾"ã€‚

### 1.2 æ··åˆæ¶æ„ (Hybrid Architecture)
ä¸ºäº†å¹³è¡¡æ¨ç†æ•ˆç‡å’Œæ§åˆ¶ç²¾åº¦ï¼ŒÏ€0.5 é‡‡ç”¨äº†ä¸€ç§æ··åˆç­–ç•¥ï¼š
- **Pre-training (é¢„è®­ç»ƒ)**: ä½¿ç”¨ **FAST Tokenizer** (ç¦»æ•£åŒ–) è¿›è¡Œå¤§è§„æ¨¡é¢„è®­ç»ƒã€‚ç¦»æ•£ Token è®­ç»ƒé€Ÿåº¦å¿«ï¼Œå®¹æ˜“æ‰©å±•åˆ°æµ·é‡æ•°æ®ã€‚
- **Inference (æ¨ç†)**: åœ¨æœ€åä¸€æ­¥ä½¿ç”¨ **Flow Matching** (è¿ç»­åŒ–) è¿›è¡Œå¾®è°ƒå’Œç”Ÿæˆã€‚
- **ä¼˜åŠ¿**: æ—¢äº«å—äº† Tokenization çš„è®­ç»ƒæ•ˆç‡ï¼Œåˆä¿ç•™äº† Flow Matching çš„æ§åˆ¶å¹³æ»‘åº¦ã€‚

## 2. è®­ç»ƒæ•°æ®çš„è‰ºæœ¯ (Data Strategy)

Ï€0.5 çš„å¼ºå¤§æ³›åŒ–èƒ½åŠ›æ¥è‡ªäºå…¶ç‹¬ç‰¹çš„è®­ç»ƒæ•°æ®é…æ¯”ã€‚

### 2.1 å¼‚æ„æ•°æ® Co-training
å®ƒä¸å†ä»…ä»…ä¾èµ–æœºå™¨äººæ•°æ® (Robot Data)ï¼Œè€Œæ˜¯æ··åˆäº†ä¸‰ç§æ•°æ®æºï¼š
1.  **Robot Data (OXE + è‡ªç ”)**: é«˜è´¨é‡ï¼Œå«åŠ¨ä½œæ ‡ç­¾ã€‚ç”¨äºå­¦ä¹ ç‰©ç†æ§åˆ¶ã€‚
2.  **Internet Videos (YouTube)**: æµ·é‡ï¼Œæ— åŠ¨ä½œæ ‡ç­¾ã€‚ç”¨äºå­¦ä¹ "ä¸–ç•Œæ¨¡å‹" (World Model) â€”â€” çŸ¥é“ç‰©ä½“è¢«æ¨ä¼šåŠ¨ï¼Œæ°´å€’å‡ºæ¥ä¼šæµã€‚
3.  **Simulation Data**: å®Œç¾æ ‡æ³¨ï¼Œä½†æœ‰ Reality Gapã€‚ç”¨äºå­¦ä¹ é•¿åºåˆ—é€»è¾‘ã€‚

### 2.2 Cross-Embodiment Alignment (è·¨å½¢æ€å¯¹é½)
Ï€0.5 èƒ½å¤Ÿæ§åˆ¶åŒè‡‚æœºå™¨äººã€ç§»åŠ¨åº•ç›˜ã€ç”šè‡³å››è¶³æœºå™¨äººã€‚
- **ç»Ÿä¸€åŠ¨ä½œç©ºé—´**: å°†ä¸åŒæœºå™¨äººçš„åŠ¨ä½œæ˜ å°„åˆ°ä¸€ä¸ªå…±äº«çš„ **Latent Action Space**ã€‚
- **æ•ˆæœ**: ä½ åœ¨ä¸€ä¸ªå•è‡‚æœºå™¨äººä¸Šè®­ç»ƒçš„"æŠ“æ¯å­"æŠ€èƒ½ï¼Œå¯ä»¥ Zero-shot è¿ç§»åˆ°åŒè‡‚æœºå™¨äººä¸Š (åªéœ€å¾®è°ƒå°‘é‡å‚æ•°)ã€‚

## 3. æ ¸å¿ƒèƒ½åŠ›çªç ´ (Capabilities)

### 3.1 å¼€æ”¾ä¸–ç•Œæ³›åŒ– (Open-World Generalization)
- **åœºæ™¯**: æŠŠæœºå™¨äººæ‰”åˆ°ä¸€ä¸ªä»æœªè§è¿‡çš„å¨æˆ¿ (Airbnb)ã€‚
- **è¡¨ç°**: Ï€0.5 èƒ½å¤Ÿè¯†åˆ«å‡ºä»æœªè§è¿‡çš„å’–å•¡æœºå‹å·ï¼Œå¹¶æ ¹æ®é€šç”¨çš„"æŒ‰æŒ‰é’®"çŸ¥è¯†å°è¯•æ“ä½œï¼Œè€Œä¸æ˜¯å› ä¸ºçº¹ç†ä¸åŒè€Œæ­»æœºã€‚
- **åŸç†**: è¿™ç§èƒ½åŠ›æ¥è‡ªäº VLM Backbone (3B -> 5B) å¼ºå¤§çš„è§†è§‰è¯­ä¹‰ç†è§£èƒ½åŠ›ã€‚

### 3.2 é•¿åºåˆ—ä»»åŠ¡ (Long-Horizon Tasks)
- **ä»»åŠ¡**: "æŠŠæ¡Œå­æ”¶æ‹¾å¹²å‡€" (Bus the table)ã€‚
- **åˆ†è§£**: 
    1. è¯†åˆ«æ‰€æœ‰åƒåœ¾ã€‚
    2. è§„åˆ’é¡ºåº (å…ˆæ‹¿å¤§çš„ï¼Œå†æ“¦æ°´çš„)ã€‚
    3. æ‰§è¡ŒåŠ¨ä½œã€‚
- **æå‡**: ç›¸æ¯” Ï€0ï¼ŒÏ€0.5 åœ¨è¿™ç§å¤šé˜¶æ®µä»»åŠ¡ä¸Šçš„æˆåŠŸç‡æå‡äº† 40% ä»¥ä¸Šã€‚

## 4. ä¸ Ï€0 å’Œ Ï€0.6 çš„å¯¹æ¯”

| ç‰¹æ€§ | Ï€0 (Base) | Ï€0.5 (Explorer) | Ï€0.6 (Master) |
| :--- | :--- | :--- | :--- |
| **æ ¸å¿ƒå…³æ³¨** | åŸºç¡€æ§åˆ¶ï¼Œç‰©ç†ç†è§£ | **ç¯å¢ƒæ³›åŒ–ï¼Œåˆ†å±‚æ¨ç†** | æè‡´ç†Ÿç»ƒåº¦ï¼Œè‡ªæˆ‘è¿›åŒ– |
| **æ¶æ„** | Flow Matching | **Unified (FAST + Flow)** | Unified + **Action Expert** |
| **è®­ç»ƒæ–¹å¼** | BC (æ¨¡ä»¿å­¦ä¹ ) | **Co-training (Web + Sim)** | **Offline RL (Recap)** |
| **é€‚ç”¨åœºæ™¯** | å›ºå®šç¯å¢ƒé‡å¤æ“ä½œ | **æ–°ç¯å¢ƒæ¢ç´¢ï¼Œå®¶åŠ¡** | å·¥å‚æµæ°´çº¿ï¼Œé«˜ç²¾åº¦è£…é… |

> **é¢è¯• Tip**: å¦‚æœè¢«é—®åˆ° Ï€0.5 çš„åˆ›æ–°ç‚¹ï¼Œé‡ç‚¹ç­” **"Hierarchical Inference" (åˆ†å±‚æ¨ç†)** å’Œ **"Open-world Generalization" (å¼€æ”¾ä¸–ç•Œæ³›åŒ–)**ã€‚å®ƒæ˜¯è¿æ¥"é€šè¯†å¤§æ¨¡å‹"å’Œ"ç‰©ç†æ‰§è¡Œå™¨"çš„å…³é”®æ¡¥æ¢ã€‚


---

\newpage

# ç¬¬27ç«  Ï€0.6 è§£æ


> **å‘å¸ƒæ—¶é—´**: 2025å¹´11æœˆ
> **æ ¸å¿ƒå®šä½**: ä»"æ¢é™©å®¶" (Explorer) è¿›åŒ–ä¸º"å¤§å¸ˆ" (Master)ã€‚**Self-Improvement (è‡ªæˆ‘è¿›åŒ–)** æ˜¯å…¶çµé­‚ã€‚

å¦‚æœè¯´ Ï€0.5 è§£å†³äº†"å»å“ªå„¿" (æ³›åŒ–) çš„é—®é¢˜ï¼Œé‚£ä¹ˆ Ï€0.6 åˆ™è§£å†³äº†"åšå¾—å¥½" (ç†Ÿç»ƒåº¦) çš„é—®é¢˜ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Ï€0.6 / Ï€*0.6 æ¶æ„ä¸è®­ç»ƒæµç¨‹                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚                     â”‚  5B VLM Backbone â”‚ â—€â”€â”€ æ›´å¤§çš„è¯­ä¹‰ç†è§£     â”‚
â”‚                     â”‚     (å¤§è„‘)       â”‚                        â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                              â”‚                                  â”‚
â”‚                              â–¼                                  â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚                     â”‚  Action Expert   â”‚ â—€â”€â”€ æ–°å¢! ç²¾ç»†æ§åˆ¶     â”‚
â”‚                     â”‚     (å°è„‘)       â”‚     é«˜é¢‘ç”µæœºä¿¡å·        â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                              â”‚                                  â”‚
â”‚                              â–¼                                  â”‚
â”‚                        ğŸ¦¾ ç²¾ç»†åŠ¨ä½œ                               â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     Ï€*0.6 Recap è®­ç»ƒæµç¨‹                         â”‚
â”‚                                                                 â”‚
â”‚   Phase 1: æ‰§è¡Œä»»åŠ¡ â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ æ”¶é›†æ•°æ® (âœ… æˆåŠŸ + âŒ å¤±è´¥)       â”‚
â”‚                                    â”‚                            â”‚
â”‚   Phase 2: åˆ†æè½¨è¿¹ â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚              â”‚                                                  â”‚
â”‚              â–¼                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚   â”‚         Recap ç®—æ³• (Offline RL)     â”‚                       â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚                       â”‚
â”‚   â”‚  â”‚ âœ… æˆåŠŸè½¨è¿¹ â”‚  â”‚ âŒ å¤±è´¥è½¨è¿¹ â”‚   â”‚                       â”‚
â”‚   â”‚  â”‚  å¥–åŠ±åŠ¨ä½œ   â”‚  â”‚  æŠ‘åˆ¶åŠ¨ä½œ   â”‚   â”‚                       â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚                       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                       â”‚                                         â”‚
â”‚   Phase 3: è‡ªæˆ‘è¿›åŒ– â”€â”€â”˜ â”€â”€â–¶ è¶…è¶Šäººç±»ç¤ºæ•™!                        â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 1. æ ¸å¿ƒæ¶æ„å‡çº§ (Architecture Upgrades)

### 1.1 5B VLM Backbone
- **è§„æ¨¡**: ä» Ï€0 çš„ 3B å‡çº§åˆ° **5B å‚æ•°**ã€‚
- **æ„ä¹‰**: æ›´å¤§çš„æ¨¡å‹æ„å‘³ç€æ›´å¼ºçš„è¯­ä¹‰ç†è§£èƒ½åŠ›ï¼Œèƒ½å¤Ÿå¤„ç†æ›´å¤æ‚çš„é•¿æŒ‡ä»¤ (e.g., "æŠŠé‚£ä¸ªçº¢è‰²çš„ã€æœ‰ç‚¹ç ´æŸçš„ç›’å­æŠ˜å å¥½æ”¾è¿›ç®±å­é‡Œ")ã€‚

### 1.2 Action Expert (åŠ¨ä½œä¸“å®¶)

> **æ ¸å¿ƒåˆ›æ–°**: Action Expert æ˜¯ Ï€0.6 æœ€é‡è¦çš„æ¶æ„å‡çº§ï¼Œè§£å†³äº† VLM "è„‘å­èªæ˜ä½†æ‰‹ç¬¨" çš„é—®é¢˜ã€‚

#### 1.2.1 ä¸ºä»€ä¹ˆéœ€è¦ Action Expert?

| é—®é¢˜ | è¯´æ˜ | è§£å†³æ–¹æ¡ˆ |
| :--- | :--- | :--- |
| **VLM æ‰‹ç¬¨** | é€šç”¨å¤§æ¨¡å‹éš¾ä»¥å¤„ç†ç©¿é’ˆå¼•çº¿ã€ç²¾å¯†è£…é…ç­‰å¾®ç±³çº§æ“ä½œ | ä¸“é—¨çš„åŠ¨ä½œç”Ÿæˆæ¨¡å— |
| **é¢‘ç‡ä¸åŒ¹é…** | VLM æ¨ç†æ…¢ (1-5Hz)ï¼Œç²¾ç»†æ§åˆ¶éœ€è¦é«˜é¢‘ (50-100Hz) | è½»é‡çº§é«˜é¢‘ç½‘ç»œ |
| **èŒè´£æ··ä¹±** | è¯­ä¹‰ç†è§£å’ŒåŠ¨ä½œç”Ÿæˆè€¦åˆï¼Œéš¾ä»¥ä¼˜åŒ– | å¤§è„‘ (VLM) + å°è„‘ (Expert) åˆ†ç¦» |
| **ç¾éš¾æ€§é—å¿˜** | è®­ç»ƒåŠ¨ä½œç”Ÿæˆä¼šç ´å VLM åŸæœ‰çŸ¥è¯† | å†»ç»“ VLMï¼Œåªè®­ç»ƒ Expert |

#### 1.2.2 æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Action Expert è¯¦ç»†æ¶æ„                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   VLM Hidden States              Noisy Actions       Timestep   â”‚
â”‚   [B, L, 2048]                   [B, H, 7]           t âˆˆ [0,1]  â”‚
â”‚   (æ¥è‡ª 5B VLM)                  (å¸¦å™ªå£°çš„åŠ¨ä½œ)       (ODE æ—¶é—´) â”‚
â”‚        â”‚                              â”‚                  â”‚      â”‚
â”‚        â–¼                              â–¼                  â–¼      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ Context Projâ”‚              â”‚ Action In   â”‚    â”‚Time Embedâ”‚ â”‚
â”‚   â”‚ 2048 â†’ 512  â”‚              â”‚ 7 â†’ 512     â”‚    â”‚Sinusoidalâ”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚
â”‚          â”‚                            â”‚                 â”‚       â”‚
â”‚          â”‚                            â–¼                 â”‚       â”‚
â”‚          â”‚                    + Position Embed          â”‚       â”‚
â”‚          â”‚                      (å¯å­¦ä¹ ä½ç½®ç¼–ç )          â”‚       â”‚
â”‚          â”‚                            â”‚                 â”‚       â”‚
â”‚          â”‚                            â–¼                 â”‚       â”‚
â”‚          â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚       â”‚
â”‚          â”‚         â”‚     Transformer Layer Ã— 4       â”‚  â”‚       â”‚
â”‚          â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚       â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  â”‚ 1. Self-Attention (åŠ¨ä½œå†…éƒ¨)â”‚  â”‚â—€â”€â”˜       â”‚
â”‚                    â”‚  â”‚    åŠ¨ä½œåºåˆ—çš„æ—¶åºä¾èµ–       â”‚  â”‚          â”‚
â”‚                    â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚          â”‚
â”‚                    â”‚  â”‚ 2. Cross-Attention (VLMèåˆ)â”‚  â”‚          â”‚
â”‚                    â”‚  â”‚    åŠ¨ä½œ query VLM ç†è§£     â”‚  â”‚          â”‚
â”‚                    â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚          â”‚
â”‚                    â”‚  â”‚ 3. FFN + AdaLN             â”‚  â”‚          â”‚
â”‚                    â”‚  â”‚    æ—¶é—´ä¿¡æ¯æ³¨å…¥            â”‚  â”‚          â”‚
â”‚                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚          â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                    â”‚                            â”‚
â”‚                                    â–¼                            â”‚
â”‚                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                             â”‚ Action Out  â”‚                     â”‚
â”‚                             â”‚ 512 â†’ 7     â”‚                     â”‚
â”‚                             â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                    â”‚                            â”‚
â”‚                                    â–¼                            â”‚
â”‚                           Velocity Field v(a_t, t)              â”‚
â”‚                           [B, H, 7] (é¢„æµ‹é€Ÿåº¦åœº)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 1.2.3 æ ¸å¿ƒç»„ä»¶

**1. AdaLN (Adaptive Layer Norm) - æ—¶é—´æ³¨å…¥**

```python
class AdaLayerNorm(nn.Module):
    """ç”¨æ—¶é—´åµŒå…¥åŠ¨æ€è°ƒåˆ¶ LayerNorm çš„ scale å’Œ shift"""
    
    def forward(self, x, t_emb):
        # ä»æ—¶é—´åµŒå…¥ç”ŸæˆåŠ¨æ€å‚æ•°
        scale, shift = self.adaln_modulation(t_emb).chunk(2, dim=-1)
        
        # æ ‡å‡† LayerNorm
        x = self.norm(x)
        
        # åŠ¨æ€è°ƒåˆ¶: y = x * (1 + scale) + shift
        return x * (1 + scale.unsqueeze(1)) + shift.unsqueeze(1)
```

**ä¸ºä»€ä¹ˆéœ€è¦ AdaLN?**
- Flow Matching ä¸­ï¼Œä¸åŒæ—¶é—´æ­¥ t çš„å™ªå£°æ°´å¹³ä¸åŒ
- æ¨¡å‹éœ€è¦çŸ¥é“å½“å‰åœ¨ ODE çš„å“ªä¸ªé˜¶æ®µ
- AdaLN å°†æ—¶é—´ä¿¡æ¯æ³¨å…¥åˆ°æ¯ä¸€å±‚ï¼ŒæŒ‡å¯¼å»å™ªè¿‡ç¨‹

**2. Cross-Attention - VLM èåˆ**

```python
## åŠ¨ä½œåºåˆ— attend to VLM context
x_norm = self.cross_attn_norm(x, t_emb)
x = x + self.cross_attn(
    query=x_norm,        # åŠ¨ä½œ (éœ€è¦ç”Ÿæˆä»€ä¹ˆåŠ¨ä½œ?)
    key=context,         # VLM (ç†è§£äº†ä»€ä¹ˆ?)
    value=context        # VLM (è¦åšä»€ä¹ˆ?)
)[0]
```

**3. å®Œæ•´å•å±‚å®ç°**

```python
class ActionExpertLayer(nn.Module):
    """å•å±‚ Action Expert: Self-Attn â†’ Cross-Attn â†’ FFN"""
    
    def forward(self, x, context, t_emb):
        # 1. Self-Attention: å­¦ä¹ åŠ¨ä½œåºåˆ—å†…éƒ¨çš„æ—¶åºå…³ç³»
        x_norm = self.self_attn_norm(x, t_emb)
        x = x + self.self_attn(x_norm, x_norm, x_norm)[0]
        
        # 2. Cross-Attention: åŠ¨ä½œ query VLM context
        x_norm = self.cross_attn_norm(x, t_emb)
        x = x + self.cross_attn(x_norm, context, context)[0]
        
        # 3. FFN: éçº¿æ€§å˜æ¢
        x_norm = self.ffn_norm(x, t_emb)
        x = x + self.ffn(x_norm)
        
        return x
```

#### 1.2.4 é…ç½®å‚æ•°

| å‚æ•° | å€¼ | è¯´æ˜ |
| :--- | :--- | :--- |
| `num_layers` | 4 | Transformer å±‚æ•° (è½»é‡çº§) |
| `num_heads` | 8 | æ³¨æ„åŠ›å¤´æ•° |
| `hidden_dim` | 512 | éšè—å±‚ç»´åº¦ |
| `action_dim` | 7 | åŠ¨ä½œç»´åº¦ (xyz + rotation + gripper) |
| `action_horizon` | 50 | Action Chunk é•¿åº¦ |
| **æ€»å‚æ•°é‡** | **~10M** | ç›¸æ¯” 5B VLM éå¸¸è½»é‡ |

#### 1.2.5 ä¸ Ï€0 çš„å¯¹æ¯”

| ç‰¹æ€§ | Ï€0 (Flow Matching) | Ï€0.6 (Action Expert) |
| :--- | :--- | :--- |
| **VLM å‚æ•°** | 3B (PaliGemma) | 5B (Gemma 3) |
| **åŠ¨ä½œç”Ÿæˆ** | VLM ç›´æ¥è¾“å‡º | ç‹¬ç«‹ Action Expert |
| **Expert å‚æ•°** | - | ~10M |
| **ç²¾ç»†æ§åˆ¶** | ä¸€èˆ¬ | **å¼º** (ä¸“é—¨ä¼˜åŒ–) |
| **è®­ç»ƒç­–ç•¥** | è”åˆè®­ç»ƒ | å¯å†»ç»“ VLMï¼Œåªè®­ç»ƒ Expert |
| **æ¨ç†é€Ÿåº¦** | å¿« | æ›´å¿« (Expert è½»é‡) |

#### 1.2.6 ç±»æ¯”ï¼šå¤§è„‘ä¸å°è„‘çš„åˆ†å·¥

```
äººç±»ç¥ç»ç³»ç»Ÿ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     å¤§è„‘        â”‚ â”€â”€â–¶ â”‚     å°è„‘        â”‚ â”€â”€â–¶ ç²¾ç»†åŠ¨ä½œ
â”‚  (ç†è§£/è§„åˆ’)    â”‚     â”‚  (è¿åŠ¨åè°ƒ)     â”‚
â”‚  "æˆ‘è¦æŠ“é‚£ä¸ªæ¯å­" â”‚     â”‚  "æ‰‹æŒ‡å¼ å¼€ã€ç§»åŠ¨ã€é—­åˆ" â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Ï€0.6 æ¶æ„:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   5B VLM        â”‚ â”€â”€â–¶ â”‚  Action Expert  â”‚ â”€â”€â–¶ ç²¾ç»†åŠ¨ä½œ
â”‚  (ç†è§£/è§„åˆ’)    â”‚     â”‚  (åŠ¨ä½œç”Ÿæˆ)     â”‚
â”‚  è¯­ä¹‰ç†è§£       â”‚     â”‚  é«˜é¢‘æ§åˆ¶ä¿¡å·   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 1.2.7 é¢è¯•å¸¸è§é—®é¢˜

**Q1: Action Expert ä¸ºä»€ä¹ˆè¦ç‹¬ç«‹å‡ºæ¥ï¼Œè€Œä¸æ˜¯è®© VLM ç›´æ¥è¾“å‡ºåŠ¨ä½œ?**

A: å››ä¸ªåŸå› :
1. **èŒè´£åˆ†ç¦»**: VLM è´Ÿè´£ç†è§£ï¼ŒExpert è´Ÿè´£ç”Ÿæˆï¼Œå„å¸å…¶èŒ
2. **æ•ˆç‡**: Expert åªæœ‰ ~10M å‚æ•°ï¼Œå¯ä»¥é«˜é¢‘è¿­ä»£ ODE æ­¥éª¤ (Flow Matching éœ€è¦å¤šæ­¥)
3. **é˜²æ­¢é—å¿˜**: è®­ç»ƒæ—¶å¯å†»ç»“ VLMï¼Œåªè®­ç»ƒ Expertï¼Œä¿æŠ¤ VLM åŸæœ‰çŸ¥è¯†
4. **çµæ´»æ€§**: å¯ä»¥æ›¿æ¢ä¸åŒçš„ VLM backboneï¼ŒExpert ä¿æŒä¸å˜

**Q2: AdaLN å’Œæ™®é€š LayerNorm æœ‰ä»€ä¹ˆåŒºåˆ«?**

A:
```
æ™®é€š LayerNorm:  y = (x - Î¼) / Ïƒ * Î³ + Î²      (Î³, Î² æ˜¯å›ºå®šå¯å­¦ä¹ å‚æ•°)
AdaLN:          y = (x - Î¼) / Ïƒ * (1 + scale(t)) + shift(t)  (ç”±æ—¶é—´ t åŠ¨æ€ç”Ÿæˆ)
```
AdaLN è®©æ¨¡å‹çŸ¥é“å½“å‰åœ¨ ODE çš„å“ªä¸ªé˜¶æ®µï¼Œä¸åŒé˜¶æ®µæœ‰ä¸åŒçš„å»å™ªè¡Œä¸ºã€‚

**Q3: Cross-Attention ä¸­ï¼Œè°æ˜¯ Queryï¼Œè°æ˜¯ Key/Value?**

A:
- **Query**: åŠ¨ä½œåºåˆ— (éœ€è¦ç”Ÿæˆä»€ä¹ˆåŠ¨ä½œ?)
- **Key/Value**: VLM context (ç†è§£äº†ä»€ä¹ˆå†…å®¹?)

åŠ¨ä½œ "è¯¢é—®" VLM "æˆ‘åº”è¯¥åšä»€ä¹ˆ?"ï¼ŒVLM å›ç­” "ä½ åº”è¯¥......"

**Q4: ä¸ºä»€ä¹ˆ Action Expert åªæœ‰ 4 å±‚?**

A: 
- Flow Matching éœ€è¦å¤šæ­¥ ODE è¿­ä»£ (é€šå¸¸ 1-10 æ­¥)
- æ¯æ­¥éƒ½è¦è¿‡ä¸€é Expertï¼Œå¤ªæ·±ä¼šå¾ˆæ…¢
- 4 å±‚è¶³å¤Ÿå°† VLM ç†è§£è½¬åŒ–ä¸ºåŠ¨ä½œï¼Œå¤æ‚æ¨ç†ç”± VLM å®Œæˆ

> **è¯¦ç»†ä»£ç å®ç°**: å‚è§ [Ï€0 æ¨¡å‹ä»£ç æ·±åº¦è§£æ](./pi0_code_analysis.md#5-action-expert-è¯¦è§£)

---

## 2. Ï€*0.6 (Pi-Star): å¼ºåŒ–å­¦ä¹ çš„å¼•å…¥

Ï€0.6 çš„æœ€å¼ºå½¢æ€æ˜¯ **Ï€*0.6**ï¼Œå®ƒæ˜¯ç»è¿‡ RL å¼ºåŒ–åçš„ç‰ˆæœ¬ã€‚

### 2.1 Recap ç®—æ³• (The Recap Algorithm)
è¿™æ˜¯ Ï€*0.6 çš„æ ¸å¿ƒç§˜å¯†æ­¦å™¨ã€‚
- **ä¼ ç»Ÿæ–¹æ³• (BC)**: æ¨¡ä»¿äººç±»ç¤ºæ•™ã€‚äººç±»æ€ä¹ˆåšï¼Œæœºå™¨äººå°±æ€ä¹ˆåšã€‚ä¸Šé™æ˜¯äººç±»æ°´å¹³ã€‚
- **Recap (Offline RL)**:
    - **å¤ç›˜ (Recap)**: æ¨¡å‹ä¸ä»…å­¦ä¹ æˆåŠŸçš„è½¨è¿¹ï¼Œè¿˜å­¦ä¹ **å¤±è´¥**çš„è½¨è¿¹ã€‚
    - **æœºåˆ¶**:
        1. æœºå™¨äººå°è¯•æ‰§è¡Œä»»åŠ¡ï¼Œæ”¶é›†æ•°æ® (åŒ…å«æˆåŠŸå’Œå¤±è´¥)ã€‚
        2. ç®—æ³•åˆ†æå¤±è´¥æ¡ˆä¾‹ï¼Œæ ‡è®°"å“ªä¸€æ­¥èµ°é”™äº†"ã€‚
        3. åœ¨ä¸‹ä¸€æ¬¡è®­ç»ƒä¸­ï¼ŒæŠ‘åˆ¶å¯¼è‡´å¤±è´¥çš„åŠ¨ä½œæ¦‚ç‡ï¼Œå¥–åŠ±å¯¼è‡´æˆåŠŸçš„åŠ¨ä½œã€‚
    - **æ•ˆæœ**: å°±åƒäººç±»ç»ƒçƒä¸€æ ·ï¼Œé€šè¿‡ä¸æ–­çš„è¯•é”™å’Œå¤ç›˜ï¼Œæœ€ç»ˆè¶…è¶Šæ•™ç»ƒ (äººç±»ç¤ºæ•™è€…)ã€‚

### 2.2 æ€§èƒ½é£è·ƒ (Performance Leap)
- **ååé‡ (Throughput)**: åœ¨æŠ˜å è¡£ç‰©ã€åˆ¶ä½œå’–å•¡ç­‰ä»»åŠ¡ä¸Šï¼ŒÏ€*0.6 çš„æ“ä½œé€Ÿåº¦æ˜¯ Ï€0.5 çš„ **2å€**ã€‚
- **é²æ£’æ€§**: å¤±è´¥ç‡é™ä½äº† **50%** ä»¥ä¸Šã€‚
- **è¿ç»­å·¥ä½œ**: å±•ç¤ºäº†è¿ç»­å·¥ä½œ 24 å°æ—¶æ— æ•…éšœçš„èƒ½åŠ› (Making Espresso all day)ã€‚

## 3. è®­ç»ƒèŒƒå¼çš„è½¬å˜ (Paradigm Shift)

ä» **Supervised Learning (ç›‘ç£å­¦ä¹ )** è½¬å‘ **Data-Driven Self-Improvement (æ•°æ®é©±åŠ¨çš„è‡ªæˆ‘è¿›åŒ–)**ã€‚

1.  **Phase 1: Pre-training**: ä½¿ç”¨æµ·é‡äº’è”ç½‘æ•°æ® + æœºå™¨äººæ•°æ®ï¼Œè®­ç»ƒå‡ºä¸€ä¸ª Base Model (Ï€0.6)ã€‚
2.  **Phase 2: Interaction**: æœºå™¨äººåœ¨ä»¿çœŸæˆ–çœŸæœºä¸­å¤§é‡è¿è¡Œï¼Œæ”¶é›†ç»éªŒã€‚
3.  **Phase 3: Post-training (Recap)**: ä½¿ç”¨ Offline RL ç®—æ³•åœ¨æ”¶é›†çš„æ•°æ®ä¸Šè¿›è¡Œå¼ºåŒ–å­¦ä¹ ï¼Œå¾—åˆ° Ï€*0.6ã€‚

## 4. æ€»ç»“ï¼šPi ç³»åˆ—è¿›åŒ–å²

| æ¨¡å‹ | æ ¸å¿ƒå…³é”®è¯ | è§£å†³çš„é—®é¢˜ | ç±»ä¼¼äººç±»é˜¶æ®µ |
| :--- | :--- | :--- | :--- |
| **Ï€0** | Flow Matching | æ€ä¹ˆåŠ¨ï¼Ÿ(åŸºç¡€æ§åˆ¶) | å©´å„¿å­¦æ­¥ |
| **Ï€0.5** | Open-World | æ€ä¹ˆé€‚åº”ï¼Ÿ(ç¯å¢ƒæ³›åŒ–) | å¹¼å„¿æ¢ç´¢ä¸–ç•Œ |
| **Ï€0.6** | Action Expert | æ€ä¹ˆåšç»†ï¼Ÿ(ç²¾ç»†æ“ä½œ) | æŠ€å·¥å­¦å¾’ |
| **Ï€*0.6** | **Recap (RL)** | **æ€ä¹ˆåšå¾—æ›´å¥½ï¼Ÿ(è‡ªæˆ‘è¿›åŒ–)** | **è¡Œä¸šå¤§å¸ˆ** |

> **é¢è¯• Tip**: é‡ç‚¹å¼ºè°ƒ **Recap ç®—æ³•** å’Œ **Offline RL**ã€‚è¿™æ˜¯ç›®å‰ Embodied AI é¢†åŸŸä»"èƒ½ç”¨"èµ°å‘"å¥½ç”¨"çš„å…³é”®æŠ€æœ¯è·¯å¾„ã€‚


---

\newpage

# ç¬¬28ç«  Galaxea G0


> [!IMPORTANT]
> **Galaxea G0** æ˜¯**æ˜Ÿæµ·å›¾æ™ºèƒ½ï¼ˆGalaxeaï¼‰** å¼€å‘çš„**åŒç³»ç»Ÿ VLA æ¡†æ¶**ï¼Œé€šè¿‡åˆ†ç¦»**è§„åˆ’ï¼ˆVLMï¼‰**å’Œ**æ‰§è¡Œï¼ˆVLAï¼‰**ï¼Œå®ç°äº†æ›´å¼ºçš„æ³›åŒ–èƒ½åŠ›å’Œé•¿æ—¶åŸŸä»»åŠ¡å¤„ç†èƒ½åŠ›ã€‚

## 1. æ¦‚è¿°
Galaxea G0 æ˜¯ä¸€ä¸ªåˆ›æ–°çš„åŒç³»ç»Ÿæ¶æ„ï¼Œæ—¨åœ¨è§£å†³ä¼ ç»Ÿå•ä¸€ VLA æ¨¡å‹åœ¨**é•¿æ—¶åŸŸç§»åŠ¨æ“ä½œ**ï¼ˆlong-horizon mobile manipulationï¼‰ä»»åŠ¡ä¸­çš„æ³›åŒ–ç“¶é¢ˆã€‚

-   **å¼€å‘è€…**: æ˜Ÿæµ·å›¾æ™ºèƒ½ï¼ˆGalaxeaï¼‰
-   **è®ºæ–‡**: [Galaxea Open-World Dataset and G0 Dual-System VLA Model (arXiv:2509.00576)](https://arxiv.org/abs/2509.00576)
-   **æ ¸å¿ƒåˆ›æ–°**: **åŒç³»ç»Ÿæ¶æ„** - å°†é«˜å±‚è§„åˆ’å’Œä½å±‚æ‰§è¡Œè§£è€¦
-   **æ•°æ®é›†**: Galaxea Open-World Datasetï¼ˆ500+ å°æ—¶ï¼Œ50 ä¸ªçœŸå®åœºæ™¯ï¼‰

## 2. æ ¸å¿ƒåˆ›æ–°ï¼šåŒç³»ç»Ÿæ¶æ„

### 2.1. ä¸ºä»€ä¹ˆéœ€è¦åŒç³»ç»Ÿï¼Ÿ
ä¼ ç»Ÿçš„å•ä¸€ VLA æ¨¡å‹é¢ä¸´ä»¥ä¸‹æŒ‘æˆ˜ï¼š
-   **é•¿æ—¶åŸŸä»»åŠ¡**: éœ€è¦åŒæ—¶å¤„ç†é«˜å±‚è§„åˆ’ï¼ˆ"å…ˆå»å®¢å…ï¼Œå†å»å¨æˆ¿"ï¼‰å’Œä½å±‚æ§åˆ¶ï¼ˆ"æŠ“å–æ¯å­"ï¼‰ã€‚
-   **æ³›åŒ–ç“¶é¢ˆ**: å•ä¸€æ¨¡å‹éš¾ä»¥åŒæ—¶ä¼˜åŒ–è¯­ä¹‰ç†è§£å’Œç²¾ç»†æ“ä½œã€‚
-   **æ•°æ®æ•ˆç‡**: éœ€è¦å¤§é‡ç«¯åˆ°ç«¯æ•°æ®ï¼Œä½†é•¿æ—¶åŸŸæ•°æ®æ”¶é›†æˆæœ¬æé«˜ã€‚

### 2.2. G0 çš„è§£å†³æ–¹æ¡ˆï¼šåˆ†å±‚è§£è€¦
Galaxea G0 é‡‡ç”¨**ä¸¤ä¸ªç‹¬ç«‹ä½†åä½œçš„æ¨¡å‹**ï¼š

```
ç”¨æˆ·æŒ‡ä»¤ â†’ [ G0-VLM ] â†’ å­ä»»åŠ¡åºåˆ— â†’ [ G0-VLA ] â†’ æœºå™¨äººåŠ¨ä½œ
          (è§„åˆ’å¤§è„‘)                    (æ‰§è¡Œå°è„‘)
```

#### 2.2.1. G0-VLM (Vision-Language Model)
-   **èŒè´£**: å¤šæ¨¡æ€è§„åˆ’ï¼Œé«˜å±‚æ¨ç†
-   **è¾“å…¥**: è§†è§‰è§‚å¯Ÿ + ç”¨æˆ·æŒ‡ä»¤ï¼ˆå¦‚ "æŠŠå®¢å…çš„æ¯å­æ‹¿åˆ°å¨æˆ¿"ï¼‰
-   **è¾“å‡º**: å­ä»»åŠ¡åºåˆ—ï¼ˆå¦‚ `["å¯¼èˆªåˆ°å®¢å…", "æŠ“å–æ¯å­", "å¯¼èˆªåˆ°å¨æˆ¿", "æ”¾ä¸‹æ¯å­"]`ï¼‰
-   **ä¼˜åŠ¿**: ä¿ç•™ VLM çš„å¼ºå¤§è¯­ä¹‰ç†è§£å’Œå¸¸è¯†æ¨ç†èƒ½åŠ›

#### 2.2.2. G0-VLA (Vision-Language-Action Model)
-   **èŒè´£**: ç»†ç²’åº¦æ‰§è¡Œï¼Œä½å±‚æ§åˆ¶
-   **è¾“å…¥**: å½“å‰å­ä»»åŠ¡ + è§†è§‰è§‚å¯Ÿ
-   **è¾“å‡º**: è¿ç»­åŠ¨ä½œï¼ˆå…³èŠ‚è§’åº¦ã€åº•ç›˜é€Ÿåº¦ï¼‰
-   **ä¼˜åŠ¿**: ä¸“æ³¨äºç²¾ç¡®çš„æ„ŸçŸ¥-åŠ¨ä½œæ˜ å°„ï¼Œä¸è¢«é•¿æ—¶åŸŸä»»åŠ¡åˆ†å¿ƒ

## 3. è®­ç»ƒç­–ç•¥ï¼šä¸‰é˜¶æ®µè¯¾ç¨‹å­¦ä¹ 

Galaxea G0 é‡‡ç”¨**ä¸‰é˜¶æ®µæ¸è¿›å¼è®­ç»ƒ**ï¼š

### é˜¶æ®µ 1: è·¨å…·èº«é¢„è®­ç»ƒ (Cross-Embodiment Pre-training)
-   **æ•°æ®**: Open X-Embodiment ç­‰å¤§è§„æ¨¡å¤šæ ·åŒ–æ•°æ®
-   **ç›®æ ‡**: å­¦ä¹ é€šç”¨çš„ä¸–ç•ŒçŸ¥è¯†å’ŒåŠ¨ä½œå…ˆéªŒ
-   **æ•ˆæœ**: æ¨¡å‹è·å¾—å¹¿æ³›çš„ä»»åŠ¡ç†è§£èƒ½åŠ›

### é˜¶æ®µ 2: å•å…·èº«é¢„è®­ç»ƒ (Single-Embodiment Pre-training)
-   **æ•°æ®**: **Galaxea Open-World Dataset**ï¼ˆåŒä¸€æœºå™¨äºº R1 Liteï¼Œ500+ å°æ—¶ï¼‰
-   **ç›®æ ‡**: é€‚é…ç‰¹å®šæœºå™¨äººçš„æ„ŸçŸ¥-åŠ¨ä½œèƒ½åŠ›
-   **å…³é”®**: è¿™æ˜¯ G0 æ€§èƒ½æå‡çš„**æ ¸å¿ƒé˜¶æ®µ**

### é˜¶æ®µ 3: ä»»åŠ¡åè®­ç»ƒ (Task-Specific Post-training)
-   **æ•°æ®**: é«˜è´¨é‡çš„ç‰¹å®šä»»åŠ¡æ¼”ç¤º
-   **ç›®æ ‡**: ç²¾è°ƒå¤æ‚æŠ€èƒ½ï¼ˆå¦‚ç²¾ç»†æŠ“å–ã€çµå·§æ“ä½œï¼‰
-   **æ•ˆæœ**: æœ€ç»ˆæ€§èƒ½ä¼˜åŒ–

## 4. Galaxea Open-World Dataset

è¿™æ˜¯ G0 çš„**å…³é”®æ•°æ®èµ„äº§**ï¼š

### 4.1. æ•°æ®è§„æ¨¡
-   **æ—¶é•¿**: 500+ å°æ—¶
-   **åœºæ™¯**: 50 ä¸ªçœŸå®ç¯å¢ƒï¼ˆä½å®…ã€å¨æˆ¿ã€é›¶å”®ã€åŠå…¬å®¤ï¼‰
-   **ä»»åŠ¡**: 150+ ç§ä»»åŠ¡ï¼ˆç§»åŠ¨ã€æŠ“å–ã€æ”¾ç½®ã€å¯¼èˆªï¼‰
-   **å…·èº«**: ç»Ÿä¸€ä½¿ç”¨ Galaxea R1 Lite æœºå™¨äºº

### 4.2. æ•°æ®ç‰¹ç‚¹
-   **çœŸå®ä¸–ç•Œ**: éæ¨¡æ‹Ÿï¼ŒçœŸå®çš„æ‚ä¹±ç¯å¢ƒ
-   **å­ä»»åŠ¡æ ‡æ³¨**: ç²¾ç¡®çš„å±‚çº§æ ‡æ³¨ï¼ˆä»»åŠ¡ â†’ å­ä»»åŠ¡ â†’ åŠ¨ä½œï¼‰
-   **è¯­è¨€å¯Œé›†**: æ¯ä¸ªå­ä»»åŠ¡éƒ½æœ‰è‡ªç„¶è¯­è¨€æè¿°
-   **å¼€æº**: å®Œå…¨å…¬å¼€ï¼Œå¯ç”¨äºç ”ç©¶

### 4.3. ä¸å…¶ä»–æ•°æ®é›†çš„å¯¹æ¯”
| æ•°æ®é›† | æ—¶é•¿ | å…·èº«ä¸€è‡´æ€§ | ç§»åŠ¨æ“ä½œ | å­ä»»åŠ¡æ ‡æ³¨ |
| :--- | :--- | :--- | :--- | :--- |
| **Galaxea Open-World** | **500+ hr** | **å•ä¸€æœºå™¨äºº** | **âœ“** | **âœ“** |
| Open X-Embodiment | 1000+ hr | å¤šæœºå™¨äºº | éƒ¨åˆ† | âœ— |
| BridgeData | 100+ hr | å•ä¸€æœºå™¨äºº | âœ— | âœ— |

## 5. æ€§èƒ½è¡¨ç°

G0 æ¨¡å‹åœ¨å¤šä¸ªåŸºå‡†æµ‹è¯•ä¸­è¡¨ç°å‡ºè‰²ï¼š

### 5.1. æ¡Œé¢æ“ä½œ (Tabletop Manipulation)
-   **æˆåŠŸç‡**: æ˜¾è‘—ä¼˜äºå•ä¸€ VLA åŸºçº¿
-   **æ³›åŒ–**: å¯¹æ–°ç‰©ä½“å’Œæ–°åœºæ™¯æ³›åŒ–èƒ½åŠ›å¼º

### 5.2. å°‘æ ·æœ¬å­¦ä¹  (Few-Shot Learning)
-   **ä¼˜åŠ¿**: å•å…·èº«é¢„è®­ç»ƒé˜¶æ®µä½¿æ¨¡å‹èƒ½å¿«é€Ÿé€‚åº”æ–°ä»»åŠ¡

### 5.3. é•¿æ—¶åŸŸç§»åŠ¨æ“ä½œ (Long-Horizon Mobile Manipulation)
-   **æ ¸å¿ƒä¼˜åŠ¿**: åŒç³»ç»Ÿæ¶æ„åœ¨å¤šæ­¥éª¤ä»»åŠ¡ä¸­è¡¨ç°çªå‡º
-   **ç¤ºä¾‹**: "ä»å§å®¤æ‹¿é¥æ§å™¨åˆ°å®¢å…ï¼Œç„¶åå»å¨æˆ¿æ‹¿æ¯å­" - æˆåŠŸç‡ 85%+

## 6. åŒç³»ç»Ÿ vs å•ç³»ç»Ÿ
| ç‰¹æ€§ | **åŒç³»ç»Ÿ (G0)** | å•ç³»ç»Ÿ (ä¼ ç»Ÿ VLA) |
| :--- | :--- | :--- |
| **é•¿æ—¶åŸŸä»»åŠ¡** | **å¼ºï¼ˆåˆ†å±‚è§„åˆ’ï¼‰** | å¼±ï¼ˆç«¯åˆ°ç«¯å›°éš¾ï¼‰|
| **æ³›åŒ–èƒ½åŠ›** | **å¼ºï¼ˆVLM ä¿ç•™ï¼‰** | ä¸­ï¼ˆæ˜“è¿‡æ‹Ÿåˆï¼‰|
| **æ•°æ®æ•ˆç‡** | **é«˜ï¼ˆåˆ†é˜¶æ®µè®­ç»ƒï¼‰** | ä½ï¼ˆéœ€å¤§é‡ç«¯åˆ°ç«¯æ•°æ®ï¼‰|
| **æ¨ç†é€Ÿåº¦** | ç¨æ…¢ï¼ˆä¸¤é˜¶æ®µï¼‰| å¿«ï¼ˆä¸€æ¬¡æ¨ç†ï¼‰|
| **å¯è§£é‡Šæ€§** | **å¼ºï¼ˆå­ä»»åŠ¡å¯è§ï¼‰** | å¼±ï¼ˆé»‘ç›’ï¼‰|

## 7. é¢è¯•è¦ç‚¹
-   **åŒç³»ç»Ÿæ¶æ„**: è®°ä½ G0-VLMï¼ˆè§„åˆ’ï¼‰+ G0-VLAï¼ˆæ‰§è¡Œï¼‰çš„åˆ†å·¥ã€‚
-   **ä¸‰é˜¶æ®µè®­ç»ƒ**: è·¨å…·èº« â†’ å•å…·èº«ï¼ˆå…³é”®ï¼‰â†’ ä»»åŠ¡åè®­ç»ƒã€‚
-   **Galaxea Open-World Dataset**: 500+ å°æ—¶ï¼Œ50 åœºæ™¯ï¼Œç»Ÿä¸€å…·èº«ï¼Œå­ä»»åŠ¡æ ‡æ³¨ã€‚
-   **æ ¸å¿ƒä¼˜åŠ¿**: é•¿æ—¶åŸŸç§»åŠ¨æ“ä½œï¼Œæ³›åŒ–èƒ½åŠ›å¼ºã€‚
-   **ä¸å…¶ä»–æ¨¡å‹å¯¹æ¯”**: 
    - vs Pi0: Pi0 æ˜¯å•ä¸€æ¨¡å‹ï¼ŒG0 æ˜¯åŒç³»ç»Ÿã€‚
    - vs WALL-OSS: WALL-OSS å¼ºè°ƒ Uni-CoTï¼ŒG0 å¼ºè°ƒåˆ†å±‚è§£è€¦ã€‚

## 8. å‚è€ƒèµ„æº
-   **è®ºæ–‡**: [arXiv:2509.00576](https://arxiv.org/abs/2509.00576)
-   **æ•°æ®é›†**: [Hugging Face - Galaxea Open-World Dataset](https://huggingface.co/datasets/Galaxea/Open-World-Dataset)
-   **GitHub**: [Galaxea G0](https://github.com/Galaxea/G0)
-   **å®˜ç½‘**: [æ˜Ÿæµ·å›¾æ™ºèƒ½](https://galaxea-ai.com/)

\newpage

# ç¬¬ä¸ƒéƒ¨åˆ†ï¼šè¯„ä¼°ä¸æ¨ç†


\newpage

# ç¬¬29ç«  WALL-OSS


> [!IMPORTANT]
> **WALL-OSS** (World-Action-Language-Learning â€“ Open Source Systemï¼Œä¸–ç•Œ-åŠ¨ä½œ-è¯­è¨€-å­¦ä¹  å¼€æºç³»ç»Ÿ) æ˜¯ **X Square Robot (è‡ªå˜é‡æœºå™¨äºº)** çš„é‡è¦å¼€æºè´¡çŒ®ï¼Œæ—¨åœ¨å¼¥åˆé™æ€ VLM ä¸åŠ¨æ€ç‰©ç†äº¤äº’ä¹‹é—´çš„é¸¿æ²Ÿã€‚å®ƒè¢«è®¾è®¡ä¸ºå…·èº« AI çš„ "Linux æ—¶åˆ»"ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WALL-OSS æ¶æ„ (Uni-CoT)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   è¾“å…¥: ğŸ“· å›¾åƒ + ğŸ“ "æ¸…æ´æ¡Œå­"                                  â”‚
â”‚              â”‚                                                  â”‚
â”‚              â–¼                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚   â”‚       Qwen2.5 VLMoE Backbone            â”‚                  â”‚
â”‚   â”‚         (ä¸“å®¶æ··åˆæ¶æ„)                   â”‚                  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                     â”‚                                          â”‚
â”‚                     â–¼                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚   â”‚           Uni-CoT æ¨ç†é“¾                 â”‚                  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                  â”‚
â”‚   â”‚  â”‚ 1. é«˜å±‚æ¨ç†: ç†è§£"æ¸…æ´æ¡Œå­"      â”‚    â”‚                  â”‚
â”‚   â”‚  â”‚         â†“                       â”‚    â”‚                  â”‚
â”‚   â”‚  â”‚ 2. å­ä»»åŠ¡åˆ†è§£: æ‰¾æµ·ç»µâ†’æŠ“å–â†’æ“¦æ‹­  â”‚    â”‚                  â”‚
â”‚   â”‚  â”‚         â†“                       â”‚    â”‚                  â”‚
â”‚   â”‚  â”‚ 3. ç»†ç²’åº¦åŠ¨ä½œ: (x,y,z) è½¨è¿¹      â”‚    â”‚                  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                     â”‚                                          â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚         â”‚                       â”‚                              â”‚
â”‚         â–¼                       â–¼                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚   â”‚ ç¦»æ•£å¤´    â”‚          â”‚ è¿ç»­å¤´    â”‚                         â”‚
â”‚   â”‚(FAST Token)â”‚          â”‚(Flow Match)â”‚                        â”‚
â”‚   â”‚  é«˜å±‚å†³ç­–  â”‚          â”‚  å¹³æ»‘è½¨è¿¹  â”‚                         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚         â”‚                      â”‚                               â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                    â–¼                                           â”‚
â”‚              ğŸ¦¾ åŒå¤´åŠ¨ä½œè¾“å‡º                                     â”‚
â”‚                                                                 â”‚
â”‚   åˆ›æ–°: ç»Ÿä¸€æ¨ç†é“¾ (Uni-CoT) = å¤§è„‘è§„åˆ’ + å°è„‘æ§åˆ¶               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 1. æ¦‚è¿°
WALL-OSS æ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯çš„å…·èº«åŸºç¡€æ¨¡å‹ï¼Œé›†æˆäº†**è§†è§‰ã€è¯­è¨€å’ŒåŠ¨ä½œ (VLA)**ã€‚ä¸ä¼ ç»Ÿçš„å°†æ„ŸçŸ¥ã€è§„åˆ’å’Œæ§åˆ¶åˆ†ç¦»çš„æµæ°´çº¿ä¸åŒï¼ŒWALL-OSS å°†è¿™äº›ç»Ÿä¸€åˆ°ä¸€ä¸ªå¯å¾®åˆ†ç³»ç»Ÿä¸­ã€‚

-   **å¼€å‘è€…**: X Square Robot (è‡ªå˜é‡æœºå™¨äºº)
-   **å‘å¸ƒæ—¥æœŸ**: 2025 å¹´
-   **æ ¸å¿ƒç›®æ ‡**: ä½¿æœºå™¨äººèƒ½å¤Ÿç†è§£ä¸–ç•Œ (World)ã€æ¨ç†ä»»åŠ¡ (Language) å¹¶æ‰§è¡Œå¤æ‚åŠ¨ä½œ (Action)ï¼Œä»¥ç»Ÿä¸€çš„æ–¹å¼ã€‚
-   **å¼€æº**: [GitHub](https://github.com/X-Square-Robot/wall-x) | [Hugging Face](https://huggingface.co/X-Square-Robot)

## 2. æ ¸å¿ƒåˆ›æ–°ï¼šUni-CoT
WALL-OSS çš„çªå‡ºç‰¹ç‚¹æ˜¯**ç»Ÿä¸€è·¨å±‚æ€ç»´é“¾ (Unified Cross-Level Chain-of-Thought, Uni-CoT)**ã€‚

ä¼ ç»Ÿ LLM ä¸­çš„ CoT (æ€ç»´é“¾) ä¸“æ³¨äºè¯­ä¹‰æ¨ç†ã€‚WALL-OSS å°†å…¶æ‰©å±•åˆ°ç‰©ç†é¢†åŸŸï¼š
1.  **é«˜å±‚æ¨ç†**: ç†è§£ç”¨æˆ·æ„å›¾ï¼ˆä¾‹å¦‚ï¼š"æ¸…æ´æ¡Œå­"ï¼‰ã€‚
2.  **å­ä»»åŠ¡åˆ†è§£**: å°†å…¶åˆ†è§£ï¼ˆä¾‹å¦‚ï¼š"æ‰¾åˆ°æµ·ç»µ"ã€"æŠ“å–æµ·ç»µ"ã€"æ“¦æ‹­è¡¨é¢"ï¼‰ã€‚
3.  **ç»†ç²’åº¦åŠ¨ä½œåˆæˆ**: ç”Ÿæˆç²¾ç¡®çš„å…³èŠ‚è§’åº¦å’Œè½¨è¿¹ï¼ˆä¾‹å¦‚ï¼š"å°†æ‰‹è‡‚ç§»åŠ¨åˆ° (x,y,z)ï¼Œé€Ÿåº¦ä¸º v"ï¼‰ã€‚

**ä¸ºä»€ä¹ˆé‡è¦**: è¿™å°† "å¤§è„‘"ï¼ˆæ¨ç†ï¼‰å’Œ "å°è„‘"ï¼ˆæ§åˆ¶ï¼‰ç»Ÿä¸€åˆ°ä¸€ä¸ªè¿ç»­é“¾ä¸­ï¼Œå‡å°‘äº†è®¡åˆ’ä¸ç‰©ç†ç°å®ä¸åŒ¹é…çš„ "æ¨¡æ€è§£è€¦" é—®é¢˜ã€‚

## 3. æ¶æ„æ·±åº¦è§£æ
WALL-OSS é‡‡ç”¨**ç´§å¯†è€¦åˆçš„å¤šæ¨¡æ€æ¶æ„**ï¼Œä½¿ç”¨**ä¸“å®¶æ··åˆ (Mixture-of-Experts, MoE)** è®¾è®¡ã€‚

### 3.1. åŒè¾“å‡ºå¤´
ä¸ºäº†å¤„ç†è¯­ä¹‰è§„åˆ’ï¼ˆç¦»æ•£ï¼‰å’Œè¿åŠ¨æ§åˆ¶ï¼ˆè¿ç»­ï¼‰çš„ä¸åŒæ€§è´¨ï¼ŒWALL-OSS ä½¿ç”¨ä¸¤ä¸ªä¸“é—¨çš„å¤´ï¼š
-   **ç¦»æ•£åŠ¨ä½œå¤´**: ç”¨äºé«˜å±‚å†³ç­–å’Œ token ç”Ÿæˆã€‚
-   **è¿ç»­åŠ¨ä½œå¤´ï¼ˆæµåŒ¹é…ï¼‰**: ç”¨äºé«˜é¢‘ã€å¹³æ»‘çš„è¿åŠ¨æ§åˆ¶ã€‚ä½¿ç”¨**æµåŒ¹é… (Flow Matching)** æ‰©æ•£æŠ€æœ¯ç”Ÿæˆç²¾ç¡®çš„è½¨è¿¹ã€‚

### 3.2. ä»»åŠ¡è·¯ç”± FFN ä¸å…±äº«æ³¨æ„åŠ›
æ¨¡å‹ä½¿ç”¨å…±äº«æ³¨æ„åŠ›æœºåˆ¶å¤„ç†å¤šæ¨¡æ€è¾“å…¥ï¼ˆè§†è§‰ + æ–‡æœ¬ï¼‰ï¼Œä½†æ ¹æ®ä»»åŠ¡é˜¶æ®µï¼ˆæ¨ç† vs. æ‰§è¡Œï¼‰å°†ä¿¡æ¯è·¯ç”±åˆ°ä¸åŒçš„å‰é¦ˆç½‘ç»œ (FFN)ã€‚è¿™å…è®¸æ¨¡å‹ä¸“ä¸šåŒ–ï¼ŒåŒæ—¶ä¸ä¸¢å¤±å…¨å±€ä¸Šä¸‹æ–‡ã€‚

## 4. è®­ç»ƒç­–ç•¥
è®­ç»ƒè¿‡ç¨‹æ˜¯ä¸€ä¸ª**ä¸¤é˜¶æ®µæµæ°´çº¿**ï¼Œæ—¨åœ¨æ¨¡ä»¿äººç±»å­¦ä¹ ï¼š

1.  **å¯å‘é˜¶æ®µ (Inspiration Stageï¼Œå¯¹é½)**:
    -   é‡ç‚¹: å°†è¯­ä¹‰æŒ‡ä»¤ä¸ç¦»æ•£åŠ¨ä½œå…ˆéªŒå¯¹é½ã€‚
    -   ç›®æ ‡: ç¡®ä¿æœºå™¨äººåœ¨ç©ºé—´å’Œè¯­ä¹‰ä¸Š "çŸ¥é“è¦åšä»€ä¹ˆ"ã€‚
    -   æ•°æ®: åŒ…å«ç¦»æ•£åŠ¨ä½œ token çš„å¤§è§„æ¨¡ VLA æ•°æ®é›†ã€‚

2.  **æ•´åˆé˜¶æ®µ (Integration Stageï¼ŒæµåŒ¹é…)**:
    -   é‡ç‚¹: é’ˆå¯¹é«˜é¢‘è¿ç»­æ§åˆ¶è¿›è¡Œå¾®è°ƒã€‚
    -   æŠ€æœ¯: ä½¿ç”¨**æµåŒ¹é… (Flow Matching)**ï¼ˆæ¯”æ ‡å‡†æ‰©æ•£æ›´é«˜æ•ˆçš„æ›¿ä»£æ–¹æ¡ˆï¼‰ç”Ÿæˆå¹³æ»‘ã€ç‰©ç†ä¸Šå¯è¡Œçš„è½¨è¿¹ã€‚
    -   ç›®æ ‡: ç¡®ä¿æœºå™¨äºº "çŸ¥é“å¦‚ä½•å¹³æ»‘ç§»åŠ¨"ã€‚

## 5. æ•°æ®ç­–ç•¥ï¼šWall-80k
X Square Robot å‘å¸ƒäº† **Wall-80k**ï¼Œä¸€ä¸ªå¯¹è®­ç»ƒ WALL-OSS è‡³å…³é‡è¦çš„é«˜è´¨é‡æ•°æ®é›†ã€‚
-   **è§„æ¨¡**: 80,000+ æ¡è½¨è¿¹ã€‚
-   **æ ¼å¼**: ä¸ **LeRobot**ï¼ˆHugging Face æ ‡å‡†ï¼‰å…¼å®¹ã€‚
-   **ç»„æˆ**: çœŸå®ä¸–ç•Œé¥æ“ä½œæ•°æ®å’Œé«˜è´¨é‡æ¨¡æ‹Ÿæ•°æ®çš„æ··åˆã€‚
-   **å¢å¼º**: ä½¿ç”¨ç”Ÿæˆè§†é¢‘æŠ€æœ¯å¢å¼ºè®­ç»ƒæ•°æ®ï¼Œæé«˜å¯¹æ–°ç¯å¢ƒçš„æ³›åŒ–èƒ½åŠ›ã€‚

## 6. æ€§èƒ½ä¸å¯¹æ¯”
| ç‰¹æ€§ | WALL-OSS | RT-2 (Google) | OpenVLA |
| :--- | :--- | :--- | :--- |
| **æ¶æ„** | MoE + æµåŒ¹é… | VLM + Token åŒ–åŠ¨ä½œ | VLM + L1 å›å½’ |
| **æ¨ç†** | **Uni-CoT (å¼º)** | CoT (ä»…è¯­ä¹‰) | æ ‡å‡† |
| **æ§åˆ¶** | **è¿ç»­ï¼ˆå¹³æ»‘ï¼‰** | ç¦»æ•£ Tokenï¼ˆæŠ–åŠ¨ï¼‰| è¿ç»­ |
| **å¼€æº** | **æ˜¯ï¼ˆå…¨æ ˆï¼‰** | å¦ | æ˜¯ |
| **æ•°æ®** | Wall-80kï¼ˆå…¬å¼€ï¼‰| ä¸“æœ‰ | Open X-Embodiment |

## 7. é¢è¯•è¦ç‚¹
-   **Uni-CoT æ˜¯å…³é”®**: è®°ä½ "ç»Ÿä¸€è·¨å±‚æ€ç»´é“¾"ã€‚å®ƒè¿æ¥äº†é«˜å±‚è§„åˆ’å’Œä½å±‚æ§åˆ¶ã€‚
-   **æµåŒ¹é…æ§åˆ¶**: ä½¿ç”¨æµåŒ¹é…ï¼ˆè€Œä¸ä»…ä»…æ˜¯ç®€å•çš„æ‰©æ•£æˆ–å›å½’ï¼‰ç”Ÿæˆå¹³æ»‘åŠ¨ä½œã€‚
-   **MoE æ¶æ„**: ä½¿ç”¨ä¸“å®¶æ··åˆå¤„ç†è§†è§‰ã€è¯­è¨€å’ŒåŠ¨ä½œå¤„ç†çš„ä¸åŒéœ€æ±‚ã€‚
-   **æ•°æ®ä¸ºä¸­å¿ƒ**: å¼ºè°ƒ Wall-80k æ•°æ®é›†å’Œä¸ LeRobot ç”Ÿæ€ç³»ç»Ÿçš„å…¼å®¹æ€§ã€‚

\newpage

# ç¬¬30ç«  Chain-of-Thought æ¨ç†


> **æ ¸å¿ƒæ¦‚å¿µ**: æ€ç»´é“¾ (Chain-of-Thought, CoT) æ˜¯ä¸€ç§è®©å¤§æ¨¡å‹åœ¨ç»™å‡ºæœ€ç»ˆç­”æ¡ˆå‰ï¼Œå…ˆç”Ÿæˆ**ä¸­é—´æ¨ç†æ­¥éª¤**çš„æŠ€æœ¯ã€‚åœ¨ VLA é¢†åŸŸï¼ŒCoT ä½¿æœºå™¨äººèƒ½å¤Ÿè¿›è¡Œå¤æ‚ä»»åŠ¡è§„åˆ’å’Œå¯è§£é‡Šçš„å†³ç­–ã€‚

## 1. ä¸ºä»€ä¹ˆ VLA éœ€è¦ CoT? (Why CoT for VLA?)

### 1.1 ä¼ ç»Ÿ VLA çš„å±€é™

ä¼ ç»Ÿ VLA æ¨¡å‹æ˜¯**ç«¯åˆ°ç«¯**çš„ï¼š

$$
\text{Observation} + \text{Instruction} \xrightarrow{\text{VLA}} \text{Action}
$$


**é—®é¢˜**:
- **é»‘ç®±å†³ç­–**: æ— æ³•ç†è§£æœºå™¨äººä¸ºä»€ä¹ˆè¿™æ ·åš
- **é•¿åºåˆ—ä»»åŠ¡å›°éš¾**: å¤æ‚ä»»åŠ¡éœ€è¦å¤šæ­¥è§„åˆ’
- **é”™è¯¯éš¾ä»¥è¯Šæ–­**: å‡ºé”™æ—¶ä¸çŸ¥é“å“ªæ­¥æ¨ç†æœ‰é—®é¢˜
- **æ³›åŒ–èƒ½åŠ›å¼±**: ç¼ºä¹æ˜¾å¼çš„æ¨ç†èƒ½åŠ›

### 1.2 CoT çš„ä»·å€¼


$$
\text{Observation} + \text{Instruction} \xrightarrow{\text{VLA}} \underbrace{\text{Reasoning Steps}}_{\text{æ€ç»´é“¾}} \xrightarrow{} \text{Action}
$$


- **å¯è§£é‡Šæ€§**: å¯ä»¥è¿½æº¯æœºå™¨äººçš„"æ€è€ƒè¿‡ç¨‹"
- **å¤æ‚ä»»åŠ¡åˆ†è§£**: è‡ªåŠ¨å°†é•¿ä»»åŠ¡æ‹†è§£ä¸ºå­ä»»åŠ¡
- **é”™è¯¯çº æ­£**: å¯ä»¥åœ¨æ¨ç†è¿‡ç¨‹ä¸­å‘ç°å¹¶çº æ­£é”™è¯¯
- **æ³›åŒ–å¢å¼º**: æ˜¾å¼æ¨ç†æœ‰åŠ©äºå¤„ç†æ–°åœºæ™¯

### 1.3 VLA ä¸­çš„ CoT åº”ç”¨æ¡ˆä¾‹

| æ¨¡å‹ | CoT ç±»å‹ | åº”ç”¨ |
| :--- | :--- | :--- |
| **RT-2** | è¯­è¨€ CoT | "first pick up the red cup, then place it..." |
| **WALL-OSS** | Uni-CoT | ç»Ÿä¸€çš„è§†è§‰-è¯­è¨€-åŠ¨ä½œæ¨ç† |
| **Galaxea G0** | åˆ†å±‚ CoT | VLM è§„åˆ’ + VLA æ‰§è¡Œ |
| **Ï€0.5** | éšå¼ CoT | Latent Thought (éšç©ºé—´æ¨ç†) |

## 2. CoT çš„åŸºæœ¬å½¢å¼ (CoT Formulations)

### 2.1 æ˜¾å¼è¯­è¨€ CoT (Explicit Language CoT)

æœºå™¨äººç”¨è‡ªç„¶è¯­è¨€æè¿°æ¨ç†è¿‡ç¨‹ã€‚

```
è¾“å…¥:
- å›¾åƒ: å¨æˆ¿åœºæ™¯ï¼Œæ¡Œä¸Šæœ‰è‹¹æœã€é¦™è•‰ã€åˆ€
- æŒ‡ä»¤: "å¸®æˆ‘åˆ‡ä¸€ä¸ªæ°´æœ"

CoT è¾“å‡º:
"è®©æˆ‘åˆ†æè¿™ä¸ªä»»åŠ¡:
1. é¦–å…ˆï¼Œæˆ‘éœ€è¦è¯†åˆ«æ¡Œä¸Šçš„æ°´æœ - æˆ‘çœ‹åˆ°äº†è‹¹æœå’Œé¦™è•‰
2. è‹¹æœæ¯”è¾ƒé€‚åˆåˆ‡ç‰‡ï¼Œæˆ‘é€‰æ‹©è‹¹æœ
3. åˆ‡æ°´æœéœ€è¦åˆ€ï¼Œåˆ€åœ¨æ¡Œå­å³ä¾§
4. æ‰§è¡Œæ­¥éª¤:
   - æ­¥éª¤1: ç§»åŠ¨åˆ°åˆ€çš„ä½ç½®ï¼ŒæŠ“å–åˆ€
   - æ­¥éª¤2: ç§»åŠ¨åˆ°è‹¹æœä½ç½®
   - æ­¥éª¤3: æ”¾ä¸‹åˆ€ï¼ŒæŠ“å–è‹¹æœå›ºå®š
   - æ­¥éª¤4: ç”¨åˆ€åˆ‡å‰²è‹¹æœ
å¼€å§‹æ‰§è¡Œæ­¥éª¤1..."

åŠ¨ä½œè¾“å‡º: [x, y, z, roll, pitch, yaw, gripper]
```

### 2.2 ç»“æ„åŒ– CoT (Structured CoT)

ç”¨ç»“æ„åŒ–æ ¼å¼ï¼ˆJSON/XMLï¼‰è¡¨ç¤ºæ¨ç†ã€‚

```python
class StructuredCoT:
    def generate(self, obs, instruction):
        # ç”Ÿæˆç»“æ„åŒ–æ¨ç†
        cot = {
            "scene_understanding": {
                "objects": ["apple", "banana", "knife"],
                "spatial_relations": {
                    "knife": "right of table",
                    "apple": "center of table"
                }
            },
            "task_decomposition": [
                {"subtask": "grasp_knife", "target": "knife"},
                {"subtask": "grasp_apple", "target": "apple"},
                {"subtask": "cut", "object": "apple", "tool": "knife"}
            ],
            "current_step": 0,
            "reasoning": "Need to first get the knife before cutting"
        }
        return cot
```

### 2.3 éšå¼ CoT (Implicit/Latent CoT)

åœ¨éšç©ºé—´ä¸­è¿›è¡Œæ¨ç†ï¼Œä¸ç”Ÿæˆæ˜¾å¼æ–‡æœ¬ã€‚

```python
class LatentCoT(nn.Module):
    """Ï€0.5 é£æ ¼çš„éšå¼æ¨ç†"""
    def __init__(self, vlm, action_decoder, num_thought_tokens=32):
        super().__init__()
        self.vlm = vlm
        self.action_decoder = action_decoder
        self.thought_tokens = nn.Parameter(torch.randn(num_thought_tokens, hidden_dim))
    
    def forward(self, obs, instruction):
        # ç¼–ç è§‚æµ‹å’ŒæŒ‡ä»¤
        context = self.vlm.encode(obs, instruction)
        
        # åœ¨éšç©ºé—´"æ€è€ƒ" - é€šè¿‡ Transformer å±‚è¿­ä»£
        thoughts = self.thought_tokens.unsqueeze(0).expand(batch_size, -1, -1)
        
        for layer in self.reasoning_layers:
            # æ€è€ƒ tokens ä¸ context äº¤äº’
            thoughts = layer(thoughts, context)  # Cross-Attention
        
        # ä»æ€è€ƒç»“æœè§£ç åŠ¨ä½œ
        actions = self.action_decoder(thoughts)
        return actions
```

### 2.4 äº¤é”™ CoT (Interleaved CoT)

æ¨ç†å’ŒåŠ¨ä½œç”Ÿæˆäº¤é”™è¿›è¡Œã€‚

```
æ—¶åˆ» t0: [è§‚æµ‹] â†’ [æ¨ç†: "æˆ‘çœ‹åˆ°æ¡Œä¸Šæœ‰æ¯å­"] â†’ [åŠ¨ä½œ: ä¼¸æ‰‹]
æ—¶åˆ» t1: [è§‚æµ‹] â†’ [æ¨ç†: "æ‰‹æ¥è¿‘æ¯å­äº†"] â†’ [åŠ¨ä½œ: å¼ å¼€å¤¹çˆª]
æ—¶åˆ» t2: [è§‚æµ‹] â†’ [æ¨ç†: "å¤¹çˆªå¯¹å‡†æ¯å­"] â†’ [åŠ¨ä½œ: æŠ“å–]
...
```

```python
class InterleavedCoT:
    def step(self, obs, history):
        # åŸºäºå†å²ä¸Šä¸‹æ–‡ç”Ÿæˆæ¨ç†
        reasoning = self.vlm.generate_text(
            prompt=f"å†å²: {history}\nå½“å‰è§‚æµ‹: {obs}\nä¸‹ä¸€æ­¥åˆ†æ: "
        )
        
        # åŸºäºæ¨ç†ç”ŸæˆåŠ¨ä½œ
        action = self.action_head(
            self.encode(obs, reasoning)
        )
        
        # æ›´æ–°å†å²
        history.append({"reasoning": reasoning, "action": action})
        
        return action, reasoning
```

## 3. VLA ä¸­çš„ CoT æ¶æ„ (CoT Architectures in VLA)

### 3.1 WALL-OSS çš„ Uni-CoT
> **å»¶ä¼¸é˜…è¯»**: WALL-OSS çš„ Unified CoT æ¶æ„å¯¹åº” `theory/wall_oss.md` ä¸­çš„ Uni-CoT + Dual Heads è®¾è®¡ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Unified CoT                            â”‚
â”‚                                                             â”‚
â”‚   è¾“å…¥: [å›¾åƒ Tokens] + [è¯­è¨€ Tokens]                        â”‚
â”‚              â”‚                                              â”‚
â”‚              â–¼                                              â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚      â”‚   VLM Backbone    â”‚                                  â”‚
â”‚      â”‚   (Qwen2.5-VL)    â”‚                                  â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚                â”‚                                            â”‚
â”‚                â–¼                                            â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚      â”‚  æ€ç»´é“¾ç”Ÿæˆå™¨      â”‚â—€â”€â”€ "First I need to..."         â”‚
â”‚      â”‚  (CoT Generator)  â”‚                                  â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚                â”‚                                            â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚         â”‚             â”‚                                     â”‚
â”‚         â–¼             â–¼                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚   â”‚ Flow Headâ”‚  â”‚FAST Head â”‚                               â”‚
â”‚   â”‚ (ç²¾ç»†)   â”‚  â”‚ (é«˜æ•ˆ)   â”‚                               â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Galaxea G0 çš„åˆ†å±‚ CoT
> **å»¶ä¼¸é˜…è¯»**: Galaxea G0 çš„åŒç³»ç»Ÿç»“æ„ä¸ `theory/galaxea_g0.md` ä¸­çš„æ˜Ÿæµ·å›¾æ¨¡å‹è¯¦è§£ä¸€è‡´ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   G0-VLM (å¤§è„‘)                              â”‚
â”‚   - åœºæ™¯ç†è§£                                                 â”‚
â”‚   - ä»»åŠ¡è§„åˆ’                                                 â”‚
â”‚   - ç”Ÿæˆå­ä»»åŠ¡åºåˆ—                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ å­ä»»åŠ¡: "pick up cup"
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   G0-VLA (å°è„‘)                              â”‚
â”‚   - æ¥æ”¶å­ä»»åŠ¡                                               â”‚
â”‚   - ç”Ÿæˆå…·ä½“åŠ¨ä½œ                                             â”‚
â”‚   - é«˜é¢‘æ§åˆ¶æ‰§è¡Œ                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```python
class GalaxeaG0:
    def __init__(self):
        self.vlm = G0_VLM()  # å¤§è„‘: è§„åˆ’
        self.vla = G0_VLA()  # å°è„‘: æ‰§è¡Œ
    
    def execute(self, obs, instruction):
        # å¤§è„‘: ç”Ÿæˆä»»åŠ¡è§„åˆ’ (CoT)
        plan = self.vlm.plan(obs, instruction)
        # plan = ["locate cup", "approach cup", "grasp cup", "lift cup"]
        
        # é€æ­¥æ‰§è¡Œ
        for subtask in plan:
            while not subtask.is_completed(obs):
                # å°è„‘: ç”Ÿæˆå…·ä½“åŠ¨ä½œ
                action = self.vla.act(obs, subtask)
                obs = env.step(action)
        
        return "Task completed"
```

## 4. CoT è®­ç»ƒæ–¹æ³• (Training CoT for VLA)

### 4.1 äººå·¥æ ‡æ³¨ CoT

```python
## æ•°æ®é›†ç¤ºä¾‹
cot_dataset = [
    {
        "observation": "kitchen_scene_001.jpg",
        "instruction": "make a sandwich",
        "cot": [
            "I see bread, cheese, lettuce on the table",
            "To make a sandwich, I need to: 1) pick up bread 2) add cheese 3) add lettuce 4) close sandwich",
            "Starting with step 1: picking up bread"
        ],
        "action": [0.1, 0.2, 0.3, 0, 0, 0, 1]  # æŠ“é¢åŒ…åŠ¨ä½œ
    },
    # ... more examples
]
```

### 4.2 è‡ªåŠ¨ç”Ÿæˆ CoT (ä½¿ç”¨ GPT-4V)

```python
def generate_cot_labels(image, instruction, action_sequence):
    """ä½¿ç”¨ GPT-4V è‡ªåŠ¨ç”Ÿæˆ CoT æ ‡ç­¾"""
    prompt = f"""
    ä½ æ˜¯ä¸€ä¸ªæœºå™¨äººä»»åŠ¡åˆ†æä¸“å®¶ã€‚
    
    ä»»åŠ¡: {instruction}
    [å›¾åƒå·²é™„åŠ ]
    
    æœºå™¨äººæ‰§è¡Œäº†ä»¥ä¸‹åŠ¨ä½œåºåˆ—: {action_sequence}
    
    è¯·ç”Ÿæˆæœºå™¨äººçš„æ€ç»´é“¾ï¼Œæè¿°:
    1. åœºæ™¯ç†è§£
    2. ä»»åŠ¡åˆ†è§£
    3. æ¯æ­¥åŠ¨ä½œçš„åŸå› 
    
    æ ¼å¼:
    æ€è€ƒ: [ä½ çš„æ¨ç†]
    """
    
    cot = gpt4v.generate(prompt, image)
    return cot
```

### 4.3 CoT è’¸é¦ (CoT Distillation)

ä»å¤§æ¨¡å‹è’¸é¦ CoT èƒ½åŠ›åˆ°å°æ¨¡å‹ã€‚

```python
class CoTDistillation:
    def __init__(self, teacher_vlm, student_vla):
        self.teacher = teacher_vlm  # GPT-4V / Claude
        self.student = student_vla  # ç›®æ ‡éƒ¨ç½²æ¨¡å‹
    
    def generate_training_data(self, obs, instruction):
        # æ•™å¸ˆç”Ÿæˆ CoT
        teacher_cot = self.teacher.generate_cot(obs, instruction)
        teacher_action = self.teacher.generate_action(obs, instruction, teacher_cot)
        
        return {
            "obs": obs,
            "instruction": instruction,
            "cot": teacher_cot,
            "action": teacher_action
        }
    
    def train_student(self, data):
        # è®­ç»ƒå­¦ç”Ÿæ¨¡å‹åŒæ—¶é¢„æµ‹ CoT å’ŒåŠ¨ä½œ
        pred_cot, pred_action = self.student(data['obs'], data['instruction'])
        
        # CoT æŸå¤± (è¯­è¨€å»ºæ¨¡)
        cot_loss = self.language_loss(pred_cot, data['cot'])
        
        # åŠ¨ä½œæŸå¤±
        action_loss = F.mse_loss(pred_action, data['action'])
        
        return cot_loss + action_loss
```

## 5. CoT çš„å…³é”®æŠ€æœ¯ (Key Techniques)

### 5.1 Self-Consistency (è‡ªä¸€è‡´æ€§)

ç”Ÿæˆå¤šä¸ª CoTï¼ŒæŠ•ç¥¨é€‰æ‹©æœ€ä¸€è‡´çš„ç»“æœã€‚

```python
def self_consistency_cot(model, obs, instruction, num_samples=5):
    """ç”Ÿæˆå¤šä¸ª CoTï¼Œé€‰æ‹©æœ€ä¸€è‡´çš„ç»“æœ"""
    cots_and_actions = []
    
    for _ in range(num_samples):
        cot = model.generate_cot(obs, instruction, temperature=0.7)
        action = model.generate_action(obs, instruction, cot)
        cots_and_actions.append((cot, action))
    
    # åŠ¨ä½œèšç±»
    actions = [a for _, a in cots_and_actions]
    clusters = cluster_actions(actions, threshold=0.1)
    
    # é€‰æ‹©æœ€å¤§èšç±»çš„ä»£è¡¨
    largest_cluster = max(clusters, key=len)
    best_action = np.mean(largest_cluster, axis=0)
    
    return best_action
```

### 5.2 Tree-of-Thoughts (æ€ç»´æ ‘)

æ¢ç´¢å¤šä¸ªæ¨ç†åˆ†æ”¯ï¼Œé€‰æ‹©æœ€ä¼˜è·¯å¾„ã€‚

```python
class TreeOfThoughts:
    def __init__(self, model, branching_factor=3, depth=3):
        self.model = model
        self.branching_factor = branching_factor
        self.depth = depth
    
    def search(self, obs, instruction):
        root = ThoughtNode(obs, instruction, thought="", score=0)
        
        # BFS/DFS æœç´¢æ€ç»´æ ‘
        frontier = [root]
        
        for d in range(self.depth):
            new_frontier = []
            for node in frontier:
                # æ‰©å±•: ç”Ÿæˆå¤šä¸ªå¯èƒ½çš„ä¸‹ä¸€æ­¥æ€è€ƒ
                children = self.expand(node)
                
                # è¯„ä¼°: å¯¹æ¯ä¸ªæ€è€ƒæ‰“åˆ†
                for child in children:
                    child.score = self.evaluate(child)
                
                new_frontier.extend(children)
            
            # å‰ªæ: ä¿ç•™ top-k
            frontier = sorted(new_frontier, key=lambda n: n.score, reverse=True)
            frontier = frontier[:self.branching_factor]
        
        # è¿”å›æœ€ä½³è·¯å¾„
        best_node = max(frontier, key=lambda n: n.score)
        return best_node.get_action()
    
    def expand(self, node):
        """ç”Ÿæˆå¤šä¸ªå€™é€‰æ€è€ƒ"""
        prompt = f"å½“å‰æ€è€ƒ: {node.thought}\nå¯èƒ½çš„ä¸‹ä¸€æ­¥: "
        thoughts = self.model.generate_multiple(prompt, n=self.branching_factor)
        return [ThoughtNode(node.obs, node.instruction, t) for t in thoughts]
    
    def evaluate(self, node):
        """è¯„ä¼°æ€è€ƒçš„è´¨é‡"""
        prompt = f"æ€è€ƒ: {node.thought}\nè¿™ä¸ªæ€è€ƒå¯¹äºå®Œæˆ'{node.instruction}'æœ‰å¤šå¤§å¸®åŠ©? (0-10åˆ†)"
        score = self.model.generate(prompt)
        return float(score)
```

### 5.3 ReAct (Reasoning + Acting)

äº¤æ›¿è¿›è¡Œæ¨ç†å’Œè¡ŒåŠ¨ã€‚

```python
class ReAct:
    """Reasoning and Acting äº¤æ›¿æ‰§è¡Œ"""
    
    def execute(self, env, instruction, max_steps=20):
        obs = env.reset()
        history = []
        
        for step in range(max_steps):
            # Thought: æ¨ç†å½“å‰åº”è¯¥åšä»€ä¹ˆ
            thought = self.reason(obs, instruction, history)
            print(f"Thought: {thought}")
            
            # Action: åŸºäºæ¨ç†æ‰§è¡ŒåŠ¨ä½œ
            action = self.act(obs, thought)
            print(f"Action: {action}")
            
            # Observation: è·å–æ–°è§‚æµ‹
            obs, reward, done, info = env.step(action)
            print(f"Observation: {info['description']}")
            
            history.append({
                "thought": thought,
                "action": action,
                "observation": info['description']
            })
            
            if done:
                break
        
        return history
    
    def reason(self, obs, instruction, history):
        prompt = f"""
        ä»»åŠ¡: {instruction}
        å†å²: {history}
        å½“å‰è§‚æµ‹: {obs}
        
        æ€è€ƒ: ä¸‹ä¸€æ­¥æˆ‘åº”è¯¥åšä»€ä¹ˆ?
        """
        return self.model.generate(prompt)
    
    def act(self, obs, thought):
        prompt = f"""
        å½“å‰æ€è€ƒ: {thought}
        å½“å‰è§‚æµ‹: {obs}
        
        æ‰§è¡ŒåŠ¨ä½œ (æ ¼å¼: [x, y, z, roll, pitch, yaw, gripper]):
        """
        action_str = self.model.generate(prompt)
        return parse_action(action_str)
```

## 6. CoT çš„è¯„ä¼° (Evaluating CoT)

### 6.1 æ¨ç†è´¨é‡è¯„ä¼°

```python
def evaluate_cot_quality(cot, ground_truth_steps):
    """è¯„ä¼° CoT æ¨ç†è´¨é‡"""
    metrics = {}
    
    # 1. æ­¥éª¤è¦†ç›–ç‡: CoT æ˜¯å¦åŒ…å«æ‰€æœ‰å¿…è¦æ­¥éª¤
    covered = sum(1 for gt in ground_truth_steps if gt in cot)
    metrics['step_coverage'] = covered / len(ground_truth_steps)
    
    # 2. é€»è¾‘ä¸€è‡´æ€§: æ­¥éª¤ä¹‹é—´æ˜¯å¦æœ‰é€»è¾‘çŸ›ç›¾
    metrics['logical_consistency'] = check_consistency(cot)
    
    # 3. å¯æ‰§è¡Œæ€§: æ¨ç†æ˜¯å¦èƒ½è½¬åŒ–ä¸ºæœ‰æ•ˆåŠ¨ä½œ
    metrics['executability'] = check_executability(cot)
    
    return metrics
```

### 6.2 ä»»åŠ¡æˆåŠŸç‡å¯¹æ¯”

| æ–¹æ³• | CALVIN æˆåŠŸç‡ | é•¿åºåˆ—ä»»åŠ¡ | æ–°åœºæ™¯æ³›åŒ– |
| :--- | :--- | :--- | :--- |
| **æ—  CoT** | 65% | 35% | 40% |
| **è¯­è¨€ CoT** | 72% | 52% | 55% |
| **ç»“æ„åŒ– CoT** | 75% | 58% | 60% |
| **åˆ†å±‚ CoT (G0)** | **78%** | **65%** | **62%** |

## 7. é¢è¯•é«˜é¢‘é—®é¢˜ (Q&A)

**Q1: CoT ä¼šå¢åŠ æ¨ç†å»¶è¿Ÿï¼Œå¦‚ä½•è§£å†³?**

A:
- **éšå¼ CoT**: åœ¨éšç©ºé—´æ¨ç†ï¼Œä¸ç”Ÿæˆæ–‡æœ¬ (Ï€0.5)
- **è’¸é¦**: å°† CoT èƒ½åŠ›è’¸é¦åˆ°æ—  CoT çš„å°æ¨¡å‹
- **ç¼“å­˜**: å¯¹å¸¸è§åœºæ™¯é¢„è®¡ç®— CoT
- **å¹¶è¡Œ**: æ¨ç†å’Œä½å±‚æ§åˆ¶å¹¶è¡Œæ‰§è¡Œ

**Q2: æ˜¾å¼ CoT å’Œéšå¼ CoT å“ªä¸ªæ›´å¥½?**

A:
- **æ˜¾å¼ CoT**: å¯è§£é‡Šæ€§å¼ºï¼Œä¾¿äºè°ƒè¯•ï¼Œä½†é€Ÿåº¦æ…¢
- **éšå¼ CoT**: é€Ÿåº¦å¿«ï¼Œä½†é»‘ç®±
- **é€‰æ‹©**: ç ”ç©¶/è°ƒè¯•ç”¨æ˜¾å¼ï¼Œéƒ¨ç½²ç”¨éšå¼

**Q3: å¦‚ä½•è®© VLA å­¦ä¼š CoT?**

A:
- **æ–¹æ³• 1**: äººå·¥æ ‡æ³¨ CoT æ•°æ® (æ˜‚è´µä½†è´¨é‡é«˜)
- **æ–¹æ³• 2**: ä½¿ç”¨ GPT-4V è‡ªåŠ¨ç”Ÿæˆ CoT æ ‡ç­¾
- **æ–¹æ³• 3**: ä»æœ‰ CoT çš„å¤§æ¨¡å‹è’¸é¦åˆ°å°æ¨¡å‹
- **æ–¹æ³• 4**: RL å¼ºåŒ–å­¦ä¹  CoT ç­–ç•¥

**Q4: CoT çš„"å¹»è§‰"é—®é¢˜å¦‚ä½•å¤„ç†?**

A:
- **Grounding**: å¼ºåˆ¶ CoT ä¸è§†è§‰è§‚æµ‹å¯¹é½
- **Self-Consistency**: å¤šæ¬¡é‡‡æ ·æŠ•ç¥¨
- **éªŒè¯å™¨**: è®­ç»ƒä¸€ä¸ªæ¨¡å‹æ£€éªŒ CoT åˆç†æ€§
- **äººæœºåä½œ**: å…³é”®æ­¥éª¤è®©äººç±»ç¡®è®¤

**Q5: WALL-OSS çš„ Uni-CoT æœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„?**

A:
- **ç»Ÿä¸€**: è§†è§‰ã€è¯­è¨€ã€åŠ¨ä½œåœ¨åŒä¸€ä¸ª CoT æ¡†æ¶ä¸‹æ¨ç†
- **åŒå¤´**: Flow (ç²¾ç»†) + FAST (é«˜æ•ˆ) åŒè¾“å‡º
- **å¯è§£é‡Š**: å¯ä»¥è¾“å‡ºæ¨ç†è¿‡ç¨‹ä¾›äººå®¡æŸ¥
- **æ³›åŒ–**: CoT å¸®åŠ©å¤„ç†æœªè§è¿‡çš„ä»»åŠ¡

## 8. ä»£ç ç¤ºä¾‹ï¼šç®€å•çš„ CoT VLA

```python
class CoTVLA(nn.Module):
    def __init__(self, vlm_backbone, action_dim=7):
        super().__init__()
        self.vlm = vlm_backbone
        self.cot_head = nn.Linear(vlm.hidden_size, vlm.vocab_size)
        self.action_head = nn.Linear(vlm.hidden_size, action_dim)
    
    def forward(self, obs, instruction, generate_cot=True):
        # ç¼–ç è§‚æµ‹å’ŒæŒ‡ä»¤
        context = self.vlm.encode(obs, instruction)
        
        if generate_cot:
            # ç”Ÿæˆæ€ç»´é“¾
            cot_tokens = []
            for _ in range(max_cot_length):
                logits = self.cot_head(context[:, -1, :])
                next_token = logits.argmax(-1)
                cot_tokens.append(next_token)
                
                # å°†æ–° token åŠ å…¥ä¸Šä¸‹æ–‡
                token_emb = self.vlm.embed(next_token)
                context = torch.cat([context, token_emb.unsqueeze(1)], dim=1)
                
                if next_token == eos_token:
                    break
            
            cot_text = self.vlm.decode(cot_tokens)
        else:
            cot_text = None
        
        # åŸºäº CoT å¢å¼ºçš„ä¸Šä¸‹æ–‡ç”ŸæˆåŠ¨ä½œ
        action = self.action_head(context[:, -1, :])
        
        return action, cot_text


## è®­ç»ƒ
model = CoTVLA(vlm_backbone)
optimizer = torch.optim.AdamW(model.parameters(), lr=1e-4)

for batch in dataloader:
    pred_action, pred_cot = model(batch['obs'], batch['instruction'])
    
    # CoT è¯­è¨€æŸå¤±
    cot_loss = F.cross_entropy(pred_cot, batch['cot_labels'])
    
    # åŠ¨ä½œæŸå¤±
    action_loss = F.mse_loss(pred_action, batch['action'])
    
    loss = cot_loss + action_loss
    loss.backward()
    optimizer.step()
```

## 9. å‚è€ƒèµ„æº (References)

- **CoT Prompting**: [Chain-of-Thought Prompting Elicits Reasoning](https://arxiv.org/abs/2201.11903)
- **ReAct**: [ReAct: Synergizing Reasoning and Acting](https://arxiv.org/abs/2210.03629)
- **Tree of Thoughts**: [Tree of Thoughts: Deliberate Problem Solving with LLMs](https://arxiv.org/abs/2305.10601)
- **WALL-OSS**: [X Square Robot Official](https://github.com/xsquare-robot)
- **RT-2 CoT**: [RT-2: Vision-Language-Action Models](https://arxiv.org/abs/2307.15818)

---


\newpage

# ç¬¬31ç«  è¯„ä¼°æ–¹æ³•è®º


åœ¨ VLA é¢†åŸŸï¼Œ"æ€ä¹ˆç®—åšå¥½äº†"æ˜¯ä¸€ä¸ªæå…¶å¤æ‚çš„é—®é¢˜ã€‚ä¸ CV/NLP ä¸åŒï¼Œæœºå™¨äººæ²¡æœ‰é™æ€çš„ Test Setï¼Œå¿…é¡»åœ¨åŠ¨æ€ç¯å¢ƒä¸­è¯„ä¼°ã€‚æœ¬ç« æ·±å…¥æ¢è®¨è¯„ä¼°çš„æ•°å­¦å®šä¹‰ã€åŸºå‡†ç»†èŠ‚åŠå®æˆ˜åè®®ã€‚

## 1. æ ¸å¿ƒè¯„ä¼°æŒ‡æ ‡ (Core Metrics)

### 1.1. Success Rate (SR) - æˆåŠŸç‡
æœ€ç›´è§‚ä½†ä¹Ÿæœ€ç²—ç³™çš„æŒ‡æ ‡ã€‚

$$
SR = \frac{1}{N} \sum_{i=1}^{N} \mathbb{I}(\text{task}_i \text{ completed})
$$

- **å®šä¹‰**: $N$ æ¬¡å°è¯•ä¸­æˆåŠŸçš„æ¬¡æ•°ã€‚
- **ç½®ä¿¡åŒºé—´ (Confidence Interval)**: ç”±äº $N$ é€šå¸¸è¾ƒå° (çœŸæœºå®éªŒæ˜‚è´µ)ï¼ŒSR çš„æ–¹å·®å¾ˆå¤§ã€‚å»ºè®®ä½¿ç”¨ **Wald Interval** æˆ– **Wilson Score Interval** æŠ¥å‘Šè¯¯å·®èŒƒå›´ã€‚
  $$ \hat{p} \pm z \sqrt{\frac{\hat{p}(1-\hat{p})}{N}} $$
  (å½“ $N=20, \hat{p}=0.5$ æ—¶ï¼Œè¯¯å·®èŒƒå›´é«˜è¾¾ $\pm 22\%$ï¼æ‰€ä»¥çœŸæœºè¯„ä¼°è‡³å°‘è¦è·‘ 50 æ¬¡ä»¥ä¸Šæ‰å…·å¤‡ç»Ÿè®¡æ„ä¹‰ã€‚)

### 1.2. Mean Steps to Success (MSS) - å¹³å‡æˆåŠŸæ­¥æ•°
è¡¡é‡æ•ˆç‡çš„æŒ‡æ ‡ã€‚
- **å®šä¹‰**: åœ¨æˆåŠŸçš„ Episodes ä¸­ï¼Œå¹³å‡æ¶ˆè€—çš„æ—¶é—´æ­¥æ•°ã€‚
- **æ„ä¹‰**: ä¸¤ä¸ªæ¨¡å‹ SR éƒ½æ˜¯ 100%ï¼Œä½†æ¨¡å‹ A ç”¨äº† 5 ç§’ï¼Œæ¨¡å‹ B ç”¨äº† 10 ç§’ï¼Œæ˜¾ç„¶ A æ›´å¥½ (æ›´æµç•…ï¼ŒçŠ¹è±«æ›´å°‘)ã€‚

### 1.3. Intervention Rate (IR) - å¹²é¢„ç‡
é€‚ç”¨äºé•¿ç¨‹ä»»åŠ¡ (Long-horizon) æˆ–è‡ªåŠ¨é©¾é©¶ã€‚

$$
IR = \frac{\text{Total Interventions}}{\text{Total Operation Time (hours)}} \quad \text{or} \quad \frac{\text{Interventions}}{\text{Total Steps}}
$$

- **å®šä¹‰**: äººç±»ä¸“å®¶ä¸ºäº†é˜²æ­¢ç¾éš¾æ€§åæœ (ç¢°æ’ã€æ‰è½) è€Œæ¥ç®¡æœºå™¨äººçš„é¢‘ç‡ã€‚
- **MPI (Miles Per Intervention)**: è‡ªåŠ¨é©¾é©¶å¸¸ç”¨ï¼ŒVLA ä¸­å¯¹åº” **Steps Per Intervention (SPI)**ã€‚

### 1.4. Executable Rate (ER) - å¯æ‰§è¡Œç‡
è¡¡é‡æ¨¡å‹çš„**å®‰å…¨æ€§**å’Œ**è¿åŠ¨å­¦ä¸€è‡´æ€§**ã€‚
- **å®šä¹‰**: æ¨¡å‹ç”Ÿæˆçš„ Action èƒ½å¤Ÿè¢«åº•å±‚æ§åˆ¶å™¨ (IK Solver / Impedance Controller) æ‰§è¡Œçš„æ¯”ä¾‹ã€‚
- **å¸¸è§å¤±è´¥**:
    - **IK No Solution**: ç›®æ ‡ç‚¹è¶…å‡ºå·¥ä½œç©ºé—´ã€‚
    - **Self-Collision**: æœºæ¢°è‡‚è‡ªç¢°æ’ã€‚
    - **Singularity**: å¥‡å¼‚ç‚¹ã€‚

---

## 2. ä»¿çœŸåŸºå‡†æ·±åº¦è§£æ (Simulation Benchmarks)

### 2.1. CALVIN (Computer Vision and Language for Interaction)
> **æ ¸å¿ƒèƒ½åŠ›**: **Long-horizon Language Following** (é•¿åºåˆ—è¯­ä¹‰è·Ÿéš)ã€‚

- **ä»»åŠ¡**: è¿ç»­å®Œæˆ 5 ä¸ªæŒ‡ä»¤ (e.g., "Open drawer" -> "Pick up block" -> "Place in drawer" -> "Turn on light" -> "Close drawer")ã€‚
- **è¯„ä¼°æ–¹å¼**: **Chain Success Rate**ã€‚
    - 1-step SR: å®Œæˆç¬¬ 1 ä¸ªä»»åŠ¡çš„æ¦‚ç‡ã€‚
    - 5-step SR: è¿ç»­å®Œæˆ 5 ä¸ªä»»åŠ¡çš„æ¦‚ç‡ (æéš¾ï¼ŒSOTA é€šå¸¸ < 10%)ã€‚
- **æ„ä¹‰**: æµ‹è¯• VLA æ¨¡å‹çš„**çŠ¶æ€ä¿æŒèƒ½åŠ›** (Stateful) å’Œ**ä¸Šä¸‹æ–‡ç†è§£èƒ½åŠ›**ã€‚

### 2.2. SIMPLER (Sim-to-Real Evaluation)
> **æ ¸å¿ƒèƒ½åŠ›**: **Sim-to-Real Correlation** (ä»¿çœŸä¸çœŸæœºçš„ç›¸å…³æ€§)ã€‚

- **ç—›ç‚¹**: ä»¥å‰æˆ‘ä»¬åœ¨ä»¿çœŸé‡Œè·‘åˆ†é«˜ï¼ŒçœŸæœºä¸€å¡Œç³Šæ¶‚ã€‚
- **åˆ›æ–°**: SIMPLER ä½¿ç”¨çœŸå®è§†é¢‘ä½œä¸ºçº¹ç†ï¼Œå¹¶ç²¾ç»†è°ƒèŠ‚ç‰©ç†å‚æ•°ï¼Œä½¿å¾—ä»¿çœŸä¸­çš„æ’å (Rank) ä¸çœŸæœºæ’åé«˜åº¦æ­£ç›¸å…³ (Pearson Correlation > 0.8)ã€‚
- **ç”¨é€”**: åœ¨ä¸ŠçœŸæœºå‰ï¼Œå…ˆç”¨ SIMPLER ç­›é€‰ Checkpointï¼ŒèŠ‚çœæ˜‚è´µçš„çœŸæœºæµ‹è¯•æ—¶é—´ã€‚

### 2.3. ManiSkill 2/3
> **æ ¸å¿ƒèƒ½åŠ›**: **Generalizable Manipulation** (æ³›åŒ–æŠ“å–)ã€‚

- **å¼•æ“**: SAPIEN (PhysX)ã€‚
- **ç‰¹ç‚¹**: åŒ…å« 2000+ ç§ä¸åŒçš„ç‰©ä½“ (PartNet Mobility)ï¼Œæ¯ä¸ªç‰©ä½“éƒ½æœ‰ä¸åŒçš„æ‹“æ‰‘ç»“æ„ (ä¸åŒçš„é—¨æŠŠæ‰‹ã€ä¸åŒçš„æ°´é¾™å¤´)ã€‚
- **è¯„ä¼°**: æµ‹è¯•æ¨¡å‹åœ¨ **Unseen Object Instances** ä¸Šçš„ Zero-shot æˆåŠŸç‡ã€‚

---

## 3. çœŸæœºè¯„ä¼°åè®® (Real World Protocols)

çœŸæœºè¯„ä¼°æ˜¯â€œç„å­¦â€çš„é‡ç¾åŒºã€‚ä¸ºäº†ä¿è¯å…¬å¹³ï¼Œå¿…é¡»éµå¾ªä¸¥æ ¼çš„åè®®ã€‚

### 3.1. å˜é‡æ§åˆ¶ (Variable Control)
- **ç‰©ä½“ä½ç½®**:
    - **Fixed**: æ¯æ¬¡éƒ½æ”¾åœ¨å®Œå…¨ç›¸åŒçš„ä½ç½® (æµ‹è¯•è®°å¿†èƒ½åŠ›)ã€‚
    - **Randomized**: åœ¨ $10cm \times 10cm$ çš„åŒºåŸŸå†…éšæœºæ”¾ç½® (æµ‹è¯•æ³›åŒ–èƒ½åŠ›)ã€‚
- **å¹²æ‰°é¡¹ (Distractors)**:
    - åœºæ™¯ä¸­æ˜¯å¦åŒ…å«ä¸ä»»åŠ¡æ— å…³çš„ç‰©ä½“ï¼Ÿ(æµ‹è¯•æŠ—å¹²æ‰°èƒ½åŠ›)ã€‚
- **å…‰ç…§**:
    - å›ºå®šå…‰æº vs è‡ªç„¶å…‰å˜åŒ–ã€‚

### 3.2. A/B Testing
åœ¨çœŸæœºä¸Šå¯¹æ¯”æ¨¡å‹ A å’Œ B æ—¶ï¼Œå¿…é¡»äº¤æ›¿è¿›è¡Œ (Interleaved)ï¼Œä»¥æ¶ˆé™¤ç¯å¢ƒéšæ—¶é—´å˜åŒ– (e.g., ç”µæœºå‘çƒ­ã€å…‰ç…§å˜åŒ–) çš„å½±å“ã€‚
- **é”™è¯¯åšæ³•**: ä¸Šåˆæµ‹æ¨¡å‹ A (50æ¬¡)ï¼Œä¸‹åˆæµ‹æ¨¡å‹ B (50æ¬¡)ã€‚
- **æ­£ç¡®åšæ³•**: A, B, A, B, ... äº¤æ›¿æµ‹è¯•ã€‚

### 3.3. Reset-Free Evaluation
- **å®šä¹‰**: æœºå™¨äººå®Œæˆä»»åŠ¡åï¼Œè‡ªåŠ¨æ‰§è¡Œâ€œå¤ä½â€åŠ¨ä½œï¼Œæˆ–è€…ä¸‹ä¸€ä¸ªä»»åŠ¡çš„åˆå§‹çŠ¶æ€å°±æ˜¯ä¸Šä¸€ä¸ªä»»åŠ¡çš„ç»“æŸçŠ¶æ€ã€‚
- **æ„ä¹‰**: å®ç° 24/7 æ— äººå€¼å®ˆçš„è‡ªåŠ¨åŒ–è¯„ä¼° (Scale Up Evaluation)ã€‚

---

## 4. æ¨¡å‹é€‰æ‹©ç­–ç•¥ (Checkpoint Selection)

åœ¨ VLA è®­ç»ƒä¸­ï¼ŒLoss ä¸ä»£è¡¨ä¸€åˆ‡ã€‚

### 4.1. ä¸ºä»€ä¹ˆ Loss å¤±æ•ˆï¼Ÿ
- **å¤šæ¨¡æ€åˆ†å¸ƒ**: æ¯”å¦‚é¢å¯¹éšœç¢ç‰©ï¼Œå‘å·¦èµ°å’Œå‘å³èµ°éƒ½æ˜¯å¯¹çš„ã€‚MSE Loss ä¼šè®©æ¨¡å‹èµ°ä¸­é—´ (æ’å¢™)ï¼ŒLoss å¯èƒ½ä¸é™åå‡ï¼Œä½†ç­–ç•¥å…¶å®å˜å¥½äº† (å­¦ä¼šäº†å¤šæ¨¡æ€)ã€‚
- **è¿‡æ‹Ÿåˆ**: æ¨¡å‹å¯èƒ½è®°ä½äº†è®­ç»ƒé›†é‡Œçš„ç‰¹å®šå™ªå£°ã€‚

### 4.2. EMA (Exponential Moving Average)
- **ç­–ç•¥**: ç»´æŠ¤ä¸€ä»½æ¨¡å‹æƒé‡çš„æ»‘åŠ¨å¹³å‡ç‰ˆæœ¬ã€‚
  $$ \theta_{EMA} = \alpha \theta_{EMA} + (1-\alpha) \theta_{current} $$
- **ä½œç”¨**: æå¤§åœ°ç¨³å®šäº†è¯„ä¼°æ—¶çš„è¡¨ç°ï¼Œå¹³æ»‘äº†è®­ç»ƒè¿‡ç¨‹ä¸­çš„éœ‡è¡ã€‚**æ‰€æœ‰ SOTA æ¨¡å‹ (RT-2, Octo, Pi0) è¯„ä¼°æ—¶ç”¨çš„éƒ½æ˜¯ EMA æƒé‡ï¼Œè€Œä¸æ˜¯å½“å‰æƒé‡**ã€‚

### 4.3. æœ€ä½³å®è·µ
1. æ¯ 5000 Steps ä¿å­˜ä¸€ä¸ª Checkpointã€‚
2. ä½¿ç”¨ SIMPLER æˆ– CALVIN è¿›è¡Œå¹¶è¡Œè¯„ä¼°ã€‚
3. é€‰å–ä»¿çœŸ SR æœ€é«˜çš„ Top-3 Checkpointã€‚
4. åœ¨çœŸæœºä¸Šå¯¹è¿™ Top-3 è¿›è¡Œå°æ ·æœ¬ (N=10) å¿«é€Ÿç­›é€‰ã€‚
5. é€‰å®šæœ€ä½³æ¨¡å‹è¿›è¡Œå¤§è§„æ¨¡ (N=50) æµ‹è¯•ã€‚

---

## 5. Evaluation Pipeline æ„å»º (Building Evaluation Pipeline)

### 5.1 æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Evaluation Pipeline æ¶æ„                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚   â”‚   Data    â”‚â”€â”€â”€â–¶â”‚   Model   â”‚â”€â”€â”€â–¶â”‚  Metrics  â”‚â”€â”€â”€â–¶â”‚ Report â”‚â”‚
â”‚   â”‚  Loader   â”‚    â”‚ Inference â”‚    â”‚ Compute   â”‚    â”‚ & Log  â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚        â”‚                â”‚                â”‚               â”‚      â”‚
â”‚        â–¼                â–¼                â–¼               â–¼      â”‚
â”‚   RLDS/HDF5        Batch/Stream     SR/MSS/IR      W&B/TB      â”‚
â”‚   CALVIN/SIMPLER   Multi-ckpt       Confidence     Artifacts   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 å…³é”®ç»„ä»¶

```python
class EvaluationPipeline:
    """VLA è¯„ä¼°æµæ°´çº¿"""
    
    def __init__(self, config):
        # 1. æ•°æ®ç®¡ç†
        self.test_set = load_test_set(config.benchmark)  # CALVIN, SIMPLER, etc.
        
        # 2. æ¨¡å‹åŠ è½½
        self.model = load_model(config.checkpoint)
        
        # 3. æŒ‡æ ‡è®¡ç®—å™¨
        self.metrics = {
            'success_rate': SuccessRateMetric(),
            'mean_steps': MeanStepsMetric(),
            'intervention_rate': InterventionRateMetric(),
        }
        
        # 4. æ—¥å¿—è®°å½•
        self.logger = WandBLogger(project=config.project)
    
    def run_episode(self, task):
        """è¿è¡Œå•ä¸ª Episode"""
        obs = self.env.reset(task)
        done = False
        steps = 0
        
        while not done and steps < self.max_steps:
            action = self.model.predict(obs)
            obs, reward, done, info = self.env.step(action)
            steps += 1
        
        return {
            'success': info['success'],
            'steps': steps,
            'trajectory': info['trajectory']
        }
    
    def evaluate(self, num_episodes=50):
        """å®Œæ•´è¯„ä¼°æµç¨‹"""
        results = []
        
        for i in range(num_episodes):
            task = self.test_set.sample()
            result = self.run_episode(task)
            results.append(result)
            
            # å®æ—¶æ—¥å¿—
            self.logger.log_episode(i, result)
        
        # è®¡ç®—æŒ‡æ ‡
        metrics = self.compute_metrics(results)
        
        # ç½®ä¿¡åŒºé—´
        metrics['sr_ci'] = self.wilson_interval(
            metrics['success_rate'], num_episodes
        )
        
        # ä¿å­˜ç»“æœ
        self.logger.log_summary(metrics)
        self.save_artifacts(results)
        
        return metrics
    
    def wilson_interval(self, p, n, z=1.96):
        """Wilson Score Interval for SR"""
        denominator = 1 + z**2 / n
        center = (p + z**2 / (2*n)) / denominator
        spread = z * np.sqrt((p*(1-p) + z**2/(4*n)) / n) / denominator
        return (center - spread, center + spread)
```

### 5.3 CI/CD é›†æˆ

```yaml
## .github/workflows/eval.yml
name: Model Evaluation

on:
  push:
    paths:
      - 'checkpoints/**'

jobs:
  evaluate:
    runs-on: self-hosted-gpu
    steps:
      - name: Run CALVIN Evaluation
        run: |
          python eval.py \
            --benchmark calvin \
            --checkpoint ${{ github.sha }} \
            --num_episodes 100
      
      - name: Upload Results
        uses: wandb/upload-artifact@v1
        with:
          name: eval-results
          path: results/
```

### 5.4 å¤±è´¥æ¡ˆä¾‹åˆ†æ

```python
class FailureAnalyzer:
    """è‡ªåŠ¨åˆ†æå¤±è´¥åŸå› """
    
    def analyze(self, failed_episodes):
        categories = {
            'perception': [],      # è§†è§‰è¯†åˆ«é”™è¯¯
            'planning': [],        # è§„åˆ’è·¯å¾„é”™è¯¯
            'execution': [],       # æ‰§è¡Œç²¾åº¦ä¸è¶³
            'ik_failure': [],      # é€†è¿åŠ¨å­¦æ— è§£
            'collision': [],       # ç¢°æ’
        }
        
        for ep in failed_episodes:
            reason = self.classify_failure(ep)
            categories[reason].append(ep)
        
        # å¯è§†åŒ–
        self.plot_failure_distribution(categories)
        
        # ç”ŸæˆæŠ¥å‘Š
        return self.generate_report(categories)
```

---

## 6. é¢è¯•é«˜é¢‘è€ƒç‚¹

**Q: å…·ä½“è®²è®²æ€ä¹ˆæ„å»º Evaluation Pipeline çš„ï¼Ÿ**
A: æ ¸å¿ƒç»„ä»¶åŒ…æ‹¬ï¼š
1. **æ•°æ®ç®¡ç†**: æ ‡å‡†åŒ–æµ‹è¯•é›† (CALVIN/SIMPLER)ï¼Œç‰ˆæœ¬æ§åˆ¶ï¼Œç¡®ä¿å¯å¤ç°
2. **æ¨ç†æœåŠ¡**: æ”¯æŒå¤š Checkpoint å¹¶è¡Œè¯„ä¼°ï¼ŒBatch/Streaming ä¸¤ç§æ¨¡å¼
3. **æŒ‡æ ‡è®¡ç®—**: è‡ªåŠ¨åŒ– SR/MSS/IR è®¡ç®—ï¼ŒWilson Interval ç½®ä¿¡åŒºé—´
4. **å¯è§†åŒ–**: å¤±è´¥æ¡ˆä¾‹åˆ†æï¼ŒAttention å¯è§†åŒ–ï¼Œè½¨è¿¹å›æ”¾
5. **CI/CD é›†æˆ**: æ¯æ¬¡è®­ç»ƒè‡ªåŠ¨è§¦å‘è¯„ä¼°ï¼Œç»“æœä¸Šä¼  W&B

**Q: ä»€ä¹ˆæ˜¯ "Cherry-picking"ï¼Ÿå¦‚ä½•é¿å…ï¼Ÿ**
A: Cherry-picking æŒ‡åªå±•ç¤ºæˆåŠŸçš„è§†é¢‘ç‰‡æ®µã€‚é¿å…æ–¹æ³•æ˜¯æŠ¥å‘Šä¸¥æ ¼å®šä¹‰çš„ Success Rateï¼Œå¹¶å…¬å¼€æ‰€æœ‰å°è¯•çš„åŸå§‹è§†é¢‘ (Uncut Videos) æˆ–æ—¥å¿—ã€‚

**Q: ä¸ºä»€ä¹ˆ Sim-to-Real è¯„ä¼°å¾ˆéš¾ï¼Ÿ**
A: å› ä¸º Reality Gapã€‚ä»¿çœŸé‡Œçš„æˆåŠŸä¸ä»£è¡¨çœŸæœºæˆåŠŸã€‚SIMPLER ç­‰å·¥ä½œè¯•å›¾ç¼©å°è¿™ä¸ª Gapï¼Œä½†ç›®å‰ä»æœªå®Œå…¨è§£å†³ã€‚æœ€å¯é çš„è¯„ä¼°ä¾ç„¶æ˜¯çœŸæœºã€‚

**Q: å¦‚ä½•è¯„ä¼°æ¨¡å‹çš„æ³›åŒ–æ€§ (Generalization)ï¼Ÿ**
A: å®šä¹‰ä¸‰ä¸ªçº§åˆ«çš„æ³›åŒ–ï¼š
L1: **Interpolation** (è®­ç»ƒåˆ†å¸ƒå†…ï¼Œæ–°ä½ç½®/æ–°è§’åº¦)ã€‚
L2: **Visual Extrapolation** (æœªè§è¿‡çš„ç‰©ä½“é¢œè‰²/çº¹ç†/èƒŒæ™¯)ã€‚
L3: **Semantic Extrapolation** (æœªè§è¿‡çš„ç‰©ä½“ç±»åˆ«/æ–°æŒ‡ä»¤)ã€‚
é¢è¯•æ—¶è¦æ˜ç¡®æŒ‡å‡ºæ¨¡å‹è¾¾åˆ°äº†å“ªä¸€çº§åˆ«çš„æ³›åŒ–ã€‚

---

\newpage

# ç¬¬32ç«  çŸ¥è¯†éš”ç¦»


> [!IMPORTANT]
> **Knowledge Insulation** (çŸ¥è¯†ç»ç¼˜) æ˜¯ **Physical Intelligence** åœ¨ Pi0 æ¨¡å‹ä¸­æå‡ºçš„ä¸€ç§è®­ç»ƒæŠ€æœ¯ï¼Œé€šè¿‡**æ¢¯åº¦éš”ç¦»**é˜²æ­¢ VLM åœ¨å­¦ä¹ æœºå™¨äººæ§åˆ¶æ—¶å‘ç”Ÿ**ç¾éš¾æ€§é—å¿˜ (Catastrophic Forgetting)**ã€‚

## 1. æ ¸å¿ƒé—®é¢˜ï¼šç¾éš¾æ€§é—å¿˜
å½“æˆ‘ä»¬å°†é¢„è®­ç»ƒçš„ **Vision-Language Model (VLM)** å¾®è°ƒä¸º **Vision-Language-Action (VLA)** æ¨¡å‹æ—¶ï¼Œä¼šé‡åˆ°ä¸€ä¸ªè‡´å‘½é—®é¢˜ï¼š

### 1.1. ä»€ä¹ˆæ˜¯ç¾éš¾æ€§é—å¿˜ï¼Ÿ
-   **å®šä¹‰**: ç¥ç»ç½‘ç»œåœ¨å­¦ä¹ æ–°ä»»åŠ¡æ—¶ï¼Œä¼š**è¦†ç›–**ä¹‹å‰å­¦åˆ°çš„çŸ¥è¯†ã€‚
-   **åœ¨ VLA ä¸­çš„è¡¨ç°**: 
    -   VLM åŸæœ¬æ‹¥æœ‰å¼ºå¤§çš„**è¯­ä¹‰ç†è§£**ï¼ˆä»äº’è”ç½‘è§„æ¨¡æ•°æ®å­¦åˆ°ï¼‰ã€‚
    -   å½“æˆ‘ä»¬æ·»åŠ **è¿ç»­åŠ¨ä½œä¸“å®¶**ï¼ˆAction Expertï¼‰è¿›è¡Œæœºå™¨äººæ§åˆ¶è®­ç»ƒæ—¶ï¼ŒVLM ä¼š**å¿˜è®°**å…¶åŸæœ‰çš„è¯­è¨€å’Œè§†è§‰çŸ¥è¯†ã€‚
    -   ç»“æœï¼šæœºå™¨äººå­¦ä¼šäº†åŠ¨ä½œï¼Œä½†**ä¸¢å¤±äº†æ³›åŒ–èƒ½åŠ›**å’Œ**æŒ‡ä»¤ç†è§£èƒ½åŠ›**ã€‚

### 1.2. ä¸ºä»€ä¹ˆä¼šå‘ç”Ÿï¼Ÿ
-   **åˆ†å¸ƒä¸åŒ¹é…**: æœºå™¨äººæ•°æ®ï¼ˆå¦‚ 10Hz çš„å…³èŠ‚è§’åº¦ï¼‰ä¸ VLM é¢„è®­ç»ƒæ•°æ®ï¼ˆäº’è”ç½‘å›¾æ–‡ï¼‰åˆ†å¸ƒå·®å¼‚å·¨å¤§ã€‚
-   **æ–°å‚æ•°çš„å¹²æ‰°**: æ–°å¢çš„**è¿ç»­åŠ¨ä½œå¤´**ï¼ˆæœªç»è®­ç»ƒï¼‰çš„æ¢¯åº¦ä¼š**æ±¡æŸ“** VLM ä¸»å¹²çš„å‚æ•°ã€‚
-   **è®­ç»ƒç›®æ ‡å†²çª**: VLM åŸæœ¬ä¼˜åŒ–è¯­è¨€ tokenï¼Œç°åœ¨è¦åŒæ—¶ä¼˜åŒ–è¿ç»­åŠ¨ä½œï¼Œå¯¼è‡´æ··ä¹±ã€‚

## 2. Knowledge Insulation çš„è§£å†³æ–¹æ¡ˆ

### 2.1. æ ¸å¿ƒæ€æƒ³ï¼šæ¢¯åº¦éš”ç¦»
**å…³é”®æ“ä½œ**: åœ¨è®­ç»ƒæ—¶**é˜»æ­¢**è¿ç»­åŠ¨ä½œä¸“å®¶çš„æ¢¯åº¦å›ä¼ åˆ° VLM ä¸»å¹²ã€‚

```python
## ä¼ªä»£ç ç¤ºä¾‹
vlm_features = vlm_backbone(image, text)  # VLM æå–ç‰¹å¾

## ç¦»æ•£åŠ¨ä½œåˆ†æ”¯ (ç”¨äº VLM æ›´æ–°)
discrete_actions = vlm_head(vlm_features)
loss_discrete = cross_entropy(discrete_actions, discrete_targets)

## è¿ç»­åŠ¨ä½œåˆ†æ”¯ (æ¢¯åº¦éš”ç¦»)
vlm_features_detached = vlm_features.detach()  # ğŸ”‘ å…³é”®ï¼é˜»æ­¢æ¢¯åº¦å›ä¼ 
continuous_actions = action_expert(vlm_features_detached)
loss_continuous = mse(continuous_actions, continuous_targets)

## åªæœ‰ç¦»æ•£æŸå¤±ä¼šæ›´æ–° VLM
loss_discrete.backward()  # âœ… VLM è¢«æ›´æ–°
## loss_continuous ä¸ä¼šå½±å“ VLM  # âœ… VLM è¢«ä¿æŠ¤
```

### 2.2. åŒè½¨è®­ç»ƒ
Knowledge Insulation é‡‡ç”¨**åŒè½¨å¹¶è¡Œ**è®­ç»ƒç­–ç•¥ï¼š

| åˆ†æ”¯ | è¾“å…¥ | è¾“å‡º | æ¢¯åº¦å»å‘ | ç›®çš„ |
| :--- | :--- | :--- | :--- | :--- |
| **ç¦»æ•£åŠ¨ä½œåˆ†æ”¯** | VLM ç‰¹å¾ | ç¦»æ•£ Tokenï¼ˆå¦‚ FASTï¼‰ | **â†’ VLM ä¸»å¹²** | ä¿æŒ VLM è¯­ä¹‰èƒ½åŠ› |
| **è¿ç»­åŠ¨ä½œåˆ†æ”¯** | VLM ç‰¹å¾ï¼ˆdetachedï¼‰ | è¿ç»­åŠ¨ä½œï¼ˆå…³èŠ‚è§’åº¦ï¼‰| **â†’ ä»…åŠ¨ä½œä¸“å®¶** | å­¦ä¹ ç²¾ç¡®æ§åˆ¶ |

## 3. ä¸ºä»€ä¹ˆè¿™æ ·æœ‰æ•ˆï¼Ÿ

### 3.1. ä¿æŠ¤ VLM çš„è¯­ä¹‰çŸ¥è¯†
-   **VLM åªçœ‹åˆ°ç¦»æ•£ token**: ç±»ä¼¼äºå®ƒé¢„è®­ç»ƒæ—¶çš„è¯­è¨€ tokenï¼Œ**åˆ†å¸ƒå¯¹é½**ã€‚
-   **é¿å…æœªè®­ç»ƒå‚æ•°çš„æ±¡æŸ“**: è¿ç»­åŠ¨ä½œä¸“å®¶åˆå§‹æ—¶æ˜¯éšæœºçš„ï¼Œå…¶æ¢¯åº¦ä¼šç ´å VLMï¼Œéš”ç¦»åå°±å®‰å…¨äº†ã€‚

### 3.2. è¿ç»­åŠ¨ä½œä¸“å®¶ç‹¬ç«‹å­¦ä¹ 
-   **ä¸“å®¶ä¸“æ³¨**: åŠ¨ä½œä¸“å®¶åªéœ€å­¦ä¹ ä» VLM ç‰¹å¾åˆ°è¿ç»­åŠ¨ä½œçš„æ˜ å°„ï¼Œä¸ç”¨æ‹…å¿ƒç ´å VLMã€‚
-   **é«˜æ•ˆæ”¶æ•›**: å¯ä»¥ä½¿ç”¨**æµåŒ¹é… (Flow Matching)** æˆ–**æ‰©æ•£ (Diffusion)** ç­‰å¤æ‚æŠ€æœ¯ï¼Œè®­ç»ƒæ›´å¿«ã€‚

### 3.3. æ¨ç†æ—¶æ— ç¼åˆ‡æ¢
-   **è®­ç»ƒæ—¶**: VLM å­¦ç¦»æ•£ï¼Œä¸“å®¶å­¦è¿ç»­ã€‚
-   **æ¨ç†æ—¶**: VLM æå–ç‰¹å¾ â†’ åŠ¨ä½œä¸“å®¶ç”Ÿæˆè¿ç»­åŠ¨ä½œ â†’ æœºå™¨äººæ‰§è¡Œã€‚

## 4. å®éªŒæ•ˆæœå¯¹æ¯”
| æŒ‡æ ‡ | **æ—  Knowledge Insulation** | **æœ‰ Knowledge Insulation** |
| :--- | :--- | :--- |
| **è®­ç»ƒé€Ÿåº¦** | æ…¢ï¼ˆVLM è¢«ç ´ååéœ€é‡æ–°å­¦ä¹ ï¼‰| **å¿«ï¼ˆVLM ç¨³å®šï¼Œä¸“å®¶å¿«é€Ÿæ”¶æ•›ï¼‰** |
| **è¯­ä¹‰ç†è§£** | å·®ï¼ˆç¾éš¾æ€§é—å¿˜ï¼‰| **å¼ºï¼ˆä¿ç•™ VLM èƒ½åŠ›ï¼‰** |
| **æ–°ä»»åŠ¡æ³›åŒ–** | å¼±ï¼ˆè¿‡æ‹Ÿåˆæœºå™¨äººæ•°æ®ï¼‰| **å¼ºï¼ˆåˆ©ç”¨ VLM çš„ç½‘ç»œçŸ¥è¯†ï¼‰** |
| **æŒ‡ä»¤è·Ÿéš** | é€€åŒ–ï¼ˆç‰¹åˆ«æ˜¯å¤šè¯­è¨€ï¼‰| **ä¿æŒï¼ˆé›¶æ ·æœ¬å¤šè¯­è¨€ï¼‰** |

## 5. ä¸å…¶ä»–æŠ€æœ¯çš„ç»“åˆ
Knowledge Insulation é€šå¸¸ä¸ä»¥ä¸‹æŠ€æœ¯é…åˆä½¿ç”¨ï¼š

-   **FAST Tokenizer**: æä¾›é«˜æ•ˆçš„ç¦»æ•£åŠ¨ä½œ tokenï¼ˆDCT + BPEï¼‰ã€‚
-   **Flow Matching**: è¿ç»­åŠ¨ä½œä¸“å®¶ä½¿ç”¨æµåŒ¹é…ç”Ÿæˆå¹³æ»‘è½¨è¿¹ã€‚
-   **Co-Training**: åŒæ—¶è®­ç»ƒ VLM åˆ†æ”¯ï¼ˆè¯­è¨€ç†è§£ï¼‰å’ŒåŠ¨ä½œåˆ†æ”¯ï¼ˆç‰©ç†æ§åˆ¶ï¼‰ã€‚
-   **LoRA**: ä½¿ç”¨ä½ç§©é€‚åº”è¿›ä¸€æ­¥å‡å°‘å¯¹ VLM çš„ä¿®æ”¹ã€‚

## 6. é¢è¯•è¦ç‚¹
-   **æ ¸å¿ƒ**: è®°ä½ "æ¢¯åº¦éš”ç¦» (Gradient Isolation)" å’Œ ".detach()" æ“ä½œã€‚
-   **é—®é¢˜**: ç¾éš¾æ€§é—å¿˜ - VLM å­¦æœºå™¨äººæ§åˆ¶æ—¶ä¼šå¿˜è®°è¯­ä¹‰çŸ¥è¯†ã€‚
-   **è§£å†³**: åŒè½¨è®­ç»ƒ - VLM å­¦ç¦»æ•£ tokenï¼ŒåŠ¨ä½œä¸“å®¶å­¦è¿ç»­æ§åˆ¶ï¼Œæ¢¯åº¦ä¸å›ä¼ ã€‚
-   **æ•ˆæœ**: ä¿æŠ¤ VLM çŸ¥è¯†ï¼ŒåŠ é€Ÿè®­ç»ƒï¼Œæå‡æ³›åŒ–ã€‚
-   **æ¥æº**: Physical Intelligence çš„ Pi0 æ¨¡å‹é¦–æ¬¡ç³»ç»Ÿæ€§åº”ç”¨è¿™ä¸€æŠ€æœ¯ã€‚

## 7. å»¶ä¼¸ï¼šæŒç»­å­¦ä¹  (Continual Learning)
Knowledge Insulation æ˜¯**æŒç»­å­¦ä¹ **é¢†åŸŸçš„ä¸€ä¸ªåº”ç”¨æ¡ˆä¾‹ï¼š
-   **æŒç»­å­¦ä¹ ç›®æ ‡**: æœºå™¨äººèƒ½ä¸æ–­å­¦ä¹ æ–°æŠ€èƒ½ï¼Œè€Œä¸å¿˜è®°æ—§æŠ€èƒ½ã€‚
-   **Knowledge Insulation çš„è´¡çŒ®**: åœ¨ VLA é€‚é…é˜¶æ®µå°±é˜²æ­¢é—å¿˜ï¼Œä¸ºåç»­æŒç»­å­¦ä¹ æ‰“å¥½åŸºç¡€ã€‚
-   **å…¶ä»–æŠ€æœ¯**: EWC (å¼¹æ€§æƒé‡å·©å›º)ã€Memory Replayï¼ˆç»éªŒå›æ”¾ï¼‰ã€Progressive Networksï¼ˆæ¸è¿›ç½‘ç»œï¼‰ã€‚

## 8. å‚è€ƒèµ„æº
-   **Pi0 Technical Report**: [Physical Intelligence](https://physicalintelligence.company/)
-   **ç›¸å…³è®ºæ–‡**: VLM2VLA, ReVLA (è§†è§‰ç¾éš¾æ€§é—å¿˜æ¢å¤)
-   **ä»£ç ç¤ºä¾‹**: æŸ¥çœ‹ Pi0 çš„ GitHubï¼ˆå¦‚å¼€æºï¼‰ä¸­çš„æ¢¯åº¦éš”ç¦»å®ç°

\newpage

# é™„å½•


\newpage

# é™„å½•A æ•°æ®æ ¼å¼ä¸å¤„ç†


åœ¨ VLA æ¨¡å‹çš„è®­ç»ƒä¸­ï¼Œæ•°æ®æ˜¯æ ¸å¿ƒå£å’ã€‚æœ¬ç« ä»‹ç»æœºå™¨äººå­¦ä¹ ä¸­é€šç”¨çš„æ•°æ®æ ¼å¼å’Œå¤„ç†ç­–ç•¥ã€‚

## 1. ä¸»æµæ•°æ®æ ¼å¼å¯¹æ¯” (Mainstream Data Formats)

åœ¨ VLA é¢†åŸŸï¼Œæ•°æ®æ ¼å¼çš„é€‰æ‹©ç›´æ¥å½±å“è®­ç»ƒæ•ˆç‡å’Œç”Ÿæ€å…¼å®¹æ€§ã€‚ç›®å‰ä¸»è¦æœ‰ä¸‰ç§ä¸»æµæ ¼å¼ï¼š

### 1.1. RLDS (Robotics Language-Image Datasets)
- **ç”Ÿæ€ä½**: **Google / Open X-Embodiment æ ‡å‡†**ã€‚
- **åº•å±‚**: åŸºäº `TensorFlow Datasets (TFDS)` å’Œ `ProtoBuf`ã€‚
- **ç‰©ç†æ ¼å¼**: **`.tfrecord`** æ–‡ä»¶ã€‚
    - è¿™æ˜¯ä¸€ç§åŸºäºè¡Œ (Row-based) çš„äºŒè¿›åˆ¶åºåˆ—åŒ–æ ¼å¼ï¼Œå°†æ•°æ®åºåˆ—åŒ–ä¸º Protocol Buffers æ¶ˆæ¯ã€‚
- **ç‰¹ç‚¹**:
    - **åºåˆ—åŒ–**: é€‚åˆå¤§è§„æ¨¡åˆ†å¸ƒå¼è¯»å–ï¼ŒGoogle TPU å‹å¥½ã€‚
    - **æ ‡å‡†åŒ–**: å¼ºåˆ¶å®šä¹‰äº† `observation`, `action`, `language` çš„æ ‡å‡†æ¥å£ã€‚
    - **æµå¼è¯»å–**: æ”¯æŒäº‘ç«¯å­˜å‚¨ (GCS) çš„æµå¼è®­ç»ƒï¼Œæ— éœ€ä¸‹è½½æ•´ä¸ªæ•°æ®é›†ã€‚
- **é€‚ç”¨åœºæ™¯**: ä½¿ç”¨ TPU è®­ç»ƒï¼Œæˆ–åŸºäº RT-1/RT-2/Octo æ¶æ„å¼€å‘æ—¶ã€‚

### 1.2. LeRobot Dataset (Hugging Face)
- **ç”Ÿæ€ä½**: **PyTorch / Open Source ç¤¾åŒºæ–°æ ‡å‡†**ã€‚
- **åº•å±‚**: åŸºäº `Parquet` (åˆ—å¼å­˜å‚¨) å’Œ `Hugging Face Datasets` (Apache Arrow)ã€‚
- **ç‰©ç†æ ¼å¼**: **`.parquet`** æ–‡ä»¶ã€‚
    - è¿™æ˜¯ä¸€ç§åŸºäºåˆ— (Column-based) çš„å­˜å‚¨æ ¼å¼ï¼Œå‹ç¼©ç‡æé«˜ï¼Œè¯»å–ç‰¹å®šåˆ—ï¼ˆå¦‚åªè¯» Action ä¸è¯» Imageï¼‰éå¸¸å¿«ã€‚
- **ç‰¹ç‚¹**:
    - **å¯è§†åŒ–**: åœ¨ Hugging Face ç½‘é¡µç«¯å¯ç›´æ¥é¢„è§ˆè§†é¢‘å’Œå…ƒæ•°æ®ã€‚
    - **è½»é‡çº§**: ä¸ä¾èµ– TensorFlowï¼Œå®‰è£…ç®€å• (`pip install lerobot`)ã€‚
    - **PyTorch åŸç”Ÿ**: æ•°æ®åŠ è½½å™¨ç›´æ¥è¾“å‡º PyTorch Tensorsã€‚
- **é€‚ç”¨åœºæ™¯**: ä½¿ç”¨ GPU è®­ç»ƒï¼ŒåŸºäº OpenVLA/ACT/Diffusion Policy å¼€å‘æ–°é¡¹ç›®æ—¶ã€‚

### 1.3. HDF5 / Robomimic
- **ç”Ÿæ€ä½**: **ä¼ ç»Ÿç§‘ç ” / ä»¿çœŸæ•°æ®æ ‡å‡†**ã€‚
- **åº•å±‚**: `HDF5` (Hierarchical Data Format)ã€‚
- **ç‰©ç†æ ¼å¼**: **`.hdf5`** æˆ– **`.h5`** æ–‡ä»¶ã€‚
    - ç±»ä¼¼äºä¸€ä¸ª"æ–‡ä»¶ç³»ç»Ÿ"ï¼Œå†…éƒ¨å¯ä»¥åƒæ–‡ä»¶å¤¹ä¸€æ ·ç»„ç»‡æ•°æ® (Groups/Datasets)ã€‚
- **ç‰¹ç‚¹**:
    - **å•æ–‡ä»¶**: æ•´ä¸ªæ•°æ®é›†é€šå¸¸æ˜¯ä¸€ä¸ªå·¨å¤§çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚
    - **éšæœºè®¿é—®**: æ”¯æŒé«˜æ•ˆçš„éšæœºç´¢å¼•è¯»å– (Random Access)ã€‚
    - **ç»“æ„çµæ´»**: ç±»ä¼¼äºæ–‡ä»¶ç³»ç»Ÿçš„å±‚çº§ç»“æ„ã€‚
- **ç¼ºç‚¹**: ä¸é€‚åˆè¶…å¤§è§„æ¨¡æ•°æ®é›† (TB çº§åˆ«)ï¼Œéš¾ä»¥æµå¼è¯»å–ã€‚
- **é€‚ç”¨åœºæ™¯**: ä»¿çœŸç¯å¢ƒ (MuJoCo) æ•°æ®æ”¶é›†ï¼Œå°è§„æ¨¡çœŸæœºå®éªŒã€‚

### ğŸ“Š æ ¼å¼å¯¹æ¯”è¡¨

| ç‰¹æ€§ | RLDS | LeRobot | HDF5 |
| :--- | :--- | :--- | :--- |
| **èƒŒä¹¦æœºæ„** | Google DeepMind | Hugging Face | Stanford (Robomimic) |
| **æ ¸å¿ƒä¾èµ–** | TensorFlow | PyTorch / Arrow | h5py |
| **å­˜å‚¨æ ¼å¼** | TFRecord (åºåˆ—åŒ–) | Parquet (åˆ—å¼) | HDF5 (å±‚çº§) |
| **æµå¼è¯»å–** | â­â­â­ (åŸç”Ÿæ”¯æŒ) | â­â­ (æ”¯æŒ) | â­ (å›°éš¾) |
| **ç”Ÿæ€å…¼å®¹** | Open X-Embodiment | Transformers / Hub | Simulators |
| **æ¨èæŒ‡æ•°** | â­â­â­ (å¤§è§„æ¨¡/TPU) | â­â­â­ (æ–°é¡¹ç›®é¦–é€‰) | â­â­ (ç§‘ç ”/ä»¿çœŸ) |

---

## 2. ä»£ç ç¤ºä¾‹ï¼šå¦‚ä½•åŠ è½½æ•°æ®

### 2.1. Loading RLDS (TensorFlow)
```python
import tensorflow_datasets as tfds

## åŠ è½½ Open X-Embodiment ä¸­çš„ fractal æ•°æ®
ds = tfds.load('fractal20220817_data', split='train')

for episode in ds.take(1):
    steps = episode['steps']
    for step in steps:
        image = step['observation']['image']
        action = step['action']
        # éœ€è¦æ‰‹åŠ¨è½¬æ¢ä¸º PyTorch Tensor å¦‚æœä¸ç”¨ TF
```

### 2.2. Loading LeRobot (PyTorch)
```python
from lerobot.common.datasets.lerobot_dataset import LeRobotDataset

## ç›´æ¥ä» Hugging Face Hub åŠ è½½
dataset = LeRobotDataset("lerobot/pusht")

## åƒæ ‡å‡†çš„ PyTorch Dataset ä¸€æ ·ä½¿ç”¨
item = dataset[0]
image = item['observation.image']  # è‡ªåŠ¨å½’ä¸€åŒ–å¹¶è½¬ä¸º Tensor (C, H, W)
action = item['action']
print(f"Action shape: {action.shape}")
```

## 3. PyTorch å®Œæ•´è®­ç»ƒæµç¨‹ (PyTorch Training Pipeline)

åœ¨ PyTorch ä¸­è®­ç»ƒ VLA æ¨¡å‹ï¼Œæ•°æ®æµé€šå¸¸éµå¾ªä»¥ä¸‹æ¨¡å¼ï¼š`Dataset` -> `DataLoader` -> `Model`ã€‚

### 3.1. æ ¸å¿ƒç»„ä»¶
1.  **Dataset**: è´Ÿè´£è¯»å–ç£ç›˜ä¸Šçš„æ•°æ® (RLDS/Parquet)ï¼Œå¹¶è¿›è¡Œé¢„å¤„ç† (Resize, Normalize)ã€‚
2.  **Processor/Transform**: å¤„ç†å¤šæ¨¡æ€æ•°æ®ã€‚
    -   **Image**: `Resize((224, 224))`, `Normalize(mean, std)`.
    -   **Text**: Tokenizer (å¦‚ Llama Tokenizer) å°†æŒ‡ä»¤è½¬ä¸º Input IDs.
    -   **Action**: å½’ä¸€åŒ–åˆ° [-1, 1].
3.  **DataLoader**: å°†å¤šä¸ªæ ·æœ¬æ‰“åŒ…æˆ Batchã€‚éœ€è¦è‡ªå®šä¹‰ `collate_fn` æ¥å¤„ç†å˜é•¿åºåˆ— (Padding)ã€‚

### 3.2. ä»£ç å®æˆ˜ (Pseudo-code)

```python
import torch
from torch.utils.data import Dataset, DataLoader
from transformers import AutoProcessor

class VLADataset(Dataset):
    def __init__(self, data_path, processor):
        self.data = load_data(data_path) # e.g., LeRobotDataset
        self.processor = processor

    def __getitem__(self, idx):
        item = self.data[idx]
        
        # 1. è·å–åŸå§‹æ•°æ®
        image = item['observation.image'] # (C, H, W)
        text = item['language_instruction'] # "Pick up the apple"
        action = item['action'] # (Time, Action_Dim)
        
        # 2. å¤šæ¨¡æ€é¢„å¤„ç† (å…³é”®æ­¥éª¤!)
        # VLA æ¨¡å‹é€šå¸¸éœ€è¦åŒæ—¶è¾“å…¥å›¾åƒå’Œæ–‡æœ¬
        inputs = self.processor(
            text=text, 
            images=image, 
            return_tensors="pt", 
            padding="max_length",
            truncation=True
        )
        
        # 3. è¿”å›å­—å…¸
        return {
            "input_ids": inputs.input_ids.squeeze(),
            "pixel_values": inputs.pixel_values.squeeze(),
            "labels": action # åŠ¨ä½œä½œä¸ºç›‘ç£ä¿¡å·
        }

## 4. è®­ç»ƒå¾ªç¯
dataset = VLADataset(path, processor)
dataloader = DataLoader(dataset, batch_size=32, shuffle=True)
model = OpenVLAModel.from_pretrained("openvla/openvla-7b")

for batch in dataloader:
    # å°†æ•°æ®é€å…¥ GPU
    input_ids = batch["input_ids"].cuda()
    pixel_values = batch["pixel_values"].cuda()
    actions = batch["labels"].cuda()
    
    # å‰å‘ä¼ æ’­
    # VLA æ¨¡å‹é€šå¸¸è®¡ç®— Action MSE Loss æˆ– Cross-Entropy Loss (å¦‚æœæ˜¯ Tokenized Action)
    loss = model(
        input_ids=input_ids, 
        pixel_values=pixel_values, 
        labels=actions
    ).loss
    
    loss.backward()
    optimizer.step()
```

### 3.3. å¸¸è§å‘ç‚¹ (Pitfalls)
-   **æ•°æ®ç±»å‹**: ç¡®ä¿ Action æ˜¯ `float32` (å¯¹äº Diffusion/Regression) æˆ– `long` (å¯¹äº Tokenization)ã€‚
-   **å›¾åƒé€šé“**: PyTorch é»˜è®¤æ˜¯ `(C, H, W)`ï¼Œè€Œæœ‰äº›è¯»å–åº“ (å¦‚ OpenCV/PIL) å¯èƒ½æ˜¯ `(H, W, C)`ï¼ŒåŠ¡å¿…æ£€æŸ¥ `permute`ã€‚
-   **å½’ä¸€åŒ–**: åŠ¨ä½œå¿…é¡»ä½¿ç”¨**ç»Ÿè®¡æ•°æ® (Statistics)** è¿›è¡Œå½’ä¸€åŒ– (e.g., min-max æˆ– mean-std)ã€‚**æ¨ç†æ—¶å¿…é¡»ä½¿ç”¨ç›¸åŒçš„ç»Ÿè®¡æ•°æ®åå½’ä¸€åŒ–**ã€‚

---

## 4. æ•°æ®åŠ æƒä¸å¹³è¡¡ (Data Weighting & Balancing)
åœ¨è®­ç»ƒé€šç”¨ VLA æ¨¡å‹æ—¶ï¼Œé€šå¸¸ä¼šæ··åˆå¤šç§æ•°æ®é›†ã€‚ä¸åŒæ•°æ®é›†çš„è´¨é‡ã€è§„æ¨¡å’Œéš¾åº¦å·®å¼‚å·¨å¤§ï¼Œç›´æ¥æ··åˆè®­ç»ƒæ•ˆæœå¾€å¾€ä¸ä½³ã€‚

### å¸¸è§ç­–ç•¥
1. **æŒ‰æ•°æ®é›†è§„æ¨¡åŠ æƒ**:
    - ç®€å•çš„æŒ‰æ¯”ä¾‹é‡‡æ ·ï¼Œä½†è¿™ä¼šå¯¼è‡´å¤§è§„æ¨¡æ•°æ®é›† (é€šå¸¸æ˜¯ç®€å•çš„é‡å¤ä»»åŠ¡) ä¸»å¯¼è®­ç»ƒï¼Œæ¨¡å‹å­¦ä¸åˆ°å¤æ‚ä»»åŠ¡ã€‚
2. **æŒ‰ä»»åŠ¡éš¾åº¦åŠ æƒ**:
    - ç»™åŒ…å«å¤æ‚æ“ä½œ (e.g., ä½¿ç”¨å·¥å…·, é•¿åºåˆ—) çš„æ•°æ®é›†æ›´é«˜çš„æƒé‡ã€‚
3. **æˆåŠŸç‡è¿‡æ»¤ (Success Filtering)**:
    - ä»…ä½¿ç”¨ `is_terminal=True` ä¸” `reward=1` çš„æˆåŠŸè½¨è¿¹è¿›è¡Œ BC (Behavior Cloning) è®­ç»ƒã€‚
    - å¯¹äºå¤±è´¥è½¨è¿¹ï¼Œå¯ä»¥ç”¨äºå¯¹æ¯”å­¦ä¹  (Contrastive Learning) æˆ–ä½œä¸ºè´Ÿæ ·æœ¬ã€‚
### 4.4. è”åˆè®­ç»ƒ (Co-training)
ä¸ºäº†é˜²æ­¢ç¾éš¾æ€§é—å¿˜å¹¶ä¿æŒé€šç”¨æ³›åŒ–èƒ½åŠ›ï¼ŒVLA è®­ç»ƒé€šå¸¸ä¼šæ··åˆäº’è”ç½‘æ•°æ®ã€‚
> è¯¦è§ç‹¬ç«‹ç« èŠ‚ï¼š**[è”åˆè®­ç»ƒè¯¦è§£ (Co-training)](./co_training.md)**

## 4. æ•°æ®æ”¶é›†å·¥å…·é“¾ (Data Collection Tools)

é«˜è´¨é‡çš„æ•°æ®æºäºé«˜æ•ˆçš„æ”¶é›†å·¥å…·ã€‚

### 4.1. é¥æ“ä½œ (Teleoperation)
- **VR å¤´æ˜¾ (Vision Pro / Quest 3)**:
    - **ä¼˜åŠ¿**: æ²‰æµ¸æ„Ÿå¼ºï¼Œèƒ½æ”¶é›† 6-DoF å§¿æ€ï¼Œé€‚åˆçµå·§æ‰‹æ“ä½œã€‚
    - **æ–¹æ¡ˆ**: ALOHA (VRç‰ˆ), AnyTeleopã€‚
- **ä¸»ä»è‡‚ (Leader-Follower Arms)**:
    - **ä¼˜åŠ¿**: åŠ›åé¦ˆçœŸå®ï¼Œæ“ä½œç²¾åº¦æé«˜ã€‚
    - **æ–¹æ¡ˆ**: ALOHA (ä½¿ç”¨ WidowX ä½œä¸ºä¸»è‡‚), GELLO (ä½æˆæœ¬ 3D æ‰“å°ä¸»è‡‚)ã€‚
- **æ‰‹æŸ„/3D é¼ æ ‡**:
    - **ä¼˜åŠ¿**: æˆæœ¬ä½ï¼Œæ˜“è·å–ã€‚
    - **åŠ£åŠ¿**: éš¾ä»¥æ§åˆ¶é«˜è‡ªç”±åº¦ (å¦‚çµå·§æ‰‹)ã€‚

### 4.2. è‡ªåŠ¨åŒ–æ”¶é›† (Autonomous Collection)
- **Scripted Policy**: åœ¨ä»¿çœŸæˆ–ç®€å•åœºæ™¯ä¸­ï¼Œç”¨ç¡¬ç¼–ç è„šæœ¬ç”Ÿæˆæ•°æ®ã€‚
- **Self-Replay**: æœºå™¨äººå›æ”¾æˆåŠŸçš„è½¨è¿¹ï¼Œå¹¶æ·»åŠ å™ªå£°è¿›è¡Œæ•°æ®å¢å¼ºã€‚

## 5. åŠ¨ä½œç©ºé—´å¯¹é½ (Action Space Alignment)
ä¸åŒæœºå™¨äººçš„åŠ¨ä½œç©ºé—´ä¸åŒ (e.g., 7-DoF æœºæ¢°è‡‚ vs 14-DoF åŒè‡‚ vs å››è¶³)ã€‚

- **å½’ä¸€åŒ– (Normalization)**: å°†æ‰€æœ‰åŠ¨ä½œç»´åº¦å½’ä¸€åŒ–åˆ° [-1, 1] æˆ– [0, 1]ã€‚
- **Proprioception Padding**: å¯¹äºè‡ªç”±åº¦è¾ƒå°‘çš„æœºå™¨äººï¼Œç”¨ 0 å¡«å……å‰©ä½™ç»´åº¦ã€‚
- **ç›¸å¯¹æ§åˆ¶ vs ç»å¯¹æ§åˆ¶**:
    - **Delta Action**: é¢„æµ‹å½“å‰çŠ¶æ€çš„å¢é‡ (dx, dy, dz)ã€‚æ³›åŒ–æ€§æ›´å¥½ã€‚
    - **Absolute Action**: é¢„æµ‹ç»å¯¹åæ ‡ã€‚ç²¾åº¦æ›´é«˜ï¼Œä½†ä¾èµ–æ ‡å®šã€‚
    - **è¶‹åŠ¿**: VLA æ¨¡å‹é€šå¸¸åå‘äºä½¿ç”¨ **Delta Action (End-effector velocity/pose delta)**ã€‚

## 7. é¢è¯•é«˜é¢‘è€ƒç‚¹
1.  **æ•°æ®æ ¼å¼**: RLDS å’Œ LeRobot æ ¼å¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿä¸ºä»€ä¹ˆ PyTorch ç”¨æˆ·ç°åœ¨å€¾å‘äº LeRobotï¼Ÿ(ç­”: LeRobot å»é™¤äº† TF ä¾èµ–ï¼ŒåŸç”Ÿæ”¯æŒ PyTorchï¼Œä¸”åŸºäº Parquet å­˜å‚¨æ•ˆç‡é«˜)
2.  **æ•°æ®æµ**: åœ¨ VLA è®­ç»ƒä¸­ï¼ŒProcessor çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ(ç­”: åŒæ—¶å¤„ç†å›¾åƒå½’ä¸€åŒ–å’Œæ–‡æœ¬ Tokenizationï¼Œç¡®ä¿å¤šæ¨¡æ€å¯¹é½)
3.  **æ•°æ®å¹³è¡¡**: å¦‚æœæˆ‘æœ‰ 1000 æ¡ç®€å•çš„ Pick-Place æ•°æ®å’Œ 100 æ¡å¤æ‚çš„ Assembly æ•°æ®ï¼Œåº”è¯¥æ€ä¹ˆè®­ç»ƒï¼Ÿ(ç­”: é‡é‡‡æ · Assembly æ•°æ®ï¼Œæé«˜å…¶åœ¨ Batch ä¸­çš„æ¯”ä¾‹)
4.  **Action Space**: ä¸ºä»€ä¹ˆè¦ç”¨ Delta Actionï¼Ÿ(ç­”: å‡å°‘å¯¹ç»å¯¹åæ ‡çš„ä¾èµ–ï¼Œæ›´å®¹æ˜“è¿ç§»åˆ°ä¸åŒä½ç½®æˆ–ä¸åŒæœºå™¨äºº)
5.  **æ•°æ®æ”¶é›†**: ç›¸æ¯”äº VR é¥æ“ä½œï¼Œä¸»ä»è‡‚ (Leader-Follower) æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ(ç­”: ä¸»ä»è‡‚æœ‰åŠ›åé¦ˆï¼Œç²¾åº¦é«˜ï¼Œä½†æˆæœ¬é«˜ä¸”ä¸ä»…é™äºå¼‚æ„æœºå™¨äººæ˜ å°„)
6.  **Co-training**: ä¸ºä»€ä¹ˆåœ¨è®­ç»ƒ VLA æ—¶è¦æ··åˆäº’è”ç½‘ VQA æ•°æ®ï¼Ÿ(ç­”: é˜²æ­¢ç¾éš¾æ€§é—å¿˜ï¼Œä¿æŒ VLM Backbone çš„é€šç”¨è¯­ä¹‰ç†è§£å’Œæ³›åŒ–èƒ½åŠ›)


---

\newpage

# é™„å½•B æ–‡çŒ®ç»¼è¿°


> **å¿«é€Ÿç´¢å¼•**: [è®ºæ–‡ç´¢å¼• (Paper Index)](./paper_index.md) - å¤šç»´åº¦æŸ¥æ‰¾ç³»ç»Ÿ
> **æœ€åæ›´æ–°**: 2025-12-06

æœ¬ç« èŠ‚å¯¹ VLA é¢†åŸŸçš„æ ¸å¿ƒæ–‡çŒ®è¿›è¡Œ**æ·±åº¦æŠ€æœ¯å½’çº³**ï¼ŒæŒ‰æŠ€æœ¯åˆ†ç±»ç»„ç»‡ï¼Œé€‚åˆé¢è¯•å‰å¿«é€Ÿå¤ä¹ æ¨¡å‹ç»†èŠ‚ã€‚

---

## ğŸ“‘ å¿«é€Ÿå¯¼èˆª

| åˆ†ç±»æ–¹å¼ | è·³è½¬é“¾æ¥ |
|:---|:---|
| ğŸ“Š [è®ºæ–‡ç´¢å¼•](./paper_index.md) | å¤šç»´åº¦ç´¢å¼•ï¼ˆæŠ€æœ¯/å…¬å¸/æ—¶é—´ï¼‰ |
| ğŸ¯ [æŒ‰æŠ€æœ¯åˆ†ç±»](#æŒ‰æŠ€æœ¯åˆ†ç±») | åŠ¨ä½œç”Ÿæˆ/è®­ç»ƒæ–¹æ³•/æ¶æ„/åº”ç”¨ |
| ğŸ¢ [æŒ‰å…¬å¸åˆ†ç±»](#æŒ‰å…¬å¸æœºæ„åˆ†ç±») | Google/Physical Intelligence/ByteDance ç­‰ |
| ğŸ“… [æŒ‰æ—¶é—´çº¿](#æŒ‰æ—¶é—´çº¿) | 2023/2024/2025 |
| ğŸ“Š [æ€»ç»“å¯¹æ¯”è¡¨](#æ€»ç»“å¯¹æ¯”è¡¨) | æ‰€æœ‰æ¨¡å‹å¿«é€Ÿå¯¹æ¯” |

---

## ğŸ¯ æŒ‰æŠ€æœ¯åˆ†ç±»

### 1. åŠ¨ä½œç”Ÿæˆç­–ç•¥ (Action Generation)

#### 1.1 Diffusion ç³»åˆ—

##### Diffusion Policy (Chi et al., RSS 2023)
> **è®ºæ–‡**: [Diffusion Policy: Visuomotor Policy Learning via Action Diffusion](https://arxiv.org/abs/2303.04137)
> **æœºæ„**: Columbia University

- **æ ¸å¿ƒé—®é¢˜**: è§£å†³ä¼ ç»Ÿ MSE å›å½’åœ¨å¤šæ¨¡æ€åˆ†å¸ƒ (Multimodal Distribution) ä¸‹çš„å¹³å‡å€¼é—®é¢˜ (å³"æ’å¢™"é—®é¢˜)ã€‚
- **æ ¸å¿ƒæŠ€æœ¯**: **DDPM (Denoising Diffusion Probabilistic Models)**ã€‚å°†åŠ¨ä½œç”Ÿæˆå»ºæ¨¡ä¸ºä»é«˜æ–¯å™ªå£°ä¸­é€æ­¥å»å™ªçš„è¿‡ç¨‹ã€‚
- **Backbone**:
    - **CNN-based**: 1D Temporal CNN (ç±»ä¼¼ U-Net)ï¼Œé€‚åˆçŸ­æ—¶åºã€‚
    - **Transformer-based**: DiT (Diffusion Transformer)ï¼Œé€‚åˆé•¿æ—¶åºã€‚
- **Action Space**: **è¿ç»­ç©ºé—´ (Continuous)**ã€‚æ— ç¦»æ•£åŒ–è¯¯å·®ï¼Œç²¾åº¦æé«˜ã€‚
- **Inference**: è¿­ä»£å»å™ªã€‚åŸå§‹ DDPM éœ€ 100 æ­¥ï¼Œä½¿ç”¨ **DDIM** å¯åŠ é€Ÿè‡³ 10-15 æ­¥ã€‚
- **Deep Dive**:
    - **EBM è§†è§’**: Diffusion å®é™…ä¸Šæ˜¯åœ¨å­¦ä¹ èƒ½é‡åœ°è²Œ (Energy Landscape)ï¼Œç›¸æ¯” MSE çš„å•å³°å¹³å‡ï¼Œå®ƒèƒ½æ•æ‰å¤šæ¨¡æ€åˆ†å¸ƒ (Multimodal Distribution)ã€‚
    - **Conditioning**: é€šè¿‡ **FiLM** å±‚å°†è¯­è¨€/å›¾åƒç‰¹å¾æ³¨å…¥ U-Netã€‚
- **Key Contribution**: é¦–æ¬¡å°†ç”Ÿæˆå¼ AI (Generative AI) å¼•å…¥æœºå™¨äººæ§åˆ¶ï¼Œå®Œç¾è§£å†³äº†å¤šè§£é—®é¢˜ï¼Œå¹¶åœ¨é«˜ç²¾åº¦ä»»åŠ¡ (å¦‚ç©¿é’ˆ) ä¸Šè¡¨ç°å“è¶Šã€‚

##### RDT-1B (Liu et al., 2024)
> **è®ºæ–‡**: [RDT-1B: a Diffusion Foundation Model for Bimanual Manipulation](https://arxiv.org/abs/2410.07864)
> **æœºæ„**: æ¸…åå¤§å­¦ MARS Lab & ByteDance
> **è¯¦ç»†è§£æ**: [rdt.md](./rdt.md)

- **æ ¸å¿ƒé—®é¢˜**: è¯æ˜æœºå™¨äººå­¦ä¹ ä¹Ÿå­˜åœ¨ Scaling Lawï¼Œå¤§æ¨¡å‹+å¤§æ•°æ®æœ‰æ•ˆã€‚
- **æ ¸å¿ƒæŠ€æœ¯**: **DiT (Diffusion Transformer)**ï¼Œåäº¿å‚æ•°çº§æ‰©æ•£æ¨¡å‹ã€‚
- **Backbone**: DiT æ¶æ„ï¼Œå¯æ‰©å±•åˆ°æ•°åäº¿å‚æ•°ã€‚
- **Action Space**: **è¿ç»­ç©ºé—´**ã€‚
- **Key Contribution**: é¦–ä¸ªåäº¿å‚æ•°çº§æœºå™¨äººæ‰©æ•£åŸºç¡€æ¨¡å‹ï¼Œä¸“ä¸ºåŒè‡‚æ“ä½œä¼˜åŒ–ï¼Œè¯æ˜ Scaling Law åœ¨æœºå™¨äººé¢†åŸŸä¹Ÿæˆç«‹ã€‚

---

#### 1.2 Flow Matching ç³»åˆ—

##### Ï€0 (Physical Intelligence, 2024)
> **è®ºæ–‡**: [Ï€0: A Generalist Robot Foundation Model](https://www.physicalintelligence.company/blog/pi0)
> **è¯¦ç»†è§£æ**: [pi0_flow_matching.md](./pi0_flow_matching.md) | [ä»£ç è§£æ](./pi0_code_analysis.md)

- **æ ¸å¿ƒé—®é¢˜**: è§£å†³ VLM æ¨ç†é€Ÿåº¦æ…¢ã€éš¾ä»¥è¿›è¡Œé«˜é¢‘ (50Hz) è¿ç»­æ§åˆ¶çš„é—®é¢˜ã€‚
- **æ ¸å¿ƒæŠ€æœ¯**: **Flow Matching (æµåŒ¹é…)**ã€‚
- **Backbone**: **PaliGemma 3B** (Google çš„è½»é‡çº§ VLM)ã€‚
- **Action Space**: **è¿ç»­ç©ºé—´ (Continuous)**ã€‚
    - ä¸åŒäº RT-2/OpenVLA çš„ç¦»æ•£ Tokenï¼ŒPi0 è¾“å‡ºè¿ç»­åŠ¨ä½œï¼Œé¿å…äº†é‡åŒ–è¯¯å·®ã€‚
- **Inference**: ä½¿ç”¨ ODE Solver (å¸¸å¾®åˆ†æ–¹ç¨‹æ±‚è§£å™¨)ã€‚ç›¸æ¯” Diffusion çš„éšæœºæ¸¸èµ°ï¼ŒFlow Matching èµ°ç›´çº¿ï¼Œ**1-10 æ­¥**å³å¯ç”Ÿæˆé«˜è´¨é‡åŠ¨ä½œã€‚
- **Deep Dive**:
    - **OT-CFM**: åŸºäº Optimal Transport æ„é€ ç›´çº¿è·¯å¾„ (Wasserstein Geodesic)ã€‚
    - **ODE Solver**: è®­ç»ƒæ—¶å­¦ä¹ å‘é‡åœºï¼Œæ¨ç†æ—¶ä½¿ç”¨ **Euler** (æé€Ÿ) æˆ– **Heun** (é«˜ç²¾) æ±‚è§£ã€‚
- **Key Contribution**: ç»“åˆäº† VLM çš„è¯­ä¹‰ç†è§£å’Œ Flow Matching çš„é«˜é¢‘ç²¾ç»†æ§åˆ¶ï¼Œå®ç°äº†"å¤§è„‘"ä¸"å°è„‘"çš„ç»Ÿä¸€ã€‚

##### Ï€0.5 (Physical Intelligence, 2025)
> **æ ¸å¿ƒå®šä½**: **Open-World Explorer (å¼€æ”¾ä¸–ç•Œæ¢é™©å®¶)**
> **è¯¦ç»†è§£æ**: [pi0_5_dissection.md](./pi0_5_dissection.md)

- **æ ¸å¿ƒé—®é¢˜**: è§£å†³æœºå™¨äººæ— æ³•åœ¨ä»æœªè§è¿‡çš„ç¯å¢ƒ (Open World) ä¸­æ³›åŒ–çš„é—®é¢˜ã€‚
- **æ ¸å¿ƒæŠ€æœ¯**: **Unified Model with Hierarchical Inference**ã€‚
- **æ¶æ„åˆ›æ–°**:
    - **Latent Thought**: æ¨¡å‹å†…éƒ¨ç”Ÿæˆéšå¼çš„é«˜å±‚è¯­ä¹‰å­ä»»åŠ¡ (Semantic Subtask)ï¼Œå†è§£ç ä¸ºåº•å±‚åŠ¨ä½œã€‚
    - **Hybrid Architecture**: è®­ç»ƒæ—¶ä½¿ç”¨ **FAST Tokenizer** (ç¦»æ•£) åŠ é€Ÿï¼Œæ¨ç†æ—¶ä½¿ç”¨ **Flow Matching** (è¿ç»­) å¾®è°ƒã€‚
- **Data Strategy**: **Co-training**ã€‚æ··åˆ Robot Data (é«˜è´¨é‡) + Internet Videos (ä¸–ç•Œæ¨¡å‹) + Simulation Data (é•¿åºåˆ—é€»è¾‘)ã€‚
- **Key Contribution**: å®ç°äº†è·¨å½¢æ€ (Cross-Embodiment) çš„ Zero-shot è¿ç§»ï¼Œå¹¶æ˜¾è‘—æå‡äº†é•¿åºåˆ—ä»»åŠ¡çš„æˆåŠŸç‡ã€‚

##### Ï€0.6 (Physical Intelligence, 2025)
> **æ ¸å¿ƒå®šä½**: **Self-Improving Master (è‡ªæˆ‘è¿›åŒ–å¤§å¸ˆ)**
> **è¯¦ç»†è§£æ**: [pi0_6_dissection.md](./pi0_6_dissection.md)

- **æ ¸å¿ƒé—®é¢˜**: å¦‚ä½•è¶…è¶Šäººç±»ç¤ºæ•™çš„ä¸Šé™ï¼Œå®ç°æè‡´çš„ç†Ÿç»ƒåº¦ (Proficiency)ã€‚
- **æ ¸å¿ƒæŠ€æœ¯**: **Recap Algorithm (Offline RL)**ã€‚
- **æ¶æ„å‡çº§**:
    - **5B Backbone**: æ›´å¼ºçš„è¯­ä¹‰ç†è§£ã€‚
    - **Action Expert**: ç‹¬ç«‹çš„é«˜é¢‘åŠ¨ä½œç”Ÿæˆæ¨¡å— (å°è„‘)ï¼Œä¸“é—¨è´Ÿè´£ç²¾ç»†æ“ä½œã€‚
- **Recap æœºåˆ¶**:
    - å­¦ä¹ å¤±è´¥è½¨è¿¹ (Failure Cases)ï¼Œé€šè¿‡ Offline RL æŠ‘åˆ¶é”™è¯¯åŠ¨ä½œï¼Œå¥–åŠ±æˆåŠŸåŠ¨ä½œã€‚
    - å®ç°äº† **Data-Driven Self-Improvement**ã€‚
- **Key Contribution**: è¯æ˜äº†æœºå™¨äººå¯ä»¥é€šè¿‡è‡ªæˆ‘å¤ç›˜ (Recap) åœ¨æ“ä½œé€Ÿåº¦å’Œé²æ£’æ€§ä¸Šè¶…è¶Šäººç±»ä¸“å®¶ã€‚

---

#### 1.3 Tokenization ç³»åˆ—

##### RT-2 (Google DeepMind, 2023)
> **è®ºæ–‡**: [RT-2: Vision-Language-Action Models Transfer Web Knowledge to Robotic Control](https://arxiv.org/abs/2307.15818)

- **æ ¸å¿ƒé—®é¢˜**: å¦‚ä½•è®©æœºå™¨äººæ‹¥æœ‰äº’è”ç½‘çº§åˆ«çš„è¯­ä¹‰ç†è§£èƒ½åŠ› (æ³›åŒ–åˆ°æœªè§è¿‡çš„ç‰©ä½“/æŒ‡ä»¤)ã€‚
- **æ ¸å¿ƒæŠ€æœ¯**: **VLA (Vision-Language-Action)** = VLM + Action Tokensã€‚
- **Backbone**: **PaLI-X (55B)** æˆ– **PaLM-E (12B)**ã€‚
- **Action Tokenization**:
    - **Uniform Discretization**: å°†åŠ¨ä½œç»´åº¦å½’ä¸€åŒ–å¹¶åˆ‡åˆ†ä¸º **256 ä¸ª Bins**ã€‚
    - **Text Mapping**: å°†è¿™äº› Bins æ˜ å°„ä¸ºç‰¹æ®Šçš„æ–‡æœ¬ Token (å¦‚ "1", "128")ï¼Œä¸è‡ªç„¶è¯­è¨€å…±äº«è¯è¡¨ã€‚
- **Training**: **Co-fine-tuning** (æ··åˆå¾®è°ƒ)ã€‚åŒæ—¶è®­ç»ƒäº’è”ç½‘ VQA æ•°æ® (ä¿æŒè¯­ä¹‰) å’Œæœºå™¨äººæ“ä½œæ•°æ® (å­¦ä¹ æ§åˆ¶)ã€‚
- **Key Contribution**: æ¶Œç°å‡º **Semantic Reasoning** (è¯­ä¹‰æ¨ç†) èƒ½åŠ›ã€‚ä¾‹å¦‚å¬åˆ° "pick up the extinct animal" èƒ½æŠ“èµ·æé¾™ç©å…·ï¼Œå°½ç®¡è®­ç»ƒæ•°æ®é‡Œåªæœ‰ "pick up dinosaur"ã€‚

##### OpenVLA (Stanford, 2024)
> **è®ºæ–‡**: [OpenVLA: An Open-Source Vision-Language-Action Model](https://arxiv.org/abs/2406.09246)

- **æ ¸å¿ƒé—®é¢˜**: å¤ç° RT-2 çš„èƒ½åŠ›ï¼Œä½†å®Œå…¨å¼€æºä¸”é«˜æ•ˆã€‚
- **æ ¸å¿ƒæŠ€æœ¯**: **Parameter-Efficient Fine-Tuning (LoRA)**ã€‚
- **Backbone**:
    - **Language**: **Llama 2 7B**ã€‚
    - **Vision**: **SigLIP** (æ¯” CLIP æ›´å¼ºçš„è§†è§‰ç¼–ç å™¨)ã€‚
    - **Projector**: 2-layer MLP (å°†è§†è§‰ Embedding æ˜ å°„åˆ°è¯­è¨€ç©ºé—´)ã€‚
- **Action Output**:
    - ä¸åŒäº RT-2 ç›´æ¥è¾“å‡ºæ–‡æœ¬ï¼ŒOpenVLA ä½¿ç”¨ä¸“é—¨çš„ **Action Head** (Linear Layer) é¢„æµ‹å»ç¦»æ•£åŒ–çš„åŠ¨ä½œ Tokenã€‚
    - ä¾ç„¶æ˜¯ **256-bin Discretization**ã€‚
- **Optimization**: æ”¯æŒ **4-bit Quantization (QLoRA)**ï¼Œä½¿å¾— 7B æ¨¡å‹å¯ä»¥åœ¨æ¶ˆè´¹çº§æ˜¾å¡ (å¦‚ RTX 3090/4090) ä¸Šè¿è¡Œã€‚
- **Key Contribution**: æä¾›äº†ç¬¬ä¸€ä¸ªæ€§èƒ½æ¥è¿‘é—­æº SOTA çš„å¼€æº VLA æ¨¡å‹ï¼Œå¹¶æ„å»ºäº†å®Œæ•´çš„å¼€æºè®­ç»ƒ/éƒ¨ç½²ç”Ÿæ€ã€‚

##### FAST (Physical Intelligence, 2025)
> **è®ºæ–‡**: [FAST: Efficient Action Tokenization for VLA Models (arXiv:2501.09747)](https://arxiv.org/abs/2501.09747)
> **è¯¦ç»†è§£æ**: [fast.md](./fast.md)

- **æ ¸å¿ƒé—®é¢˜**: ä¼ ç»ŸåŠ¨ä½œ token åŒ–æ–¹æ³•ï¼ˆç®€å•åˆ†æ¡¶ï¼‰æ— æ³•å¤„ç†é«˜é¢‘ã€çµå·§çš„æœºå™¨äººæ“ä½œã€‚
- **æ ¸å¿ƒæŠ€æœ¯**: **Frequency-space Action Sequence Tokenization (DCT + BPE)**ã€‚
- **å·¥ä½œåŸç†**:
    - **DCT (ç¦»æ•£ä½™å¼¦å˜æ¢)**: å°†æ—¶åŸŸåŠ¨ä½œåºåˆ—è½¬æ¢åˆ°é¢‘åŸŸï¼Œåªä¿ç•™ä½é¢‘ç³»æ•°ï¼ˆå‹ç¼©æ¯” 2.5:1ï¼‰ã€‚
    - **BPE (å­—èŠ‚å¯¹ç¼–ç )**: ç±»ä¼¼ GPTï¼Œå°†å¸¸è§ DCT ç³»æ•°ç»„åˆåˆå¹¶ä¸ºå•ä¸ª tokenï¼ˆå‹ç¼©æ¯” 2.3:1ï¼‰ã€‚
- **æ•ˆæœ**: ä¸€ä¸ª 10 æ­¥åŠ¨ä½œåºåˆ—ä» 70 ä¸ª token å‹ç¼©ä¸º **2-3 ä¸ª token**ã€‚
- **FAST+**: åœ¨ 100 ä¸‡+çœŸå®æœºå™¨äººæ•°æ®ä¸Šé¢„è®­ç»ƒçš„é€šç”¨ tokenizerï¼Œè·¨å¹³å°æ³›åŒ–ã€‚
- **Key Contribution**: ä½¿ OpenVLA è®­ç»ƒé€Ÿåº¦æå‡ **5 å€**ï¼ŒåŒæ—¶ä¿æŒé«˜é¢‘åŠ¨ä½œç²¾åº¦ã€‚

---

#### 1.4 å…¶ä»–åŠ¨ä½œç”Ÿæˆæ–¹æ³•

##### ACT (Zeng et al., 2023)
> **è®ºæ–‡**: [ACT: Learning Fine-Grained Bimanual Manipulation with Low-Cost Hardware](https://arxiv.org/abs/2304.13705)
> **è¯¦ç»†è§£æ**: [act.md](./act.md)

- **æ ¸å¿ƒé—®é¢˜**: å¦‚ä½•ç”¨ä½æˆæœ¬ç¡¬ä»¶å®ç°ç²¾ç»†åŒè‡‚æ“ä½œã€‚
- **æ ¸å¿ƒæŠ€æœ¯**: **CVAE (Conditional Variational Autoencoder)** + **Action Chunking**ã€‚
- **Backbone**: CNN-based encoder-decoderã€‚
- **Action Space**: **è¿ç»­ç©ºé—´**ã€‚
- **Key Contribution**: ALOHA ç³»ç»Ÿçš„æ ¸å¿ƒç®—æ³•ï¼Œè¯æ˜äº† CVAE + åŠ¨ä½œåˆ†å—çš„æœ‰æ•ˆæ€§ã€‚

---

#### 1.5 Latent Action ç³»åˆ— (æ½œåœ¨åŠ¨ä½œå­¦ä¹ ) ğŸ†•

> **æ ¸å¿ƒæ€æƒ³**: ä»è§†é¢‘ä¸­å­¦ä¹ "ä»»åŠ¡ä¸­å¿ƒ"çš„æ½œåœ¨åŠ¨ä½œè¡¨ç¤ºï¼Œå®ç°è·¨æœºå™¨äººæ³›åŒ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ä¼ ç»Ÿ VLA vs Latent Action VLA                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   ä¼ ç»Ÿ VLA:                                                      â”‚
â”‚   Image + Language â”€â”€â†’ Specific Robot Action (7-DoF)            â”‚
â”‚                        â””â”€â”€ ç»‘å®šç‰¹å®šæœºå™¨äºº                        â”‚
â”‚                                                                 â”‚
â”‚   Latent Action VLA:                                            â”‚
â”‚   Video â”€â”€â†’ Latent Action â”€â”€â†’ Decoder â”€â”€â†’ Any Robot Action      â”‚
â”‚             (ä»»åŠ¡ä¸­å¿ƒè¡¨ç¤º)      (å¯æ’æ‹”)    (ä¸åŒæœºå™¨äºº)          â”‚
â”‚             â””â”€â”€ æœºå™¨äººæ— å…³ â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                                                                 â”‚
â”‚   ä¼˜åŠ¿:                                                         â”‚
â”‚   â€¢ å¯åˆ©ç”¨æµ·é‡äº’è”ç½‘è§†é¢‘                                         â”‚
â”‚   â€¢ æ½œåœ¨åŠ¨ä½œç©ºé—´æ›´æ˜“æ³›åŒ–                                         â”‚
â”‚   â€¢ æ¢æœºå™¨äººåªéœ€æ¢ Decoder                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

##### UniVLA (IJRR 2024)
> **è®ºæ–‡**: [UniVLA: Learning to Act Anywhere with Task-centric Latent Actions](https://journals.sagepub.com/doi/full/10.1177/02783649241227559)
> **arXiv**: [2505.06111](https://arxiv.org/abs/2505.06111)

- **æ ¸å¿ƒé—®é¢˜**: å¦‚ä½•åˆ©ç”¨è§†é¢‘æ•°æ®è®­ç»ƒè·¨æœºå™¨äººæ³›åŒ–çš„ VLA ç­–ç•¥ã€‚
- **æ ¸å¿ƒæŠ€æœ¯**: **Task-centric Latent Actions (ä»»åŠ¡ä¸­å¿ƒæ½œåœ¨åŠ¨ä½œ)**ã€‚
- **æ¶æ„è®¾è®¡**:
    - **Video Encoder**: ä»è§†é¢‘åºåˆ—æå–è§†è§‰ç‰¹å¾
    - **Latent Action Model**: å­¦ä¹ ä¸æœºå™¨äººæ— å…³çš„"ä»»åŠ¡æ„å›¾"è¡¨ç¤º
    - **Robot-specific Decoder**: å°†æ½œåœ¨åŠ¨ä½œè§£ç ä¸ºå…·ä½“æœºå™¨äººåŠ¨ä½œ
- **è®­ç»ƒæ•°æ®**: äº’è”ç½‘è§†é¢‘ + æœºå™¨äººæ¼”ç¤ºæ•°æ®
- **Key Contribution**: 
    - é¦–æ¬¡åœ¨ IJRR é¡¶åˆŠå‘è¡¨çš„æ½œåœ¨åŠ¨ä½œ VLA æ¡†æ¶
    - åœ¨æ“ä½œå’Œå¯¼èˆªä»»åŠ¡ä¸Šå®ç° SOTA
    - æœ‰æ•ˆçš„ Sim-to-Real è¿ç§»

##### EvoVLA (2025)
> **è®ºæ–‡**: [EvoVLA: Self-Evolving Vision-Language-Action Model](https://arxiv.org/abs/2511.16166)

- **æ ¸å¿ƒé—®é¢˜**: è§£å†³é•¿æ—¶ç¨‹ä»»åŠ¡ä¸­çš„"é˜¶æ®µå¹»è§‰"é—®é¢˜ï¼ˆæ¨¡å‹æŠ¥å‘Šè¿›åº¦ > å®é™…è¿›åº¦ï¼‰ã€‚
- **æ ¸å¿ƒæŠ€æœ¯**: **è‡ªè¿›åŒ–æ¡†æ¶ (Self-Evolving Framework)**ã€‚
- **ä¸‰å¤§åˆ›æ–°**:
    - **SAR (Stage-Aligned Reward)**: é˜¶æ®µå¯¹é½å¥–åŠ±ï¼Œä¸‰å…ƒå¯¹æ¯”å­¦ä¹ 
    - **POE (Pose-Based Object Exploration)**: åŸºäºå§¿æ€çš„æ¢ç´¢ï¼ˆéåŸå§‹åƒç´ ï¼‰
    - **Long-Horizon Memory**: é€‰æ‹©æ€§ä¸Šä¸‹æ–‡ä¿ç•™ + é—¨æ§èåˆ
- **æ€§èƒ½**: Discoverse-L åŸºå‡†ä¸Šå¹³å‡æˆåŠŸç‡ **69.2%** (+10.2%)ï¼ŒçœŸæœº **54.6%** (+11%)
- **Key Contribution**: è§£å†³é•¿æ—¶ç¨‹æ“ä½œä¸­çš„é˜¶æ®µå¹»è§‰ï¼Œè‡ªç›‘ç£æŒç»­è¿›åŒ–

##### MemoryVLA (2025)
> **è®ºæ–‡**: [MemoryVLA: Memory-Augmented VLA for Long-Horizon Manipulation](https://arxiv.org/abs/2508.19236)

- **æ ¸å¿ƒé—®é¢˜**: é•¿æ—¶ç¨‹ä»»åŠ¡ä¸­çš„éé©¬å°”å¯å¤«æ€§é—®é¢˜ã€‚
- **æ ¸å¿ƒæŠ€æœ¯**: **æ„ŸçŸ¥-è®¤çŸ¥è®°å¿†ç³»ç»Ÿ (Perception-Cognition Memory)**ã€‚
- **æ¶æ„è®¾è®¡**:
    - **å·¥ä½œè®°å¿†**: çŸ­æœŸä»»åŠ¡ä¸Šä¸‹æ–‡
    - **æ„ŸçŸ¥è®°å¿†**: å†å²è§†è§‰è§‚æµ‹
    - **è®¤çŸ¥è®°å¿†**: é«˜å±‚ä»»åŠ¡è¯­ä¹‰
- **Key Contribution**: é€šè¿‡æ˜¾å¼è®°å¿†æœºåˆ¶å¤„ç†é•¿åºåˆ—ä¾èµ–

##### å…¶ä»– 2025 ç›¸å…³å·¥ä½œ

| æ¨¡å‹ | æ ¸å¿ƒåˆ›æ–° | è®ºæ–‡é“¾æ¥ |
|:---|:---|:---|
| **TTF-VLA** | Temporal Token Fusionï¼Œè®­ç»ƒæ— å…³çš„å¤šå¸§èåˆ | [arXiv:2508.19257](https://arxiv.org/abs/2508.19257) |
| **OmniVLA** | å¤šä¼ æ„Ÿå™¨æ„ŸçŸ¥ï¼ˆçº¢å¤–/é›·è¾¾/éº¦å…‹é£ï¼‰ | [arXiv:2511.01210](https://arxiv.org/abs/2511.01210) |
| **MergeVLA** | è·¨æŠ€èƒ½æ¨¡å‹åˆå¹¶ï¼ŒçŸ¥è¯†è¿ç§» | [arXiv:2511.18810](https://arxiv.org/abs/2511.18810) |
| **ContextVLA** | å¤šå¸§ä¸Šä¸‹æ–‡å‹ç¼© | 2025 |
| **ReconVLA** | éšå¼è§†è§‰æ³¨æ„åŠ›å¼•å¯¼ | [arXiv:2508.10333](https://arxiv.org/abs/2508.10333) |

---

### 2. è®­ç»ƒæ–¹æ³• (Training Methods)

#### 2.1 BC (Behavior Cloning)

##### RT-2 - Co-fine-tuning
- åŒæ—¶è®­ç»ƒäº’è”ç½‘ VQA æ•°æ®å’Œæœºå™¨äººæ“ä½œæ•°æ®
- ä¿æŒ VLM çš„è¯­ä¹‰èƒ½åŠ›ï¼ŒåŒæ—¶å­¦ä¹ æ§åˆ¶

##### OpenVLA - LoRA Fine-tuning
- å‚æ•°é«˜æ•ˆå¾®è°ƒï¼Œé™ä½è®¡ç®—æˆæœ¬
- æ”¯æŒ 4-bit é‡åŒ–éƒ¨ç½²

##### Ï€0 - Flow Matching Training
- ç«¯åˆ°ç«¯è®­ç»ƒï¼Œå­¦ä¹ è¿ç»­åŠ¨ä½œåˆ†å¸ƒ
- ç»“åˆ VLM é¢„è®­ç»ƒå’Œ Flow Matching

---

#### 2.2 RL (Reinforcement Learning)

##### GR-RL (ByteDance Seed, 2025)
> **è¯¦ç»†è§£æ**: [gr_rl_dissection.md](./gr_rl_dissection.md)

- **æ ¸å¿ƒæŠ€æœ¯**: **Offline RL + Online RL** ä¸‰é˜¶æ®µè®­ç»ƒ
- **é˜¶æ®µ 1**: Critic ç­›é€‰é«˜è´¨é‡æ¼”ç¤ºæ•°æ®
- **é˜¶æ®µ 2**: å½¢æ€å¯¹ç§°æ€§å¢å¼ºï¼ˆæ•°æ®ç¿»å€ï¼‰
- **é˜¶æ®µ 3**: åœ¨çº¿ RL æ½œåœ¨ç©ºé—´æ¢ç´¢ï¼ˆå¯¹é½è®­ç»ƒ-éƒ¨ç½²å·®å¼‚ï¼‰
- **Key Contribution**: é¦–ä¸ªå®ŒæˆçœŸæœºç©¿é‹å¸¦ä»»åŠ¡çš„ VLAï¼Œ78% æˆåŠŸç‡

##### Ï€*0.6 Recap (Physical Intelligence, 2025)
> **è¯¦ç»†è§£æ**: [pi0_6_dissection.md](./pi0_6_dissection.md#recap)

- **æ ¸å¿ƒæŠ€æœ¯**: **Recap Algorithm (Offline RL)**
- **æœºåˆ¶**: ä»æˆåŠŸå’Œå¤±è´¥è½¨è¿¹ä¸­å­¦ä¹ ï¼ŒæŠ‘åˆ¶é”™è¯¯åŠ¨ä½œï¼Œå¥–åŠ±æˆåŠŸåŠ¨ä½œ
- **Key Contribution**: è¶…è¶Šäººç±»ç¤ºæ•™æ°´å¹³ï¼Œå®ç°è‡ªæˆ‘è¿›åŒ–

---

#### 2.3 æ··åˆè®­ç»ƒæ–¹æ³•

##### Ï€0.5 - Co-training
- **æ•°æ®æ··åˆ**: Robot Data (é«˜è´¨é‡) + Internet Videos (ä¸–ç•Œæ¨¡å‹) + Simulation Data (é•¿åºåˆ—é€»è¾‘)
- **æ•ˆæœ**: æå‡è·¨å½¢æ€æ³›åŒ–å’Œé•¿åºåˆ—ä»»åŠ¡æˆåŠŸç‡

---

### 3. æ¶æ„åˆ›æ–° (Architecture Innovations)

#### 3.1 å•æ¨¡å‹æ¶æ„

##### RT-2 / OpenVLA / Ï€0
- VLM Backbone + Action Head
- ç»Ÿä¸€æ¶æ„ï¼Œç«¯åˆ°ç«¯è®­ç»ƒ

---

#### 3.2 åŒç³»ç»Ÿæ¶æ„

##### Galaxea G0 (æ˜Ÿæµ·å›¾æ™ºèƒ½, 2024)
> **è®ºæ–‡**: [Galaxea Open-World Dataset and G0 Dual-System VLA Model (arXiv:2509.00576)](https://arxiv.org/abs/2509.00576)
> **è¯¦ç»†è§£æ**: [galaxea_g0.md](./galaxea_g0.md)

- **æ ¸å¿ƒé—®é¢˜**: å•ä¸€ VLA æ¨¡å‹éš¾ä»¥åŒæ—¶å¤„ç†é•¿æ—¶åŸŸä»»åŠ¡çš„é«˜å±‚è§„åˆ’å’Œä½å±‚æ§åˆ¶ã€‚
- **æ ¸å¿ƒæŠ€æœ¯**: **Dual-System Architecture (åŒç³»ç»Ÿæ¶æ„)**ã€‚
- **æ¶æ„è®¾è®¡**:
    - **G0-VLM**: è´Ÿè´£å¤šæ¨¡æ€è§„åˆ’å’Œé«˜å±‚æ¨ç†ï¼ˆå¤§è„‘ï¼‰ã€‚
    - **G0-VLA**: è´Ÿè´£ç»†ç²’åº¦æ‰§è¡Œå’Œä½å±‚æ§åˆ¶ï¼ˆå°è„‘ï¼‰ã€‚
- **è®­ç»ƒç­–ç•¥**: **ä¸‰é˜¶æ®µè¯¾ç¨‹å­¦ä¹ **
    1. è·¨å…·èº«é¢„è®­ç»ƒï¼ˆå­¦ä¹ é€šç”¨ä¸–ç•ŒçŸ¥è¯†ï¼‰
    2. å•å…·èº«é¢„è®­ç»ƒï¼ˆé€‚é…ç‰¹å®šæœºå™¨äººï¼‰â† æ ¸å¿ƒé˜¶æ®µ
    3. ä»»åŠ¡åè®­ç»ƒï¼ˆç²¾è°ƒå¤æ‚æŠ€èƒ½ï¼‰
- **Galaxea Open-World Dataset**: 500+ å°æ—¶ï¼Œ50 ä¸ªçœŸå®åœºæ™¯ï¼Œç»Ÿä¸€å…·èº«ï¼ˆR1 Liteï¼‰ï¼Œç²¾ç¡®å­ä»»åŠ¡æ ‡æ³¨ã€‚
- **Key Contribution**: åœ¨é•¿æ—¶åŸŸç§»åŠ¨æ“ä½œä»»åŠ¡ä¸Šè¡¨ç°çªå‡ºï¼Œæ³›åŒ–èƒ½åŠ›å¼ºï¼Œå¯è§£é‡Šæ€§é«˜ï¼ˆå­ä»»åŠ¡å¯è§ï¼‰ã€‚

##### Ï€0.6 - VLM + Action Expert
- **VLM (å¤§è„‘)**: 5B å‚æ•°ï¼Œè´Ÿè´£è¯­ä¹‰ç†è§£
- **Action Expert (å°è„‘)**: è½»é‡çº§ Transformerï¼Œè´Ÿè´£é«˜é¢‘ç²¾ç»†æ§åˆ¶
- **è¯¦ç»†è§£æ**: [pi0_6_dissection.md](./pi0_6_dissection.md#action-expert)

---

#### 3.3 å±‚çº§æ¶æ„

##### WALL-OSS (XÂ², 2025)
> **è¯¦ç»†è§£æ**: [wall_oss.md](./wall_oss.md)

- **æ ¸å¿ƒæŠ€æœ¯**: **Uni-CoT (ç»Ÿä¸€æ€ç»´é“¾)** + **Dual Heads (Flow + FAST)**
- **æ¶æ„**: ç»Ÿä¸€æ¨¡å‹å†…éƒ¨ç”Ÿæˆ CoTï¼ŒåŒå¤´è¾“å‡ºè¿ç»­å’Œç¦»æ•£åŠ¨ä½œ
- **Key Contribution**: è¾¹æƒ³è¾¹åŠ¨ï¼Œé•¿åºåˆ—æ¨ç†èƒ½åŠ›å¼º

---

### 4. åº”ç”¨åœºæ™¯ (Application Domains)

#### 4.1 æ“ä½œä»»åŠ¡ (Manipulation)
- RT-2, OpenVLA, Ï€0, GR-RL, ACT

#### 4.2 å¯¼èˆªä»»åŠ¡ (Navigation)
- (å¾…è¡¥å……)

#### 4.3 çµå·§æ‰‹ (Dexterous Manipulation)
- GR-RL (ç©¿é‹å¸¦), RDT-1B (åŒè‡‚æ“ä½œ)

---

## ğŸ¢ æŒ‰å…¬å¸/æœºæ„åˆ†ç±»

### Google DeepMind
- **RT-2** (2023)
- **RT-1** (2022)

### Physical Intelligence
- **Ï€0** (2024)
- **Ï€0.5** (2025)
- **Ï€0.6** (2025)
- **FAST** (2025)
- **Knowledge Insulation** (2024)

### ByteDance Seed
- **GR-RL** (2025)
- **RDT-1B** (2024) (ä¸æ¸…ååˆä½œ)

### Stanford
- **OpenVLA** (2024)
- **ACT** (2023)

### XÂ² (è‡ªå˜é‡)
- **WALL-OSS** (2025)

### Galaxea AI
- **G0** (2024)

---

## ğŸ“… æŒ‰æ—¶é—´çº¿

### 2023ï¼ˆæ—©æœŸæ¢ç´¢ï¼‰

#### Diffusion Policy (RSS 2023)
- é¦–æ¬¡å°†ç”Ÿæˆå¼ AI å¼•å…¥æœºå™¨äººæ§åˆ¶
- [è¯¦ç»†å†…å®¹](#diffusion-policy-chi-et-al-rss-2023---açº§)

#### RT-2 (ICRA 2023)
- VLA èŒƒå¼ç¡®ç«‹
- [è¯¦ç»†å†…å®¹](#rt-2-google-deepmind-2023---sçº§)

#### ACT (2023)
- CVAE + åŠ¨ä½œåˆ†å—
- [è¯¦ç»†å†…å®¹](#act-zeng-et-al-2023---açº§)

---

### 2024ï¼ˆçˆ†å‘æœŸï¼‰

#### OpenVLA (2024.06)
- é¦–ä¸ªå¼€æº SOTA VLA
- [è¯¦ç»†å†…å®¹](#openvla-stanford-2024---sçº§)

#### Ï€0 (2024.10)
- Flow Matching + VLM
- [æ·±åº¦è§£æ](./pi0_flow_matching.md)

#### RDT-1B (2024.10)
- åäº¿å‚æ•°æ‰©æ•£æ¨¡å‹
- [è¯¦ç»†è§£æ](./rdt.md)

#### Galaxea G0 (2024.09)
- åŒç³»ç»Ÿæ¶æ„
- [è¯¦ç»†è§£æ](./galaxea_g0.md)

#### Knowledge Insulation (2024)
- æ¢¯åº¦éš”ç¦»é˜²é—å¿˜
- [è¯¦ç»†å†…å®¹](#knowledge-insulation-physical-intelligence-2024---bçº§)

---

### 2025ï¼ˆæœ€æ–°è¿›å±•ï¼‰

#### Ï€0.5 (2025.01)
- å¼€æ”¾ä¸–ç•Œæ³›åŒ–
- [æ·±åº¦è§£æ](./pi0_5_dissection.md)

#### Ï€0.6 (2025.11)
- è‡ªæˆ‘è¿›åŒ– (Recap)
- [æ·±åº¦è§£æ](./pi0_6_dissection.md)

#### FAST (2025.01)
- DCT + BPE Tokenization
- [è¯¦ç»†è§£æ](./fast.md)

#### GR-RL (2025)
- ä¸‰é˜¶æ®µ RL è®­ç»ƒ
- [æ·±åº¦è§£æ](./gr_rl_dissection.md)

#### WALL-OSS (2025)
- Uni-CoT + åŒå¤´æ¶æ„
- [è¯¦ç»†è§£æ](./wall_oss.md)

---

## ğŸ”§ è®­ç»ƒæŠ€æœ¯ (Training Techniques)

### Knowledge Insulation (Physical Intelligence, 2024)
> **æŠ€æœ¯**: Pi0 çš„æ¢¯åº¦éš”ç¦»è®­ç»ƒæ–¹æ³•

- **æ ¸å¿ƒé—®é¢˜**: VLA å¾®è°ƒæ—¶ï¼Œæ–°å¢çš„è¿ç»­åŠ¨ä½œä¸“å®¶ä¼šç ´å VLM çš„é¢„è®­ç»ƒè¯­ä¹‰çŸ¥è¯†ï¼ˆç¾éš¾æ€§é—å¿˜ï¼‰ã€‚
- **æ ¸å¿ƒæŠ€æœ¯**: **Gradient Isolation (æ¢¯åº¦éš”ç¦»)**ã€‚
- **å·¥ä½œåŸç†**:
    - **VLM åˆ†æ”¯**: å­¦ä¹ ç¦»æ•£åŠ¨ä½œ tokenï¼ˆä¿æŒè¯­ä¹‰ç†è§£ï¼‰ã€‚
    - **åŠ¨ä½œä¸“å®¶åˆ†æ”¯**: å­¦ä¹ è¿ç»­åŠ¨ä½œï¼ˆä½¿ç”¨ `.detach()` é˜»æ­¢æ¢¯åº¦å›ä¼ åˆ° VLMï¼‰ã€‚
- **æ•ˆæœ**: VLM çš„è¯­ä¹‰çŸ¥è¯†è¢«"ç»ç¼˜"ä¿æŠ¤ï¼ŒåŒæ—¶åŠ¨ä½œä¸“å®¶ç‹¬ç«‹å­¦ä¹ è¿ç»­æ§åˆ¶ã€‚
- **Key Contribution**: é˜²æ­¢ç¾éš¾æ€§é—å¿˜ï¼ŒåŠ é€Ÿè®­ç»ƒï¼Œæå‡æ³›åŒ–èƒ½åŠ›ï¼Œä¸ºæŒç»­å­¦ä¹ æ‰“å¥½åŸºç¡€ã€‚

---

## ğŸ“Š æ€»ç»“å¯¹æ¯”è¡¨ (Summary Table)

| ç‰¹æ€§ | Diffusion Policy | RT-2 | OpenVLA | Ï€0 | Ï€0.6 | GR-RL | WALL-OSS | Galaxea G0 | FAST |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **æ ¸å¿ƒæœºåˆ¶** | Denoising | Token Prediction | Token + LoRA | Flow Matching | Flow + Recap | **MoT + RL** | **Uni-CoT + Dual Heads** | **Dual-System** | **DCT + BPE** |
| **åŠ¨ä½œç©ºé—´** | è¿ç»­ | ç¦»æ•£ (256) | ç¦»æ•£ (256) | è¿ç»­ | è¿ç»­ | è¿ç»­ | è¿ç»­ + ç¦»æ•£ | è¿ç»­ | **ç¦»æ•£ (å‹ç¼©)** |
| **Backbone** | CNN/ViT | PaLI-X (55B) | Llama 2 (7B) | PaliGemma (3B) | 5B VLM | **MoT (5B)** | VLM | **VLM + VLA** | **Tokenizer** |
| **æ¨ç†é€Ÿåº¦** | æ…¢ (100 æ­¥) | ææ…¢ | ä¸­ç­‰ | å¿« (1-10 æ­¥) | å¿« (1-10 æ­¥) | ä¸­ç­‰ | å¿«/ç²¾ | ç¨æ…¢ (ä¸¤é˜¶æ®µ) | **æå¿« (5x)** |
| **è¯­ä¹‰èƒ½åŠ›** | å¼± | æå¼º | å¼º | å¼º | å¼º | å¼º | **å¼º (CoT)** | **å¼º (åˆ†ç¦» VLM)** | N/A |
| **è®­ç»ƒæ–¹æ³•** | BC | Co-fine-tuning | LoRA | Flow Training | **BC + Recap** | **BC + RL** | BC | Co-training | Tokenizer |
| **é€‚ç”¨åœºæ™¯** | ç²¾ç»†æ“ä½œ | é«˜å±‚è§„åˆ’ | é€šç”¨æ“ä½œ | é€šç”¨æ§åˆ¶ | é€šç”¨+ç²¾ç»† | **é«˜ç²¾åº¦é•¿æ—¶ç¨‹** | é•¿åºåˆ—æ¨ç† | **é•¿æ—¶åŸŸç§»åŠ¨æ“ä½œ** | **é«˜é¢‘ Token åŒ–** |
| **æ ¸å¿ƒä¼˜åŠ¿** | å¤šæ¨¡æ€åˆ†å¸ƒ | è¯­ä¹‰æ¶Œç° | å¼€æºç”Ÿæ€ | é«˜æ•ˆæ¨ç† | **è‡ªæˆ‘è¿›åŒ–** | **ä¸‰é˜¶æ®µè®­ç»ƒ** | **ç»Ÿä¸€æ€ç»´é“¾** | **åˆ†å±‚è§£è€¦** | **å‹ç¼©æ•ˆç‡** |

---

## ğŸ“š ç›¸å…³èµ„æº

- [ğŸ“Š è®ºæ–‡ç´¢å¼•](./paper_index.md) - å¤šç»´åº¦å¿«é€ŸæŸ¥æ‰¾
- [ğŸ”¬ æ¨¡å‹æ·±åº¦è§£æ](./README.md#-part-5-æ¨¡å‹è¯¦è§£-model-zoo) - ç‹¬ç«‹æ·±åº¦è§£ææ–‡æ¡£
- [ğŸ“– ç†è®ºæ€»è§ˆ](./README.md) - è¿”å›ç†è®ºç›®å½•

---

**æœ€åæ›´æ–°**: 2025-12-06

\newpage

# é™„å½•C ASCII å›¾è¡¨é€ŸæŸ¥

## ASCII Diagram Cheat Sheet

é›†ä¸­æç‚¼ `theory/` ä¸­æ‰€æœ‰å…³é”®çš„ ASCII ç»“æ„å›¾ï¼Œä¾¿äºè®°å¿†æ ¸å¿ƒæ¶æ„ã€æµç¨‹ä¸å¯¹æ¯”ã€‚

### 1. Quantization Flow
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    é‡åŒ–æµç¨‹ (Quantization Flow)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   FP32 æƒé‡                    INT8/INT4 æƒé‡                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚   â”‚ 0.0234  â”‚                  â”‚   3     â”‚                      â”‚
â”‚   â”‚ 0.1567  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶    â”‚   20    â”‚                      â”‚
â”‚   â”‚-0.0891  â”‚    é‡åŒ– (Q)      â”‚  -11    â”‚                      â”‚
â”‚   â”‚ 0.2103  â”‚                  â”‚   27    â”‚                      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚       â–²                             â”‚                           â”‚
â”‚       â”‚                             â”‚                           â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚              åé‡åŒ– (DeQ)                                        â”‚
â”‚                                                                 â”‚
â”‚   å­˜å‚¨: 32-bit â”€â”€â”€â”€â”€â”€â”€â”€â–¶ 4-bit (8x å‹ç¼©)                        â”‚
â”‚   ç²¾åº¦: é«˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ ä½ (æœ‰æŸå¤±)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Symmetric vs Asymmetric Quantization
```
å¯¹ç§°é‡åŒ– (Symmetric)              éå¯¹ç§°é‡åŒ– (Asymmetric)
        Z = 0                           Z â‰  0

    -127 â—€â”€â”€â”€â”€â”€â”€â–¶ +127              0 â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ 255
      â”‚     0     â”‚                 â”‚      Z       â”‚
      â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤                 â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
      â”‚     â”‚     â”‚                 â”‚      â”‚       â”‚
   â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€           â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€
     min   0    max               min    0       max
      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                              â”‚
       æ•°æ®åˆ†å¸ƒå¯¹ç§°                    æ•°æ®åˆ†å¸ƒåç§»
     (é€‚åˆæƒé‡ weights)           (é€‚åˆæ¿€æ´»å€¼ activations)
```

### 3. LoRA Architecture
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LoRA æ¶æ„ç¤ºæ„å›¾                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚         è¾“å…¥ x                                                  â”‚
â”‚           â”‚                                                     â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”                                               â”‚
â”‚     â”‚           â”‚                                               â”‚
â”‚     â–¼           â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚  â”‚  Wâ‚€  â”‚   â”‚  A   â”‚  â† ä½ç§©çŸ©é˜µ (r << d)                       â”‚
â”‚  â”‚      â”‚   â”‚ rÃ—k  â”‚    å¯è®­ç»ƒ                                  â”‚
â”‚  â”‚ dÃ—k  â”‚   â””â”€â”€â”¬â”€â”€â”€â”˜                                            â”‚
â”‚  â”‚      â”‚      â”‚                                                â”‚
â”‚  â”‚ å†»ç»“ â”‚      â–¼                                                â”‚
â”‚  â””â”€â”€â”¬â”€â”€â”€â”˜   â”Œâ”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚     â”‚       â”‚  B   â”‚  â† ä½ç§©çŸ©é˜µ                                â”‚
â”‚     â”‚       â”‚ dÃ—r  â”‚    å¯è®­ç»ƒ                                  â”‚
â”‚     â”‚       â””â”€â”€â”¬â”€â”€â”€â”˜                                            â”‚
â”‚     â”‚          â”‚                                                â”‚
â”‚     â”‚    Î”W = BÂ·A                                               â”‚
â”‚     â”‚          â”‚                                                â”‚
â”‚     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                                â”‚
â”‚          â”‚  W = Wâ‚€ + Î±Â·BA                                       â”‚
â”‚          â–¼                                                      â”‚
â”‚        è¾“å‡º h                                                   â”‚
â”‚                                                                 â”‚
â”‚  å‚æ•°é‡: dÃ—k (å†»ç»“) + rÃ—(d+k) (è®­ç»ƒ) â‰ˆ 0.1% ~ 1%                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. Co-training Mix
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Co-training æ•°æ®æ··åˆç­–ç•¥                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚   æœºå™¨äººæ•°æ®      â”‚       â”‚   äº’è”ç½‘æ•°æ®      â”‚               â”‚
â”‚  â”‚   (Robot Data)   â”‚       â”‚   (Web Data)     â”‚               â”‚
â”‚  â”‚                  â”‚       â”‚                  â”‚               â”‚
â”‚  â”‚  ğŸ“· + ğŸ¯ + ğŸ¦¾    â”‚       â”‚  ğŸ“· + ğŸ“         â”‚               â”‚
â”‚  â”‚  å›¾åƒ æŒ‡ä»¤ åŠ¨ä½œ   â”‚       â”‚  å›¾åƒ æ–‡æœ¬        â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚           â”‚                          â”‚                          â”‚
â”‚           â”‚    æ··åˆæ¯”ä¾‹ 1:1          â”‚                          â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                      â–¼                                          â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚           â”‚      VLA æ¨¡å‹        â”‚                              â”‚
â”‚           â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”   â”‚                              â”‚
â”‚           â”‚   â”‚Actionâ”‚ Text â”‚   â”‚                              â”‚
â”‚           â”‚   â”‚ Head â”‚ Head â”‚   â”‚                              â”‚
â”‚           â”‚   â””â”€â”€â”¬â”€â”€â”€â”´â”€â”€â”¬â”€â”€â”€â”˜   â”‚                              â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                  â”‚      â”‚                                       â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â” â”Œâ”€â”´â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚           â”‚ Action  â”‚ â”‚  Text  â”‚                               â”‚
â”‚           â”‚  Loss   â”‚ â”‚  Loss  â”‚                               â”‚
â”‚           â”‚ (æœºå™¨äºº)â”‚ â”‚ (äº’è”ç½‘)â”‚                               â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                                                 â”‚
â”‚   æ•ˆæœ: ä¿æŒè¯­ä¹‰èƒ½åŠ› âœ“  å­¦ä¹ åŠ¨ä½œæ§åˆ¶ âœ“  é˜²æ­¢ç¾éš¾æ€§é—å¿˜ âœ“         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5. Action Generation Matrix
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ä¸‰ç§åŠ¨ä½œç”ŸæˆèŒƒå¼å¯¹æ¯” (Action Generation)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. ç¦»æ•£åŒ– Tokenization (RT-1, RT-2)                            â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚     â”‚ è¿ç»­åŠ¨ä½œ â”€â”€â–¶ ç¦»æ•£ Bins â”€â”€â–¶ Token é¢„æµ‹   â”‚                 â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚     âš¡ å¿«é€Ÿ (1æ­¥)  |  ğŸ“‰ ç²¾åº¦æŸå¤±  |  âœ… å¤šæ¨¡æ€                  â”‚
â”‚                                                                 â”‚
â”‚  2. æ‰©æ•£ç­–ç•¥ Diffusion (Octo)                                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚     â”‚ å™ªå£° â•â•â•â•â–¶ å»å™ª â•â•â•â•â–¶...â•â•â•â–¶ åŠ¨ä½œ â”‚                         â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚     ğŸ¢ æ…¢ (50-100æ­¥)  |  ğŸ¯ é«˜ç²¾åº¦  |  âœ… å¤šæ¨¡æ€                â”‚
â”‚                                                                 â”‚
â”‚  3. æµåŒ¹é… Flow Matching (Ï€0)                                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚     â”‚ å™ªå£° â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–¶ åŠ¨ä½œ â”‚                          â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚     âš¡ æå¿« (1-10æ­¥)  |  ğŸ¯ é«˜ç²¾åº¦  |  âœ… å¤šæ¨¡æ€                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6. Ï€0.5 Unified Flow
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ï€0.5 ç»Ÿä¸€æ¶æ„ (Unified Model)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   è¾“å…¥: ğŸ“· å›¾åƒ + ğŸ“ è¯­è¨€æŒ‡ä»¤                                    â”‚
â”‚              â”‚                                                  â”‚
â”‚              â–¼                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚   â”‚          VLM Backbone         â”‚                              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                     â–¼                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚   â”‚  Latent Thought     â”‚                      â”‚                 â”‚
â”‚   â”‚  (subtask planner)  â”‚                      â”‚                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚                 â”‚
â”‚             â–¼                                 â–¼                 â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚      â”‚ FAST Token  â”‚                     â”‚ Flow Match  â”‚           â”‚
â”‚      â”‚ (Pretrain)  â”‚                     â”‚  (Inference)â”‚           â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                â”‚                                 â”‚              â”‚
â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                               â–¼                                 â”‚
â”‚                      ğŸ¦¾ è¿ç»­åŠ¨ä½œè¾“å‡º (50Hz)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7. Ï€0.6 + Recap Flow
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Ï€0.6 / Ï€*0.6 æ¶æ„ä¸è®­ç»ƒæµç¨‹                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚                     â”‚  5B VLM Backbone â”‚                        â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                              â–¼                                  â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚                     â”‚  Action Expert   â”‚                        â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                              â–¼                                  â”‚
â”‚                         ğŸ¦¾ ç²¾ç»†åŠ¨ä½œ                               â”‚
â”‚                                                                 â”‚
â”‚   Recap Training Pipeline:                                         â”‚
â”‚   Phase1: Collect successes/failures                              â”‚
â”‚              â”‚                                                   â”‚
â”‚           Analyze trajectories                                    â”‚
â”‚              â”‚                                                   â”‚
â”‚   Phase2: Recap Offline RL (reward positives, penalize negatives)â”‚
â”‚              â”‚                                                   â”‚
â”‚           Update policy                                           â”‚
â”‚              â”‚                                                   â”‚
â”‚   Phase3: Self-improvement â†’ surpass human demonstrations         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8. VLA Architecture Evolution
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    VLA æ¶æ„æ¼”è¿›è·¯çº¿å›¾                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   RT-1 (2022)              RT-2 (2023)              Ï€0 (2024)   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚EffNet   â”‚              â”‚ PaLI-X  â”‚              â”‚ Gemma   â”‚ â”‚
â”‚   â”‚   +     â”‚   â”€â”€â”€â”€â–¶      â”‚  55B    â”‚   â”€â”€â”€â”€â–¶      â”‚  +Flow  â”‚ â”‚
â”‚   â”‚Tokenize â”‚              â”‚ VLM+Act â”‚              â”‚ Matchingâ”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚     å°æ¨¡å‹                   å¤§VLM                    é«˜æ•ˆæ¨ç†   â”‚
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                    é€šç”¨ VLA æ¶æ„æ¨¡æ¿                     â”‚   â”‚
â”‚   â”‚                                                         â”‚   â”‚
â”‚   â”‚    ğŸ“· Image          ğŸ“ Language                        â”‚   â”‚
â”‚   â”‚       â”‚                  â”‚                              â”‚   â”‚
â”‚   â”‚       â–¼                  â–¼                              â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚   â”‚
â”‚   â”‚  â”‚ Vision  â”‚       â”‚ Language  â”‚                        â”‚   â”‚
â”‚   â”‚  â”‚ Encoder â”‚       â”‚ Encoder   â”‚                        â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                        â”‚   â”‚
â”‚   â”‚       â”‚                  â”‚                              â”‚   â”‚
â”‚   â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚   â”‚
â”‚   â”‚                â”‚ Fusion                                 â”‚   â”‚
â”‚   â”‚                â–¼                                        â”‚   â”‚
â”‚   â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚   â”‚
â”‚   â”‚       â”‚  Transformer    â”‚                               â”‚   â”‚
â”‚   â”‚       â”‚    Backbone     â”‚                               â”‚   â”‚
â”‚   â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚   â”‚
â”‚   â”‚                â”‚                                        â”‚   â”‚
â”‚   â”‚                â–¼                                        â”‚   â”‚
â”‚   â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚   â”‚
â”‚   â”‚       â”‚   Action Head   â”‚                               â”‚   â”‚
â”‚   â”‚       â”‚ Token/Diff/Flow â”‚                               â”‚   â”‚
â”‚   â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚   â”‚
â”‚   â”‚                â”‚                                        â”‚   â”‚
â”‚   â”‚                â–¼                                        â”‚   â”‚
â”‚   â”‚          ğŸ¦¾ Robot Action                                â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9. Flash Attention vs Standard
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Flash Attention vs æ ‡å‡† Attention                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   æ ‡å‡† Attention (å†…å­˜ç“¶é¢ˆ)           Flash Attention (åˆ†å—)    â”‚
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚      Q Â· K^T      â”‚               â”‚   Qâ‚Â·Kâ‚  Qâ‚Â·Kâ‚‚   â”‚     â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚               â”‚  â”Œâ”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”  â”‚     â”‚
â”‚   â”‚   â”‚             â”‚ â”‚   â”€â”€â”€â”€â–¶       â”‚  â”‚ å—1 â”‚â”‚ å—2 â”‚  â”‚     â”‚
â”‚   â”‚   â”‚   N Ã— N     â”‚ â”‚   åˆ†å—        â”‚  â””â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”˜  â”‚     â”‚
â”‚   â”‚   â”‚  (å·¨å¤§!)    â”‚ â”‚               â”‚  â”Œâ”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”  â”‚     â”‚
â”‚   â”‚   â”‚             â”‚ â”‚               â”‚  â”‚ å—3 â”‚â”‚ å—4 â”‚  â”‚     â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚               â”‚  â””â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”˜  â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚   å†…å­˜: O(NÂ²) âŒ                       å†…å­˜: O(N) âœ…             â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        å†…å­˜å±‚çº§ä¼˜åŒ–                              â”‚
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚   â”‚      HBM       â”‚     â”‚     SRAM       â”‚                     â”‚
â”‚   â”‚   (æ˜¾å­˜)       â”‚     â”‚   (L2 Cache)   â”‚                     â”‚
â”‚   â”‚   24GB+        â”‚ â—€â”€â–¶ â”‚    ~20MB       â”‚                     â”‚
â”‚   â”‚   æ…¢ 1TB/s     â”‚     â”‚   å¿« 19TB/s    â”‚                     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚          â”‚                      â”‚                               â”‚
â”‚          â”‚   æ ‡å‡†: å¤šæ¬¡è¯»å†™      â”‚   Flash: ä¸€æ¬¡åŠ è½½             â”‚
â”‚          â”‚   Q,K â”€â”€â–¶ S â”€â”€â–¶ P    â”‚   å…¨éƒ¨åœ¨ SRAM è®¡ç®—            â”‚
â”‚          â”‚   æ¯æ­¥å†™å› HBM       â”‚   åªå†™æœ€ç»ˆç»“æœ                 â”‚
â”‚   ç»“æœ: 2-4x åŠ é€Ÿ, æ˜¾å­˜ O(NÂ²) â†’ O(N)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10. WALL-OSS Uni-CoT
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WALL-OSS æ¶æ„ (Uni-CoT)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   è¾“å…¥: ğŸ“· å›¾åƒ + ğŸ“ æŒ‡ä»¤                                          â”‚
â”‚              â”‚                                                  â”‚
â”‚              â–¼                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚   â”‚       Qwen2.5 VLMoE Backbone            â”‚                  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                     â”‚                                          â”‚
â”‚                     â–¼                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚   â”‚           Uni-CoT æ¨ç†é“¾                 â”‚                  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                  â”‚
â”‚   â”‚  â”‚ 1. é«˜å±‚æ¨ç†: ç†è§£ä»»åŠ¡               â”‚    â”‚                  â”‚
â”‚   â”‚  â”‚ 2. å­ä»»åŠ¡åˆ†è§£: æ‰¾æµ·ç»µâ†’æŠ“å–â†’æ“¦æ‹­     â”‚    â”‚                  â”‚
â”‚   â”‚  â”‚ 3. ç»†ç²’åº¦åŠ¨ä½œ: (x,y,z) è½¨è¿¹         â”‚    â”‚                  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                     â”‚                                          â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚         â–¼                       â–¼                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚   â”‚ ç¦»æ•£å¤´    â”‚          â”‚ è¿ç»­å¤´    â”‚                         â”‚
â”‚   â”‚(FAST Token)â”‚          â”‚(Flow Match)â”‚                        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚         â”‚                      â”‚                               â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                    â–¼                                           â”‚
â”‚              ğŸ¦¾ åŒå¤´åŠ¨ä½œè¾“å‡º                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

