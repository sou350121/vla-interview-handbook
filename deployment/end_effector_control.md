# æ•°æ®é©±åŠ¨ä¸è§¦è§‰é—­ç¯æœ«ç«¯æ‰§è¡Œå™¨æ§åˆ¶ç³»ç»Ÿ (Data-Driven Tactile Closed-Loop End-Effector Control)

> **é¢è¯•åœºæ™¯**: "è¯·æè¿°ä½ åœ¨æœ«ç«¯æ‰§è¡Œå™¨æ§åˆ¶ç³»ç»Ÿå¼€å‘ä¸­çš„è½¯ä»¶å·¥ç¨‹ç»éªŒï¼Œç‰¹åˆ«æ˜¯æ•°æ®é©±åŠ¨å’Œè§¦è§‰é—­ç¯æ–¹é¢ã€‚"

æœ¬æ–‡æ¶µç›–æœ«ç«¯æ‰§è¡Œå™¨æ§åˆ¶ç³»ç»Ÿçš„å®Œæ•´è½¯ä»¶å·¥ç¨‹å®è·µï¼Œä»ç³»ç»Ÿæ¶æ„åˆ°è§¦è§‰é—­ç¯æ§åˆ¶ï¼Œä»æ•°æ®é‡‡é›†åˆ°æ¨¡å‹éƒ¨ç½²ã€‚

---

## ğŸ“Š ç³»ç»Ÿæ¦‚è§ˆ (System Overview)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ•°æ®é©±åŠ¨è§¦è§‰é—­ç¯æœ«ç«¯æ‰§è¡Œå™¨æ§åˆ¶ç³»ç»Ÿæ¶æ„                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                        æ„ŸçŸ¥å±‚ (Perception Layer)                     â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚   â”‚
â”‚   â”‚  â”‚ è§†è§‰ç›¸æœº â”‚  â”‚ è§¦è§‰ä¼ æ„Ÿ â”‚  â”‚ åŠ›/åŠ›çŸ©  â”‚  â”‚ ä½ç½®ç¼–ç  â”‚             â”‚   â”‚
â”‚   â”‚  â”‚ RGB-D    â”‚  â”‚ GelSight â”‚  â”‚ F/T Sensorâ”‚  â”‚ Encoder  â”‚             â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜             â”‚   â”‚
â”‚   â”‚       â”‚             â”‚             â”‚             â”‚                   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚           â”‚             â”‚             â”‚             â”‚                       â”‚
â”‚           â–¼             â–¼             â–¼             â–¼                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                      æ•°æ®èåˆå±‚ (Fusion Layer)                       â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚   â”‚  â”‚  æ—¶é—´åŒæ­¥ â†’ ç©ºé—´å¯¹é½ â†’ ç‰¹å¾æå– â†’ å¤šæ¨¡æ€èåˆ â†’ çŠ¶æ€ä¼°è®¡        â”‚ â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                       å†³ç­–å±‚ (Decision Layer)                        â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚   â”‚
â”‚   â”‚  â”‚ VLA ç­–ç•¥æ¨¡å‹ â”‚  â”‚ è§¦è§‰é—­ç¯æ§åˆ¶ â”‚  â”‚ å®‰å…¨ç›‘æ§æ¨¡å— â”‚               â”‚   â”‚
â”‚   â”‚  â”‚ (é«˜å±‚è§„åˆ’)   â”‚  â”‚ (ä½å±‚åé¦ˆ)   â”‚  â”‚ (ç´§æ€¥åˆ¶åŠ¨)   â”‚               â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚   â”‚
â”‚   â”‚         â”‚                 â”‚                 â”‚                       â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚             â”‚                 â”‚                 â”‚                           â”‚
â”‚             â–¼                 â–¼                 â–¼                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                       æ‰§è¡Œå±‚ (Execution Layer)                       â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚   â”‚
â”‚   â”‚  â”‚ ç”µæœºé©±åŠ¨å™¨   â”‚  â”‚ å¤¹çˆªæ§åˆ¶å™¨   â”‚  â”‚ æœºæ¢°è‡‚æ§åˆ¶å™¨ â”‚               â”‚   â”‚
â”‚   â”‚  â”‚ (CAN/EtherCAT)â”‚  â”‚ (ä½ç½®/åŠ›æ§)  â”‚  â”‚ (è½¨è¿¹è·Ÿè¸ª)   â”‚               â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   ğŸ’¡ æ ¸å¿ƒ: è§¦è§‰åé¦ˆ â†’ åŠ›æ§è°ƒæ•´ â†’ é˜²æ»‘/è‡ªé€‚åº”æŠ“å–                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1. è½¯ä»¶æ¶æ„è®¾è®¡ (Software Architecture)

### 1.1 åˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        è½¯ä»¶åˆ†å±‚æ¶æ„                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  åº”ç”¨å±‚ (Application Layer)                              Python     â”‚   â”‚
â”‚   â”‚  - VLA ç­–ç•¥æ¨ç†                                                     â”‚   â”‚
â”‚   â”‚  - ä»»åŠ¡ç¼–æ’ (Task Orchestration)                                    â”‚   â”‚
â”‚   â”‚  - äººæœºäº¤äº’ç•Œé¢                                                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚ ROS 2 / gRPC                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  ä¸­é—´ä»¶å±‚ (Middleware Layer)                             C++/Python â”‚   â”‚
â”‚   â”‚  - ROS 2 èŠ‚ç‚¹é€šä¿¡                                                   â”‚   â”‚
â”‚   â”‚  - æ•°æ®åŒæ­¥ä¸ç¼“å­˜                                                   â”‚   â”‚
â”‚   â”‚  - çŠ¶æ€æœºç®¡ç†                                                       â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚ å…±äº«å†…å­˜ / DDS                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  å®æ—¶æ§åˆ¶å±‚ (Real-Time Control Layer)                    C/C++      â”‚   â”‚
â”‚   â”‚  - è§¦è§‰é—­ç¯æ§åˆ¶å™¨ (1kHz)                                            â”‚   â”‚
â”‚   â”‚  - åŠ›/ä½ç½®æ··åˆæ§åˆ¶                                                  â”‚   â”‚
â”‚   â”‚  - å®‰å…¨ç›‘æ§ä¸æ€¥åœ                                                   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚ CAN / EtherCAT / SPI                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  ç¡¬ä»¶æŠ½è±¡å±‚ (HAL Layer)                                  C/é©±åŠ¨     â”‚   â”‚
â”‚   â”‚  - ç”µæœºé©±åŠ¨æ¥å£                                                     â”‚   â”‚
â”‚   â”‚  - ä¼ æ„Ÿå™¨è¯»å–æ¥å£                                                   â”‚   â”‚
â”‚   â”‚  - ç¡¬ä»¶å®‰å…¨é™ä½                                                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   ğŸ’¡ å…³é”®: å®æ—¶æ§åˆ¶å±‚å¿…é¡»ä¿è¯ç¡®å®šæ€§å»¶è¿Ÿ (Deterministic Latency)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æ ¸å¿ƒæ¨¡å—åˆ’åˆ†

| æ¨¡å— | èŒè´£ | è¯­è¨€ | å®æ—¶æ€§è¦æ±‚ |
| :--- | :--- | :--- | :--- |
| **Perception** | ä¼ æ„Ÿå™¨æ•°æ®é‡‡é›†ä¸é¢„å¤„ç† | Python/C++ | 30-60 Hz |
| **Fusion** | å¤šæ¨¡æ€æ•°æ®èåˆä¸çŠ¶æ€ä¼°è®¡ | Python | 30-60 Hz |
| **Policy** | VLA ç­–ç•¥æ¨ç† | Python (PyTorch) | 10-30 Hz |
| **TactileControl** | è§¦è§‰é—­ç¯åŠ›æ§åˆ¶å™¨ | C++ | **1000 Hz** |
| **MotorDriver** | ç”µæœºåº•å±‚é©±åŠ¨ | C | **1000+ Hz** |
| **SafetyMonitor** | å®‰å…¨ç›‘æ§ä¸æ€¥åœ | C++ | **1000 Hz** |

### 1.3 é€šä¿¡æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        é€šä¿¡æ‹“æ‰‘                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                           â”‚
â”‚   â”‚ VLA Policy  â”‚â—„â”€â”€â”€â”€ gRPC (è¿œç¨‹æ¨ç†) â”€â”€â”€â”€â–º â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚   â”‚ (GPU Server)â”‚                            â”‚ æ¨ç†æœåŠ¡å™¨   â”‚               â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                            â”‚ (4090/H100) â”‚               â”‚
â”‚          â”‚                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚          â”‚ ROS 2 Topic (10-30 Hz)                                          â”‚
â”‚          â–¼                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     ROS 2 Topic      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚   â”‚ Task Managerâ”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Perception  â”‚                     â”‚
â”‚   â”‚ (çŠ¶æ€æœº)     â”‚     (30-60 Hz)       â”‚ (ä¼ æ„Ÿå™¨)    â”‚                     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚          â”‚                                                                  â”‚
â”‚          â”‚ å…±äº«å†…å­˜ / LCM (1kHz)                                            â”‚
â”‚          â–¼                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     EtherCAT         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚   â”‚ RT Control  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Motor Driverâ”‚                     â”‚
â”‚   â”‚ (å®æ—¶æ§åˆ¶)   â”‚     (1kHz)           â”‚ (ç”µæœºé©±åŠ¨)  â”‚                     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                                             â”‚
â”‚   é€šä¿¡åè®®é€‰æ‹©:                                                             â”‚
â”‚   - é«˜å±‚ (éå®æ—¶): ROS 2 DDS, gRPC, ZeroMQ                                 â”‚
â”‚   - ä½å±‚ (å®æ—¶): EtherCAT, CAN FD, å…±äº«å†…å­˜, LCM                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. è§¦è§‰é—­ç¯æ§åˆ¶ (Tactile Closed-Loop Control)

### 2.1 æ§åˆ¶å›è·¯è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     è§¦è§‰é—­ç¯æ§åˆ¶æ¡†å›¾                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                              â”‚
â”‚   â”‚ ç›®æ ‡åŠ›   â”‚                                                              â”‚
â”‚   â”‚ F_target â”‚                                                              â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                                              â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â–¼        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚                                                        â”‚   â”‚
â”‚   â”‚  âˆ‘    â”‚â—„â”€â”€â”¤  e = F_target - F_measured                              â”‚   â”‚
â”‚   â”‚ (è¯¯å·®) â”‚   â”‚                                                        â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â–¼                                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                      PID / é˜»æŠ—æ§åˆ¶å™¨                                â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚  ä½ç½®æ§åˆ¶:  x_cmd = x_current + K_p * e + K_i * âˆ«e + K_d * Ä—       â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚  é˜»æŠ—æ§åˆ¶:  F = M * áº + B * áº‹ + K * (x - x_d)                       â”‚   â”‚
â”‚   â”‚            (è´¨é‡-é˜»å°¼-åˆšåº¦ æ¨¡å‹)                                    â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                        ç”µæœºé©±åŠ¨å™¨                                    â”‚   â”‚
â”‚   â”‚                    (ä½ç½®/é€Ÿåº¦/åŠ›çŸ©æ§åˆ¶)                              â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                         æœ«ç«¯æ‰§è¡Œå™¨                                   â”‚   â”‚
â”‚   â”‚                      (å¤¹çˆª / çµå·§æ‰‹)                                 â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                        è§¦è§‰ä¼ æ„Ÿå™¨                                    â”‚   â”‚
â”‚   â”‚                  (GelSight / F/T Sensor)                            â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â”‚ F_measured                             â”‚
â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  åé¦ˆå›è·¯    â”‚
â”‚                                                                             â”‚
â”‚   ğŸ’¡ å…³é”®æŒ‡æ ‡: æ§åˆ¶é¢‘ç‡ â‰¥ 1kHz, åŠ›åˆ†è¾¨ç‡ < 0.1N, å“åº”æ—¶é—´ < 10ms           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 åŠ›æ§åˆ¶æ¨¡å¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     åŠ›æ§åˆ¶æ¨¡å¼å¯¹æ¯”                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   æ¨¡å¼              åŸç†                é€‚ç”¨åœºæ™¯              å®ç°éš¾åº¦       â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚   çº¯ä½ç½®æ§åˆ¶        ç»™å®šç›®æ ‡ä½ç½®        å¿«é€Ÿç§»åŠ¨              â˜…â˜†â˜†â˜†â˜†        â”‚
â”‚   Position          æ— åŠ›åé¦ˆ            éæ¥è§¦é˜¶æ®µ                          â”‚
â”‚                                                                             â”‚
â”‚   çº¯åŠ›æ§åˆ¶          ç»™å®šç›®æ ‡åŠ›          æ’åŠ›æ‰“ç£¨              â˜…â˜…â˜…â˜†â˜†        â”‚
â”‚   Force             ä½ç½®è‡ªé€‚åº”          æ’åŠ›æŠ›å…‰                            â”‚
â”‚                                                                             â”‚
â”‚   é˜»æŠ—æ§åˆ¶          æ¨¡æ‹Ÿå¼¹ç°§-é˜»å°¼       æŸ”é¡ºæŠ“å–              â˜…â˜…â˜…â˜…â˜†        â”‚
â”‚   Impedance         F = K(x-x_d) + Báº‹   äººæœºåä½œ                            â”‚
â”‚                                                                             â”‚
â”‚   å¯¼çº³æ§åˆ¶          åŠ›è¾“å…¥â†’ä½ç½®è¾“å‡º     ç²¾å¯†è£…é…              â˜…â˜…â˜…â˜…â˜†        â”‚
â”‚   Admittance        x = âˆ«(F/B)dt        åŠ›æ•æ„Ÿä»»åŠ¡                          â”‚
â”‚                                                                             â”‚
â”‚   æ··åˆåŠ›/ä½æ§åˆ¶     ä¸åŒè½´ä¸åŒæ¨¡å¼      æ’å…¥ä»»åŠ¡              â˜…â˜…â˜…â˜…â˜…        â”‚
â”‚   Hybrid            Zè½´åŠ›æ§ + XYä½æ§    æ¥è§¦çº¦æŸ                            â”‚
â”‚                                                                             â”‚
â”‚   ğŸ’¡ VLA æŠ“å–å¸¸ç”¨: æ¥è¿‘é˜¶æ®µä½ç½®æ§åˆ¶ â†’ æ¥è§¦ååˆ‡æ¢é˜»æŠ—æ§åˆ¶                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 è§¦è§‰åé¦ˆå¤„ç†

```python
# è§¦è§‰æ•°æ®å¤„ç† Pipeline
import numpy as np
from dataclasses import dataclass
from typing import Optional
import cv2

@dataclass
class TactileReading:
    """è§¦è§‰ä¼ æ„Ÿå™¨è¯»æ•°"""
    timestamp: float
    force_vector: np.ndarray      # [Fx, Fy, Fz] in N
    torque_vector: np.ndarray     # [Tx, Ty, Tz] in Nm
    contact_area: float           # æ¥è§¦é¢ç§¯ mm^2
    slip_detected: bool           # æ˜¯å¦æ£€æµ‹åˆ°æ»‘åŠ¨
    raw_image: Optional[np.ndarray] = None  # è§†è§¦è§‰åŸå§‹å›¾åƒ

class TactileFeedbackProcessor:
    """è§¦è§‰åé¦ˆå¤„ç†å™¨"""
    
    def __init__(self, config):
        self.force_threshold = config.get('force_threshold', 0.5)  # N
        self.slip_threshold = config.get('slip_threshold', 0.1)    # æ»‘åŠ¨æ£€æµ‹é˜ˆå€¼
        self.filter_alpha = config.get('filter_alpha', 0.8)        # ä½é€šæ»¤æ³¢ç³»æ•°
        
        self.prev_reading = None
        self.filtered_force = np.zeros(3)
        
    def process(self, reading: TactileReading) -> dict:
        """å¤„ç†è§¦è§‰è¯»æ•°ï¼Œè¿”å›æ§åˆ¶ä¿¡å·"""
        
        # 1. ä½é€šæ»¤æ³¢å»å™ª
        self.filtered_force = (
            self.filter_alpha * self.filtered_force + 
            (1 - self.filter_alpha) * reading.force_vector
        )
        
        # 2. æ¥è§¦æ£€æµ‹
        contact_detected = np.linalg.norm(self.filtered_force) > self.force_threshold
        
        # 3. æ»‘åŠ¨æ£€æµ‹ (åŸºäºåˆ‡å‘åŠ›å˜åŒ–ç‡)
        slip_detected = False
        if self.prev_reading is not None:
            tangential_force = self.filtered_force[:2]  # Fx, Fy
            prev_tangential = self.prev_reading.force_vector[:2]
            force_change_rate = np.linalg.norm(tangential_force - prev_tangential)
            slip_detected = force_change_rate > self.slip_threshold
        
        # 4. è®¡ç®—æŠ“å–åŠ›è°ƒæ•´
        grip_adjustment = self._compute_grip_adjustment(
            self.filtered_force, 
            slip_detected
        )
        
        self.prev_reading = reading
        
        return {
            'filtered_force': self.filtered_force,
            'contact_detected': contact_detected,
            'slip_detected': slip_detected,
            'grip_adjustment': grip_adjustment,
            'timestamp': reading.timestamp
        }
    
    def _compute_grip_adjustment(self, force: np.ndarray, slip: bool) -> float:
        """è®¡ç®—æŠ“å–åŠ›è°ƒæ•´é‡"""
        if slip:
            # æ£€æµ‹åˆ°æ»‘åŠ¨ï¼Œå¢åŠ æŠ“å–åŠ›
            return 0.5  # å¢åŠ  0.5N
        
        normal_force = abs(force[2])  # Fz
        if normal_force > 10.0:  # è¿‡å¤§
            return -0.2  # å‡å°‘
        
        return 0.0  # ä¿æŒ

class SlipDetector:
    """åŸºäºè§†è§¦è§‰çš„æ»‘åŠ¨æ£€æµ‹å™¨"""
    
    def __init__(self):
        self.prev_frame = None
        self.optical_flow = cv2.optflow.DualTVL1OpticalFlow_create()
        
    def detect(self, tactile_image: np.ndarray) -> tuple[bool, np.ndarray]:
        """æ£€æµ‹æ»‘åŠ¨ï¼Œè¿”å› (æ˜¯å¦æ»‘åŠ¨, æ»‘åŠ¨æ–¹å‘å‘é‡)"""
        
        gray = cv2.cvtColor(tactile_image, cv2.COLOR_BGR2GRAY)
        
        if self.prev_frame is None:
            self.prev_frame = gray
            return False, np.zeros(2)
        
        # è®¡ç®—å…‰æµ
        flow = self.optical_flow.calc(self.prev_frame, gray, None)
        
        # è®¡ç®—å¹³å‡æµåŠ¨
        mean_flow = np.mean(flow, axis=(0, 1))
        flow_magnitude = np.linalg.norm(mean_flow)
        
        self.prev_frame = gray
        
        # é˜ˆå€¼åˆ¤æ–­
        slip_detected = flow_magnitude > 2.0  # pixels
        slip_direction = mean_flow / (flow_magnitude + 1e-6)
        
        return slip_detected, slip_direction
```

### 2.4 å®æ—¶æ§åˆ¶å™¨å®ç°

```cpp
// tactile_controller.hpp - å®æ—¶è§¦è§‰é—­ç¯æ§åˆ¶å™¨
#pragma once

#include <atomic>
#include <chrono>
#include <thread>
#include <Eigen/Dense>

class TactileController {
public:
    struct Config {
        double control_rate_hz = 1000.0;
        double kp = 100.0;   // æ¯”ä¾‹å¢ç›Š
        double ki = 10.0;    // ç§¯åˆ†å¢ç›Š
        double kd = 5.0;     // å¾®åˆ†å¢ç›Š
        double max_force = 20.0;  // æœ€å¤§åŠ› N
        double min_force = 0.1;   // æœ€å°åŠ› N
    };
    
    TactileController(const Config& config) : config_(config) {
        integral_error_ = 0.0;
        prev_error_ = 0.0;
        running_ = false;
    }
    
    void start() {
        running_ = true;
        control_thread_ = std::thread(&TactileController::controlLoop, this);
        
        // è®¾ç½®å®æ—¶ä¼˜å…ˆçº§ (éœ€è¦ root æƒé™)
        struct sched_param param;
        param.sched_priority = 99;
        pthread_setschedparam(control_thread_.native_handle(), SCHED_FIFO, &param);
    }
    
    void stop() {
        running_ = false;
        if (control_thread_.joinable()) {
            control_thread_.join();
        }
    }
    
    void setTargetForce(double force) {
        target_force_.store(std::clamp(force, config_.min_force, config_.max_force));
    }
    
    double getCurrentForce() const {
        return current_force_.load();
    }
    
private:
    void controlLoop() {
        auto period = std::chrono::microseconds(
            static_cast<int>(1e6 / config_.control_rate_hz)
        );
        
        while (running_) {
            auto start = std::chrono::high_resolution_clock::now();
            
            // 1. è¯»å–ä¼ æ„Ÿå™¨
            double measured_force = readForceSensor();
            current_force_.store(measured_force);
            
            // 2. è®¡ç®—è¯¯å·®
            double target = target_force_.load();
            double error = target - measured_force;
            
            // 3. PID è®¡ç®—
            integral_error_ += error * (1.0 / config_.control_rate_hz);
            integral_error_ = std::clamp(integral_error_, -10.0, 10.0);  // æŠ—ç§¯åˆ†é¥±å’Œ
            
            double derivative = (error - prev_error_) * config_.control_rate_hz;
            prev_error_ = error;
            
            double output = config_.kp * error + 
                           config_.ki * integral_error_ + 
                           config_.kd * derivative;
            
            // 4. è¾“å‡ºé™å¹…
            output = std::clamp(output, -config_.max_force, config_.max_force);
            
            // 5. å‘é€åˆ°ç”µæœº
            sendMotorCommand(output);
            
            // 6. ç­‰å¾…ä¸‹ä¸€ä¸ªå‘¨æœŸ
            auto end = std::chrono::high_resolution_clock::now();
            auto elapsed = end - start;
            if (elapsed < period) {
                std::this_thread::sleep_for(period - elapsed);
            }
        }
    }
    
    double readForceSensor();    // ç¡¬ä»¶æ¥å£
    void sendMotorCommand(double force);  // ç¡¬ä»¶æ¥å£
    
    Config config_;
    std::atomic<bool> running_;
    std::atomic<double> target_force_{5.0};
    std::atomic<double> current_force_{0.0};
    
    double integral_error_;
    double prev_error_;
    
    std::thread control_thread_;
};
```

---

## 3. æ•°æ®é©±åŠ¨å¼€å‘ (Data-Driven Development)

### 3.1 æ•°æ®é‡‡é›†ç³»ç»Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æ•°æ®é‡‡é›†ç³»ç»Ÿæ¶æ„                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                        æ•°æ®æº (Data Sources)                         â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚   â”‚  â”‚ RGB ç›¸æœº â”‚ â”‚ æ·±åº¦ç›¸æœº â”‚ â”‚ è§¦è§‰ä¼ æ„Ÿ â”‚ â”‚ åŠ›/åŠ›çŸ©  â”‚ â”‚ å…³èŠ‚çŠ¶æ€ â”‚  â”‚   â”‚
â”‚   â”‚  â”‚ 30 FPS   â”‚ â”‚ 30 FPS   â”‚ â”‚ 60 FPS   â”‚ â”‚ 1000 Hz  â”‚ â”‚ 1000 Hz  â”‚  â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚           â”‚            â”‚            â”‚            â”‚            â”‚            â”‚
â”‚           â–¼            â–¼            â–¼            â–¼            â–¼            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                     æ—¶é—´åŒæ­¥æ¨¡å— (Time Sync)                         â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚   â”‚  â”‚  PTP/NTP æ—¶é’ŸåŒæ­¥ â†’ ç¡¬ä»¶è§¦å‘ â†’ è½¯ä»¶æ—¶é—´æˆ³å¯¹é½ â†’ æ’å€¼é‡é‡‡æ ·     â”‚ â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                      æ•°æ®è®°å½•å™¨ (Data Recorder)                      â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚   â”‚  â”‚  Ring Buffer â†’ å‹ç¼©ç¼–ç  â†’ å†™å…¥ç£ç›˜ (HDF5/ROS Bag/LeRobot)       â”‚ â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   æ•°æ®æ ¼å¼:                                                                 â”‚
â”‚   {                                                                         â”‚
â”‚     "timestamp": 1699999999.123456,                                         â”‚
â”‚     "rgb_image": [...],           // å‹ç¼© JPEG                              â”‚
â”‚     "depth_image": [...],         // å‹ç¼© PNG                               â”‚
â”‚     "tactile_image": [...],       // GelSight å›¾åƒ                          â”‚
â”‚     "force_torque": [Fx, Fy, Fz, Tx, Ty, Tz],                              â”‚
â”‚     "joint_positions": [...],                                               â”‚
â”‚     "joint_velocities": [...],                                              â”‚
â”‚     "gripper_state": {"position": 0.05, "force": 2.3},                     â”‚
â”‚     "action": {"type": "grasp", "target_force": 5.0}                       â”‚
â”‚   }                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 æ•°æ®é‡‡é›†ä»£ç ç¤ºä¾‹

```python
# data_collector.py - å¤šæ¨¡æ€æ•°æ®é‡‡é›†å™¨
import time
import threading
import queue
import h5py
import numpy as np
from dataclasses import dataclass, field
from typing import Dict, Any, List
from concurrent.futures import ThreadPoolExecutor

@dataclass
class SensorFrame:
    """ä¼ æ„Ÿå™¨å¸§æ•°æ®"""
    timestamp: float
    sensor_id: str
    data: Any
    metadata: Dict = field(default_factory=dict)

class SynchronizedDataCollector:
    """åŒæ­¥å¤šæ¨¡æ€æ•°æ®é‡‡é›†å™¨"""
    
    def __init__(self, config: Dict):
        self.config = config
        self.sensors = {}
        self.data_queue = queue.Queue(maxsize=1000)
        self.running = False
        self.episode_data = []
        
        # æ—¶é—´åŒæ­¥
        self.reference_time = None
        self.time_offsets = {}
        
    def register_sensor(self, sensor_id: str, sensor_driver, rate_hz: float):
        """æ³¨å†Œä¼ æ„Ÿå™¨"""
        self.sensors[sensor_id] = {
            'driver': sensor_driver,
            'rate_hz': rate_hz,
            'period': 1.0 / rate_hz,
            'last_timestamp': 0.0
        }
        
    def start_collection(self):
        """å¼€å§‹é‡‡é›†"""
        self.running = True
        self.reference_time = time.time()
        
        # å¯åŠ¨å„ä¼ æ„Ÿå™¨é‡‡é›†çº¿ç¨‹
        self.threads = []
        for sensor_id, sensor_info in self.sensors.items():
            t = threading.Thread(
                target=self._sensor_loop,
                args=(sensor_id, sensor_info),
                daemon=True
            )
            t.start()
            self.threads.append(t)
        
        # å¯åŠ¨æ•°æ®å¤„ç†çº¿ç¨‹
        self.process_thread = threading.Thread(
            target=self._process_loop,
            daemon=True
        )
        self.process_thread.start()
        
    def stop_collection(self):
        """åœæ­¢é‡‡é›†"""
        self.running = False
        for t in self.threads:
            t.join(timeout=1.0)
        self.process_thread.join(timeout=1.0)
        
    def _sensor_loop(self, sensor_id: str, sensor_info: Dict):
        """ä¼ æ„Ÿå™¨é‡‡é›†å¾ªç¯"""
        driver = sensor_info['driver']
        period = sensor_info['period']
        
        while self.running:
            start = time.perf_counter()
            
            try:
                # è¯»å–ä¼ æ„Ÿå™¨æ•°æ®
                data = driver.read()
                timestamp = time.time() - self.reference_time
                
                frame = SensorFrame(
                    timestamp=timestamp,
                    sensor_id=sensor_id,
                    data=data
                )
                
                self.data_queue.put(frame, timeout=0.1)
                
            except Exception as e:
                print(f"Sensor {sensor_id} error: {e}")
            
            # ç²¾ç¡®ç­‰å¾…
            elapsed = time.perf_counter() - start
            if elapsed < period:
                time.sleep(period - elapsed)
                
    def _process_loop(self):
        """æ•°æ®å¤„ç†å¾ªç¯"""
        buffer = {}  # æŒ‰æ—¶é—´æˆ³ç¼“å­˜
        
        while self.running:
            try:
                frame = self.data_queue.get(timeout=0.1)
                
                # æŒ‰æ—¶é—´çª—å£èšåˆ
                time_key = round(frame.timestamp, 2)  # 10ms çª—å£
                
                if time_key not in buffer:
                    buffer[time_key] = {}
                    
                buffer[time_key][frame.sensor_id] = frame.data
                
                # æ£€æŸ¥æ˜¯å¦æ‰€æœ‰ä¼ æ„Ÿå™¨éƒ½æœ‰æ•°æ®
                if len(buffer[time_key]) == len(self.sensors):
                    self.episode_data.append({
                        'timestamp': time_key,
                        **buffer[time_key]
                    })
                    del buffer[time_key]
                    
                # æ¸…ç†è¿‡æœŸæ•°æ®
                current_time = time.time() - self.reference_time
                expired = [k for k in buffer if current_time - k > 1.0]
                for k in expired:
                    del buffer[k]
                    
            except queue.Empty:
                continue
                
    def save_episode(self, filepath: str, metadata: Dict = None):
        """ä¿å­˜ Episode æ•°æ®"""
        with h5py.File(filepath, 'w') as f:
            # ä¿å­˜å…ƒæ•°æ®
            if metadata:
                for k, v in metadata.items():
                    f.attrs[k] = v
                    
            # ä¿å­˜æ—¶é—´æˆ³
            timestamps = [d['timestamp'] for d in self.episode_data]
            f.create_dataset('timestamps', data=np.array(timestamps))
            
            # ä¿å­˜å„ä¼ æ„Ÿå™¨æ•°æ®
            for sensor_id in self.sensors:
                sensor_data = [d.get(sensor_id) for d in self.episode_data]
                
                # å¤„ç†ä¸åŒæ•°æ®ç±»å‹
                if isinstance(sensor_data[0], np.ndarray):
                    f.create_dataset(
                        sensor_id, 
                        data=np.stack(sensor_data),
                        compression='gzip'
                    )
                else:
                    # æ ‡é‡æˆ–å…¶ä»–ç±»å‹
                    f.create_dataset(sensor_id, data=np.array(sensor_data))
                    
        print(f"Saved {len(self.episode_data)} frames to {filepath}")
        self.episode_data = []

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    from sensors import RGBCamera, DepthCamera, GelSightSensor, FTSensor
    
    collector = SynchronizedDataCollector({})
    
    # æ³¨å†Œä¼ æ„Ÿå™¨
    collector.register_sensor('rgb', RGBCamera('/dev/video0'), rate_hz=30)
    collector.register_sensor('depth', DepthCamera(), rate_hz=30)
    collector.register_sensor('tactile', GelSightSensor(), rate_hz=60)
    collector.register_sensor('force', FTSensor('/dev/ttyUSB0'), rate_hz=100)
    
    # å¼€å§‹é‡‡é›†
    collector.start_collection()
    
    # é‡‡é›† 10 ç§’
    time.sleep(10)
    
    # åœæ­¢å¹¶ä¿å­˜
    collector.stop_collection()
    collector.save_episode('episode_001.h5', {'task': 'grasp_cup'})
```

### 3.3 æ•°æ®é©±åŠ¨æ¨¡å‹è®­ç»ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æ•°æ®é©±åŠ¨è®­ç»ƒæµç¨‹                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   1. æ•°æ®æ”¶é›†                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  é¥æ“ä½œ (Teleoperation) / ç¤ºæ•™ (Demonstration) / è‡ªä¸»æ¢ç´¢           â”‚   â”‚
â”‚   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚   â”‚  â€¢ äººç±»æ“ä½œå‘˜é¥æ§æœºå™¨äººæ‰§è¡Œä»»åŠ¡                                     â”‚   â”‚
â”‚   â”‚  â€¢ è®°å½•: è§‚æµ‹ (o_t) + åŠ¨ä½œ (a_t) + å¥–åŠ± (r_t)                       â”‚   â”‚
â”‚   â”‚  â€¢ ç›®æ ‡: æ”¶é›† 1000+ é«˜è´¨é‡ Episode                                  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚   2. æ•°æ®é¢„å¤„ç†                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  æ¸…æ´— â†’ å¯¹é½ â†’ å¢å¼º â†’ æ ‡å‡†åŒ– â†’ åˆ‡åˆ†                                  â”‚   â”‚
â”‚   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚   â”‚  â€¢ è¿‡æ»¤å¤±è´¥/å¼‚å¸¸ Episode                                            â”‚   â”‚
â”‚   â”‚  â€¢ æ—¶é—´æˆ³å¯¹é½ (æ’å€¼/é‡é‡‡æ ·)                                         â”‚   â”‚
â”‚   â”‚  â€¢ æ•°æ®å¢å¼º (é¢œè‰²æŠ–åŠ¨, è£å‰ª, å™ªå£°)                                  â”‚   â”‚
â”‚   â”‚  â€¢ åŠ¨ä½œæ ‡å‡†åŒ– (å½’ä¸€åŒ–åˆ° [-1, 1])                                    â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚   3. æ¨¡å‹è®­ç»ƒ                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  è¡Œä¸ºå…‹éš† (BC) / Diffusion Policy / Flow Matching                   â”‚   â”‚
â”‚   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚   â”‚  è¾“å…¥: è§†è§‰ + è§¦è§‰ + æœ¬ä½“æ„Ÿè§‰ + è¯­è¨€æŒ‡ä»¤                            â”‚   â”‚
â”‚   â”‚  è¾“å‡º: åŠ¨ä½œåºåˆ— (Action Chunk)                                      â”‚   â”‚
â”‚   â”‚  æŸå¤±: MSE (BC) / ELBO (Diffusion) / CFM (Flow)                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚   4. åœ¨çº¿å¾®è°ƒ (Optional)                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  Residual RL / DAGGER / Human Feedback                              â”‚   â”‚
â”‚   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚   â”‚  â€¢ éƒ¨ç½²åæ”¶é›†å¤±è´¥æ¡ˆä¾‹                                               â”‚   â”‚
â”‚   â”‚  â€¢ äººç±»çº æ­£ + é‡æ–°è®­ç»ƒ                                              â”‚   â”‚
â”‚   â”‚  â€¢ æŒç»­æ”¹è¿›é—­ç¯                                                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   ğŸ’¡ å…³é”®: æ•°æ®è´¨é‡ > æ•°æ®æ•°é‡; è§¦è§‰æ•°æ®å¯¹ç²¾ç»†æ“ä½œè‡³å…³é‡è¦                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. è½¯ä»¶å·¥ç¨‹å®è·µ (Software Engineering Practices)

### 4.1 ä»£ç ç»„ç»‡ç»“æ„

```
end_effector_control/
â”œâ”€â”€ README.md
â”œâ”€â”€ pyproject.toml              # Python ä¾èµ–ç®¡ç†
â”œâ”€â”€ CMakeLists.txt              # C++ æ„å»º
â”œâ”€â”€ setup.py
â”‚
â”œâ”€â”€ config/                     # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ robot_config.yaml       # æœºå™¨äººå‚æ•°
â”‚   â”œâ”€â”€ sensor_config.yaml      # ä¼ æ„Ÿå™¨é…ç½®
â”‚   â””â”€â”€ controller_config.yaml  # æ§åˆ¶å™¨å‚æ•°
â”‚
â”œâ”€â”€ src/                        # æºä»£ç 
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚
â”‚   â”œâ”€â”€ perception/             # æ„ŸçŸ¥æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ camera_driver.py
â”‚   â”‚   â”œâ”€â”€ tactile_driver.py
â”‚   â”‚   â”œâ”€â”€ force_sensor.py
â”‚   â”‚   â””â”€â”€ sensor_fusion.py
â”‚   â”‚
â”‚   â”œâ”€â”€ control/                # æ§åˆ¶æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ force_controller.py
â”‚   â”‚   â”œâ”€â”€ impedance_controller.py
â”‚   â”‚   â”œâ”€â”€ slip_controller.py
â”‚   â”‚   â””â”€â”€ safety_monitor.py
â”‚   â”‚
â”‚   â”œâ”€â”€ policy/                 # ç­–ç•¥æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ vla_policy.py
â”‚   â”‚   â”œâ”€â”€ tactile_policy.py
â”‚   â”‚   â””â”€â”€ hybrid_policy.py
â”‚   â”‚
â”‚   â”œâ”€â”€ data/                   # æ•°æ®æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ collector.py
â”‚   â”‚   â”œâ”€â”€ dataset.py
â”‚   â”‚   â””â”€â”€ augmentation.py
â”‚   â”‚
â”‚   â”œâ”€â”€ drivers/                # ç¡¬ä»¶é©±åŠ¨
â”‚   â”‚   â”œâ”€â”€ motor_driver.cpp
â”‚   â”‚   â”œâ”€â”€ can_interface.cpp
â”‚   â”‚   â””â”€â”€ ethercat_master.cpp
â”‚   â”‚
â”‚   â””â”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ transforms.py
â”‚       â”œâ”€â”€ filters.py
â”‚       â””â”€â”€ logging.py
â”‚
â”œâ”€â”€ ros2_ws/                    # ROS 2 å·¥ä½œç©ºé—´
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ tactile_msgs/       # è‡ªå®šä¹‰æ¶ˆæ¯
â”‚       â”œâ”€â”€ tactile_driver/     # ä¼ æ„Ÿå™¨ ROS èŠ‚ç‚¹
â”‚       â””â”€â”€ tactile_control/    # æ§åˆ¶ ROS èŠ‚ç‚¹
â”‚
â”œâ”€â”€ scripts/                    # è„šæœ¬
â”‚   â”œâ”€â”€ calibrate_sensor.py
â”‚   â”œâ”€â”€ collect_data.py
â”‚   â”œâ”€â”€ train_policy.py
â”‚   â””â”€â”€ deploy_policy.py
â”‚
â”œâ”€â”€ tests/                      # æµ‹è¯•
â”‚   â”œâ”€â”€ test_perception.py
â”‚   â”œâ”€â”€ test_control.py
â”‚   â””â”€â”€ test_integration.py
â”‚
â””â”€â”€ docker/                     # å®¹å™¨åŒ–
    â”œâ”€â”€ Dockerfile
    â””â”€â”€ docker-compose.yaml
```

### 4.2 é…ç½®ç®¡ç†

```yaml
# config/controller_config.yaml
controller:
  type: "impedance"
  rate_hz: 1000
  
  # PID å‚æ•°
  pid:
    kp: 100.0
    ki: 10.0
    kd: 5.0
    
  # é˜»æŠ—å‚æ•°
  impedance:
    mass: 1.0        # è™šæ‹Ÿè´¨é‡ kg
    damping: 10.0    # é˜»å°¼ Ns/m
    stiffness: 500.0 # åˆšåº¦ N/m
    
  # å®‰å…¨é™åˆ¶
  safety:
    max_force: 20.0  # N
    max_velocity: 0.5  # m/s
    max_acceleration: 2.0  # m/s^2
    
  # è§¦è§‰å‚æ•°
  tactile:
    slip_threshold: 0.1
    contact_threshold: 0.5
    filter_alpha: 0.8

sensor:
  tactile:
    type: "gelsight_mini"
    device: "/dev/video2"
    resolution: [320, 240]
    fps: 60
    
  force_torque:
    type: "ati_mini45"
    interface: "can"
    can_id: 0x100
    rate_hz: 1000
```

### 4.3 æµ‹è¯•ç­–ç•¥

```python
# tests/test_control.py
import pytest
import numpy as np
from src.control.force_controller import ForceController
from src.control.slip_controller import SlipController

class TestForceController:
    """åŠ›æ§åˆ¶å™¨å•å…ƒæµ‹è¯•"""
    
    @pytest.fixture
    def controller(self):
        config = {
            'kp': 100.0,
            'ki': 10.0,
            'kd': 5.0,
            'max_force': 20.0
        }
        return ForceController(config)
    
    def test_pid_output_within_limits(self, controller):
        """æµ‹è¯• PID è¾“å‡ºåœ¨é™åˆ¶èŒƒå›´å†…"""
        for target in [0.0, 5.0, 10.0, 20.0]:
            controller.set_target(target)
            
            for measured in np.linspace(0, 25, 50):
                output = controller.compute(measured)
                assert -20.0 <= output <= 20.0
                
    def test_steady_state_error(self, controller):
        """æµ‹è¯•ç¨³æ€è¯¯å·®"""
        target = 5.0
        controller.set_target(target)
        
        # æ¨¡æ‹Ÿ 1000 æ­¥
        measured = 0.0
        for _ in range(1000):
            output = controller.compute(measured)
            measured = measured + output * 0.001  # ç®€åŒ–åŠ¨åŠ›å­¦
            
        # ç¨³æ€è¯¯å·®åº”å°äº 1%
        assert abs(measured - target) < target * 0.01
        
    def test_anti_windup(self, controller):
        """æµ‹è¯•æŠ—ç§¯åˆ†é¥±å’Œ"""
        controller.set_target(100.0)  # è¶…å‡ºé™åˆ¶çš„ç›®æ ‡
        
        for _ in range(1000):
            controller.compute(0.0)
            
        # ç§¯åˆ†é¡¹åº”è¢«é™åˆ¶
        assert abs(controller.integral_error) < 100.0

class TestSlipController:
    """æ»‘åŠ¨æ§åˆ¶å™¨æµ‹è¯•"""
    
    @pytest.fixture
    def controller(self):
        return SlipController(slip_threshold=0.1)
    
    def test_slip_detection(self, controller):
        """æµ‹è¯•æ»‘åŠ¨æ£€æµ‹"""
        # æ¨¡æ‹Ÿæ»‘åŠ¨
        tactile_data = {
            'tangential_force': np.array([0.0, 0.0]),
            'normal_force': 5.0
        }
        
        # åˆå§‹æ— æ»‘åŠ¨
        result = controller.update(tactile_data)
        assert not result['slip_detected']
        
        # æ¨¡æ‹Ÿæ»‘åŠ¨
        tactile_data['tangential_force'] = np.array([0.5, 0.3])
        result = controller.update(tactile_data)
        assert result['slip_detected']
        
    def test_grip_adjustment(self, controller):
        """æµ‹è¯•æŠ“å–åŠ›è°ƒæ•´"""
        # æ£€æµ‹åˆ°æ»‘åŠ¨æ—¶åº”å¢åŠ æŠ“å–åŠ›
        tactile_data = {
            'tangential_force': np.array([0.5, 0.3]),
            'normal_force': 5.0
        }
        
        result = controller.update(tactile_data)
        assert result['grip_adjustment'] > 0

# é›†æˆæµ‹è¯•
class TestIntegration:
    """ç³»ç»Ÿé›†æˆæµ‹è¯•"""
    
    @pytest.fixture
    def system(self):
        from src.control.system import ControlSystem
        return ControlSystem(config_path='config/test_config.yaml')
    
    def test_grasp_sequence(self, system):
        """æµ‹è¯•æŠ“å–åºåˆ—"""
        # 1. æ¥è¿‘
        system.move_to_pregrasp()
        assert system.state == 'pregrasp'
        
        # 2. æ¥è§¦
        system.approach_until_contact()
        assert system.is_in_contact()
        
        # 3. æŠ“å–
        system.grasp(target_force=5.0)
        assert 4.5 < system.get_grasp_force() < 5.5
        
        # 4. æèµ·
        system.lift(height=0.1)
        assert system.get_height() > 0.09
        
        # 5. æ£€æŸ¥æ— æ»‘åŠ¨
        assert not system.slip_detected()
```

### 4.4 CI/CD æµç¨‹

```yaml
# .github/workflows/ci.yaml
name: CI

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v4
        with:
          python-version: '3.10'
      - name: Lint
        run: |
          pip install ruff mypy
          ruff check src/
          mypy src/ --ignore-missing-imports

  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v4
        with:
          python-version: '3.10'
      - name: Install dependencies
        run: |
          pip install -e ".[dev]"
      - name: Run tests
        run: |
          pytest tests/ -v --cov=src --cov-report=xml
      - name: Upload coverage
        uses: codecov/codecov-action@v3

  build-cpp:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Build C++ components
        run: |
          mkdir build && cd build
          cmake .. -DCMAKE_BUILD_TYPE=Release
          make -j$(nproc)
      - name: Run C++ tests
        run: |
          cd build && ctest --output-on-failure

  ros2-build:
    runs-on: ubuntu-latest
    container:
      image: ros:humble
    steps:
      - uses: actions/checkout@v3
      - name: Build ROS 2 packages
        run: |
          source /opt/ros/humble/setup.bash
          cd ros2_ws
          colcon build --symlink-install
      - name: Test ROS 2 packages
        run: |
          source /opt/ros/humble/setup.bash
          source ros2_ws/install/setup.bash
          colcon test
```

---

## 5. éƒ¨ç½²ä¸è¿ç»´ (Deployment & Operations)

### 5.1 éƒ¨ç½²æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ç”Ÿäº§éƒ¨ç½²æ¶æ„                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                        äº‘ç«¯ (Cloud)                                  â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚   â”‚
â”‚   â”‚  â”‚ æ¨¡å‹è®­ç»ƒ     â”‚  â”‚ æ•°æ®å­˜å‚¨     â”‚  â”‚ ç›‘æ§å‘Šè­¦     â”‚               â”‚   â”‚
â”‚   â”‚  â”‚ (GPU é›†ç¾¤)   â”‚  â”‚ (S3/OSS)     â”‚  â”‚ (Grafana)    â”‚               â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â”‚ 5G / WiFi 6                            â”‚
â”‚                                    â–¼                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                      è¾¹ç¼˜æœåŠ¡å™¨ (Edge Server)                        â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚   â”‚
â”‚   â”‚  â”‚ VLA æ¨ç†     â”‚  â”‚ æ•°æ®ç¼“å­˜     â”‚  â”‚ OTA æ›´æ–°     â”‚               â”‚   â”‚
â”‚   â”‚  â”‚ (RTX 4090)   â”‚  â”‚ (Redis)      â”‚  â”‚ (K3s)        â”‚               â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â”‚ ä»¥å¤ªç½‘ / EtherCAT                      â”‚
â”‚                                    â–¼                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                      æœºå™¨äººæœ¬ä½“ (Robot)                              â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚   â”‚
â”‚   â”‚  â”‚ å®æ—¶æ§åˆ¶å™¨   â”‚  â”‚ ä¼ æ„Ÿå™¨é‡‡é›†   â”‚  â”‚ å®‰å…¨ç›‘æ§     â”‚               â”‚   â”‚
â”‚   â”‚  â”‚ (Jetson/MCU) â”‚  â”‚ (FPGA)       â”‚  â”‚ (PLC)        â”‚               â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   ğŸ’¡ å…³é”®: å®æ—¶æ§åˆ¶åœ¨æœ¬åœ°, é«˜å±‚å†³ç­–å¯è¿œç¨‹                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 å®¹å™¨åŒ–éƒ¨ç½²

```dockerfile
# Dockerfile
FROM nvidia/cuda:12.1-runtime-ubuntu22.04

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    python3.10 python3-pip \
    libopencv-dev \
    libeigen3-dev \
    && rm -rf /var/lib/apt/lists/*

# å®‰è£… Python ä¾èµ–
COPY requirements.txt /app/
RUN pip3 install -r /app/requirements.txt

# å¤åˆ¶ä»£ç 
COPY src/ /app/src/
COPY config/ /app/config/
COPY scripts/ /app/scripts/

WORKDIR /app

# è®¾ç½®ç¯å¢ƒå˜é‡
ENV PYTHONPATH=/app
ENV CUDA_VISIBLE_DEVICES=0

# å¯åŠ¨å‘½ä»¤
CMD ["python3", "scripts/run_controller.py", "--config", "config/production.yaml"]
```

```yaml
# docker-compose.yaml
version: '3.8'

services:
  controller:
    build: .
    runtime: nvidia
    privileged: true  # è®¿é—®ç¡¬ä»¶
    volumes:
      - /dev:/dev
      - ./data:/app/data
      - ./logs:/app/logs
    environment:
      - NVIDIA_VISIBLE_DEVICES=all
    network_mode: host  # å®æ—¶é€šä¿¡
    restart: unless-stopped

  monitoring:
    image: grafana/grafana:latest
    ports:
      - "3000:3000"
    volumes:
      - grafana_data:/var/lib/grafana

  prometheus:
    image: prom/prometheus:latest
    ports:
      - "9090:9090"
    volumes:
      - ./monitoring/prometheus.yml:/etc/prometheus/prometheus.yml

volumes:
  grafana_data:
```

---

## 6. é¢è¯•é«˜é¢‘ Q&A

### Q1: å¦‚ä½•ä¿è¯è§¦è§‰é—­ç¯æ§åˆ¶çš„å®æ—¶æ€§ï¼Ÿ

**å›ç­”è¦ç‚¹**:
1. **ç¡¬ä»¶å±‚é¢**: ä½¿ç”¨ PREEMPT_RT å†…æ ¸æˆ– Xenomai å®æ—¶æ“ä½œç³»ç»Ÿ
2. **è½¯ä»¶å±‚é¢**: 
   - æ§åˆ¶çº¿ç¨‹è®¾ç½® SCHED_FIFO è°ƒåº¦ç­–ç•¥å’Œæœ€é«˜ä¼˜å…ˆçº§
   - é¿å…åŠ¨æ€å†…å­˜åˆ†é… (é¢„åˆ†é… buffer)
   - é¿å…ç³»ç»Ÿè°ƒç”¨ (ä½¿ç”¨ mmap å…±äº«å†…å­˜)
3. **é€šä¿¡å±‚é¢**: ä½¿ç”¨ EtherCAT æˆ– CAN FDï¼Œé¿å… USB/ä»¥å¤ªç½‘
4. **ç›‘æ§**: æµ‹é‡æ§åˆ¶å‘¨æœŸæŠ–åŠ¨ (Jitter)ï¼ŒæŠ¥è­¦é˜ˆå€¼ < 100Î¼s

### Q2: è§¦è§‰ä¼ æ„Ÿå™¨æ ‡å®šå¦‚ä½•åšï¼Ÿ

**å›ç­”è¦ç‚¹**:
1. **åŠ›-ä½ç§»æ ‡å®š**: ç”¨å·²çŸ¥åŠ› (ç ç ) å‹è§¦è§‰ä¼ æ„Ÿå™¨ï¼Œè®°å½•è¯»æ•°
2. **é›¶ç‚¹æ ¡å‡†**: æ— æ¥è§¦æ—¶è®°å½•åŸºçº¿ï¼Œå®šæœŸé‡æ–°æ ¡å‡†
3. **æ¸©åº¦è¡¥å¿**: ç¡…èƒ¶ææ–™å—æ¸©åº¦å½±å“ï¼Œéœ€è¦æ¸©åº¦ä¼ æ„Ÿå™¨è¡¥å¿
4. **è€åŒ–è¡¥å¿**: é•¿æœŸä½¿ç”¨åææ–™å½¢å˜ï¼Œéœ€è¦å‘¨æœŸæ€§é‡æ–°æ ‡å®š

### Q3: å¦‚ä½•å¤„ç†å¤šä¼ æ„Ÿå™¨æ•°æ®åŒæ­¥é—®é¢˜ï¼Ÿ

**å›ç­”è¦ç‚¹**:
1. **ç¡¬ä»¶åŒæ­¥**: ä½¿ç”¨ PTP/IEEE 1588 æ—¶é’ŸåŒæ­¥ï¼Œç¡¬ä»¶è§¦å‘é‡‡é›†
2. **è½¯ä»¶åŒæ­¥**: 
   - æ‰€æœ‰æ•°æ®å¸¦æ—¶é—´æˆ³
   - ä½¿ç”¨æ’å€¼å¯¹é½åˆ°ç»Ÿä¸€æ—¶é—´è½´
   - å¤„ç†ä¸¢å¸§å’Œå»¶è¿Ÿ
3. **å®è·µç»éªŒ**: 
   - ç›¸æœºç”¨ç¡¬ä»¶è§¦å‘
   - åŠ›ä¼ æ„Ÿå™¨å’Œç¼–ç å™¨ç”¨ EtherCAT åŒæ­¥
   - é¢„ç•™ buffer å¤„ç†ç½‘ç»œæŠ–åŠ¨

### Q4: æ•°æ®é©±åŠ¨æ–¹æ³•ç›¸æ¯”ä¼ ç»Ÿæ§åˆ¶æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ

| ç»´åº¦ | ä¼ ç»Ÿæ§åˆ¶ | æ•°æ®é©±åŠ¨ |
| :--- | :--- | :--- |
| **æ³›åŒ–èƒ½åŠ›** | éœ€è¦ä¸ºæ¯ä¸ªä»»åŠ¡æ‰‹åŠ¨è°ƒå‚ | å¯ä»æ•°æ®ä¸­å­¦ä¹ æ³›åŒ– |
| **å¤æ‚ä»»åŠ¡** | éš¾ä»¥å¤„ç†é«˜ç»´ã€éçº¿æ€§ | å¯å¤„ç†å¤æ‚æ„ŸçŸ¥-åŠ¨ä½œæ˜ å°„ |
| **å¼€å‘æ•ˆç‡** | éœ€è¦ä¸“å®¶çŸ¥è¯†å»ºæ¨¡ | æ”¶é›†æ•°æ® + è®­ç»ƒ |
| **å¯è§£é‡Šæ€§** | é«˜ | ä½ (é»‘ç›’) |
| **å®‰å…¨æ€§** | å¯è¯æ˜ç¨³å®šæ€§ | éœ€è¦é¢å¤–å®‰å…¨æœºåˆ¶ |
| **å®æ—¶æ€§** | é«˜ | å–å†³äºæ¨¡å‹å¤æ‚åº¦ |

**æœ€ä½³å®è·µ**: æ··åˆæ¶æ„ â€”â€” é«˜å±‚ç”¨æ•°æ®é©±åŠ¨ç­–ç•¥ï¼Œä½å±‚ç”¨ä¼ ç»ŸåŠ›æ§ä¿è¯å®‰å…¨

### Q5: æè¿°ä¸€ä¸ªä½ è§£å†³è¿‡çš„è§¦è§‰æ§åˆ¶éš¾é¢˜

**æ¨¡æ¿å›ç­”**:
> "åœ¨å¼€å‘æŸ”æ€§ç‰©ä½“æŠ“å–æ—¶ï¼Œé‡åˆ°äº†**æ»‘åŠ¨æ£€æµ‹å»¶è¿Ÿ**å¯¼è‡´ç‰©ä½“æ‰è½çš„é—®é¢˜ã€‚
> 
> **åˆ†æ**: GelSight å¸§ç‡ 60Hzï¼Œå¤„ç†å»¶è¿Ÿ ~20msï¼Œæ€»å»¶è¿Ÿ ~35msï¼Œè¶…è¿‡äº†æ»‘åŠ¨å‘ç”Ÿåˆ°æ‰è½çš„æ—¶é—´çª—å£ã€‚
> 
> **è§£å†³æ–¹æ¡ˆ**:
> 1. åœ¨ FPGA ä¸Šå®ç°å…‰æµè®¡ç®—ï¼Œå°†å¤„ç†å»¶è¿Ÿé™åˆ° < 5ms
> 2. ä½¿ç”¨é¢„æµ‹æ¨¡å‹ï¼ŒåŸºäºåŠ›å˜åŒ–è¶‹åŠ¿æå‰é¢„æµ‹æ»‘åŠ¨
> 3. å¢åŠ åˆ‡å‘åŠ›ä¼ æ„Ÿå™¨ä½œä¸ºå†—ä½™ï¼Œå®ç° 1kHz å¿«é€Ÿæ»‘åŠ¨æ£€æµ‹
> 
> **ç»“æœ**: æ»‘åŠ¨å“åº”æ—¶é—´ä» 35ms é™åˆ° 8msï¼ŒæŠ“å–æˆåŠŸç‡ä» 75% æå‡åˆ° 95%ã€‚"

---

## ğŸ“š æ¨èèµ„æº

- [ROS 2 Control](https://control.ros.org/) - æœºå™¨äººæ§åˆ¶æ¡†æ¶
- [OROCOS](https://www.orocos.org/) - å®æ—¶æ§åˆ¶å·¥å…·é“¾
- [EtherCAT](https://www.ethercat.org/) - å·¥ä¸šå®æ—¶ä»¥å¤ªç½‘
- [GelSight SDK](https://github.com/gelsight/gsrobotics) - è§†è§¦è§‰ä¼ æ„Ÿå™¨
- [LeRobot](https://github.com/huggingface/lerobot) - ç«¯åˆ°ç«¯æœºå™¨äººå­¦ä¹ 

---

[â† Back to Deployment Index](./README.md)
[â† See Sensor Integration](./sensor_integration.md)
[â† See Dexterous Hand Guide](./dexterous_hand_guide.md)

